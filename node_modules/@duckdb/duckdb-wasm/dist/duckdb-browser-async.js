var duckdb=(()=>{var yy=Object.create;var Fi=Object.defineProperty;var by=Object.getOwnPropertyDescriptor;var my=Object.getOwnPropertyNames;var gy=Object.getPrototypeOf,_y=Object.prototype.hasOwnProperty;var nl=t=>Fi(t,"__esModule",{value:!0});var m=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Ty=(t,e)=>{nl(t);for(var r in e)Fi(t,r,{get:e[r],enumerable:!0})},By=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of my(e))!_y.call(t,n)&&n!=="default"&&Fi(t,n,{get:()=>e[n],enumerable:!(r=by(e,n))||r.enumerable});return t},Va=t=>By(nl(Fi(t!=null?yy(gy(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var jr=m(al=>{var p={};p.Offset;p.Table;p.SIZEOF_SHORT=2;p.SIZEOF_INT=4;p.FILE_IDENTIFIER_LENGTH=4;p.Encoding={UTF8_BYTES:1,UTF16_STRING:2};p.int32=new Int32Array(2);p.float32=new Float32Array(p.int32.buffer);p.float64=new Float64Array(p.int32.buffer);p.isLittleEndian=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;p.Long=function(t,e){this.low=t|0,this.high=e|0};p.Long.create=function(t,e){return t==0&&e==0?p.Long.ZERO:new p.Long(t,e)};p.Long.prototype.toFloat64=function(){return(this.low>>>0)+this.high*4294967296};p.Long.prototype.equals=function(t){return this.low==t.low&&this.high==t.high};p.Long.ZERO=new p.Long(0,0);p.Builder=function(t){if(t)var e=t;else var e=1024;this.bb=p.ByteBuffer.allocate(e),this.space=e,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1};p.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1};p.Builder.prototype.forceDefaults=function(t){this.force_defaults=t};p.Builder.prototype.dataBuffer=function(){return this.bb};p.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())};p.Builder.prototype.prep=function(t,e){t>this.minalign&&(this.minalign=t);for(var r=~(this.bb.capacity()-this.space+e)+1&t-1;this.space<r+t+e;){var n=this.bb.capacity();this.bb=p.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-n}this.pad(r)};p.Builder.prototype.pad=function(t){for(var e=0;e<t;e++)this.bb.writeInt8(--this.space,0)};p.Builder.prototype.writeInt8=function(t){this.bb.writeInt8(this.space-=1,t)};p.Builder.prototype.writeInt16=function(t){this.bb.writeInt16(this.space-=2,t)};p.Builder.prototype.writeInt32=function(t){this.bb.writeInt32(this.space-=4,t)};p.Builder.prototype.writeInt64=function(t){this.bb.writeInt64(this.space-=8,t)};p.Builder.prototype.writeFloat32=function(t){this.bb.writeFloat32(this.space-=4,t)};p.Builder.prototype.writeFloat64=function(t){this.bb.writeFloat64(this.space-=8,t)};p.Builder.prototype.addInt8=function(t){this.prep(1,0),this.writeInt8(t)};p.Builder.prototype.addInt16=function(t){this.prep(2,0),this.writeInt16(t)};p.Builder.prototype.addInt32=function(t){this.prep(4,0),this.writeInt32(t)};p.Builder.prototype.addInt64=function(t){this.prep(8,0),this.writeInt64(t)};p.Builder.prototype.addFloat32=function(t){this.prep(4,0),this.writeFloat32(t)};p.Builder.prototype.addFloat64=function(t){this.prep(8,0),this.writeFloat64(t)};p.Builder.prototype.addFieldInt8=function(t,e,r){(this.force_defaults||e!=r)&&(this.addInt8(e),this.slot(t))};p.Builder.prototype.addFieldInt16=function(t,e,r){(this.force_defaults||e!=r)&&(this.addInt16(e),this.slot(t))};p.Builder.prototype.addFieldInt32=function(t,e,r){(this.force_defaults||e!=r)&&(this.addInt32(e),this.slot(t))};p.Builder.prototype.addFieldInt64=function(t,e,r){(this.force_defaults||!e.equals(r))&&(this.addInt64(e),this.slot(t))};p.Builder.prototype.addFieldFloat32=function(t,e,r){(this.force_defaults||e!=r)&&(this.addFloat32(e),this.slot(t))};p.Builder.prototype.addFieldFloat64=function(t,e,r){(this.force_defaults||e!=r)&&(this.addFloat64(e),this.slot(t))};p.Builder.prototype.addFieldOffset=function(t,e,r){(this.force_defaults||e!=r)&&(this.addOffset(e),this.slot(t))};p.Builder.prototype.addFieldStruct=function(t,e,r){e!=r&&(this.nested(e),this.slot(t))};p.Builder.prototype.nested=function(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")};p.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")};p.Builder.prototype.slot=function(t){this.vtable[t]=this.offset()};p.Builder.prototype.offset=function(){return this.bb.capacity()-this.space};p.Builder.growByteBuffer=function(t){var e=t.capacity();if(e&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var r=e<<1,n=p.ByteBuffer.allocate(r);return n.setPosition(r-e),n.bytes().set(t.bytes(),r-e),n};p.Builder.prototype.addOffset=function(t){this.prep(p.SIZEOF_INT,0),this.writeInt32(this.offset()-t+p.SIZEOF_INT)};p.Builder.prototype.startObject=function(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(var e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()};p.Builder.prototype.endObject=function(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var t=this.offset(),e=this.vtable_in_use-1;e>=0&&this.vtable[e]==0;e--);for(var r=e+1;e>=0;e--)this.addInt16(this.vtable[e]!=0?t-this.vtable[e]:0);var n=2;this.addInt16(t-this.object_start);var s=(r+n)*p.SIZEOF_SHORT;this.addInt16(s);var a=0,o=this.space;e:for(e=0;e<this.vtables.length;e++){var c=this.bb.capacity()-this.vtables[e];if(s==this.bb.readInt16(c)){for(var f=p.SIZEOF_SHORT;f<s;f+=p.SIZEOF_SHORT)if(this.bb.readInt16(o+f)!=this.bb.readInt16(c+f))continue e;a=this.vtables[e];break}}return a?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,a-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t};p.Builder.prototype.finish=function(t,e){if(e){var r=e;if(this.prep(this.minalign,p.SIZEOF_INT+p.FILE_IDENTIFIER_LENGTH),r.length!=p.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+p.FILE_IDENTIFIER_LENGTH);for(var n=p.FILE_IDENTIFIER_LENGTH-1;n>=0;n--)this.writeInt8(r.charCodeAt(n))}this.prep(this.minalign,p.SIZEOF_INT),this.addOffset(t),this.bb.setPosition(this.space)};p.Builder.prototype.requiredField=function(t,e){var r=this.bb.capacity()-t,n=r-this.bb.readInt32(r),s=this.bb.readInt16(n+e)!=0;if(!s)throw new Error("FlatBuffers: field "+e+" must be set")};p.Builder.prototype.startVector=function(t,e,r){this.notNested(),this.vector_num_elems=e,this.prep(p.SIZEOF_INT,t*e),this.prep(r,t*e)};p.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset()};p.Builder.prototype.createString=function(t){if(t instanceof Uint8Array)var e=t;else for(var e=[],r=0;r<t.length;){var n,s=t.charCodeAt(r++);if(s<55296||s>=56320)n=s;else{var a=t.charCodeAt(r++);n=(s<<10)+a+(65536-(55296<<10)-56320)}n<128?e.push(n):(n<2048?e.push(n>>6&31|192):(n<65536?e.push(n>>12&15|224):e.push(n>>18&7|240,n>>12&63|128),e.push(n>>6&63|128)),e.push(n&63|128))}this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(var r=0,o=this.space,c=this.bb.bytes();r<e.length;r++)c[o++]=e[r];return this.endVector()};p.Builder.prototype.createLong=function(t,e){return p.Long.create(t,e)};p.ByteBuffer=function(t){this.bytes_=t,this.position_=0};p.ByteBuffer.allocate=function(t){return new p.ByteBuffer(new Uint8Array(t))};p.ByteBuffer.prototype.clear=function(){this.position_=0};p.ByteBuffer.prototype.bytes=function(){return this.bytes_};p.ByteBuffer.prototype.position=function(){return this.position_};p.ByteBuffer.prototype.setPosition=function(t){this.position_=t};p.ByteBuffer.prototype.capacity=function(){return this.bytes_.length};p.ByteBuffer.prototype.readInt8=function(t){return this.readUint8(t)<<24>>24};p.ByteBuffer.prototype.readUint8=function(t){return this.bytes_[t]};p.ByteBuffer.prototype.readInt16=function(t){return this.readUint16(t)<<16>>16};p.ByteBuffer.prototype.readUint16=function(t){return this.bytes_[t]|this.bytes_[t+1]<<8};p.ByteBuffer.prototype.readInt32=function(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24};p.ByteBuffer.prototype.readUint32=function(t){return this.readInt32(t)>>>0};p.ByteBuffer.prototype.readInt64=function(t){return new p.Long(this.readInt32(t),this.readInt32(t+4))};p.ByteBuffer.prototype.readUint64=function(t){return new p.Long(this.readUint32(t),this.readUint32(t+4))};p.ByteBuffer.prototype.readFloat32=function(t){return p.int32[0]=this.readInt32(t),p.float32[0]};p.ByteBuffer.prototype.readFloat64=function(t){return p.int32[p.isLittleEndian?0:1]=this.readInt32(t),p.int32[p.isLittleEndian?1:0]=this.readInt32(t+4),p.float64[0]};p.ByteBuffer.prototype.writeInt8=function(t,e){this.bytes_[t]=e};p.ByteBuffer.prototype.writeUint8=function(t,e){this.bytes_[t]=e};p.ByteBuffer.prototype.writeInt16=function(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8};p.ByteBuffer.prototype.writeUint16=function(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8};p.ByteBuffer.prototype.writeInt32=function(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24};p.ByteBuffer.prototype.writeUint32=function(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24};p.ByteBuffer.prototype.writeInt64=function(t,e){this.writeInt32(t,e.low),this.writeInt32(t+4,e.high)};p.ByteBuffer.prototype.writeUint64=function(t,e){this.writeUint32(t,e.low),this.writeUint32(t+4,e.high)};p.ByteBuffer.prototype.writeFloat32=function(t,e){p.float32[0]=e,this.writeInt32(t,p.int32[0])};p.ByteBuffer.prototype.writeFloat64=function(t,e){p.float64[0]=e,this.writeInt32(t,p.int32[p.isLittleEndian?0:1]),this.writeInt32(t+4,p.int32[p.isLittleEndian?1:0])};p.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+p.SIZEOF_INT+p.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var t="",e=0;e<p.FILE_IDENTIFIER_LENGTH;e++)t+=String.fromCharCode(this.readInt8(this.position_+p.SIZEOF_INT+e));return t};p.ByteBuffer.prototype.__offset=function(t,e){var r=t-this.readInt32(t);return e<this.readInt16(r)?this.readInt16(r+e):0};p.ByteBuffer.prototype.__union=function(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t};p.ByteBuffer.prototype.__string=function(t,e){t+=this.readInt32(t);var r=this.readInt32(t),n="",s=0;if(t+=p.SIZEOF_INT,e===p.Encoding.UTF8_BYTES)return this.bytes_.subarray(t,t+r);for(;s<r;){var a,o=this.readUint8(t+s++);if(o<192)a=o;else{var c=this.readUint8(t+s++);if(o<224)a=(o&31)<<6|c&63;else{var f=this.readUint8(t+s++);if(o<240)a=(o&15)<<12|(c&63)<<6|f&63;else{var i=this.readUint8(t+s++);a=(o&7)<<18|(c&63)<<12|(f&63)<<6|i&63}}}a<65536?n+=String.fromCharCode(a):(a-=65536,n+=String.fromCharCode((a>>10)+55296,(a&(1<<10)-1)+56320))}return n};p.ByteBuffer.prototype.__indirect=function(t){return t+this.readInt32(t)};p.ByteBuffer.prototype.__vector=function(t){return t+this.readInt32(t)+p.SIZEOF_INT};p.ByteBuffer.prototype.__vector_len=function(t){return this.readInt32(t+this.readInt32(t))};p.ByteBuffer.prototype.__has_identifier=function(t){if(t.length!=p.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+p.FILE_IDENTIFIER_LENGTH);for(var e=0;e<p.FILE_IDENTIFIER_LENGTH;e++)if(t.charCodeAt(e)!=this.readInt8(this.position_+p.SIZEOF_INT+e))return!1;return!0};p.ByteBuffer.prototype.createLong=function(t,e){return p.Long.create(t,e)};al.flatbuffers=p});var ol=m(La=>{"use strict";function Vt(t,e,r){return e<=t&&t<=r}function Di(t){if(t===void 0)return{};if(t===Object(t))return t;throw TypeError("Could not convert argument to dictionary")}function Oy(t){for(var e=String(t),r=e.length,n=0,s=[];n<r;){var a=e.charCodeAt(n);if(a<55296||a>57343)s.push(a);else if(56320<=a&&a<=57343)s.push(65533);else if(55296<=a&&a<=56319)if(n===r-1)s.push(65533);else{var o=t.charCodeAt(n+1);if(56320<=o&&o<=57343){var c=a&1023,f=o&1023;s.push(65536+(c<<10)+f),n+=1}else s.push(65533)}n+=1}return s}function Ay(t){for(var e="",r=0;r<t.length;++r){var n=t[r];n<=65535?e+=String.fromCharCode(n):(n-=65536,e+=String.fromCharCode((n>>10)+55296,(n&1023)+56320))}return e}var Ri=-1;function Pa(t){this.tokens=[].slice.call(t)}Pa.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():Ri},prepend:function(t){if(Array.isArray(t))for(var e=t;e.length;)this.tokens.unshift(e.pop());else this.tokens.unshift(t)},push:function(t){if(Array.isArray(t))for(var e=t;e.length;)this.tokens.push(e.shift());else this.tokens.push(t)}};var kr=-1;function Na(t,e){if(t)throw TypeError("Decoder error");return e||65533}var Ei="utf-8";function Ui(t,e){if(!(this instanceof Ui))return new Ui(t,e);if(t=t!==void 0?String(t).toLowerCase():Ei,t!==Ei)throw new Error("Encoding not supported. Only utf-8 is supported");e=Di(e),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=Boolean(e.fatal),this._ignoreBOM=Boolean(e.ignoreBOM),Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}Ui.prototype={decode:function(e,r){var n;typeof e=="object"&&e instanceof ArrayBuffer?n=new Uint8Array(e):typeof e=="object"&&"buffer"in e&&e.buffer instanceof ArrayBuffer?n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):n=new Uint8Array(0),r=Di(r),this._streaming||(this._decoder=new Fy({fatal:this._fatal}),this._BOMseen=!1),this._streaming=Boolean(r.stream);for(var s=new Pa(n),a=[],o;!s.endOfStream()&&(o=this._decoder.handler(s,s.read()),o!==kr);)o!==null&&(Array.isArray(o)?a.push.apply(a,o):a.push(o));if(!this._streaming){do{if(o=this._decoder.handler(s,s.read()),o===kr)break;o!==null&&(Array.isArray(o)?a.push.apply(a,o):a.push(o))}while(!s.endOfStream());this._decoder=null}return a.length&&["utf-8"].indexOf(this.encoding)!==-1&&!this._ignoreBOM&&!this._BOMseen&&(a[0]===65279?(this._BOMseen=!0,a.shift()):this._BOMseen=!0),Ay(a)}};function Vi(t,e){if(!(this instanceof Vi))return new Vi(t,e);if(t=t!==void 0?String(t).toLowerCase():Ei,t!==Ei)throw new Error("Encoding not supported. Only utf-8 is supported");e=Di(e),this._streaming=!1,this._encoder=null,this._options={fatal:Boolean(e.fatal)},Object.defineProperty(this,"encoding",{value:"utf-8"})}Vi.prototype={encode:function(e,r){e=e?String(e):"",r=Di(r),this._streaming||(this._encoder=new Dy(this._options)),this._streaming=Boolean(r.stream);for(var n=[],s=new Pa(Oy(e)),a;!s.endOfStream()&&(a=this._encoder.handler(s,s.read()),a!==kr);)Array.isArray(a)?n.push.apply(n,a):n.push(a);if(!this._streaming){for(;a=this._encoder.handler(s,s.read()),a!==kr;)Array.isArray(a)?n.push.apply(n,a):n.push(a);this._encoder=null}return new Uint8Array(n)}};function Fy(t){var e=t.fatal,r=0,n=0,s=0,a=128,o=191;this.handler=function(c,f){if(f===Ri&&s!==0)return s=0,Na(e);if(f===Ri)return kr;if(s===0){if(Vt(f,0,127))return f;if(Vt(f,194,223))s=1,r=f-192;else if(Vt(f,224,239))f===224&&(a=160),f===237&&(o=159),s=2,r=f-224;else if(Vt(f,240,244))f===240&&(a=144),f===244&&(o=143),s=3,r=f-240;else return Na(e);return r=r<<6*s,null}if(!Vt(f,a,o))return r=s=n=0,a=128,o=191,c.prepend(f),Na(e);if(a=128,o=191,n+=1,r+=f-128<<6*(s-n),n!==s)return null;var i=r;return r=s=n=0,i}}function Dy(t){var e=t.fatal;this.handler=function(r,n){if(n===Ri)return kr;if(Vt(n,0,127))return n;var s,a;Vt(n,128,2047)?(s=1,a=192):Vt(n,2048,65535)?(s=2,a=224):Vt(n,65536,1114111)&&(s=3,a=240);for(var o=[(n>>6*s)+a];s>0;){var c=n>>6*(s-1);o.push(128|c&63),s-=1}return o}}La.TextEncoder=Vi;La.TextDecoder=Ui});var Ir=m(Cr=>{"use strict";Object.defineProperty(Cr,"__esModule",{value:!0});Cr.encodeUtf8=Cr.decodeUtf8=void 0;var cl=de(),ul=ol(),Mi=typeof Buffer=="function"?Buffer:null,ll=typeof TextDecoder=="function"&&typeof TextEncoder=="function";Cr.decodeUtf8=(t=>{if(ll||!Mi){let e=new t("utf-8");return r=>e.decode(r)}return e=>{let{buffer:r,byteOffset:n,length:s}=cl.toUint8Array(e);return Mi.from(r,n,s).toString()}})(typeof TextDecoder!="undefined"?TextDecoder:ul.TextDecoder);Cr.encodeUtf8=(t=>{if(ll||!Mi){let e=new t;return r=>e.encode(r)}return(e="")=>cl.toUint8Array(Mi.from(e,"utf8"))})(typeof TextEncoder!="undefined"?TextEncoder:ul.TextEncoder)});var qr=m(Ve=>{"use strict";Object.defineProperty(Ve,"__esModule",{value:!0});Ve.AsyncQueue=Ve.ReadableInterop=Ve.ArrowJSON=Ve.ITERATOR_DONE=void 0;var dl=jn();Ve.ITERATOR_DONE=Object.freeze({done:!0,value:void 0});var fl=class{constructor(e){this._json=e}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}};Ve.ArrowJSON=fl;var xa=class{tee(){return this._getDOMStream().tee()}pipe(e,r){return this._getNodeStream().pipe(e,r)}pipeTo(e,r){return this._getDOMStream().pipeTo(e,r)}pipeThrough(e,r){return this._getDOMStream().pipeThrough(e,r)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}};Ve.ReadableInterop=xa;var hl=class extends xa{constructor(){super();this._values=[],this.resolvers=[],this._closedPromise=new Promise(e=>this._closedPromiseResolve=e)}get closed(){return this._closedPromise}async cancel(e){await this.return(e)}write(e){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(e):this.resolvers.shift().resolve({done:!1,value:e}))}abort(e){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:e}:this.resolvers.shift().reject({done:!0,value:e}))}close(){if(this._closedPromiseResolve){let{resolvers:e}=this;for(;e.length>0;)e.shift().resolve(Ve.ITERATOR_DONE);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(e){return dl.default.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,e)}toNodeStream(e){return dl.default.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,e)}async throw(e){return await this.abort(e),Ve.ITERATOR_DONE}async return(e){return await this.close(),Ve.ITERATOR_DONE}async read(e){return(await this.next(e,"read")).value}async peek(e){return(await this.next(e,"peek")).value}next(...e){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((r,n)=>{this.resolvers.push({resolve:r,reject:n})}):Promise.resolve(Ve.ITERATOR_DONE)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error(`${this} is closed`)}};Ve.AsyncQueue=hl});var Ae=m(S=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});S.isReadableNodeStream=S.isWritableNodeStream=S.isReadableDOMStream=S.isWritableDOMStream=S.isFetchResponse=S.isFSReadStream=S.isFileHandle=S.isUnderlyingSink=S.isIteratorResult=S.isArrayLike=S.isArrowJSON=S.isAsyncIterable=S.isIterable=S.isObservable=S.isPromise=S.isObject=S.BigUint64ArrayAvailable=S.BigUint64Array=S.BigInt64ArrayAvailable=S.BigInt64Array=S.BigIntAvailable=S.BigInt=void 0;var Pi=qr(),[Ry,Ey]=(()=>{let t=()=>{throw new Error("BigInt is not available in this environment")};function e(){throw t()}return e.asIntN=()=>{throw t()},e.asUintN=()=>{throw t()},typeof BigInt!="undefined"?[BigInt,!0]:[e,!1]})();S.BigInt=Ry;S.BigIntAvailable=Ey;var[Uy,Vy]=(()=>{let t=()=>{throw new Error("BigInt64Array is not available in this environment")};class e{static get BYTES_PER_ELEMENT(){return 8}static of(){throw t()}static from(){throw t()}constructor(){throw t()}}return typeof BigInt64Array!="undefined"?[BigInt64Array,!0]:[e,!1]})();S.BigInt64Array=Uy;S.BigInt64ArrayAvailable=Vy;var[My,Py]=(()=>{let t=()=>{throw new Error("BigUint64Array is not available in this environment")};class e{static get BYTES_PER_ELEMENT(){return 8}static of(){throw t()}static from(){throw t()}constructor(){throw t()}}return typeof BigUint64Array!="undefined"?[BigUint64Array,!0]:[e,!1]})();S.BigUint64Array=My;S.BigUint64ArrayAvailable=Py;var ja=t=>typeof t=="number",pl=t=>typeof t=="boolean",we=t=>typeof t=="function";S.isObject=t=>t!=null&&Object(t)===t;S.isPromise=t=>S.isObject(t)&&we(t.then);S.isObservable=t=>S.isObject(t)&&we(t.subscribe);S.isIterable=t=>S.isObject(t)&&we(t[Symbol.iterator]);S.isAsyncIterable=t=>S.isObject(t)&&we(t[Symbol.asyncIterator]);S.isArrowJSON=t=>S.isObject(t)&&S.isObject(t.schema);S.isArrayLike=t=>S.isObject(t)&&ja(t.length);S.isIteratorResult=t=>S.isObject(t)&&"done"in t&&"value"in t;S.isUnderlyingSink=t=>S.isObject(t)&&we(t.abort)&&we(t.close)&&we(t.start)&&we(t.write);S.isFileHandle=t=>S.isObject(t)&&we(t.stat)&&ja(t.fd);S.isFSReadStream=t=>S.isReadableNodeStream(t)&&ja(t.bytesRead);S.isFetchResponse=t=>S.isObject(t)&&S.isReadableDOMStream(t.body);S.isWritableDOMStream=t=>S.isObject(t)&&we(t.abort)&&we(t.getWriter)&&!(t instanceof Pi.ReadableInterop);S.isReadableDOMStream=t=>S.isObject(t)&&we(t.cancel)&&we(t.getReader)&&!(t instanceof Pi.ReadableInterop);S.isWritableNodeStream=t=>S.isObject(t)&&we(t.end)&&we(t.write)&&pl(t.writable)&&!(t instanceof Pi.ReadableInterop);S.isReadableNodeStream=t=>S.isObject(t)&&we(t.read)&&we(t.pipe)&&pl(t.readable)&&!(t instanceof Pi.ReadableInterop)});var de=m(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});I.compareArrayLike=I.rebaseValueOffsets=I.toUint8ClampedArrayAsyncIterator=I.toFloat64ArrayAsyncIterator=I.toFloat32ArrayAsyncIterator=I.toUint32ArrayAsyncIterator=I.toUint16ArrayAsyncIterator=I.toUint8ArrayAsyncIterator=I.toInt32ArrayAsyncIterator=I.toInt16ArrayAsyncIterator=I.toInt8ArrayAsyncIterator=I.toArrayBufferViewAsyncIterator=I.toUint8ClampedArrayIterator=I.toFloat64ArrayIterator=I.toFloat32ArrayIterator=I.toUint32ArrayIterator=I.toUint16ArrayIterator=I.toUint8ArrayIterator=I.toInt32ArrayIterator=I.toInt16ArrayIterator=I.toInt8ArrayIterator=I.toArrayBufferViewIterator=I.toUint8ClampedArray=I.toFloat64Array=I.toFloat32Array=I.toBigUint64Array=I.toUint32Array=I.toUint16Array=I.toUint8Array=I.toBigInt64Array=I.toInt32Array=I.toInt16Array=I.toInt8Array=I.toArrayBufferView=I.joinUint8Arrays=I.memcpy=void 0;var Ny=jr(),Ly=Ir(),xy=Ny.flatbuffers.ByteBuffer,wr=Ae(),ka=typeof SharedArrayBuffer!="undefined"?SharedArrayBuffer:ArrayBuffer;function jy(t){let e=t[0]?[t[0]]:[],r,n,s,a;for(let o,c,f=0,i=0,u=t.length;++f<u;){if(o=e[i],c=t[f],!o||!c||o.buffer!==c.buffer||c.byteOffset<o.byteOffset){c&&(e[++i]=c);continue}if({byteOffset:r,byteLength:s}=o,{byteOffset:n,byteLength:a}=c,r+s<n||n+a<r){c&&(e[++i]=c);continue}e[i]=new Uint8Array(o.buffer,r,n-r+a)}return e}function Ca(t,e,r=0,n=e.byteLength){let s=t.byteLength,a=new Uint8Array(t.buffer,t.byteOffset,s),o=new Uint8Array(e.buffer,e.byteOffset,Math.min(n,s));return a.set(o,r),t}I.memcpy=Ca;function ky(t,e){let r=jy(t),n=r.reduce((u,y)=>u+y.byteLength,0),s,a,o,c=0,f=-1,i=Math.min(e||1/0,n);for(let u=r.length;++f<u;){if(s=r[f],a=s.subarray(0,Math.min(s.length,i-c)),i<=c+a.length){a.length<s.length?r[f]=s.subarray(a.length):a.length===s.length&&f++,o?Ca(o,a,c):o=a;break}Ca(o||(o=new Uint8Array(i)),a,c),c+=a.length}return[o||new Uint8Array(0),r.slice(f),n-(o?o.byteLength:0)]}I.joinUint8Arrays=ky;function De(t,e){let r=wr.isIteratorResult(e)?e.value:e;return r instanceof t?t===Uint8Array?new t(r.buffer,r.byteOffset,r.byteLength):r:r?(typeof r=="string"&&(r=Ly.encodeUtf8(r)),r instanceof ArrayBuffer?new t(r):r instanceof ka?new t(r):r instanceof xy?De(t,r.bytes()):ArrayBuffer.isView(r)?r.byteLength<=0?new t(0):new t(r.buffer,r.byteOffset,r.byteLength/t.BYTES_PER_ELEMENT):t.from(r)):new t(0)}I.toArrayBufferView=De;I.toInt8Array=t=>De(Int8Array,t);I.toInt16Array=t=>De(Int16Array,t);I.toInt32Array=t=>De(Int32Array,t);I.toBigInt64Array=t=>De(wr.BigInt64Array,t);I.toUint8Array=t=>De(Uint8Array,t);I.toUint16Array=t=>De(Uint16Array,t);I.toUint32Array=t=>De(Uint32Array,t);I.toBigUint64Array=t=>De(wr.BigUint64Array,t);I.toFloat32Array=t=>De(Float32Array,t);I.toFloat64Array=t=>De(Float64Array,t);I.toUint8ClampedArray=t=>De(Uint8ClampedArray,t);var qa=t=>(t.next(),t);function*ht(t,e){let r=function*(s){yield s},n=typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof ka?r(e):wr.isIterable(e)?e:r(e);return yield*qa(function*(s){let a=null;do a=s.next(yield De(t,a));while(!a.done)}(n[Symbol.iterator]())),new t}I.toArrayBufferViewIterator=ht;I.toInt8ArrayIterator=t=>ht(Int8Array,t);I.toInt16ArrayIterator=t=>ht(Int16Array,t);I.toInt32ArrayIterator=t=>ht(Int32Array,t);I.toUint8ArrayIterator=t=>ht(Uint8Array,t);I.toUint16ArrayIterator=t=>ht(Uint16Array,t);I.toUint32ArrayIterator=t=>ht(Uint32Array,t);I.toFloat32ArrayIterator=t=>ht(Float32Array,t);I.toFloat64ArrayIterator=t=>ht(Float64Array,t);I.toUint8ClampedArrayIterator=t=>ht(Uint8ClampedArray,t);async function*it(t,e){if(wr.isPromise(e))return yield*it(t,await e);let r=async function*(a){yield await a},n=async function*(a){yield*qa(function*(o){let c=null;do c=o.next(yield c&&c.value);while(!c.done)}(a[Symbol.iterator]()))},s=typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof ka?r(e):wr.isIterable(e)?n(e):wr.isAsyncIterable(e)?e:r(e);return yield*qa(async function*(a){let o=null;do o=await a.next(yield De(t,o));while(!o.done)}(s[Symbol.asyncIterator]())),new t}I.toArrayBufferViewAsyncIterator=it;I.toInt8ArrayAsyncIterator=t=>it(Int8Array,t);I.toInt16ArrayAsyncIterator=t=>it(Int16Array,t);I.toInt32ArrayAsyncIterator=t=>it(Int32Array,t);I.toUint8ArrayAsyncIterator=t=>it(Uint8Array,t);I.toUint16ArrayAsyncIterator=t=>it(Uint16Array,t);I.toUint32ArrayAsyncIterator=t=>it(Uint32Array,t);I.toFloat32ArrayAsyncIterator=t=>it(Float32Array,t);I.toFloat64ArrayAsyncIterator=t=>it(Float64Array,t);I.toUint8ClampedArrayAsyncIterator=t=>it(Uint8ClampedArray,t);function Cy(t,e,r){if(t!==0){r=r.slice(0,e+1);for(let n=-1;++n<=e;)r[n]+=t}return r}I.rebaseValueOffsets=Cy;function qy(t,e){let r=0,n=t.length;if(n!==e.length)return!1;if(n>0)do if(t[r]!==e[r])return!1;while(++r<n);return!0}I.compareArrayLike=qy});var jn=m(za=>{"use strict";Object.defineProperty(za,"__esModule",{value:!0});var Re=de();za.default={fromIterable(t){return Ni(Wy(t))},fromAsyncIterable(t){return Ni(zy(t))},fromDOMStream(t){return Ni(Yy(t))},fromNodeStream(t){return Ni(Gy(t))},toDOMStream(t,e){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(t,e){throw new Error('"toNodeStream" not available in this environment')}};var Ni=t=>(t.next(),t);function*Wy(t){let e,r=!1,n=[],s,a,o,c=0;function f(){return a==="peek"?Re.joinUint8Arrays(n,o)[0]:([s,n,c]=Re.joinUint8Arrays(n,o),s)}({cmd:a,size:o}=yield null);let i=Re.toUint8ArrayIterator(t)[Symbol.iterator]();try{do if({done:e,value:s}=isNaN(o-c)?i.next(void 0):i.next(o-c),!e&&s.byteLength>0&&(n.push(s),c+=s.byteLength),e||o<=c)do({cmd:a,size:o}=yield f());while(o<c);while(!e)}catch(u){(r=!0)&&typeof i.throw=="function"&&i.throw(u)}finally{r===!1&&typeof i.return=="function"&&i.return(null)}return null}async function*zy(t){let e,r=!1,n=[],s,a,o,c=0;function f(){return a==="peek"?Re.joinUint8Arrays(n,o)[0]:([s,n,c]=Re.joinUint8Arrays(n,o),s)}({cmd:a,size:o}=yield null);let i=Re.toUint8ArrayAsyncIterator(t)[Symbol.asyncIterator]();try{do if({done:e,value:s}=isNaN(o-c)?await i.next(void 0):await i.next(o-c),!e&&s.byteLength>0&&(n.push(s),c+=s.byteLength),e||o<=c)do({cmd:a,size:o}=yield f());while(o<c);while(!e)}catch(u){(r=!0)&&typeof i.throw=="function"&&await i.throw(u)}finally{r===!1&&typeof i.return=="function"&&await i.return(new Uint8Array(0))}return null}async function*Yy(t){let e=!1,r=!1,n=[],s,a,o,c=0;function f(){return a==="peek"?Re.joinUint8Arrays(n,o)[0]:([s,n,c]=Re.joinUint8Arrays(n,o),s)}({cmd:a,size:o}=yield null);let i=new yl(t);try{do if({done:e,value:s}=isNaN(o-c)?await i.read(void 0):await i.read(o-c),!e&&s.byteLength>0&&(n.push(Re.toUint8Array(s)),c+=s.byteLength),e||o<=c)do({cmd:a,size:o}=yield f());while(o<c);while(!e)}catch(u){(r=!0)&&await i.cancel(u)}finally{r===!1?await i.cancel():t.locked&&i.releaseLock()}return null}var yl=class{constructor(e){this.source=e,this.byobReader=null,this.defaultReader=null;try{this.supportsBYOB=!!(this.reader=this.getBYOBReader())}catch{this.supportsBYOB=!(this.reader=this.getDefaultReader())}}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=this.byobReader=this.defaultReader=null}async cancel(e){let{reader:r,source:n}=this;r&&await r.cancel(e).catch(()=>{}),n&&n.locked&&this.releaseLock()}async read(e){if(e===0)return{done:this.reader==null,value:new Uint8Array(0)};let r=!this.supportsBYOB||typeof e!="number"?await this.getDefaultReader().read():await this.readFromBYOBReader(e);return!r.done&&(r.value=Re.toUint8Array(r)),r}getDefaultReader(){return this.byobReader&&this.releaseLock(),this.defaultReader||(this.defaultReader=this.source.getReader(),this.defaultReader.closed.catch(()=>{})),this.reader=this.defaultReader}getBYOBReader(){return this.defaultReader&&this.releaseLock(),this.byobReader||(this.byobReader=this.source.getReader({mode:"byob"}),this.byobReader.closed.catch(()=>{})),this.reader=this.byobReader}async readFromBYOBReader(e){return await bl(this.getBYOBReader(),new ArrayBuffer(e),0,e)}};async function bl(t,e,r,n){if(r>=n)return{done:!1,value:new Uint8Array(e,0,n)};let{done:s,value:a}=await t.read(new Uint8Array(e,r,n-r));return(r+=a.byteLength)<n&&!s?await bl(t,a.buffer,r,n):{done:s,value:new Uint8Array(a.buffer,0,r)}}var Wa=(t,e)=>{let r=s=>n([e,s]),n;return[e,r,new Promise(s=>(n=s)&&t.once(e,r))]};async function*Gy(t){let e=[],r="error",n=!1,s=null,a,o,c=0,f=[],i;function u(){return a==="peek"?Re.joinUint8Arrays(f,o)[0]:([i,f,c]=Re.joinUint8Arrays(f,o),i)}if({cmd:a,size:o}=yield null,t.isTTY)return yield new Uint8Array(0),null;try{e[0]=Wa(t,"end"),e[1]=Wa(t,"error");do{if(e[2]=Wa(t,"readable"),[r,s]=await Promise.race(e.map(N=>N[2])),r==="error")break;if((n=r==="end")||(isFinite(o-c)?(i=Re.toUint8Array(t.read(o-c)),i.byteLength<o-c&&(i=Re.toUint8Array(t.read(void 0)))):i=Re.toUint8Array(t.read(void 0)),i.byteLength>0&&(f.push(i),c+=i.byteLength)),n||o<=c)do({cmd:a,size:o}=yield u());while(o<c)}while(!n)}finally{await y(e,r==="error"?s:null)}return null;function y(N,Z){return i=f=null,new Promise(async(ke,xr)=>{for(let[zt,py]of N)t.off(zt,py);try{let zt=t.destroy;zt&&zt.call(t,Z),Z=void 0}catch(zt){Z=zt||Z}finally{Z!=null?xr(Z):ke()}})}}});var ue=m(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});Wr.Vector=Wr.AbstractVector=void 0;var Li=class{};Wr.AbstractVector=Li;Wr.Vector=Li;Li.prototype.data=null});var zr=m(w=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0});w.org=void 0;var $;(function(t){var e;(function(r){var n;(function(s){var a;(function(o){let c;(function(f){f[f.V1=0]="V1",f[f.V2=1]="V2",f[f.V3=2]="V3",f[f.V4=3]="V4"})(c=o.MetadataVersion||(o.MetadataVersion={}))})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){let c;(function(f){f[f.Sparse=0]="Sparse",f[f.Dense=1]="Dense"})(c=o.UnionMode||(o.UnionMode={}))})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){let c;(function(f){f[f.HALF=0]="HALF",f[f.SINGLE=1]="SINGLE",f[f.DOUBLE=2]="DOUBLE"})(c=o.Precision||(o.Precision={}))})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){let c;(function(f){f[f.DAY=0]="DAY",f[f.MILLISECOND=1]="MILLISECOND"})(c=o.DateUnit||(o.DateUnit={}))})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){let c;(function(f){f[f.SECOND=0]="SECOND",f[f.MILLISECOND=1]="MILLISECOND",f[f.MICROSECOND=2]="MICROSECOND",f[f.NANOSECOND=3]="NANOSECOND"})(c=o.TimeUnit||(o.TimeUnit={}))})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){let c;(function(f){f[f.YEAR_MONTH=0]="YEAR_MONTH",f[f.DAY_TIME=1]="DAY_TIME"})(c=o.IntervalUnit||(o.IntervalUnit={}))})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){let c;(function(f){f[f.NONE=0]="NONE",f[f.Null=1]="Null",f[f.Int=2]="Int",f[f.FloatingPoint=3]="FloatingPoint",f[f.Binary=4]="Binary",f[f.Utf8=5]="Utf8",f[f.Bool=6]="Bool",f[f.Decimal=7]="Decimal",f[f.Date=8]="Date",f[f.Time=9]="Time",f[f.Timestamp=10]="Timestamp",f[f.Interval=11]="Interval",f[f.List=12]="List",f[f.Struct_=13]="Struct_",f[f.Union=14]="Union",f[f.FixedSizeBinary=15]="FixedSizeBinary",f[f.FixedSizeList=16]="FixedSizeList",f[f.Map=17]="Map",f[f.Duration=18]="Duration",f[f.LargeBinary=19]="LargeBinary",f[f.LargeUtf8=20]="LargeUtf8",f[f.LargeList=21]="LargeList"})(c=o.Type||(o.Type={}))})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){let c;(function(f){f[f.Little=0]="Little",f[f.Big=1]="Big"})(c=o.Endianness||(o.Endianness={}))})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsNull(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}static startNull(i){i.startObject(0)}static endNull(i){return i.endObject()}static createNull(i){return c.startNull(i),c.endNull(i)}}o.Null=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsStruct_(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}static startStruct_(i){i.startObject(0)}static endStruct_(i){return i.endObject()}static createStruct_(i){return c.startStruct_(i),c.endStruct_(i)}}o.Struct_=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsList(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}static startList(i){i.startObject(0)}static endList(i){return i.endObject()}static createList(i){return c.startList(i),c.endList(i)}}o.List=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsLargeList(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}static startLargeList(i){i.startObject(0)}static endLargeList(i){return i.endObject()}static createLargeList(i){return c.startLargeList(i),c.endLargeList(i)}}o.LargeList=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsFixedSizeList(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}listSize(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt32(this.bb_pos+i):0}static startFixedSizeList(i){i.startObject(1)}static addListSize(i,u){i.addFieldInt32(0,u,0)}static endFixedSizeList(i){return i.endObject()}static createFixedSizeList(i,u){return c.startFixedSizeList(i),c.addListSize(i,u),c.endFixedSizeList(i)}}o.FixedSizeList=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsMap(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}keysSorted(){let i=this.bb.__offset(this.bb_pos,4);return i?!!this.bb.readInt8(this.bb_pos+i):!1}static startMap(i){i.startObject(1)}static addKeysSorted(i,u){i.addFieldInt8(0,+u,0)}static endMap(i){return i.endObject()}static createMap(i,u){return c.startMap(i),c.addKeysSorted(i,u),c.endMap(i)}}o.Map=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsUnion(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}mode(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt16(this.bb_pos+i):t.apache.arrow.flatbuf.UnionMode.Sparse}typeIds(i){let u=this.bb.__offset(this.bb_pos,6);return u?this.bb.readInt32(this.bb.__vector(this.bb_pos+u)+i*4):0}typeIdsLength(){let i=this.bb.__offset(this.bb_pos,6);return i?this.bb.__vector_len(this.bb_pos+i):0}typeIdsArray(){let i=this.bb.__offset(this.bb_pos,6);return i?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+i),this.bb.__vector_len(this.bb_pos+i)):null}static startUnion(i){i.startObject(2)}static addMode(i,u){i.addFieldInt16(0,u,t.apache.arrow.flatbuf.UnionMode.Sparse)}static addTypeIds(i,u){i.addFieldOffset(1,u,0)}static createTypeIdsVector(i,u){i.startVector(4,u.length,4);for(let y=u.length-1;y>=0;y--)i.addInt32(u[y]);return i.endVector()}static startTypeIdsVector(i,u){i.startVector(4,u,4)}static endUnion(i){return i.endObject()}static createUnion(i,u,y){return c.startUnion(i),c.addMode(i,u),c.addTypeIds(i,y),c.endUnion(i)}}o.Union=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsInt(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}bitWidth(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt32(this.bb_pos+i):0}isSigned(){let i=this.bb.__offset(this.bb_pos,6);return i?!!this.bb.readInt8(this.bb_pos+i):!1}static startInt(i){i.startObject(2)}static addBitWidth(i,u){i.addFieldInt32(0,u,0)}static addIsSigned(i,u){i.addFieldInt8(1,+u,0)}static endInt(i){return i.endObject()}static createInt(i,u,y){return c.startInt(i),c.addBitWidth(i,u),c.addIsSigned(i,y),c.endInt(i)}}o.Int=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsFloatingPoint(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}precision(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt16(this.bb_pos+i):t.apache.arrow.flatbuf.Precision.HALF}static startFloatingPoint(i){i.startObject(1)}static addPrecision(i,u){i.addFieldInt16(0,u,t.apache.arrow.flatbuf.Precision.HALF)}static endFloatingPoint(i){return i.endObject()}static createFloatingPoint(i,u){return c.startFloatingPoint(i),c.addPrecision(i,u),c.endFloatingPoint(i)}}o.FloatingPoint=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsUtf8(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}static startUtf8(i){i.startObject(0)}static endUtf8(i){return i.endObject()}static createUtf8(i){return c.startUtf8(i),c.endUtf8(i)}}o.Utf8=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsBinary(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}static startBinary(i){i.startObject(0)}static endBinary(i){return i.endObject()}static createBinary(i){return c.startBinary(i),c.endBinary(i)}}o.Binary=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsLargeUtf8(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}static startLargeUtf8(i){i.startObject(0)}static endLargeUtf8(i){return i.endObject()}static createLargeUtf8(i){return c.startLargeUtf8(i),c.endLargeUtf8(i)}}o.LargeUtf8=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsLargeBinary(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}static startLargeBinary(i){i.startObject(0)}static endLargeBinary(i){return i.endObject()}static createLargeBinary(i){return c.startLargeBinary(i),c.endLargeBinary(i)}}o.LargeBinary=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsFixedSizeBinary(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}byteWidth(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt32(this.bb_pos+i):0}static startFixedSizeBinary(i){i.startObject(1)}static addByteWidth(i,u){i.addFieldInt32(0,u,0)}static endFixedSizeBinary(i){return i.endObject()}static createFixedSizeBinary(i,u){return c.startFixedSizeBinary(i),c.addByteWidth(i,u),c.endFixedSizeBinary(i)}}o.FixedSizeBinary=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsBool(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}static startBool(i){i.startObject(0)}static endBool(i){return i.endObject()}static createBool(i){return c.startBool(i),c.endBool(i)}}o.Bool=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsDecimal(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}precision(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt32(this.bb_pos+i):0}scale(){let i=this.bb.__offset(this.bb_pos,6);return i?this.bb.readInt32(this.bb_pos+i):0}static startDecimal(i){i.startObject(2)}static addPrecision(i,u){i.addFieldInt32(0,u,0)}static addScale(i,u){i.addFieldInt32(1,u,0)}static endDecimal(i){return i.endObject()}static createDecimal(i,u,y){return c.startDecimal(i),c.addPrecision(i,u),c.addScale(i,y),c.endDecimal(i)}}o.Decimal=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsDate(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}unit(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt16(this.bb_pos+i):t.apache.arrow.flatbuf.DateUnit.MILLISECOND}static startDate(i){i.startObject(1)}static addUnit(i,u){i.addFieldInt16(0,u,t.apache.arrow.flatbuf.DateUnit.MILLISECOND)}static endDate(i){return i.endObject()}static createDate(i,u){return c.startDate(i),c.addUnit(i,u),c.endDate(i)}}o.Date=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsTime(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}unit(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt16(this.bb_pos+i):t.apache.arrow.flatbuf.TimeUnit.MILLISECOND}bitWidth(){let i=this.bb.__offset(this.bb_pos,6);return i?this.bb.readInt32(this.bb_pos+i):32}static startTime(i){i.startObject(2)}static addUnit(i,u){i.addFieldInt16(0,u,t.apache.arrow.flatbuf.TimeUnit.MILLISECOND)}static addBitWidth(i,u){i.addFieldInt32(1,u,32)}static endTime(i){return i.endObject()}static createTime(i,u,y){return c.startTime(i),c.addUnit(i,u),c.addBitWidth(i,y),c.endTime(i)}}o.Time=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsTimestamp(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}unit(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt16(this.bb_pos+i):t.apache.arrow.flatbuf.TimeUnit.SECOND}timezone(i){let u=this.bb.__offset(this.bb_pos,6);return u?this.bb.__string(this.bb_pos+u,i):null}static startTimestamp(i){i.startObject(2)}static addUnit(i,u){i.addFieldInt16(0,u,t.apache.arrow.flatbuf.TimeUnit.SECOND)}static addTimezone(i,u){i.addFieldOffset(1,u,0)}static endTimestamp(i){return i.endObject()}static createTimestamp(i,u,y){return c.startTimestamp(i),c.addUnit(i,u),c.addTimezone(i,y),c.endTimestamp(i)}}o.Timestamp=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsInterval(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}unit(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt16(this.bb_pos+i):t.apache.arrow.flatbuf.IntervalUnit.YEAR_MONTH}static startInterval(i){i.startObject(1)}static addUnit(i,u){i.addFieldInt16(0,u,t.apache.arrow.flatbuf.IntervalUnit.YEAR_MONTH)}static endInterval(i){return i.endObject()}static createInterval(i,u){return c.startInterval(i),c.addUnit(i,u),c.endInterval(i)}}o.Interval=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsDuration(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}unit(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt16(this.bb_pos+i):t.apache.arrow.flatbuf.TimeUnit.MILLISECOND}static startDuration(i){i.startObject(1)}static addUnit(i,u){i.addFieldInt16(0,u,t.apache.arrow.flatbuf.TimeUnit.MILLISECOND)}static endDuration(i){return i.endObject()}static createDuration(i,u){return c.startDuration(i),c.addUnit(i,u),c.endDuration(i)}}o.Duration=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsKeyValue(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}key(i){let u=this.bb.__offset(this.bb_pos,4);return u?this.bb.__string(this.bb_pos+u,i):null}value(i){let u=this.bb.__offset(this.bb_pos,6);return u?this.bb.__string(this.bb_pos+u,i):null}static startKeyValue(i){i.startObject(2)}static addKey(i,u){i.addFieldOffset(0,u,0)}static addValue(i,u){i.addFieldOffset(1,u,0)}static endKeyValue(i){return i.endObject()}static createKeyValue(i,u,y){return c.startKeyValue(i),c.addKey(i,u),c.addValue(i,y),c.endKeyValue(i)}}o.KeyValue=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsDictionaryEncoding(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}id(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt64(this.bb_pos+i):this.bb.createLong(0,0)}indexType(i){let u=this.bb.__offset(this.bb_pos,6);return u?(i||new t.apache.arrow.flatbuf.Int).__init(this.bb.__indirect(this.bb_pos+u),this.bb):null}isOrdered(){let i=this.bb.__offset(this.bb_pos,8);return i?!!this.bb.readInt8(this.bb_pos+i):!1}static startDictionaryEncoding(i){i.startObject(3)}static addId(i,u){i.addFieldInt64(0,u,i.createLong(0,0))}static addIndexType(i,u){i.addFieldOffset(1,u,0)}static addIsOrdered(i,u){i.addFieldInt8(2,+u,0)}static endDictionaryEncoding(i){return i.endObject()}static createDictionaryEncoding(i,u,y,N){return c.startDictionaryEncoding(i),c.addId(i,u),c.addIndexType(i,y),c.addIsOrdered(i,N),c.endDictionaryEncoding(i)}}o.DictionaryEncoding=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsField(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}name(i){let u=this.bb.__offset(this.bb_pos,4);return u?this.bb.__string(this.bb_pos+u,i):null}nullable(){let i=this.bb.__offset(this.bb_pos,6);return i?!!this.bb.readInt8(this.bb_pos+i):!1}typeType(){let i=this.bb.__offset(this.bb_pos,8);return i?this.bb.readUint8(this.bb_pos+i):t.apache.arrow.flatbuf.Type.NONE}type(i){let u=this.bb.__offset(this.bb_pos,10);return u?this.bb.__union(i,this.bb_pos+u):null}dictionary(i){let u=this.bb.__offset(this.bb_pos,12);return u?(i||new t.apache.arrow.flatbuf.DictionaryEncoding).__init(this.bb.__indirect(this.bb_pos+u),this.bb):null}children(i,u){let y=this.bb.__offset(this.bb_pos,14);return y?(u||new t.apache.arrow.flatbuf.Field).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+y)+i*4),this.bb):null}childrenLength(){let i=this.bb.__offset(this.bb_pos,14);return i?this.bb.__vector_len(this.bb_pos+i):0}customMetadata(i,u){let y=this.bb.__offset(this.bb_pos,16);return y?(u||new t.apache.arrow.flatbuf.KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+y)+i*4),this.bb):null}customMetadataLength(){let i=this.bb.__offset(this.bb_pos,16);return i?this.bb.__vector_len(this.bb_pos+i):0}static startField(i){i.startObject(7)}static addName(i,u){i.addFieldOffset(0,u,0)}static addNullable(i,u){i.addFieldInt8(1,+u,0)}static addTypeType(i,u){i.addFieldInt8(2,u,t.apache.arrow.flatbuf.Type.NONE)}static addType(i,u){i.addFieldOffset(3,u,0)}static addDictionary(i,u){i.addFieldOffset(4,u,0)}static addChildren(i,u){i.addFieldOffset(5,u,0)}static createChildrenVector(i,u){i.startVector(4,u.length,4);for(let y=u.length-1;y>=0;y--)i.addOffset(u[y]);return i.endVector()}static startChildrenVector(i,u){i.startVector(4,u,4)}static addCustomMetadata(i,u){i.addFieldOffset(6,u,0)}static createCustomMetadataVector(i,u){i.startVector(4,u.length,4);for(let y=u.length-1;y>=0;y--)i.addOffset(u[y]);return i.endVector()}static startCustomMetadataVector(i,u){i.startVector(4,u,4)}static endField(i){return i.endObject()}static createField(i,u,y,N,Z,ke,xr,zt){return c.startField(i),c.addName(i,u),c.addNullable(i,y),c.addTypeType(i,N),c.addType(i,Z),c.addDictionary(i,ke),c.addChildren(i,xr),c.addCustomMetadata(i,zt),c.endField(i)}}o.Field=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static createBuffer(i,u,y){return i.prep(8,16),i.writeInt64(y),i.writeInt64(u),i.offset()}}o.Buffer=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsSchema(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}endianness(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt16(this.bb_pos+i):t.apache.arrow.flatbuf.Endianness.Little}fields(i,u){let y=this.bb.__offset(this.bb_pos,6);return y?(u||new t.apache.arrow.flatbuf.Field).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+y)+i*4),this.bb):null}fieldsLength(){let i=this.bb.__offset(this.bb_pos,6);return i?this.bb.__vector_len(this.bb_pos+i):0}customMetadata(i,u){let y=this.bb.__offset(this.bb_pos,8);return y?(u||new t.apache.arrow.flatbuf.KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+y)+i*4),this.bb):null}customMetadataLength(){let i=this.bb.__offset(this.bb_pos,8);return i?this.bb.__vector_len(this.bb_pos+i):0}static startSchema(i){i.startObject(3)}static addEndianness(i,u){i.addFieldInt16(0,u,t.apache.arrow.flatbuf.Endianness.Little)}static addFields(i,u){i.addFieldOffset(1,u,0)}static createFieldsVector(i,u){i.startVector(4,u.length,4);for(let y=u.length-1;y>=0;y--)i.addOffset(u[y]);return i.endVector()}static startFieldsVector(i,u){i.startVector(4,u,4)}static addCustomMetadata(i,u){i.addFieldOffset(2,u,0)}static createCustomMetadataVector(i,u){i.startVector(4,u.length,4);for(let y=u.length-1;y>=0;y--)i.addOffset(u[y]);return i.endVector()}static startCustomMetadataVector(i,u){i.startVector(4,u,4)}static endSchema(i){return i.endObject()}static finishSchemaBuffer(i,u){i.finish(u)}static createSchema(i,u,y,N){return c.startSchema(i),c.addEndianness(i,u),c.addFields(i,y),c.addCustomMetadata(i,N),c.endSchema(i)}}o.Schema=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})($=w.org||(w.org={}))});var Ya=m(Ee=>{"use strict";Object.defineProperty(Ee,"__esModule",{value:!0});Ee.org=void 0;var kn=zr(),Yr;(function(t){var e;(function(r){var n;(function(s){var a;(function(o){o.Schema=kn.org.apache.arrow.flatbuf.Schema})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(Yr=Ee.org||(Ee.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){let c;(function(f){f[f.NONE=0]="NONE",f[f.Schema=1]="Schema",f[f.DictionaryBatch=2]="DictionaryBatch",f[f.RecordBatch=3]="RecordBatch",f[f.Tensor=4]="Tensor",f[f.SparseTensor=5]="SparseTensor"})(c=o.MessageHeader||(o.MessageHeader={}))})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(Yr=Ee.org||(Ee.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static createFieldNode(i,u,y){return i.prep(8,16),i.writeInt64(y),i.writeInt64(u),i.offset()}}o.FieldNode=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(Yr=Ee.org||(Ee.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsRecordBatch(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}length(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt64(this.bb_pos+i):this.bb.createLong(0,0)}nodes(i,u){let y=this.bb.__offset(this.bb_pos,6);return y?(u||new t.apache.arrow.flatbuf.FieldNode).__init(this.bb.__vector(this.bb_pos+y)+i*16,this.bb):null}nodesLength(){let i=this.bb.__offset(this.bb_pos,6);return i?this.bb.__vector_len(this.bb_pos+i):0}buffers(i,u){let y=this.bb.__offset(this.bb_pos,8);return y?(u||new kn.org.apache.arrow.flatbuf.Buffer).__init(this.bb.__vector(this.bb_pos+y)+i*16,this.bb):null}buffersLength(){let i=this.bb.__offset(this.bb_pos,8);return i?this.bb.__vector_len(this.bb_pos+i):0}static startRecordBatch(i){i.startObject(3)}static addLength(i,u){i.addFieldInt64(0,u,i.createLong(0,0))}static addNodes(i,u){i.addFieldOffset(1,u,0)}static startNodesVector(i,u){i.startVector(16,u,8)}static addBuffers(i,u){i.addFieldOffset(2,u,0)}static startBuffersVector(i,u){i.startVector(16,u,8)}static endRecordBatch(i){return i.endObject()}static createRecordBatch(i,u,y,N){return c.startRecordBatch(i),c.addLength(i,u),c.addNodes(i,y),c.addBuffers(i,N),c.endRecordBatch(i)}}o.RecordBatch=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(Yr=Ee.org||(Ee.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsDictionaryBatch(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}id(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt64(this.bb_pos+i):this.bb.createLong(0,0)}data(i){let u=this.bb.__offset(this.bb_pos,6);return u?(i||new t.apache.arrow.flatbuf.RecordBatch).__init(this.bb.__indirect(this.bb_pos+u),this.bb):null}isDelta(){let i=this.bb.__offset(this.bb_pos,8);return i?!!this.bb.readInt8(this.bb_pos+i):!1}static startDictionaryBatch(i){i.startObject(3)}static addId(i,u){i.addFieldInt64(0,u,i.createLong(0,0))}static addData(i,u){i.addFieldOffset(1,u,0)}static addIsDelta(i,u){i.addFieldInt8(2,+u,0)}static endDictionaryBatch(i){return i.endObject()}static createDictionaryBatch(i,u,y,N){return c.startDictionaryBatch(i),c.addId(i,u),c.addData(i,y),c.addIsDelta(i,N),c.endDictionaryBatch(i)}}o.DictionaryBatch=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(Yr=Ee.org||(Ee.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsMessage(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}version(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt16(this.bb_pos+i):kn.org.apache.arrow.flatbuf.MetadataVersion.V1}headerType(){let i=this.bb.__offset(this.bb_pos,6);return i?this.bb.readUint8(this.bb_pos+i):t.apache.arrow.flatbuf.MessageHeader.NONE}header(i){let u=this.bb.__offset(this.bb_pos,8);return u?this.bb.__union(i,this.bb_pos+u):null}bodyLength(){let i=this.bb.__offset(this.bb_pos,10);return i?this.bb.readInt64(this.bb_pos+i):this.bb.createLong(0,0)}customMetadata(i,u){let y=this.bb.__offset(this.bb_pos,12);return y?(u||new kn.org.apache.arrow.flatbuf.KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+y)+i*4),this.bb):null}customMetadataLength(){let i=this.bb.__offset(this.bb_pos,12);return i?this.bb.__vector_len(this.bb_pos+i):0}static startMessage(i){i.startObject(5)}static addVersion(i,u){i.addFieldInt16(0,u,kn.org.apache.arrow.flatbuf.MetadataVersion.V1)}static addHeaderType(i,u){i.addFieldInt8(1,u,t.apache.arrow.flatbuf.MessageHeader.NONE)}static addHeader(i,u){i.addFieldOffset(2,u,0)}static addBodyLength(i,u){i.addFieldInt64(3,u,i.createLong(0,0))}static addCustomMetadata(i,u){i.addFieldOffset(4,u,0)}static createCustomMetadataVector(i,u){i.startVector(4,u.length,4);for(let y=u.length-1;y>=0;y--)i.addOffset(u[y]);return i.endVector()}static startCustomMetadataVector(i,u){i.startVector(4,u,4)}static endMessage(i){return i.endObject()}static finishMessageBuffer(i,u){i.finish(u)}static createMessage(i,u,y,N,Z,ke){return c.startMessage(i),c.addVersion(i,u),c.addHeaderType(i,y),c.addHeader(i,N),c.addBodyLength(i,Z),c.addCustomMetadata(i,ke),c.endMessage(i)}}o.Message=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(Yr=Ee.org||(Ee.org={}))});var ee=m(te=>{"use strict";Object.defineProperty(te,"__esModule",{value:!0});te.BufferType=te.Type=te.MetadataVersion=te.MessageHeader=te.IntervalUnit=te.UnionMode=te.Precision=te.TimeUnit=te.DateUnit=te.ArrowType=void 0;var vr=zr(),Hy=Ya();te.ArrowType=vr.org.apache.arrow.flatbuf.Type;te.DateUnit=vr.org.apache.arrow.flatbuf.DateUnit;te.TimeUnit=vr.org.apache.arrow.flatbuf.TimeUnit;te.Precision=vr.org.apache.arrow.flatbuf.Precision;te.UnionMode=vr.org.apache.arrow.flatbuf.UnionMode;te.IntervalUnit=vr.org.apache.arrow.flatbuf.IntervalUnit;te.MessageHeader=Hy.org.apache.arrow.flatbuf.MessageHeader;te.MetadataVersion=vr.org.apache.arrow.flatbuf.MetadataVersion;var $y;(function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth"})($y=te.Type||(te.Type={}));var Jy;(function(t){t[t.OFFSET=0]="OFFSET",t[t.DATA=1]="DATA",t[t.VALIDITY=2]="VALIDITY",t[t.TYPE=3]="TYPE"})(Jy=te.BufferType||(te.BufferType={}))});var pt=m(fe=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});fe.popcnt_uint32=fe.popcnt_array=fe.popcnt_bit_range=fe.iterateBits=fe.packBools=fe.truncateBitmap=fe.setBool=fe.getBit=fe.getBool=void 0;function ml(t,e,r,n){return(r&1<<n)!=0}fe.getBool=ml;function gl(t,e,r,n){return(r&1<<n)>>n}fe.getBit=gl;function Ky(t,e,r){return r?!!(t[e>>3]|=1<<e%8)||!0:!(t[e>>3]&=~(1<<e%8))&&!1}fe.setBool=Ky;function Qy(t,e,r){let n=r.byteLength+7&~7;if(t>0||r.byteLength<n){let s=new Uint8Array(n);return s.set(t%8==0?r.subarray(t>>3):_l(Ga(r,t,e,null,ml)).subarray(0,n)),s}return r}fe.truncateBitmap=Qy;function _l(t){let e=[],r=0,n=0,s=0;for(let o of t)o&&(s|=1<<n),++n==8&&(e[r++]=s,s=n=0);(r===0||n>0)&&(e[r++]=s);let a=new Uint8Array(e.length+7&~7);return a.set(e),a}fe.packBools=_l;function*Ga(t,e,r,n,s){let a=e%8,o=e>>3,c=0,f=r;for(;f>0;a=0){let i=t[o++];do yield s(n,c++,i,a);while(--f>0&&++a<8)}}fe.iterateBits=Ga;function Ha(t,e,r){if(r-e<=0)return 0;if(r-e<8){let a=0;for(let o of Ga(t,e,r-e,t,gl))a+=o;return a}let n=r>>3<<3,s=e+(e%8==0?0:8-e%8);return Ha(t,e,s)+Ha(t,n,r)+Tl(t,s>>3,n-s>>3)}fe.popcnt_bit_range=Ha;function Tl(t,e,r){let n=0,s=e|0,a=new DataView(t.buffer,t.byteOffset,t.byteLength),o=r===void 0?t.byteLength:s+r;for(;o-s>=4;)n+=xi(a.getUint32(s)),s+=4;for(;o-s>=2;)n+=xi(a.getUint16(s)),s+=2;for(;o-s>=1;)n+=xi(a.getUint8(s)),s+=1;return n}fe.popcnt_array=Tl;function xi(t){let e=t|0;return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),(e+(e>>>4)&252645135)*16843009>>>24}fe.popcnt_uint32=xi});var ve=m(ji=>{"use strict";Object.defineProperty(ji,"__esModule",{value:!0});ji.Visitor=void 0;var Zy=st(),Xy=ue(),b=ee(),eb=K(),X=class{visitMany(e,...r){return e.map((n,s)=>this.visit(n,...r.map(a=>a[s])))}visit(...e){return this.getVisitFn(e[0],!1).apply(this,e)}getVisitFn(e,r=!0){return tb(this,e,r)}visitNull(e,...r){return null}visitBool(e,...r){return null}visitInt(e,...r){return null}visitFloat(e,...r){return null}visitUtf8(e,...r){return null}visitBinary(e,...r){return null}visitFixedSizeBinary(e,...r){return null}visitDate(e,...r){return null}visitTimestamp(e,...r){return null}visitTime(e,...r){return null}visitDecimal(e,...r){return null}visitList(e,...r){return null}visitStruct(e,...r){return null}visitUnion(e,...r){return null}visitDictionary(e,...r){return null}visitInterval(e,...r){return null}visitFixedSizeList(e,...r){return null}visitMap(e,...r){return null}};ji.Visitor=X;function tb(t,e,r=!0){let n=null,s=b.Type.NONE;switch(e instanceof Zy.Data||e instanceof Xy.Vector?s=$a(e.type):e instanceof eb.DataType?s=$a(e):typeof(s=e)!="number"&&(s=b.Type[e]),s){case b.Type.Null:n=t.visitNull;break;case b.Type.Bool:n=t.visitBool;break;case b.Type.Int:n=t.visitInt;break;case b.Type.Int8:n=t.visitInt8||t.visitInt;break;case b.Type.Int16:n=t.visitInt16||t.visitInt;break;case b.Type.Int32:n=t.visitInt32||t.visitInt;break;case b.Type.Int64:n=t.visitInt64||t.visitInt;break;case b.Type.Uint8:n=t.visitUint8||t.visitInt;break;case b.Type.Uint16:n=t.visitUint16||t.visitInt;break;case b.Type.Uint32:n=t.visitUint32||t.visitInt;break;case b.Type.Uint64:n=t.visitUint64||t.visitInt;break;case b.Type.Float:n=t.visitFloat;break;case b.Type.Float16:n=t.visitFloat16||t.visitFloat;break;case b.Type.Float32:n=t.visitFloat32||t.visitFloat;break;case b.Type.Float64:n=t.visitFloat64||t.visitFloat;break;case b.Type.Utf8:n=t.visitUtf8;break;case b.Type.Binary:n=t.visitBinary;break;case b.Type.FixedSizeBinary:n=t.visitFixedSizeBinary;break;case b.Type.Date:n=t.visitDate;break;case b.Type.DateDay:n=t.visitDateDay||t.visitDate;break;case b.Type.DateMillisecond:n=t.visitDateMillisecond||t.visitDate;break;case b.Type.Timestamp:n=t.visitTimestamp;break;case b.Type.TimestampSecond:n=t.visitTimestampSecond||t.visitTimestamp;break;case b.Type.TimestampMillisecond:n=t.visitTimestampMillisecond||t.visitTimestamp;break;case b.Type.TimestampMicrosecond:n=t.visitTimestampMicrosecond||t.visitTimestamp;break;case b.Type.TimestampNanosecond:n=t.visitTimestampNanosecond||t.visitTimestamp;break;case b.Type.Time:n=t.visitTime;break;case b.Type.TimeSecond:n=t.visitTimeSecond||t.visitTime;break;case b.Type.TimeMillisecond:n=t.visitTimeMillisecond||t.visitTime;break;case b.Type.TimeMicrosecond:n=t.visitTimeMicrosecond||t.visitTime;break;case b.Type.TimeNanosecond:n=t.visitTimeNanosecond||t.visitTime;break;case b.Type.Decimal:n=t.visitDecimal;break;case b.Type.List:n=t.visitList;break;case b.Type.Struct:n=t.visitStruct;break;case b.Type.Union:n=t.visitUnion;break;case b.Type.DenseUnion:n=t.visitDenseUnion||t.visitUnion;break;case b.Type.SparseUnion:n=t.visitSparseUnion||t.visitUnion;break;case b.Type.Dictionary:n=t.visitDictionary;break;case b.Type.Interval:n=t.visitInterval;break;case b.Type.IntervalDayTime:n=t.visitIntervalDayTime||t.visitInterval;break;case b.Type.IntervalYearMonth:n=t.visitIntervalYearMonth||t.visitInterval;break;case b.Type.FixedSizeList:n=t.visitFixedSizeList;break;case b.Type.Map:n=t.visitMap;break}if(typeof n=="function")return n;if(!r)return()=>null;throw new Error(`Unrecognized type '${b.Type[s]}'`)}function $a(t){switch(t.typeId){case b.Type.Null:return b.Type.Null;case b.Type.Int:let{bitWidth:e,isSigned:r}=t;switch(e){case 8:return r?b.Type.Int8:b.Type.Uint8;case 16:return r?b.Type.Int16:b.Type.Uint16;case 32:return r?b.Type.Int32:b.Type.Uint32;case 64:return r?b.Type.Int64:b.Type.Uint64}return b.Type.Int;case b.Type.Float:switch(t.precision){case b.Precision.HALF:return b.Type.Float16;case b.Precision.SINGLE:return b.Type.Float32;case b.Precision.DOUBLE:return b.Type.Float64}return b.Type.Float;case b.Type.Binary:return b.Type.Binary;case b.Type.Utf8:return b.Type.Utf8;case b.Type.Bool:return b.Type.Bool;case b.Type.Decimal:return b.Type.Decimal;case b.Type.Time:switch(t.unit){case b.TimeUnit.SECOND:return b.Type.TimeSecond;case b.TimeUnit.MILLISECOND:return b.Type.TimeMillisecond;case b.TimeUnit.MICROSECOND:return b.Type.TimeMicrosecond;case b.TimeUnit.NANOSECOND:return b.Type.TimeNanosecond}return b.Type.Time;case b.Type.Timestamp:switch(t.unit){case b.TimeUnit.SECOND:return b.Type.TimestampSecond;case b.TimeUnit.MILLISECOND:return b.Type.TimestampMillisecond;case b.TimeUnit.MICROSECOND:return b.Type.TimestampMicrosecond;case b.TimeUnit.NANOSECOND:return b.Type.TimestampNanosecond}return b.Type.Timestamp;case b.Type.Date:switch(t.unit){case b.DateUnit.DAY:return b.Type.DateDay;case b.DateUnit.MILLISECOND:return b.Type.DateMillisecond}return b.Type.Date;case b.Type.Interval:switch(t.unit){case b.IntervalUnit.DAY_TIME:return b.Type.IntervalDayTime;case b.IntervalUnit.YEAR_MONTH:return b.Type.IntervalYearMonth}return b.Type.Interval;case b.Type.Map:return b.Type.Map;case b.Type.List:return b.Type.List;case b.Type.Struct:return b.Type.Struct;case b.Type.Union:switch(t.mode){case b.UnionMode.Dense:return b.Type.DenseUnion;case b.UnionMode.Sparse:return b.Type.SparseUnion}return b.Type.Union;case b.Type.FixedSizeBinary:return b.Type.FixedSizeBinary;case b.Type.FixedSizeList:return b.Type.FixedSizeList;case b.Type.Dictionary:return b.Type.Dictionary}throw new Error(`Unrecognized type '${b.Type[t.typeId]}'`)}X.prototype.visitInt8=null;X.prototype.visitInt16=null;X.prototype.visitInt32=null;X.prototype.visitInt64=null;X.prototype.visitUint8=null;X.prototype.visitUint16=null;X.prototype.visitUint32=null;X.prototype.visitUint64=null;X.prototype.visitFloat16=null;X.prototype.visitFloat32=null;X.prototype.visitFloat64=null;X.prototype.visitDateDay=null;X.prototype.visitDateMillisecond=null;X.prototype.visitTimestampSecond=null;X.prototype.visitTimestampMillisecond=null;X.prototype.visitTimestampMicrosecond=null;X.prototype.visitTimestampNanosecond=null;X.prototype.visitTimeSecond=null;X.prototype.visitTimeMillisecond=null;X.prototype.visitTimeMicrosecond=null;X.prototype.visitTimeNanosecond=null;X.prototype.visitDenseUnion=null;X.prototype.visitSparseUnion=null;X.prototype.visitIntervalDayTime=null;X.prototype.visitIntervalYearMonth=null});var Za=m(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});Fe.instance=Fe.TypeComparator=void 0;var rb=ve(),F=class extends rb.Visitor{compareSchemas(e,r){return e===r||r instanceof e.constructor&&Fe.instance.compareFields(e.fields,r.fields)}compareFields(e,r){return e===r||Array.isArray(e)&&Array.isArray(r)&&e.length===r.length&&e.every((n,s)=>Fe.instance.compareField(n,r[s]))}compareField(e,r){return e===r||r instanceof e.constructor&&e.name===r.name&&e.nullable===r.nullable&&Fe.instance.visit(e.type,r.type)}};Fe.TypeComparator=F;function Me(t,e){return e instanceof t.constructor}function Cn(t,e){return t===e||Me(t,e)}function Mt(t,e){return t===e||Me(t,e)&&t.bitWidth===e.bitWidth&&t.isSigned===e.isSigned}function ki(t,e){return t===e||Me(t,e)&&t.precision===e.precision}function nb(t,e){return t===e||Me(t,e)&&t.byteWidth===e.byteWidth}function Ja(t,e){return t===e||Me(t,e)&&t.unit===e.unit}function qn(t,e){return t===e||Me(t,e)&&t.unit===e.unit&&t.timezone===e.timezone}function Wn(t,e){return t===e||Me(t,e)&&t.unit===e.unit&&t.bitWidth===e.bitWidth}function ib(t,e){return t===e||Me(t,e)&&t.children.length===e.children.length&&Fe.instance.compareFields(t.children,e.children)}function sb(t,e){return t===e||Me(t,e)&&t.children.length===e.children.length&&Fe.instance.compareFields(t.children,e.children)}function Ka(t,e){return t===e||Me(t,e)&&t.mode===e.mode&&t.typeIds.every((r,n)=>r===e.typeIds[n])&&Fe.instance.compareFields(t.children,e.children)}function ab(t,e){return t===e||Me(t,e)&&t.id===e.id&&t.isOrdered===e.isOrdered&&Fe.instance.visit(t.indices,e.indices)&&Fe.instance.visit(t.dictionary,e.dictionary)}function Qa(t,e){return t===e||Me(t,e)&&t.unit===e.unit}function ob(t,e){return t===e||Me(t,e)&&t.listSize===e.listSize&&t.children.length===e.children.length&&Fe.instance.compareFields(t.children,e.children)}function cb(t,e){return t===e||Me(t,e)&&t.keysSorted===e.keysSorted&&t.children.length===e.children.length&&Fe.instance.compareFields(t.children,e.children)}F.prototype.visitNull=Cn;F.prototype.visitBool=Cn;F.prototype.visitInt=Mt;F.prototype.visitInt8=Mt;F.prototype.visitInt16=Mt;F.prototype.visitInt32=Mt;F.prototype.visitInt64=Mt;F.prototype.visitUint8=Mt;F.prototype.visitUint16=Mt;F.prototype.visitUint32=Mt;F.prototype.visitUint64=Mt;F.prototype.visitFloat=ki;F.prototype.visitFloat16=ki;F.prototype.visitFloat32=ki;F.prototype.visitFloat64=ki;F.prototype.visitUtf8=Cn;F.prototype.visitBinary=Cn;F.prototype.visitFixedSizeBinary=nb;F.prototype.visitDate=Ja;F.prototype.visitDateDay=Ja;F.prototype.visitDateMillisecond=Ja;F.prototype.visitTimestamp=qn;F.prototype.visitTimestampSecond=qn;F.prototype.visitTimestampMillisecond=qn;F.prototype.visitTimestampMicrosecond=qn;F.prototype.visitTimestampNanosecond=qn;F.prototype.visitTime=Wn;F.prototype.visitTimeSecond=Wn;F.prototype.visitTimeMillisecond=Wn;F.prototype.visitTimeMicrosecond=Wn;F.prototype.visitTimeNanosecond=Wn;F.prototype.visitDecimal=Cn;F.prototype.visitList=ib;F.prototype.visitStruct=sb;F.prototype.visitUnion=Ka;F.prototype.visitDenseUnion=Ka;F.prototype.visitSparseUnion=Ka;F.prototype.visitDictionary=ab;F.prototype.visitInterval=Qa;F.prototype.visitIntervalDayTime=Qa;F.prototype.visitIntervalYearMonth=Qa;F.prototype.visitFixedSizeList=ob;F.prototype.visitMap=cb;Fe.instance=new F});var K=m(T=>{"use strict";Object.defineProperty(T,"__esModule",{value:!0});T.strideForType=T.Dictionary=T.Map_=T.FixedSizeList=T.FixedSizeBinary=T.SparseUnion=T.DenseUnion=T.Union=T.Struct=T.List=T.IntervalYearMonth=T.IntervalDayTime=T.Interval=T.TimestampNanosecond=T.TimestampMicrosecond=T.TimestampMillisecond=T.TimestampSecond=T.Timestamp=T.TimeNanosecond=T.TimeMicrosecond=T.TimeMillisecond=T.TimeSecond=T.Time=T.DateMillisecond=T.DateDay=T.Date_=T.Decimal=T.Bool=T.Utf8=T.Binary=T.Float64=T.Float32=T.Float16=T.Float=T.Uint64=T.Uint32=T.Uint16=T.Uint8=T.Int64=T.Int32=T.Int16=T.Int8=T.Int=T.Null=T.DataType=void 0;var ub=Za(),v=ee(),se=class{static isNull(e){return e&&e.typeId===v.Type.Null}static isInt(e){return e&&e.typeId===v.Type.Int}static isFloat(e){return e&&e.typeId===v.Type.Float}static isBinary(e){return e&&e.typeId===v.Type.Binary}static isUtf8(e){return e&&e.typeId===v.Type.Utf8}static isBool(e){return e&&e.typeId===v.Type.Bool}static isDecimal(e){return e&&e.typeId===v.Type.Decimal}static isDate(e){return e&&e.typeId===v.Type.Date}static isTime(e){return e&&e.typeId===v.Type.Time}static isTimestamp(e){return e&&e.typeId===v.Type.Timestamp}static isInterval(e){return e&&e.typeId===v.Type.Interval}static isList(e){return e&&e.typeId===v.Type.List}static isStruct(e){return e&&e.typeId===v.Type.Struct}static isUnion(e){return e&&e.typeId===v.Type.Union}static isFixedSizeBinary(e){return e&&e.typeId===v.Type.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===v.Type.FixedSizeList}static isMap(e){return e&&e.typeId===v.Type.Map}static isDictionary(e){return e&&e.typeId===v.Type.Dictionary}get typeId(){return v.Type.NONE}compareTo(e){return ub.instance.visit(this,e)}};T.DataType=se;se[Symbol.toStringTag]=(t=>(t.children=null,t.ArrayType=Array,t[Symbol.toStringTag]="DataType"))(se.prototype);var Ci=class extends se{toString(){return"Null"}get typeId(){return v.Type.Null}};T.Null=Ci;Ci[Symbol.toStringTag]=(t=>t[Symbol.toStringTag]="Null")(Ci.prototype);var qe=class extends se{constructor(e,r){super();this.isSigned=e,this.bitWidth=r}get typeId(){return v.Type.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?Int32Array:Uint32Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}};T.Int=qe;qe[Symbol.toStringTag]=(t=>(t.isSigned=null,t.bitWidth=null,t[Symbol.toStringTag]="Int"))(qe.prototype);var Xa=class extends qe{constructor(){super(!0,8)}};T.Int8=Xa;var eo=class extends qe{constructor(){super(!0,16)}};T.Int16=eo;var to=class extends qe{constructor(){super(!0,32)}};T.Int32=to;var ro=class extends qe{constructor(){super(!0,64)}};T.Int64=ro;var no=class extends qe{constructor(){super(!1,8)}};T.Uint8=no;var io=class extends qe{constructor(){super(!1,16)}};T.Uint16=io;var so=class extends qe{constructor(){super(!1,32)}};T.Uint32=so;var ao=class extends qe{constructor(){super(!1,64)}};T.Uint64=ao;Object.defineProperty(Xa.prototype,"ArrayType",{value:Int8Array});Object.defineProperty(eo.prototype,"ArrayType",{value:Int16Array});Object.defineProperty(to.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(ro.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(no.prototype,"ArrayType",{value:Uint8Array});Object.defineProperty(io.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(so.prototype,"ArrayType",{value:Uint32Array});Object.defineProperty(ao.prototype,"ArrayType",{value:Uint32Array});var Sr=class extends se{constructor(e){super();this.precision=e}get typeId(){return v.Type.Float}get ArrayType(){switch(this.precision){case v.Precision.HALF:return Uint16Array;case v.Precision.SINGLE:return Float32Array;case v.Precision.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}};T.Float=Sr;Sr[Symbol.toStringTag]=(t=>(t.precision=null,t[Symbol.toStringTag]="Float"))(Sr.prototype);var oo=class extends Sr{constructor(){super(v.Precision.HALF)}};T.Float16=oo;var co=class extends Sr{constructor(){super(v.Precision.SINGLE)}};T.Float32=co;var uo=class extends Sr{constructor(){super(v.Precision.DOUBLE)}};T.Float64=uo;Object.defineProperty(oo.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(co.prototype,"ArrayType",{value:Float32Array});Object.defineProperty(uo.prototype,"ArrayType",{value:Float64Array});var qi=class extends se{constructor(){super()}get typeId(){return v.Type.Binary}toString(){return"Binary"}};T.Binary=qi;qi[Symbol.toStringTag]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Binary"))(qi.prototype);var Wi=class extends se{constructor(){super()}get typeId(){return v.Type.Utf8}toString(){return"Utf8"}};T.Utf8=Wi;Wi[Symbol.toStringTag]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Utf8"))(Wi.prototype);var zi=class extends se{constructor(){super()}get typeId(){return v.Type.Bool}toString(){return"Bool"}};T.Bool=zi;zi[Symbol.toStringTag]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Bool"))(zi.prototype);var Yi=class extends se{constructor(e,r){super();this.scale=e,this.precision=r}get typeId(){return v.Type.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}};T.Decimal=Yi;Yi[Symbol.toStringTag]=(t=>(t.scale=null,t.precision=null,t.ArrayType=Uint32Array,t[Symbol.toStringTag]="Decimal"))(Yi.prototype);var Gr=class extends se{constructor(e){super();this.unit=e}get typeId(){return v.Type.Date}toString(){return`Date${(this.unit+1)*32}<${v.DateUnit[this.unit]}>`}};T.Date_=Gr;Gr[Symbol.toStringTag]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Date"))(Gr.prototype);var Bl=class extends Gr{constructor(){super(v.DateUnit.DAY)}};T.DateDay=Bl;var Il=class extends Gr{constructor(){super(v.DateUnit.MILLISECOND)}};T.DateMillisecond=Il;var Yt=class extends se{constructor(e,r){super();this.unit=e,this.bitWidth=r}get typeId(){return v.Type.Time}toString(){return`Time${this.bitWidth}<${v.TimeUnit[this.unit]}>`}};T.Time=Yt;Yt[Symbol.toStringTag]=(t=>(t.unit=null,t.bitWidth=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Time"))(Yt.prototype);var wl=class extends Yt{constructor(){super(v.TimeUnit.SECOND,32)}};T.TimeSecond=wl;var vl=class extends Yt{constructor(){super(v.TimeUnit.MILLISECOND,32)}};T.TimeMillisecond=vl;var Sl=class extends Yt{constructor(){super(v.TimeUnit.MICROSECOND,64)}};T.TimeMicrosecond=Sl;var Ol=class extends Yt{constructor(){super(v.TimeUnit.NANOSECOND,64)}};T.TimeNanosecond=Ol;var Gt=class extends se{constructor(e,r){super();this.unit=e,this.timezone=r}get typeId(){return v.Type.Timestamp}toString(){return`Timestamp<${v.TimeUnit[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}};T.Timestamp=Gt;Gt[Symbol.toStringTag]=(t=>(t.unit=null,t.timezone=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Timestamp"))(Gt.prototype);var Al=class extends Gt{constructor(e){super(v.TimeUnit.SECOND,e)}};T.TimestampSecond=Al;var Fl=class extends Gt{constructor(e){super(v.TimeUnit.MILLISECOND,e)}};T.TimestampMillisecond=Fl;var Dl=class extends Gt{constructor(e){super(v.TimeUnit.MICROSECOND,e)}};T.TimestampMicrosecond=Dl;var Rl=class extends Gt{constructor(e){super(v.TimeUnit.NANOSECOND,e)}};T.TimestampNanosecond=Rl;var Hr=class extends se{constructor(e){super();this.unit=e}get typeId(){return v.Type.Interval}toString(){return`Interval<${v.IntervalUnit[this.unit]}>`}};T.Interval=Hr;Hr[Symbol.toStringTag]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Interval"))(Hr.prototype);var El=class extends Hr{constructor(){super(v.IntervalUnit.DAY_TIME)}};T.IntervalDayTime=El;var Ul=class extends Hr{constructor(){super(v.IntervalUnit.YEAR_MONTH)}};T.IntervalYearMonth=Ul;var Gi=class extends se{constructor(e){super();this.children=[e]}get typeId(){return v.Type.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}};T.List=Gi;Gi[Symbol.toStringTag]=(t=>(t.children=null,t[Symbol.toStringTag]="List"))(Gi.prototype);var Hi=class extends se{constructor(e){super();this.children=e}get typeId(){return v.Type.Struct}toString(){return`Struct<{${this.children.map(e=>`${e.name}:${e.type}`).join(", ")}}>`}};T.Struct=Hi;Hi[Symbol.toStringTag]=(t=>(t.children=null,t[Symbol.toStringTag]="Struct"))(Hi.prototype);var $r=class extends se{constructor(e,r,n){super();this.mode=e,this.children=n,this.typeIds=r=Int32Array.from(r),this.typeIdToChildIndex=r.reduce((s,a,o)=>(s[a]=o)&&s||s,Object.create(null))}get typeId(){return v.Type.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(e=>`${e.type}`).join(" | ")}>`}};T.Union=$r;$r[Symbol.toStringTag]=(t=>(t.mode=null,t.typeIds=null,t.children=null,t.typeIdToChildIndex=null,t.ArrayType=Int8Array,t[Symbol.toStringTag]="Union"))($r.prototype);var Vl=class extends $r{constructor(e,r){super(v.UnionMode.Dense,e,r)}};T.DenseUnion=Vl;var Ml=class extends $r{constructor(e,r){super(v.UnionMode.Sparse,e,r)}};T.SparseUnion=Ml;var $i=class extends se{constructor(e){super();this.byteWidth=e}get typeId(){return v.Type.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}};T.FixedSizeBinary=$i;$i[Symbol.toStringTag]=(t=>(t.byteWidth=null,t.ArrayType=Uint8Array,t[Symbol.toStringTag]="FixedSizeBinary"))($i.prototype);var Ji=class extends se{constructor(e,r){super();this.listSize=e,this.children=[r]}get typeId(){return v.Type.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}};T.FixedSizeList=Ji;Ji[Symbol.toStringTag]=(t=>(t.children=null,t.listSize=null,t[Symbol.toStringTag]="FixedSizeList"))(Ji.prototype);var Ki=class extends se{constructor(e,r=!1){super();this.children=[e],this.keysSorted=r}get typeId(){return v.Type.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}toString(){return`Map<{${this.children[0].type.children.map(e=>`${e.name}:${e.type}`).join(", ")}}>`}};T.Map_=Ki;Ki[Symbol.toStringTag]=(t=>(t.children=null,t.keysSorted=null,t[Symbol.toStringTag]="Map_"))(Ki.prototype);var lb=(t=>()=>++t)(-1),Qi=class extends se{constructor(e,r,n,s){super();this.indices=r,this.dictionary=e,this.isOrdered=s||!1,this.id=n==null?lb():typeof n=="number"?n:n.low}get typeId(){return v.Type.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}};T.Dictionary=Qi;Qi[Symbol.toStringTag]=(t=>(t.id=null,t.indices=null,t.isOrdered=null,t.dictionary=null,t[Symbol.toStringTag]="Dictionary"))(Qi.prototype);function db(t){let e=t;switch(t.typeId){case v.Type.Decimal:return 4;case v.Type.Timestamp:return 2;case v.Type.Date:return 1+e.unit;case v.Type.Interval:return 1+e.unit;case v.Type.Int:return 1+ +(e.bitWidth>32);case v.Type.Time:return 1+ +(e.bitWidth>32);case v.Type.FixedSizeList:return e.listSize;case v.Type.FixedSizeBinary:return e.byteWidth;default:return 1}}T.strideForType=db});var st=m(Or=>{"use strict";Object.defineProperty(Or,"__esModule",{value:!0});Or.Data=Or.kUnknownNullCount=void 0;var fb=pt(),hb=pt(),O=ee(),pb=K(),G=de();Or.kUnknownNullCount=-1;var M=class{constructor(e,r,n,s,a,o,c){this.type=e,this.dictionary=c,this.offset=Math.floor(Math.max(r||0,0)),this.length=Math.floor(Math.max(n||0,0)),this._nullCount=Math.floor(Math.max(s||0,-1)),this.childData=(o||[]).map(i=>i instanceof M?i:i.data);let f;a instanceof M?(this.stride=a.stride,this.values=a.values,this.typeIds=a.typeIds,this.nullBitmap=a.nullBitmap,this.valueOffsets=a.valueOffsets):(this.stride=pb.strideForType(e),a&&((f=a[0])&&(this.valueOffsets=f),(f=a[1])&&(this.values=f),(f=a[2])&&(this.nullBitmap=f),(f=a[3])&&(this.typeIds=f)))}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let e=0,{valueOffsets:r,values:n,nullBitmap:s,typeIds:a}=this;return r&&(e+=r.byteLength),n&&(e+=n.byteLength),s&&(e+=s.byteLength),a&&(e+=a.byteLength),this.childData.reduce((o,c)=>o+c.byteLength,e)}get nullCount(){let e=this._nullCount,r;return e<=Or.kUnknownNullCount&&(r=this.nullBitmap)&&(this._nullCount=e=this.length-hb.popcnt_bit_range(r,this.offset,this.offset+this.length)),e}clone(e,r=this.offset,n=this.length,s=this._nullCount,a=this,o=this.childData){return new M(e,r,n,s,a,o,this.dictionary)}slice(e,r){let{stride:n,typeId:s,childData:a}=this,o=+(this._nullCount===0)-1,c=s===16?n:1,f=this._sliceBuffers(e,r,n,s);return this.clone(this.type,this.offset+e,r,o,f,!a.length||this.valueOffsets?a:this._sliceChildren(a,c*e,c*r))}_changeLengthAndBackfillNullBitmap(e){if(this.typeId===O.Type.Null)return this.clone(this.type,0,e,0);let{length:r,nullCount:n}=this,s=new Uint8Array((e+63&~63)>>3).fill(255,0,r>>3);s[r>>3]=(1<<r-(r&~7))-1,n>0&&s.set(fb.truncateBitmap(this.offset,r,this.nullBitmap),0);let a=this.buffers;return a[O.BufferType.VALIDITY]=s,this.clone(this.type,0,e,n+(e-r),a)}_sliceBuffers(e,r,n,s){let a,{buffers:o}=this;return(a=o[O.BufferType.TYPE])&&(o[O.BufferType.TYPE]=a.subarray(e,e+r)),(a=o[O.BufferType.OFFSET])&&(o[O.BufferType.OFFSET]=a.subarray(e,e+r+1))||(a=o[O.BufferType.DATA])&&(o[O.BufferType.DATA]=s===6?a:a.subarray(n*e,n*(e+r))),o}_sliceChildren(e,r,n){return e.map(s=>s.slice(r,n))}static new(e,r,n,s,a,o,c){switch(a instanceof M?a=a.buffers:a||(a=[]),e.typeId){case O.Type.Null:return M.Null(e,r,n);case O.Type.Int:return M.Int(e,r,n,s||0,a[O.BufferType.VALIDITY],a[O.BufferType.DATA]||[]);case O.Type.Dictionary:return M.Dictionary(e,r,n,s||0,a[O.BufferType.VALIDITY],a[O.BufferType.DATA]||[],c);case O.Type.Float:return M.Float(e,r,n,s||0,a[O.BufferType.VALIDITY],a[O.BufferType.DATA]||[]);case O.Type.Bool:return M.Bool(e,r,n,s||0,a[O.BufferType.VALIDITY],a[O.BufferType.DATA]||[]);case O.Type.Decimal:return M.Decimal(e,r,n,s||0,a[O.BufferType.VALIDITY],a[O.BufferType.DATA]||[]);case O.Type.Date:return M.Date(e,r,n,s||0,a[O.BufferType.VALIDITY],a[O.BufferType.DATA]||[]);case O.Type.Time:return M.Time(e,r,n,s||0,a[O.BufferType.VALIDITY],a[O.BufferType.DATA]||[]);case O.Type.Timestamp:return M.Timestamp(e,r,n,s||0,a[O.BufferType.VALIDITY],a[O.BufferType.DATA]||[]);case O.Type.Interval:return M.Interval(e,r,n,s||0,a[O.BufferType.VALIDITY],a[O.BufferType.DATA]||[]);case O.Type.FixedSizeBinary:return M.FixedSizeBinary(e,r,n,s||0,a[O.BufferType.VALIDITY],a[O.BufferType.DATA]||[]);case O.Type.Binary:return M.Binary(e,r,n,s||0,a[O.BufferType.VALIDITY],a[O.BufferType.OFFSET]||[],a[O.BufferType.DATA]||[]);case O.Type.Utf8:return M.Utf8(e,r,n,s||0,a[O.BufferType.VALIDITY],a[O.BufferType.OFFSET]||[],a[O.BufferType.DATA]||[]);case O.Type.List:return M.List(e,r,n,s||0,a[O.BufferType.VALIDITY],a[O.BufferType.OFFSET]||[],(o||[])[0]);case O.Type.FixedSizeList:return M.FixedSizeList(e,r,n,s||0,a[O.BufferType.VALIDITY],(o||[])[0]);case O.Type.Struct:return M.Struct(e,r,n,s||0,a[O.BufferType.VALIDITY],o||[]);case O.Type.Map:return M.Map(e,r,n,s||0,a[O.BufferType.VALIDITY],a[O.BufferType.OFFSET]||[],(o||[])[0]);case O.Type.Union:return M.Union(e,r,n,s||0,a[O.BufferType.VALIDITY],a[O.BufferType.TYPE]||[],a[O.BufferType.OFFSET]||o,o)}throw new Error(`Unrecognized typeId ${e.typeId}`)}static Null(e,r,n){return new M(e,r,n,0)}static Int(e,r,n,s,a,o){return new M(e,r,n,s,[void 0,G.toArrayBufferView(e.ArrayType,o),G.toUint8Array(a)])}static Dictionary(e,r,n,s,a,o,c){return new M(e,r,n,s,[void 0,G.toArrayBufferView(e.indices.ArrayType,o),G.toUint8Array(a)],[],c)}static Float(e,r,n,s,a,o){return new M(e,r,n,s,[void 0,G.toArrayBufferView(e.ArrayType,o),G.toUint8Array(a)])}static Bool(e,r,n,s,a,o){return new M(e,r,n,s,[void 0,G.toArrayBufferView(e.ArrayType,o),G.toUint8Array(a)])}static Decimal(e,r,n,s,a,o){return new M(e,r,n,s,[void 0,G.toArrayBufferView(e.ArrayType,o),G.toUint8Array(a)])}static Date(e,r,n,s,a,o){return new M(e,r,n,s,[void 0,G.toArrayBufferView(e.ArrayType,o),G.toUint8Array(a)])}static Time(e,r,n,s,a,o){return new M(e,r,n,s,[void 0,G.toArrayBufferView(e.ArrayType,o),G.toUint8Array(a)])}static Timestamp(e,r,n,s,a,o){return new M(e,r,n,s,[void 0,G.toArrayBufferView(e.ArrayType,o),G.toUint8Array(a)])}static Interval(e,r,n,s,a,o){return new M(e,r,n,s,[void 0,G.toArrayBufferView(e.ArrayType,o),G.toUint8Array(a)])}static FixedSizeBinary(e,r,n,s,a,o){return new M(e,r,n,s,[void 0,G.toArrayBufferView(e.ArrayType,o),G.toUint8Array(a)])}static Binary(e,r,n,s,a,o,c){return new M(e,r,n,s,[G.toInt32Array(o),G.toUint8Array(c),G.toUint8Array(a)])}static Utf8(e,r,n,s,a,o,c){return new M(e,r,n,s,[G.toInt32Array(o),G.toUint8Array(c),G.toUint8Array(a)])}static List(e,r,n,s,a,o,c){return new M(e,r,n,s,[G.toInt32Array(o),void 0,G.toUint8Array(a)],c?[c]:[])}static FixedSizeList(e,r,n,s,a,o){return new M(e,r,n,s,[void 0,void 0,G.toUint8Array(a)],o?[o]:[])}static Struct(e,r,n,s,a,o){return new M(e,r,n,s,[void 0,void 0,G.toUint8Array(a)],o)}static Map(e,r,n,s,a,o,c){return new M(e,r,n,s,[G.toInt32Array(o),void 0,G.toUint8Array(a)],c?[c]:[])}static Union(e,r,n,s,a,o,c,f){let i=[void 0,void 0,G.toUint8Array(a),G.toArrayBufferView(e.ArrayType,o)];return e.mode===O.UnionMode.Sparse?new M(e,r,n,s,i,c):(i[O.BufferType.OFFSET]=G.toInt32Array(c),new M(e,r,n,s,i,f))}};Or.Data=M;M.prototype.childData=Object.freeze([])});var lo=m(Zi=>{"use strict";Object.defineProperty(Zi,"__esModule",{value:!0});Zi.valueToString=void 0;var yb=void 0;function bb(t){if(t===null)return"null";if(t===yb)return"undefined";switch(typeof t){case"number":return`${t}`;case"bigint":return`${t}`;case"string":return`"${t}"`}return typeof t[Symbol.toPrimitive]=="function"?t[Symbol.toPrimitive]("string"):ArrayBuffer.isView(t)?`[${t}]`:JSON.stringify(t)}Zi.valueToString=bb});var Pl=m(Xi=>{"use strict";Object.defineProperty(Xi,"__esModule",{value:!0});Xi.createIsValidFunction=void 0;var fo=lo(),mb=Ae();function gb(t){if(!t||t.length<=0)return function(s){return!0};let e="",r=t.filter(n=>n===n);return r.length>0&&(e=`
    switch (x) {${r.map(n=>`
        case ${_b(n)}:`).join("")}
            return false;
    }`),t.length!==r.length&&(e=`if (x !== x) return false;
${e}`),new Function("x",`${e}
return true;`)}Xi.createIsValidFunction=gb;function _b(t){return typeof t!="bigint"?fo.valueToString(t):mb.BigIntAvailable?`${fo.valueToString(t)}n`:`"${fo.valueToString(t)}"`}});var Ht=m(We=>{"use strict";Object.defineProperty(We,"__esModule",{value:!0});We.WideBufferBuilder=We.OffsetsBufferBuilder=We.BitmapBufferBuilder=We.DataBufferBuilder=We.BufferBuilder=void 0;var Nl=de(),ho=Ae(),po=(t,e)=>(t*e+63&~63||64)/e,Tb=(t,e=0)=>t.length>=e?t.subarray(0,e):Nl.memcpy(new t.constructor(e),t,0),zn=class{constructor(e,r=1){this.buffer=e,this.stride=r,this.BYTES_PER_ELEMENT=e.BYTES_PER_ELEMENT,this.ArrayType=e.constructor,this._resize(this.length=e.length/r|0)}get byteLength(){return this.length*this.stride*this.BYTES_PER_ELEMENT|0}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(e,r){return this}append(e){return this.set(this.length,e)}reserve(e){if(e>0){this.length+=e;let r=this.stride,n=this.length*r,s=this.buffer.length;n>=s&&this._resize(s===0?po(n*1,this.BYTES_PER_ELEMENT):po(n*2,this.BYTES_PER_ELEMENT))}return this}flush(e=this.length){e=po(e*this.stride,this.BYTES_PER_ELEMENT);let r=Tb(this.buffer,e);return this.clear(),r}clear(){return this.length=0,this._resize(0),this}_resize(e){return this.buffer=Nl.memcpy(new this.ArrayType(e),this.buffer)}};We.BufferBuilder=zn;zn.prototype.offset=0;var es=class extends zn{last(){return this.get(this.length-1)}get(e){return this.buffer[e]}set(e,r){return this.reserve(e-this.length+1),this.buffer[e*this.stride]=r,this}};We.DataBufferBuilder=es;var Ll=class extends es{constructor(e=new Uint8Array(0)){super(e,1/8);this.numValid=0}get numInvalid(){return this.length-this.numValid}get(e){return this.buffer[e>>3]>>e%8&1}set(e,r){let{buffer:n}=this.reserve(e-this.length+1),s=e>>3,a=e%8,o=n[s]>>a&1;return r?o===0&&(n[s]|=1<<a,++this.numValid):o===1&&(n[s]&=~(1<<a),--this.numValid),this}clear(){return this.numValid=0,super.clear()}};We.BitmapBufferBuilder=Ll;var xl=class extends es{constructor(e=new Int32Array(1)){super(e,1)}append(e){return this.set(this.length-1,e)}set(e,r){let n=this.length-1,s=this.reserve(e-n+1).buffer;return n<e++&&s.fill(s[n],n,e),s[e]=s[e-1]+r,this}flush(e=this.length-1){return e>this.length&&this.set(e-1,0),super.flush(e+1)}};We.OffsetsBufferBuilder=xl;var jl=class extends zn{get ArrayType64(){return this._ArrayType64||(this._ArrayType64=this.buffer instanceof Int32Array?ho.BigInt64Array:ho.BigUint64Array)}set(e,r){switch(this.reserve(e-this.length+1),typeof r){case"bigint":this.buffer64[e]=r;break;case"number":this.buffer[e*this.stride]=r;break;default:this.buffer.set(r,e*this.stride)}return this}_resize(e){let r=super._resize(e),n=r.byteLength/(this.BYTES_PER_ELEMENT*this.stride);return ho.BigIntAvailable&&(this.buffer64=new this.ArrayType64(r.buffer,r.byteOffset,n)),r}};We.WideBufferBuilder=jl});var ae=m($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.VariableWidthBuilder=$t.FixedWidthBuilder=$t.Builder=void 0;var Bb=ue(),Jr=ee(),Ib=st(),wb=Pl(),yo=Ht(),vb=K(),ze=class{constructor({type:e,nullValues:r}){this.length=0,this.finished=!1,this.type=e,this.children=[],this.nullValues=r,this.stride=vb.strideForType(e),this._nulls=new yo.BitmapBufferBuilder,r&&r.length>0&&(this._isValid=wb.createIsValidFunction(r))}static new(e){}static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e){throw new Error('"throughDOM" not available in this environment')}static throughIterable(e){return Sb(e)}static throughAsyncIterable(e){return Ob(e)}toVector(){return Bb.Vector.new(this.flush())}get ArrayType(){return this.type.ArrayType}get nullCount(){return this._nulls.numInvalid}get numChildren(){return this.children.length}get byteLength(){let e=0;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),this._typeIds&&(e+=this._typeIds.byteLength),this.children.reduce((r,n)=>r+n.byteLength,e)}get reservedLength(){return this._nulls.reservedLength}get reservedByteLength(){let e=0;return this._offsets&&(e+=this._offsets.reservedByteLength),this._values&&(e+=this._values.reservedByteLength),this._nulls&&(e+=this._nulls.reservedByteLength),this._typeIds&&(e+=this._typeIds.reservedByteLength),this.children.reduce((r,n)=>r+n.reservedByteLength,e)}get valueOffsets(){return this._offsets?this._offsets.buffer:null}get values(){return this._values?this._values.buffer:null}get nullBitmap(){return this._nulls?this._nulls.buffer:null}get typeIds(){return this._typeIds?this._typeIds.buffer:null}append(e){return this.set(this.length,e)}isValid(e){return this._isValid(e)}set(e,r){return this.setValid(e,this.isValid(r))&&this.setValue(e,r),this}setValue(e,r){this._setValue(this,e,r)}setValid(e,r){return this.length=this._nulls.set(e,+r).length,r}addChild(e,r=`${this.numChildren}`){throw new Error(`Cannot append children to non-nested type "${this.type}"`)}getChildAt(e){return this.children[e]||null}flush(){let e=[],r=this._values,n=this._offsets,s=this._typeIds,{length:a,nullCount:o}=this;s?(e[Jr.BufferType.TYPE]=s.flush(a),n&&(e[Jr.BufferType.OFFSET]=n.flush(a))):n?(r&&(e[Jr.BufferType.DATA]=r.flush(n.last())),e[Jr.BufferType.OFFSET]=n.flush(a)):r&&(e[Jr.BufferType.DATA]=r.flush(a)),o>0&&(e[Jr.BufferType.VALIDITY]=this._nulls.flush(a));let c=Ib.Data.new(this.type,0,a,o,e,this.children.map(f=>f.flush()));return this.clear(),c}finish(){return this.finished=!0,this.children.forEach(e=>e.finish()),this}clear(){return this.length=0,this._offsets&&this._offsets.clear(),this._values&&this._values.clear(),this._nulls&&this._nulls.clear(),this._typeIds&&this._typeIds.clear(),this.children.forEach(e=>e.clear()),this}};$t.Builder=ze;ze.prototype.length=1;ze.prototype.stride=1;ze.prototype.children=null;ze.prototype.finished=!1;ze.prototype.nullValues=null;ze.prototype._isValid=()=>!0;var kl=class extends ze{constructor(e){super(e);this._values=new yo.DataBufferBuilder(new this.ArrayType(0),this.stride)}setValue(e,r){let n=this._values;return n.reserve(e-n.length+1),super.setValue(e,r)}};$t.FixedWidthBuilder=kl;var Cl=class extends ze{constructor(e){super(e);this._pendingLength=0,this._offsets=new yo.OffsetsBufferBuilder}setValue(e,r){let n=this._pending||(this._pending=new Map),s=n.get(e);s&&(this._pendingLength-=s.length),this._pendingLength+=r.length,n.set(e,r)}setValid(e,r){return super.setValid(e,r)?!0:((this._pending||(this._pending=new Map)).set(e,void 0),!1)}clear(){return this._pendingLength=0,this._pending=void 0,super.clear()}flush(){return this._flush(),super.flush()}finish(){return this._flush(),super.finish()}_flush(){let e=this._pending,r=this._pendingLength;return this._pendingLength=0,this._pending=void 0,e&&e.size>0&&this._flushPending(e,r),this}};$t.VariableWidthBuilder=Cl;function Sb(t){let{["queueingStrategy"]:e="count"}=t,{["highWaterMark"]:r=e!=="bytes"?1e3:2**14}=t,n=e!=="bytes"?"length":"byteLength";return function*(s){let a=0,o=ze.new(t);for(let c of s)o.append(c)[n]>=r&&++a&&(yield o.toVector());(o.finish().length>0||a===0)&&(yield o.toVector())}}function Ob(t){let{["queueingStrategy"]:e="count"}=t,{["highWaterMark"]:r=e!=="bytes"?1e3:2**14}=t,n=e!=="bytes"?"length":"byteLength";return async function*(s){let a=0,o=ze.new(t);for await(let c of s)o.append(c)[n]>=r&&++a&&(yield o.toVector());(o.finish().length>0||a===0)&&(yield o.toVector())}}});var bo=m(ts=>{"use strict";Object.defineProperty(ts,"__esModule",{value:!0});ts.BoolBuilder=void 0;var Ab=Ht(),Fb=ae(),ql=class extends Fb.Builder{constructor(e){super(e);this._values=new Ab.BitmapBufferBuilder}setValue(e,r){this._values.set(e,+r)}};ts.BoolBuilder=ql});var mo=m(rs=>{"use strict";Object.defineProperty(rs,"__esModule",{value:!0});rs.NullBuilder=void 0;var Db=ae(),Wl=class extends Db.Builder{setValue(e,r){}setValid(e,r){return this.length=Math.max(e+1,this.length),r}};rs.NullBuilder=Wl});var go=m(Jt=>{"use strict";Object.defineProperty(Jt,"__esModule",{value:!0});Jt.DateMillisecondBuilder=Jt.DateDayBuilder=Jt.DateBuilder=void 0;var Rb=ae(),ns=class extends Rb.FixedWidthBuilder{};Jt.DateBuilder=ns;var zl=class extends ns{};Jt.DateDayBuilder=zl;var Yl=class extends ns{};Jt.DateMillisecondBuilder=Yl});var _o=m(is=>{"use strict";Object.defineProperty(is,"__esModule",{value:!0});is.DecimalBuilder=void 0;var Eb=ae(),Gl=class extends Eb.FixedWidthBuilder{};is.DecimalBuilder=Gl});var Bo=m(ss=>{"use strict";Object.defineProperty(ss,"__esModule",{value:!0});ss.DictionaryBuilder=void 0;var Ub=K(),To=ae(),Hl=class extends To.Builder{constructor({type:e,nullValues:r,dictionaryHashFunction:n}){super({type:new Ub.Dictionary(e.dictionary,e.indices,e.id,e.isOrdered)});this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=To.Builder.new({type:this.type.indices,nullValues:r}),this.dictionary=To.Builder.new({type:this.type.dictionary,nullValues:null}),typeof n=="function"&&(this.valueToKey=n)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(e){return this.indices.isValid(e)}setValid(e,r){let n=this.indices;return r=n.setValid(e,r),this.length=n.length,r}setValue(e,r){let n=this._keysToIndices,s=this.valueToKey(r),a=n[s];return a===void 0&&(n[s]=a=this._dictionaryOffset+this.dictionary.append(r).length-1),this.indices.setValue(e,a)}flush(){let e=this.type,r=this._dictionary,n=this.dictionary.toVector(),s=this.indices.flush().clone(e);return s.dictionary=r?r.concat(n):n,this.finished||(this._dictionaryOffset+=n.length),this._dictionary=s.dictionary,this.clear(),s}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey(e){return typeof e=="string"?e:`${e}`}};ss.DictionaryBuilder=Hl});var Io=m(as=>{"use strict";Object.defineProperty(as,"__esModule",{value:!0});as.FixedSizeBinaryBuilder=void 0;var Vb=ae(),$l=class extends Vb.FixedWidthBuilder{};as.FixedSizeBinaryBuilder=$l});var Yn=m(Qr=>{"use strict";Object.defineProperty(Qr,"__esModule",{value:!0});Qr.float64ToUint16=Qr.uint16ToFloat64=void 0;var Jl=new Float64Array(1),Kr=new Uint32Array(Jl.buffer);function Mb(t){let e=(t&31744)>>10,r=(t&1023)/1024,n=(-1)**((t&32768)>>15);switch(e){case 31:return n*(r?NaN:1/0);case 0:return n*(r?6103515625e-14*r:0)}return n*2**(e-15)*(1+r)}Qr.uint16ToFloat64=Mb;function Pb(t){if(t!==t)return 32256;Jl[0]=t;let e=(Kr[1]&2147483648)>>16&65535,r=Kr[1]&2146435072,n=0;return r>=1089470464?Kr[0]>0?r=31744:(r=(r&2080374784)>>16,n=(Kr[1]&1048575)>>10):r<=1056964608?(n=1048576+(Kr[1]&1048575),n=1048576+(n<<(r>>20)-998)>>21,r=0):(r=r-1056964608>>10,n=(Kr[1]&1048575)+512>>10),e|r|n&65535}Qr.float64ToUint16=Pb});var wo=m(yt=>{"use strict";Object.defineProperty(yt,"__esModule",{value:!0});yt.Float64Builder=yt.Float32Builder=yt.Float16Builder=yt.FloatBuilder=void 0;var Nb=Yn(),Lb=ae(),Gn=class extends Lb.FixedWidthBuilder{};yt.FloatBuilder=Gn;var Kl=class extends Gn{setValue(e,r){this._values.set(e,Nb.float64ToUint16(r))}};yt.Float16Builder=Kl;var Ql=class extends Gn{setValue(e,r){this._values.set(e,r)}};yt.Float32Builder=Ql;var Zl=class extends Gn{setValue(e,r){this._values.set(e,r)}};yt.Float64Builder=Zl});var Jn=m(be=>{"use strict";Object.defineProperty(be,"__esModule",{value:!0});be.BN=be.bignumToBigInt=be.bignumToString=be.isArrowBigNumSymbol=void 0;var xb=de(),Hn=Ae();be.isArrowBigNumSymbol=Symbol.for("isArrowBigNum");function at(t,...e){return e.length===0?Object.setPrototypeOf(xb.toArrayBufferView(this.TypedArray,t),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(t,...e),this.constructor.prototype)}at.prototype[be.isArrowBigNumSymbol]=!0;at.prototype.toJSON=function(){return`"${be.bignumToString(this)}"`};at.prototype.valueOf=function(){return Xl(this)};at.prototype.toString=function(){return be.bignumToString(this)};at.prototype[Symbol.toPrimitive]=function(t="default"){switch(t){case"number":return Xl(this);case"string":return be.bignumToString(this);case"default":return be.bignumToBigInt(this)}return be.bignumToString(this)};function Zr(...t){return at.apply(this,t)}function Xr(...t){return at.apply(this,t)}function $n(...t){return at.apply(this,t)}Object.setPrototypeOf(Zr.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(Xr.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf($n.prototype,Object.create(Uint32Array.prototype));Object.assign(Zr.prototype,at.prototype,{constructor:Zr,signed:!0,TypedArray:Int32Array,BigIntArray:Hn.BigInt64Array});Object.assign(Xr.prototype,at.prototype,{constructor:Xr,signed:!1,TypedArray:Uint32Array,BigIntArray:Hn.BigUint64Array});Object.assign($n.prototype,at.prototype,{constructor:$n,signed:!0,TypedArray:Uint32Array,BigIntArray:Hn.BigUint64Array});function Xl(t){let{buffer:e,byteOffset:r,length:n,signed:s}=t,a=new Int32Array(e,r,n),o=0,c=0,f=a.length,i,u;for(;c<f;)u=a[c++],i=a[c++],s||(i=i>>>0),o+=(u>>>0)+i*c**32;return o}Hn.BigIntAvailable?(be.bignumToBigInt=t=>t.byteLength===8?new t.BigIntArray(t.buffer,t.byteOffset,1)[0]:vo(t),be.bignumToString=t=>t.byteLength===8?`${new t.BigIntArray(t.buffer,t.byteOffset,1)[0]}`:vo(t)):(be.bignumToString=vo,be.bignumToBigInt=be.bignumToString);function vo(t){let e="",r=new Uint32Array(2),n=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),s=new Uint32Array((n=new Uint16Array(n).reverse()).buffer),a=-1,o=n.length-1;do{for(r[0]=n[a=0];a<o;)n[a++]=r[1]=r[0]/10,r[0]=(r[0]-r[1]*10<<16)+n[a];n[a]=r[1]=r[0]/10,r[0]=r[0]-r[1]*10,e=`${r[0]}${e}`}while(s[0]||s[1]||s[2]||s[3]);return e||"0"}var os=class{static new(e,r){switch(r){case!0:return new Zr(e);case!1:return new Xr(e)}switch(e.constructor){case Int8Array:case Int16Array:case Int32Array:case Hn.BigInt64Array:return new Zr(e)}return e.byteLength===16?new $n(e):new Xr(e)}static signed(e){return new Zr(e)}static unsigned(e){return new Xr(e)}static decimal(e){return new $n(e)}constructor(e,r){return os.new(e,r)}};be.BN=os});var So=m(he=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.Uint64Builder=he.Uint32Builder=he.Uint16Builder=he.Uint8Builder=he.Int64Builder=he.Int32Builder=he.Int16Builder=he.Int8Builder=he.IntBuilder=void 0;var jb=Jn(),ed=Ht(),kb=Ae(),Cb=ae(),bt=class extends Cb.FixedWidthBuilder{setValue(e,r){this._values.set(e,r)}};he.IntBuilder=bt;var td=class extends bt{};he.Int8Builder=td;var rd=class extends bt{};he.Int16Builder=rd;var nd=class extends bt{};he.Int32Builder=nd;var id=class extends bt{constructor(e){e.nullValues&&(e.nullValues=e.nullValues.map(cs));super(e);this._values=new ed.WideBufferBuilder(new Int32Array(0),2)}get values64(){return this._values.buffer64}isValid(e){return super.isValid(cs(e))}};he.Int64Builder=id;var sd=class extends bt{};he.Uint8Builder=sd;var ad=class extends bt{};he.Uint16Builder=ad;var od=class extends bt{};he.Uint32Builder=od;var cd=class extends bt{constructor(e){e.nullValues&&(e.nullValues=e.nullValues.map(cs));super(e);this._values=new ed.WideBufferBuilder(new Uint32Array(0),2)}get values64(){return this._values.buffer64}isValid(e){return super.isValid(cs(e))}};he.Uint64Builder=cd;var cs=(t=>e=>(ArrayBuffer.isView(e)&&(t.buffer=e.buffer,t.byteOffset=e.byteOffset,t.byteLength=e.byteLength,e=jb.bignumToBigInt(t),t.buffer=null),e))({BigIntArray:kb.BigInt64Array})});var Oo=m(Ye=>{"use strict";Object.defineProperty(Ye,"__esModule",{value:!0});Ye.TimeNanosecondBuilder=Ye.TimeMicrosecondBuilder=Ye.TimeMillisecondBuilder=Ye.TimeSecondBuilder=Ye.TimeBuilder=void 0;var qb=ae(),en=class extends qb.FixedWidthBuilder{};Ye.TimeBuilder=en;var ud=class extends en{};Ye.TimeSecondBuilder=ud;var ld=class extends en{};Ye.TimeMillisecondBuilder=ld;var dd=class extends en{};Ye.TimeMicrosecondBuilder=dd;var fd=class extends en{};Ye.TimeNanosecondBuilder=fd});var Ao=m(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});Ge.TimestampNanosecondBuilder=Ge.TimestampMicrosecondBuilder=Ge.TimestampMillisecondBuilder=Ge.TimestampSecondBuilder=Ge.TimestampBuilder=void 0;var Wb=ae(),tn=class extends Wb.FixedWidthBuilder{};Ge.TimestampBuilder=tn;var hd=class extends tn{};Ge.TimestampSecondBuilder=hd;var pd=class extends tn{};Ge.TimestampMillisecondBuilder=pd;var yd=class extends tn{};Ge.TimestampMicrosecondBuilder=yd;var bd=class extends tn{};Ge.TimestampNanosecondBuilder=bd});var Fo=m(Kt=>{"use strict";Object.defineProperty(Kt,"__esModule",{value:!0});Kt.IntervalYearMonthBuilder=Kt.IntervalDayTimeBuilder=Kt.IntervalBuilder=void 0;var zb=ae(),us=class extends zb.FixedWidthBuilder{};Kt.IntervalBuilder=us;var md=class extends us{};Kt.IntervalDayTimeBuilder=md;var gd=class extends us{};Kt.IntervalYearMonthBuilder=gd});var ds=m(ls=>{"use strict";Object.defineProperty(ls,"__esModule",{value:!0});ls.BinaryBuilder=void 0;var Yb=de(),Gb=Ht(),Hb=ae(),_d=class extends Hb.VariableWidthBuilder{constructor(e){super(e);this._values=new Gb.BufferBuilder(new Uint8Array(0))}get byteLength(){let e=this._pendingLength+this.length*4;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),e}setValue(e,r){return super.setValue(e,Yb.toUint8Array(r))}_flushPending(e,r){let n=this._offsets,s=this._values.reserve(r).buffer,a=0,o=0,c=0,f;for([a,f]of e)f===void 0?n.set(a,0):(o=f.length,s.set(f,c),n.set(a,o),c+=o)}};ls.BinaryBuilder=_d});var hs=m(fs=>{"use strict";Object.defineProperty(fs,"__esModule",{value:!0});fs.Utf8Builder=void 0;var $b=Ir(),Jb=ds(),Kb=Ht(),Qb=ae(),Do=class extends Qb.VariableWidthBuilder{constructor(e){super(e);this._values=new Kb.BufferBuilder(new Uint8Array(0))}get byteLength(){let e=this._pendingLength+this.length*4;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),e}setValue(e,r){return super.setValue(e,$b.encodeUtf8(r))}_flushPending(e,r){}};fs.Utf8Builder=Do;Do.prototype._flushPending=Jb.BinaryBuilder.prototype._flushPending});var Ro=m(ps=>{"use strict";Object.defineProperty(ps,"__esModule",{value:!0});ps.Run=void 0;var Zb=ue(),Td=class{get length(){return this._values.length}get(e){return this._values[e]}clear(){return this._values=null,this}bind(e){return e instanceof Zb.Vector?e:(this._values=e,this)}};ps.Run=Td});var Kn=m(nn=>{"use strict";Object.defineProperty(nn,"__esModule",{value:!0});nn.StructRow=nn.MapRow=void 0;var Bd=lo(),Se=Symbol.for("parent"),rn=Symbol.for("rowIndex"),Ne=Symbol.for("keyToIdx"),Le=Symbol.for("idxToVal"),Eo=Symbol.for("nodejs.util.inspect.custom"),mt=class{constructor(e,r){this[Se]=e,this.size=r}entries(){return this[Symbol.iterator]()}has(e){return this.get(e)!==void 0}get(e){let r;if(e!=null){let n=this[Ne]||(this[Ne]=new Map),s=n.get(e);if(s!==void 0){let a=this[Le]||(this[Le]=new Array(this.size));(r=a[s])!==void 0||(a[s]=r=this.getValue(s))}else if((s=this.getIndex(e))>-1){n.set(e,s);let a=this[Le]||(this[Le]=new Array(this.size));(r=a[s])!==void 0||(a[s]=r=this.getValue(s))}}return r}set(e,r){if(e!=null){let n=this[Ne]||(this[Ne]=new Map),s=n.get(e);if(s===void 0&&n.set(e,s=this.getIndex(e)),s>-1){let a=this[Le]||(this[Le]=new Array(this.size));a[s]=this.setValue(s,r)}}return this}clear(){throw new Error(`Clearing ${this[Symbol.toStringTag]} not supported.`)}delete(e){throw new Error(`Deleting ${this[Symbol.toStringTag]} values not supported.`)}*[Symbol.iterator](){let e=this.keys(),r=this.values(),n=this[Ne]||(this[Ne]=new Map),s=this[Le]||(this[Le]=new Array(this.size));for(let a,o,c=0,f,i;!((f=e.next()).done||(i=r.next()).done);++c)a=f.value,o=i.value,s[c]=o,n.has(a)||n.set(a,c),yield[a,o]}forEach(e,r){let n=this.keys(),s=this.values(),a=r===void 0?e:(f,i,u)=>e.call(r,f,i,u),o=this[Ne]||(this[Ne]=new Map),c=this[Le]||(this[Le]=new Array(this.size));for(let f,i,u=0,y,N;!((y=n.next()).done||(N=s.next()).done);++u)f=y.value,i=N.value,c[u]=i,o.has(f)||o.set(f,u),a(i,f,this)}toArray(){return[...this.values()]}toJSON(){let e={};return this.forEach((r,n)=>e[n]=r),e}inspect(){return this.toString()}[Eo](){return this.toString()}toString(){let e=[];return this.forEach((r,n)=>{n=Bd.valueToString(n),r=Bd.valueToString(r),e.push(`${n}: ${r}`)}),`{ ${e.join(", ")} }`}};mt[Symbol.toStringTag]=(t=>(Object.defineProperties(t,{size:{writable:!0,enumerable:!1,configurable:!1,value:0},[Se]:{writable:!0,enumerable:!1,configurable:!1,value:null},[rn]:{writable:!0,enumerable:!1,configurable:!1,value:-1}}),t[Symbol.toStringTag]="Row"))(mt.prototype);var Id=class extends mt{constructor(e){super(e,e.length);return Xb(this)}keys(){return this[Se].getChildAt(0)[Symbol.iterator]()}values(){return this[Se].getChildAt(1)[Symbol.iterator]()}getKey(e){return this[Se].getChildAt(0).get(e)}getIndex(e){return this[Se].getChildAt(0).indexOf(e)}getValue(e){return this[Se].getChildAt(1).get(e)}setValue(e,r){this[Se].getChildAt(1).set(e,r)}};nn.MapRow=Id;var wd=class extends mt{constructor(e){super(e,e.type.children.length);return vd(this)}*keys(){for(let e of this[Se].type.children)yield e.name}*values(){for(let e of this[Se].type.children)yield this[e.name]}getKey(e){return this[Se].type.children[e].name}getIndex(e){return this[Se].type.children.findIndex(r=>r.name===e)}getValue(e){return this[Se].getChildAt(e).get(this[rn])}setValue(e,r){return this[Se].getChildAt(e).set(this[rn],r)}};nn.StructRow=wd;Object.setPrototypeOf(mt.prototype,Map.prototype);var vd=(()=>{let t={enumerable:!0,configurable:!1,get:null,set:null};return e=>{let r=-1,n=e[Ne]||(e[Ne]=new Map),s=o=>function(){return this.get(o)},a=o=>function(c){return this.set(o,c)};for(let o of e.keys())n.set(o,++r),t.get=s(o),t.set=a(o),e.hasOwnProperty(o)||(t.enumerable=!0,Object.defineProperty(e,o,t)),e.hasOwnProperty(r)||(t.enumerable=!1,Object.defineProperty(e,r,t));return t.get=t.set=null,e}})(),Xb=(()=>{if(typeof Proxy=="undefined")return vd;let t=mt.prototype.has,e=mt.prototype.get,r=mt.prototype.set,n=mt.prototype.getKey,s={isExtensible(){return!1},deleteProperty(){return!1},preventExtensions(){return!0},ownKeys(a){return[...a.keys()].map(o=>`${o}`)},has(a,o){switch(o){case"getKey":case"getIndex":case"getValue":case"setValue":case"toArray":case"toJSON":case"inspect":case"constructor":case"isPrototypeOf":case"propertyIsEnumerable":case"toString":case"toLocaleString":case"valueOf":case"size":case"has":case"get":case"set":case"clear":case"delete":case"keys":case"values":case"entries":case"forEach":case"__proto__":case"__defineGetter__":case"__defineSetter__":case"hasOwnProperty":case"__lookupGetter__":case"__lookupSetter__":case Symbol.iterator:case Symbol.toStringTag:case Se:case rn:case Le:case Ne:case Eo:return!0}return typeof o=="number"&&!a.has(o)&&(o=a.getKey(o)),a.has(o)},get(a,o,c){switch(o){case"getKey":case"getIndex":case"getValue":case"setValue":case"toArray":case"toJSON":case"inspect":case"constructor":case"isPrototypeOf":case"propertyIsEnumerable":case"toString":case"toLocaleString":case"valueOf":case"size":case"has":case"get":case"set":case"clear":case"delete":case"keys":case"values":case"entries":case"forEach":case"__proto__":case"__defineGetter__":case"__defineSetter__":case"hasOwnProperty":case"__lookupGetter__":case"__lookupSetter__":case Symbol.iterator:case Symbol.toStringTag:case Se:case rn:case Le:case Ne:case Eo:return Reflect.get(a,o,c)}return typeof o=="number"&&!t.call(c,o)&&(o=n.call(c,o)),e.call(c,o)},set(a,o,c,f){switch(o){case Se:case rn:case Le:case Ne:return Reflect.set(a,o,c,f);case"getKey":case"getIndex":case"getValue":case"setValue":case"toArray":case"toJSON":case"inspect":case"constructor":case"isPrototypeOf":case"propertyIsEnumerable":case"toString":case"toLocaleString":case"valueOf":case"size":case"has":case"get":case"set":case"clear":case"delete":case"keys":case"values":case"entries":case"forEach":case"__proto__":case"__defineGetter__":case"__defineSetter__":case"hasOwnProperty":case"__lookupGetter__":case"__lookupSetter__":case Symbol.iterator:case Symbol.toStringTag:return!1}return typeof o=="number"&&!t.call(f,o)&&(o=n.call(f,o)),t.call(f,o)?!!r.call(f,o,c):!1}};return a=>new Proxy(a,s)})()});var Zn=m(Qt=>{"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});Qt.createElementComparator=Qt.clampRange=Qt.clampIndex=void 0;var Sd=ue(),Od=Kn(),em=de(),Ad=Ae();function tm(t,e,r){let n=t.length,s=e>-1?e:n+e%n;return r?r(t,s):s}Qt.clampIndex=tm;var Fd;function rm(t,e,r,n){let{length:s=0}=t,a=typeof e!="number"?0:e,o=typeof r!="number"?s:r;return a<0&&(a=(a%s+s)%s),o<0&&(o=(o%s+s)%s),o<a&&(Fd=a,a=o,o=Fd),o>s&&(o=s),n?n(t,a,o):[a,o]}Qt.clampRange=rm;var nm=Ad.BigIntAvailable?Ad.BigInt(0):0,Dd=t=>t!==t;function Qn(t){let e=typeof t;if(e!=="object"||t===null)return Dd(t)?Dd:e!=="bigint"?r=>r===t:r=>nm+r===t;if(t instanceof Date){let r=t.valueOf();return n=>n instanceof Date?n.valueOf()===r:!1}return ArrayBuffer.isView(t)?r=>r?em.compareArrayLike(t,r):!1:t instanceof Map?sm(t):Array.isArray(t)?im(t):t instanceof Sd.Vector?am(t):om(t)}Qt.createElementComparator=Qn;function im(t){let e=[];for(let r=-1,n=t.length;++r<n;)e[r]=Qn(t[r]);return ys(e)}function sm(t){let e=-1,r=[];return t.forEach(n=>r[++e]=Qn(n)),ys(r)}function am(t){let e=[];for(let r=-1,n=t.length;++r<n;)e[r]=Qn(t.get(r));return ys(e)}function om(t){let e=Object.keys(t);if(e.length===0)return()=>!1;let r=[];for(let n=-1,s=e.length;++n<s;)r[n]=Qn(t[e[n]]);return ys(r,e)}function ys(t,e){return r=>{if(!r||typeof r!="object")return!1;switch(r.constructor){case Array:return cm(t,r);case Map:case Od.MapRow:case Od.StructRow:return Rd(t,r,r.keys());case Object:case void 0:return Rd(t,r,e||Object.keys(r))}return r instanceof Sd.Vector?um(t,r):!1}}function cm(t,e){let r=t.length;if(e.length!==r)return!1;for(let n=-1;++n<r;)if(!t[n](e[n]))return!1;return!0}function um(t,e){let r=t.length;if(e.length!==r)return!1;for(let n=-1;++n<r;)if(!t[n](e.get(n)))return!1;return!0}function Rd(t,e,r){let n=r[Symbol.iterator](),s=e instanceof Map?e.keys():Object.keys(e)[Symbol.iterator](),a=e instanceof Map?e.values():Object.values(e)[Symbol.iterator](),o=0,c=t.length,f=a.next(),i=n.next(),u=s.next();for(;o<c&&!i.done&&!u.done&&!f.done&&!(i.value!==u.value||!t[o](f.value));++o,i=n.next(),u=s.next(),f=a.next());return o===c&&i.done&&u.done&&f.done?!0:(n.return&&n.return(),s.return&&s.return(),a.return&&a.return(),!1)}});var Zt=m(bs=>{"use strict";Object.defineProperty(bs,"__esModule",{value:!0});bs.Chunked=void 0;var lm=Zn(),Ed=K(),dm=Xt(),Ud=ue(),Pt=class extends Ud.AbstractVector{constructor(e,r=[],n=fm(r)){super();this._nullCount=-1,this._type=e,this._chunks=r,this._chunkOffsets=n,this._length=n[n.length-1],this._numChildren=(this._type.children||[]).length}static flatten(...e){return dm.selectChunkArgs(Ud.Vector,e)}static concat(...e){let r=Pt.flatten(...e);return new Pt(r[0].type,r)}get type(){return this._type}get length(){return this._length}get chunks(){return this._chunks}get typeId(){return this._type.typeId}get VectorName(){return`Chunked<${this._type}>`}get data(){return this._chunks[0]?this._chunks[0].data:null}get ArrayType(){return this._type.ArrayType}get numChildren(){return this._numChildren}get stride(){return this._chunks[0]?this._chunks[0].stride:1}get byteLength(){return this._chunks.reduce((e,r)=>e+r.byteLength,0)}get nullCount(){let e=this._nullCount;return e<0&&(this._nullCount=e=this._chunks.reduce((r,{nullCount:n})=>r+n,0)),e}get indices(){if(Ed.DataType.isDictionary(this._type)){if(!this._indices){let e=this._chunks;this._indices=e.length===1?e[0].indices:Pt.concat(...e.map(r=>r.indices))}return this._indices}return null}get dictionary(){return Ed.DataType.isDictionary(this._type)?this._chunks[this._chunks.length-1].data.dictionary:null}*[Symbol.iterator](){for(let e of this._chunks)yield*e}clone(e=this._chunks){return new Pt(this._type,e)}concat(...e){return this.clone(Pt.flatten(this,...e))}slice(e,r){return lm.clampRange(this,e,r,this._sliceInternal)}getChildAt(e){if(e<0||e>=this._numChildren)return null;let r=this._children||(this._children=[]),n,s,a;return(n=r[e])?n:(s=(this._type.children||[])[e])&&(a=this._chunks.map(o=>o.getChildAt(e)).filter(o=>o!=null),a.length>0)?r[e]=new Pt(s.type,a):null}search(e,r){let n=e,s=this._chunkOffsets,a=s.length-1;if(n<0||n>=s[a])return null;if(a<=1)return r?r(this,0,n):[0,n];let o=0,c=0,f=0;do{if(o+1===a)return r?r(this,o,n-c):[o,n-c];f=o+(a-o)/2|0,n>=s[f]?o=f:a=f}while(n<s[a]&&n>=(c=s[o]));return null}isValid(e){return!!this.search(e,this.isValidInternal)}get(e){return this.search(e,this.getInternal)}set(e,r){this.search(e,({chunks:n},s,a)=>n[s].set(a,r))}indexOf(e,r){return r&&typeof r=="number"?this.search(r,(n,s,a)=>this.indexOfInternal(n,s,a,e)):this.indexOfInternal(this,0,Math.max(0,r||0),e)}toArray(){let{chunks:e}=this,r=e.length,n=this._type.ArrayType;if(r<=0)return new n(0);if(r<=1)return e[0].toArray();let s=0,a=new Array(r);for(let f=-1;++f<r;)s+=(a[f]=e[f].toArray()).length;n!==a[0].constructor&&(n=a[0].constructor);let o=new n(s),c=n===Array?pm:hm;for(let f=-1,i=0;++f<r;)i=c(a[f],o,i);return o}getInternal({_chunks:e},r,n){return e[r].get(n)}isValidInternal({_chunks:e},r,n){return e[r].isValid(n)}indexOfInternal({_chunks:e},r,n,s){let a=r-1,o=e.length,c=n,f=0,i=-1;for(;++a<o;){if(~(i=e[a].indexOf(s,c)))return f+i;c=0,f+=e[a].length}return-1}_sliceInternal(e,r,n){let s=[],{chunks:a,_chunkOffsets:o}=e;for(let c=-1,f=a.length;++c<f;){let i=a[c],u=i.length,y=o[c];if(y>=n)break;if(r>=y+u)continue;if(y>=r&&y+u<=n){s.push(i);continue}let N=Math.max(0,r-y),Z=Math.min(n-y,u);s.push(i.slice(N,Z))}return e.clone(s)}};bs.Chunked=Pt;function fm(t){let e=new Uint32Array((t||[]).length+1),r=e[0]=0,n=e.length;for(let s=0;++s<n;)e[s]=r+=t[s-1].length;return e}var hm=(t,e,r)=>(e.set(t,r),r+t.length),pm=(t,e,r)=>{let n=r;for(let s=-1,a=t.length;++s<a;)e[n++]=t[s];return n}});var sn=m(ms=>{"use strict";Object.defineProperty(ms,"__esModule",{value:!0});ms.Column=void 0;var Vd=_e(),Md=ue(),Uo=Zt(),Ar=class extends Uo.Chunked{constructor(e,r=[],n){r=Uo.Chunked.flatten(...r);super(e.type,r,n);if(this._field=e,r.length===1&&!(this instanceof Vo))return new Vo(e,r[0],this._chunkOffsets)}static new(...e){let[r,n,...s]=e;typeof r!="string"&&!(r instanceof Vd.Field)&&(n=r,r="");let a=Uo.Chunked.flatten(Array.isArray(n)?[...n,...s]:n instanceof Md.Vector?[n,...s]:[Md.Vector.new(n,...s)]);if(typeof r=="string"){let o=a[0].data.type;r=new Vd.Field(r,o,!0)}else!r.nullable&&a.some(({nullCount:o})=>o>0)&&(r=r.clone({nullable:!0}));return new Ar(r,a)}get field(){return this._field}get name(){return this._field.name}get nullable(){return this._field.nullable}get metadata(){return this._field.metadata}clone(e=this._chunks){return new Ar(this._field,e)}getChildAt(e){if(e<0||e>=this.numChildren)return null;let r=this._children||(this._children=[]),n,s,a;return(n=r[e])?n:(s=(this.type.children||[])[e])&&(a=this._chunks.map(o=>o.getChildAt(e)).filter(o=>o!=null),a.length>0)?r[e]=new Ar(s,a):null}};ms.Column=Ar;var Vo=class extends Ar{constructor(e,r,n){super(e,[r],n);this._chunk=r}search(e,r){return r?r(this,0,e):[0,e]}isValid(e){return this._chunk.isValid(e)}get(e){return this._chunk.get(e)}set(e,r){this._chunk.set(e,r)}indexOf(e,r){return this._chunk.indexOf(e,r)}}});var Xt=m(Pe=>{"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Pe.selectColumnChildrenArgs=Pe.selectVectorChildrenArgs=Pe.selectChunkArgs=Pe.selectFieldArgs=Pe.selectColumnArgs=Pe.selectArgs=void 0;var Pd=st(),Nd=_e(),er=sn(),Xn=ue(),Ld=K(),ym=Zt(),tr=Array.isArray;Pe.selectArgs=(t,e)=>gs(t,e,[],0);Pe.selectColumnArgs=t=>{let[e,r]=Po(t,[[],[]]);return r.map((n,s)=>n instanceof er.Column?er.Column.new(n.field.clone(e[s]),n):n instanceof Xn.Vector?er.Column.new(e[s],n):er.Column.new(e[s],[]))};Pe.selectFieldArgs=t=>Po(t,[[],[]]);Pe.selectChunkArgs=(t,e)=>Mo(t,e,[],0);Pe.selectVectorChildrenArgs=(t,e)=>xd(t,e,[],0);Pe.selectColumnChildrenArgs=(t,e)=>jd(t,e,[],0);function gs(t,e,r,n){let s,a=n,o=-1,c=e.length;for(;++o<c;)tr(s=e[o])?a=gs(t,s,r,a).length:s instanceof t&&(r[a++]=s);return r}function Mo(t,e,r,n){let s,a=n,o=-1,c=e.length;for(;++o<c;)tr(s=e[o])?a=Mo(t,s,r,a).length:s instanceof ym.Chunked?a=Mo(t,s.chunks,r,a).length:s instanceof t&&(r[a++]=s);return r}function xd(t,e,r,n){let s,a=n,o=-1,c=e.length;for(;++o<c;)tr(s=e[o])?a=xd(t,s,r,a).length:s instanceof t?a=gs(Xn.Vector,s.schema.fields.map((f,i)=>s.getChildAt(i)),r,a).length:s instanceof Xn.Vector&&(r[a++]=s);return r}function jd(t,e,r,n){let s,a=n,o=-1,c=e.length;for(;++o<c;)tr(s=e[o])?a=jd(t,s,r,a).length:s instanceof t?a=gs(er.Column,s.schema.fields.map((f,i)=>er.Column.new(f,s.getChildAt(i))),r,a).length:s instanceof er.Column&&(r[a++]=s);return r}var bm=(t,[e,r],n)=>(t[0][n]=e,t[1][n]=r,t);function Po(t,e){let r,n;switch(n=t.length){case 0:return e;case 1:if(r=e[0],!t[0])return e;if(tr(t[0]))return Po(t[0],e);t[0]instanceof Pd.Data||t[0]instanceof Xn.Vector||t[0]instanceof Ld.DataType||([r,t]=Object.entries(t[0]).reduce(bm,e));break;default:tr(r=t[n-1])?t=tr(t[0])?t[0]:t.slice(0,n-1):(t=tr(t[0])?t[0]:t,r=[])}let s=-1,a=-1,o=-1,c=t.length,f,i,[u,y]=e;for(;++o<c;)i=t[o],i instanceof er.Column&&(y[++a]=i)?u[++s]=i.field.clone(r[o],i.type,!0):({[o]:f=o}=r,i instanceof Ld.DataType&&(y[++a]=i)?u[++s]=Nd.Field.new(f,i,!0):i&&i.type&&(y[++a]=i)&&(i instanceof Pd.Data&&(y[a]=i=Xn.Vector.new(i)),u[++s]=Nd.Field.new(f,i.type,!0)));return e}});var _e=m(an=>{"use strict";Object.defineProperty(an,"__esModule",{value:!0});an.Field=an.Schema=void 0;var mm=K(),gm=Xt(),_m=Xt(),kd=Za(),xe=class{constructor(e=[],r,n){this.fields=e||[],this.metadata=r||new Map,n||(n=No(e)),this.dictionaries=n}static from(...e){return xe.new(e[0],e[1])}static new(...e){return new xe(_m.selectFieldArgs(e)[0])}get[Symbol.toStringTag](){return"Schema"}toString(){return`Schema<{ ${this.fields.map((e,r)=>`${r}: ${e}`).join(", ")} }>`}compareTo(e){return kd.instance.compareSchemas(this,e)}select(...e){let r=e.reduce((n,s)=>(n[s]=!0)&&n,Object.create(null));return new xe(this.fields.filter(n=>r[n.name]),this.metadata)}selectAt(...e){return new xe(e.map(r=>this.fields[r]).filter(Boolean),this.metadata)}assign(...e){let r=e[0]instanceof xe?e[0]:new xe(gm.selectArgs(gt,e)),n=[...this.fields],s=_s(_s(new Map,this.metadata),r.metadata),a=r.fields.filter(c=>{let f=n.findIndex(i=>i.name===c.name);return~f?(n[f]=c.clone({metadata:_s(_s(new Map,n[f].metadata),c.metadata)}))&&!1:!0}),o=No(a,new Map);return new xe([...n,...a],s,new Map([...this.dictionaries,...o]))}};an.Schema=xe;var gt=class{constructor(e,r,n=!1,s){this.name=e,this.type=r,this.nullable=n,this.metadata=s||new Map}static new(...e){let[r,n,s,a]=e;return e[0]&&typeof e[0]=="object"&&({name:r}=e[0],n===void 0&&(n=e[0].type),s===void 0&&(s=e[0].nullable),a===void 0&&(a=e[0].metadata)),new gt(`${r}`,n,s,a)}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}compareTo(e){return kd.instance.compareField(this,e)}clone(...e){let[r,n,s,a]=e;return!e[0]||typeof e[0]!="object"?[r=this.name,n=this.type,s=this.nullable,a=this.metadata]=e:{name:r=this.name,type:n=this.type,nullable:s=this.nullable,metadata:a=this.metadata}=e[0],gt.new(r,n,s,a)}};an.Field=gt;function _s(t,e){return new Map([...t||new Map,...e||new Map])}function No(t,e=new Map){for(let r=-1,n=t.length;++r<n;){let a=t[r].type;if(mm.DataType.isDictionary(a)){if(!e.has(a.id))e.set(a.id,a.dictionary);else if(e.get(a.id)!==a.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}a.children&&a.children.length>0&&No(a.children,e)}return e}xe.prototype.fields=null;xe.prototype.metadata=null;xe.prototype.dictionaries=null;gt.prototype.type=null;gt.prototype.name=null;gt.prototype.nullable=null;gt.prototype.metadata=null});var Lo=m(Ts=>{"use strict";Object.defineProperty(Ts,"__esModule",{value:!0});Ts.ListBuilder=void 0;var Tm=Ro(),Bm=_e(),Im=K(),wm=Ht(),vm=ae(),Cd=class extends vm.VariableWidthBuilder{constructor(e){super(e);this._run=new Tm.Run,this._offsets=new wm.OffsetsBufferBuilder}addChild(e,r="0"){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=e,this.type=new Im.List(new Bm.Field(r,e.type,!0)),this.numChildren-1}clear(){return this._run.clear(),super.clear()}_flushPending(e){let r=this._run,n=this._offsets,s=this._setValue,a=0,o;for([a,o]of e)o===void 0?n.set(a,0):(n.set(a,o.length),s(this,a,r.bind(o)))}};Ts.ListBuilder=Cd});var xo=m(Bs=>{"use strict";Object.defineProperty(Bs,"__esModule",{value:!0});Bs.FixedSizeListBuilder=void 0;var Sm=Ro(),Om=_e(),Am=ae(),Fm=K(),qd=class extends Am.Builder{constructor(){super(...arguments);this._run=new Sm.Run}setValue(e,r){super.setValue(e,this._run.bind(r))}addChild(e,r="0"){if(this.numChildren>0)throw new Error("FixedSizeListBuilder can only have one child.");let n=this.children.push(e);return this.type=new Fm.FixedSizeList(this.type.listSize,new Om.Field(r,e.type,!0)),n}clear(){return this._run.clear(),super.clear()}};Bs.FixedSizeListBuilder=qd});var jo=m(Is=>{"use strict";Object.defineProperty(Is,"__esModule",{value:!0});Is.MapBuilder=void 0;var Dm=_e(),Rm=K(),Em=ae(),Wd=class extends Em.VariableWidthBuilder{set(e,r){return super.set(e,r)}setValue(e,r){r=r instanceof Map?r:new Map(Object.entries(r));let n=this._pending||(this._pending=new Map),s=n.get(e);s&&(this._pendingLength-=s.size),this._pendingLength+=r.size,n.set(e,r)}addChild(e,r=`${this.numChildren}`){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=e,this.type=new Rm.Map_(new Dm.Field(r,e.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending(e){let r=this._offsets,n=this._setValue;e.forEach((s,a)=>{s===void 0?r.set(a,0):(r.set(a,s.size),n(this,a,s))})}};Is.MapBuilder=Wd});var ko=m(ws=>{"use strict";Object.defineProperty(ws,"__esModule",{value:!0});ws.StructBuilder=void 0;var Um=_e(),Vm=ae(),Mm=K(),zd=class extends Vm.Builder{addChild(e,r=`${this.numChildren}`){let n=this.children.push(e);return this.type=new Mm.Struct([...this.type.children,new Um.Field(r,e.type,!0)]),n}};ws.StructBuilder=zd});var Co=m(rr=>{"use strict";Object.defineProperty(rr,"__esModule",{value:!0});rr.DenseUnionBuilder=rr.SparseUnionBuilder=rr.UnionBuilder=void 0;var Pm=_e(),Yd=Ht(),Nm=ae(),Lm=K(),vs=class extends Nm.Builder{constructor(e){super(e);this._typeIds=new Yd.DataBufferBuilder(new Int8Array(0),1),typeof e.valueToChildTypeId=="function"&&(this._valueToChildTypeId=e.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(e,r){return this.set(this.length,e,r)}set(e,r,n){return n===void 0&&(n=this._valueToChildTypeId(this,r,e)),this.setValid(e,this.isValid(r))&&this.setValue(e,r,n),this}setValue(e,r,n){this._typeIds.set(e,n),super.setValue(e,r)}addChild(e,r=`${this.children.length}`){let n=this.children.push(e),{type:{children:s,mode:a,typeIds:o}}=this,c=[...s,new Pm.Field(r,e.type)];return this.type=new Lm.Union(a,[...o,n],c),n}_valueToChildTypeId(e,r,n){throw new Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}};rr.UnionBuilder=vs;var Gd=class extends vs{};rr.SparseUnionBuilder=Gd;var Hd=class extends vs{constructor(e){super(e);this._offsets=new Yd.DataBufferBuilder(new Int32Array(0))}setValue(e,r,n){let s=this.type.typeIdToChildIndex[n];return this._offsets.set(e,this.getChildAt(s).length),super.setValue(e,r,n)}};rr.DenseUnionBuilder=Hd});var zo=m(on=>{"use strict";Object.defineProperty(on,"__esModule",{value:!0});on.instance=on.SetVisitor=void 0;var xm=ue(),jm=ve(),km=Ir(),Cm=Yn(),qm=de(),He=ee(),P=class extends jm.Visitor{};on.SetVisitor=P;var Wm=(t,e,r)=>{t[e]=r/864e5|0},qo=(t,e,r)=>{t[e]=r%4294967296|0,t[e+1]=r/4294967296|0},zm=(t,e,r)=>{t[e]=r*1e3%4294967296|0,t[e+1]=r*1e3/4294967296|0},Ym=(t,e,r)=>{t[e]=r*1e6%4294967296|0,t[e+1]=r*1e6/4294967296|0},$d=(t,e,r,n)=>{let{[r]:s,[r+1]:a}=e;s!=null&&a!=null&&t.set(n.subarray(0,a-s),s)},Gm=({offset:t,values:e},r,n)=>{let s=t+r;n?e[s>>3]|=1<<s%8:e[s>>3]&=~(1<<s%8)},Jd=({values:t},e,r)=>{Wm(t,e,r.valueOf())},Kd=({values:t},e,r)=>{qo(t,e*2,r.valueOf())},_t=({stride:t,values:e},r,n)=>{e[t*r]=n},Qd=({stride:t,values:e},r,n)=>{e[t*r]=Cm.float64ToUint16(n)},Wo=(t,e,r)=>{switch(typeof r){case"bigint":t.values64[e]=r;break;case"number":t.values[e*t.stride]=r;break;default:let n=r,{stride:s,ArrayType:a}=t,o=qm.toArrayBufferView(a,n);t.values.set(o.subarray(0,s),s*e)}},Hm=({stride:t,values:e},r,n)=>{e.set(n.subarray(0,t),t*r)},$m=({values:t,valueOffsets:e},r,n)=>$d(t,e,r,n),Jm=({values:t,valueOffsets:e},r,n)=>{$d(t,e,r,km.encodeUtf8(n))},Km=(t,e,r)=>{t.type.bitWidth<64?_t(t,e,r):Wo(t,e,r)},Qm=(t,e,r)=>{t.type.precision!==He.Precision.HALF?_t(t,e,r):Qd(t,e,r)},Zm=(t,e,r)=>{t.type.unit===He.DateUnit.DAY?Jd(t,e,r):Kd(t,e,r)},Zd=({values:t},e,r)=>qo(t,e*2,r/1e3),Xd=({values:t},e,r)=>qo(t,e*2,r),ef=({values:t},e,r)=>zm(t,e*2,r),tf=({values:t},e,r)=>Ym(t,e*2,r),Xm=(t,e,r)=>{switch(t.type.unit){case He.TimeUnit.SECOND:return Zd(t,e,r);case He.TimeUnit.MILLISECOND:return Xd(t,e,r);case He.TimeUnit.MICROSECOND:return ef(t,e,r);case He.TimeUnit.NANOSECOND:return tf(t,e,r)}},rf=({values:t,stride:e},r,n)=>{t[e*r]=n},nf=({values:t,stride:e},r,n)=>{t[e*r]=n},sf=({values:t},e,r)=>{t.set(r.subarray(0,2),2*e)},af=({values:t},e,r)=>{t.set(r.subarray(0,2),2*e)},eg=(t,e,r)=>{switch(t.type.unit){case He.TimeUnit.SECOND:return rf(t,e,r);case He.TimeUnit.MILLISECOND:return nf(t,e,r);case He.TimeUnit.MICROSECOND:return sf(t,e,r);case He.TimeUnit.NANOSECOND:return af(t,e,r)}},tg=({values:t},e,r)=>{t.set(r.subarray(0,4),4*e)},rg=(t,e,r)=>{let n=t.getChildAt(0),s=t.valueOffsets;for(let a=-1,o=s[e],c=s[e+1];o<c;)n.set(o++,r.get(++a))},ng=(t,e,r)=>{let n=t.getChildAt(0),s=t.valueOffsets,a=r instanceof Map?[...r]:Object.entries(r);for(let o=-1,c=s[e],f=s[e+1];c<f;)n.set(c++,a[++o])},ig=(t,e)=>(r,n,s)=>r&&r.set(t,e[s]),sg=(t,e)=>(r,n,s)=>r&&r.set(t,e.get(s)),ag=(t,e)=>(r,n,s)=>r&&r.set(t,e.get(n.name)),og=(t,e)=>(r,n,s)=>r&&r.set(t,e[n.name]),cg=(t,e,r)=>{let n=r instanceof Map?ag(e,r):r instanceof xm.Vector?sg(e,r):Array.isArray(r)?ig(e,r):og(e,r);t.type.children.forEach((s,a)=>n(t.getChildAt(a),s,a))},ug=(t,e,r)=>{t.type.mode===He.UnionMode.Dense?of(t,e,r):cf(t,e,r)},of=(t,e,r)=>{let n=t.typeIdToChildIndex[t.typeIds[e]],s=t.getChildAt(n);s&&s.set(t.valueOffsets[e],r)},cf=(t,e,r)=>{let n=t.typeIdToChildIndex[t.typeIds[e]],s=t.getChildAt(n);s&&s.set(e,r)},lg=(t,e,r)=>{let n=t.getKey(e);n!==null&&t.setValue(n,r)},dg=(t,e,r)=>{t.type.unit===He.IntervalUnit.DAY_TIME?uf(t,e,r):lf(t,e,r)},uf=({values:t},e,r)=>{t.set(r.subarray(0,2),2*e)},lf=({values:t},e,r)=>{t[e]=r[0]*12+r[1]%12},fg=(t,e,r)=>{let n=t.getChildAt(0),{stride:s}=t;for(let a=-1,o=e*s;++a<s;)n.set(o+a,r.get(a))};P.prototype.visitBool=Gm;P.prototype.visitInt=Km;P.prototype.visitInt8=_t;P.prototype.visitInt16=_t;P.prototype.visitInt32=_t;P.prototype.visitInt64=Wo;P.prototype.visitUint8=_t;P.prototype.visitUint16=_t;P.prototype.visitUint32=_t;P.prototype.visitUint64=Wo;P.prototype.visitFloat=Qm;P.prototype.visitFloat16=Qd;P.prototype.visitFloat32=_t;P.prototype.visitFloat64=_t;P.prototype.visitUtf8=Jm;P.prototype.visitBinary=$m;P.prototype.visitFixedSizeBinary=Hm;P.prototype.visitDate=Zm;P.prototype.visitDateDay=Jd;P.prototype.visitDateMillisecond=Kd;P.prototype.visitTimestamp=Xm;P.prototype.visitTimestampSecond=Zd;P.prototype.visitTimestampMillisecond=Xd;P.prototype.visitTimestampMicrosecond=ef;P.prototype.visitTimestampNanosecond=tf;P.prototype.visitTime=eg;P.prototype.visitTimeSecond=rf;P.prototype.visitTimeMillisecond=nf;P.prototype.visitTimeMicrosecond=sf;P.prototype.visitTimeNanosecond=af;P.prototype.visitDecimal=tg;P.prototype.visitList=rg;P.prototype.visitStruct=cg;P.prototype.visitUnion=ug;P.prototype.visitDenseUnion=of;P.prototype.visitSparseUnion=cf;P.prototype.visitDictionary=lg;P.prototype.visitInterval=dg;P.prototype.visitIntervalDayTime=uf;P.prototype.visitIntervalYearMonth=lf;P.prototype.visitFixedSizeList=fg;P.prototype.visitMap=ng;on.instance=new P});var df=m(cn=>{"use strict";Object.defineProperty(cn,"__esModule",{value:!0});cn.instance=cn.GetBuilderCtor=void 0;var hg=ve(),pg=ds(),yg=bo(),Yo=go(),bg=_o(),mg=Bo(),gg=Io(),_g=xo(),Ss=wo(),Go=Fo(),Nt=So(),Tg=Lo(),Bg=jo(),Ig=mo(),wg=ko(),ei=Ao(),ti=Oo(),Ho=Co(),vg=hs(),$o=class extends hg.Visitor{visitNull(){return Ig.NullBuilder}visitBool(){return yg.BoolBuilder}visitInt(){return Nt.IntBuilder}visitInt8(){return Nt.Int8Builder}visitInt16(){return Nt.Int16Builder}visitInt32(){return Nt.Int32Builder}visitInt64(){return Nt.Int64Builder}visitUint8(){return Nt.Uint8Builder}visitUint16(){return Nt.Uint16Builder}visitUint32(){return Nt.Uint32Builder}visitUint64(){return Nt.Uint64Builder}visitFloat(){return Ss.FloatBuilder}visitFloat16(){return Ss.Float16Builder}visitFloat32(){return Ss.Float32Builder}visitFloat64(){return Ss.Float64Builder}visitUtf8(){return vg.Utf8Builder}visitBinary(){return pg.BinaryBuilder}visitFixedSizeBinary(){return gg.FixedSizeBinaryBuilder}visitDate(){return Yo.DateBuilder}visitDateDay(){return Yo.DateDayBuilder}visitDateMillisecond(){return Yo.DateMillisecondBuilder}visitTimestamp(){return ei.TimestampBuilder}visitTimestampSecond(){return ei.TimestampSecondBuilder}visitTimestampMillisecond(){return ei.TimestampMillisecondBuilder}visitTimestampMicrosecond(){return ei.TimestampMicrosecondBuilder}visitTimestampNanosecond(){return ei.TimestampNanosecondBuilder}visitTime(){return ti.TimeBuilder}visitTimeSecond(){return ti.TimeSecondBuilder}visitTimeMillisecond(){return ti.TimeMillisecondBuilder}visitTimeMicrosecond(){return ti.TimeMicrosecondBuilder}visitTimeNanosecond(){return ti.TimeNanosecondBuilder}visitDecimal(){return bg.DecimalBuilder}visitList(){return Tg.ListBuilder}visitStruct(){return wg.StructBuilder}visitUnion(){return Ho.UnionBuilder}visitDenseUnion(){return Ho.DenseUnionBuilder}visitSparseUnion(){return Ho.SparseUnionBuilder}visitDictionary(){return mg.DictionaryBuilder}visitInterval(){return Go.IntervalBuilder}visitIntervalDayTime(){return Go.IntervalDayTimeBuilder}visitIntervalYearMonth(){return Go.IntervalYearMonthBuilder}visitFixedSizeList(){return _g.FixedSizeListBuilder}visitMap(){return Bg.MapBuilder}};cn.GetBuilderCtor=$o;cn.instance=new $o});var As=m(B=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0});B.DenseUnionBuilder=B.SparseUnionBuilder=B.UnionBuilder=B.StructBuilder=B.MapBuilder=B.FixedSizeListBuilder=B.ListBuilder=B.BinaryBuilder=B.Utf8Builder=B.IntervalYearMonthBuilder=B.IntervalDayTimeBuilder=B.IntervalBuilder=B.TimestampNanosecondBuilder=B.TimestampMicrosecondBuilder=B.TimestampMillisecondBuilder=B.TimestampSecondBuilder=B.TimestampBuilder=B.TimeNanosecondBuilder=B.TimeMicrosecondBuilder=B.TimeMillisecondBuilder=B.TimeSecondBuilder=B.TimeBuilder=B.Uint64Builder=B.Uint32Builder=B.Uint16Builder=B.Uint8Builder=B.Int64Builder=B.Int32Builder=B.Int16Builder=B.Int8Builder=B.IntBuilder=B.Float64Builder=B.Float32Builder=B.Float16Builder=B.FloatBuilder=B.FixedSizeBinaryBuilder=B.DictionaryBuilder=B.DecimalBuilder=B.DateMillisecondBuilder=B.DateDayBuilder=B.DateBuilder=B.NullBuilder=B.BoolBuilder=B.Builder=void 0;var Sg=ae();Object.defineProperty(B,"Builder",{enumerable:!0,get:function(){return Sg.Builder}});var Og=bo();Object.defineProperty(B,"BoolBuilder",{enumerable:!0,get:function(){return Og.BoolBuilder}});var Ag=mo();Object.defineProperty(B,"NullBuilder",{enumerable:!0,get:function(){return Ag.NullBuilder}});var Jo=go();Object.defineProperty(B,"DateBuilder",{enumerable:!0,get:function(){return Jo.DateBuilder}});Object.defineProperty(B,"DateDayBuilder",{enumerable:!0,get:function(){return Jo.DateDayBuilder}});Object.defineProperty(B,"DateMillisecondBuilder",{enumerable:!0,get:function(){return Jo.DateMillisecondBuilder}});var Fg=_o();Object.defineProperty(B,"DecimalBuilder",{enumerable:!0,get:function(){return Fg.DecimalBuilder}});var Dg=Bo();Object.defineProperty(B,"DictionaryBuilder",{enumerable:!0,get:function(){return Dg.DictionaryBuilder}});var Rg=Io();Object.defineProperty(B,"FixedSizeBinaryBuilder",{enumerable:!0,get:function(){return Rg.FixedSizeBinaryBuilder}});var Os=wo();Object.defineProperty(B,"FloatBuilder",{enumerable:!0,get:function(){return Os.FloatBuilder}});Object.defineProperty(B,"Float16Builder",{enumerable:!0,get:function(){return Os.Float16Builder}});Object.defineProperty(B,"Float32Builder",{enumerable:!0,get:function(){return Os.Float32Builder}});Object.defineProperty(B,"Float64Builder",{enumerable:!0,get:function(){return Os.Float64Builder}});var Lt=So();Object.defineProperty(B,"IntBuilder",{enumerable:!0,get:function(){return Lt.IntBuilder}});Object.defineProperty(B,"Int8Builder",{enumerable:!0,get:function(){return Lt.Int8Builder}});Object.defineProperty(B,"Int16Builder",{enumerable:!0,get:function(){return Lt.Int16Builder}});Object.defineProperty(B,"Int32Builder",{enumerable:!0,get:function(){return Lt.Int32Builder}});Object.defineProperty(B,"Int64Builder",{enumerable:!0,get:function(){return Lt.Int64Builder}});Object.defineProperty(B,"Uint8Builder",{enumerable:!0,get:function(){return Lt.Uint8Builder}});Object.defineProperty(B,"Uint16Builder",{enumerable:!0,get:function(){return Lt.Uint16Builder}});Object.defineProperty(B,"Uint32Builder",{enumerable:!0,get:function(){return Lt.Uint32Builder}});Object.defineProperty(B,"Uint64Builder",{enumerable:!0,get:function(){return Lt.Uint64Builder}});var ri=Oo();Object.defineProperty(B,"TimeBuilder",{enumerable:!0,get:function(){return ri.TimeBuilder}});Object.defineProperty(B,"TimeSecondBuilder",{enumerable:!0,get:function(){return ri.TimeSecondBuilder}});Object.defineProperty(B,"TimeMillisecondBuilder",{enumerable:!0,get:function(){return ri.TimeMillisecondBuilder}});Object.defineProperty(B,"TimeMicrosecondBuilder",{enumerable:!0,get:function(){return ri.TimeMicrosecondBuilder}});Object.defineProperty(B,"TimeNanosecondBuilder",{enumerable:!0,get:function(){return ri.TimeNanosecondBuilder}});var ni=Ao();Object.defineProperty(B,"TimestampBuilder",{enumerable:!0,get:function(){return ni.TimestampBuilder}});Object.defineProperty(B,"TimestampSecondBuilder",{enumerable:!0,get:function(){return ni.TimestampSecondBuilder}});Object.defineProperty(B,"TimestampMillisecondBuilder",{enumerable:!0,get:function(){return ni.TimestampMillisecondBuilder}});Object.defineProperty(B,"TimestampMicrosecondBuilder",{enumerable:!0,get:function(){return ni.TimestampMicrosecondBuilder}});Object.defineProperty(B,"TimestampNanosecondBuilder",{enumerable:!0,get:function(){return ni.TimestampNanosecondBuilder}});var Ko=Fo();Object.defineProperty(B,"IntervalBuilder",{enumerable:!0,get:function(){return Ko.IntervalBuilder}});Object.defineProperty(B,"IntervalDayTimeBuilder",{enumerable:!0,get:function(){return Ko.IntervalDayTimeBuilder}});Object.defineProperty(B,"IntervalYearMonthBuilder",{enumerable:!0,get:function(){return Ko.IntervalYearMonthBuilder}});var Eg=hs();Object.defineProperty(B,"Utf8Builder",{enumerable:!0,get:function(){return Eg.Utf8Builder}});var Ug=ds();Object.defineProperty(B,"BinaryBuilder",{enumerable:!0,get:function(){return Ug.BinaryBuilder}});var Vg=Lo();Object.defineProperty(B,"ListBuilder",{enumerable:!0,get:function(){return Vg.ListBuilder}});var Mg=xo();Object.defineProperty(B,"FixedSizeListBuilder",{enumerable:!0,get:function(){return Mg.FixedSizeListBuilder}});var Pg=jo();Object.defineProperty(B,"MapBuilder",{enumerable:!0,get:function(){return Pg.MapBuilder}});var Ng=ko();Object.defineProperty(B,"StructBuilder",{enumerable:!0,get:function(){return Ng.StructBuilder}});var Qo=Co();Object.defineProperty(B,"UnionBuilder",{enumerable:!0,get:function(){return Qo.UnionBuilder}});Object.defineProperty(B,"SparseUnionBuilder",{enumerable:!0,get:function(){return Qo.SparseUnionBuilder}});Object.defineProperty(B,"DenseUnionBuilder",{enumerable:!0,get:function(){return Qo.DenseUnionBuilder}});var Zo=ee(),Lg=hs(),xg=ae(),ff=zo(),hf=df();xg.Builder.new=pf;function pf(t){let e=t.type,r=new(hf.instance.getVisitFn(e)())(t);if(e.children&&e.children.length>0){let n=t.children||[],s={nullValues:t.nullValues},a=Array.isArray(n)?(o,c)=>n[c]||s:({name:o})=>n[o]||s;e.children.forEach((o,c)=>{let{type:f}=o,i=a(o,c);r.children.push(pf({...i,type:f}))})}return r}Object.keys(Zo.Type).map(t=>Zo.Type[t]).filter(t=>typeof t=="number"&&t!==Zo.Type.NONE).forEach(t=>{let e=hf.instance.visit(t);e.prototype._setValue=ff.instance.getVisitFn(t)});Lg.Utf8Builder.prototype._setValue=ff.instance.visitBinary});var bf=m(Fr=>{"use strict";Object.defineProperty(Fr,"__esModule",{value:!0});Fr.org=void 0;var Xo=zr(),yf;(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}static getRootAsFooter(i,u){return(u||new c).__init(i.readInt32(i.position())+i.position(),i)}version(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt16(this.bb_pos+i):Xo.org.apache.arrow.flatbuf.MetadataVersion.V1}schema(i){let u=this.bb.__offset(this.bb_pos,6);return u?(i||new Xo.org.apache.arrow.flatbuf.Schema).__init(this.bb.__indirect(this.bb_pos+u),this.bb):null}dictionaries(i,u){let y=this.bb.__offset(this.bb_pos,8);return y?(u||new t.apache.arrow.flatbuf.Block).__init(this.bb.__vector(this.bb_pos+y)+i*24,this.bb):null}dictionariesLength(){let i=this.bb.__offset(this.bb_pos,8);return i?this.bb.__vector_len(this.bb_pos+i):0}recordBatches(i,u){let y=this.bb.__offset(this.bb_pos,10);return y?(u||new t.apache.arrow.flatbuf.Block).__init(this.bb.__vector(this.bb_pos+y)+i*24,this.bb):null}recordBatchesLength(){let i=this.bb.__offset(this.bb_pos,10);return i?this.bb.__vector_len(this.bb_pos+i):0}static startFooter(i){i.startObject(4)}static addVersion(i,u){i.addFieldInt16(0,u,Xo.org.apache.arrow.flatbuf.MetadataVersion.V1)}static addSchema(i,u){i.addFieldOffset(1,u,0)}static addDictionaries(i,u){i.addFieldOffset(2,u,0)}static startDictionariesVector(i,u){i.startVector(24,u,8)}static addRecordBatches(i,u){i.addFieldOffset(3,u,0)}static startRecordBatchesVector(i,u){i.startVector(24,u,8)}static endFooter(i){return i.endObject()}static finishFooterBuffer(i,u){i.finish(u)}static createFooter(i,u,y,N,Z){return c.startFooter(i),c.addVersion(i,u),c.addSchema(i,y),c.addDictionaries(i,N),c.addRecordBatches(i,Z),c.endFooter(i)}}o.Footer=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(yf=Fr.org||(Fr.org={}));(function(t){var e;(function(r){var n;(function(s){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(i,u){return this.bb_pos=i,this.bb=u,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static createBlock(i,u,y,N){return i.prep(8,24),i.writeInt64(N),i.pad(4),i.writeInt32(y),i.writeInt64(u),i.offset()}}o.Block=c})(a=s.flatbuf||(s.flatbuf={}))})(n=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(yf=Fr.org||(Fr.org={}))});var rc=m(un=>{"use strict";Object.defineProperty(un,"__esModule",{value:!0});un.FileBlock=un.Footer=void 0;var mf=bf(),ec=jr(),gf=ec.flatbuffers.Long,jg=ec.flatbuffers.Builder,kg=ec.flatbuffers.ByteBuffer,Cg=mf.org.apache.arrow.flatbuf.Block,Tt=mf.org.apache.arrow.flatbuf.Footer,_f=_e(),Tf=ee(),qg=de(),tc=class{constructor(e,r=Tf.MetadataVersion.V4,n,s){this.schema=e,this.version=r,n&&(this._recordBatches=n),s&&(this._dictionaryBatches=s)}static decode(e){e=new kg(qg.toUint8Array(e));let r=Tt.getRootAsFooter(e),n=_f.Schema.decode(r.schema());return new Bf(n,r)}static encode(e){let r=new jg,n=_f.Schema.encode(r,e.schema);Tt.startRecordBatchesVector(r,e.numRecordBatches),[...e.recordBatches()].slice().reverse().forEach(o=>nr.encode(r,o));let s=r.endVector();Tt.startDictionariesVector(r,e.numDictionaries),[...e.dictionaryBatches()].slice().reverse().forEach(o=>nr.encode(r,o));let a=r.endVector();return Tt.startFooter(r),Tt.addSchema(r,n),Tt.addVersion(r,Tf.MetadataVersion.V4),Tt.addRecordBatches(r,s),Tt.addDictionaries(r,a),Tt.finishFooterBuffer(r,Tt.endFooter(r)),r.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}*recordBatches(){for(let e,r=-1,n=this.numRecordBatches;++r<n;)(e=this.getRecordBatch(r))&&(yield e)}*dictionaryBatches(){for(let e,r=-1,n=this.numDictionaries;++r<n;)(e=this.getDictionaryBatch(r))&&(yield e)}getRecordBatch(e){return e>=0&&e<this.numRecordBatches&&this._recordBatches[e]||null}getDictionaryBatch(e){return e>=0&&e<this.numDictionaries&&this._dictionaryBatches[e]||null}};un.Footer=tc;var Bf=class extends tc{constructor(e,r){super(e,r.version());this._footer=r}get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}getRecordBatch(e){if(e>=0&&e<this.numRecordBatches){let r=this._footer.recordBatches(e);if(r)return nr.decode(r)}return null}getDictionaryBatch(e){if(e>=0&&e<this.numDictionaries){let r=this._footer.dictionaries(e);if(r)return nr.decode(r)}return null}},nr=class{constructor(e,r,n){this.metaDataLength=e,this.offset=typeof n=="number"?n:n.low,this.bodyLength=typeof r=="number"?r:r.low}static decode(e){return new nr(e.metaDataLength(),e.bodyLength(),e.offset())}static encode(e,r){let{metaDataLength:n}=r,s=new gf(r.offset,0),a=new gf(r.bodyLength,0);return Cg.createBlock(e,s,n,a)}};un.FileBlock=nr});var or=m(ar=>{"use strict";Object.defineProperty(ar,"__esModule",{value:!0});ar.AsyncByteStream=ar.ByteStream=ar.AsyncByteQueue=void 0;var ir=jn(),If=Ir(),ii=qr(),nc=de(),ln=Ae(),ic=class extends ii.AsyncQueue{write(e){if((e=nc.toUint8Array(e)).byteLength>0)return super.write(e)}toString(e=!1){return e?If.decodeUtf8(this.toUint8Array(!0)):this.toUint8Array(!1).then(If.decodeUtf8)}toUint8Array(e=!1){return e?nc.joinUint8Arrays(this._values)[0]:(async()=>{let r=[],n=0;for await(let s of this)r.push(s),n+=s.byteLength;return nc.joinUint8Arrays(r,n)[0]})()}};ar.AsyncByteQueue=ic;var wf=class{constructor(e){e&&(this.source=new vf(ir.default.fromIterable(e)))}[Symbol.iterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}};ar.ByteStream=wf;var Fs=class{constructor(e){e instanceof Fs?this.source=e.source:e instanceof ic?this.source=new sr(ir.default.fromAsyncIterable(e)):ln.isReadableNodeStream(e)?this.source=new sr(ir.default.fromNodeStream(e)):ln.isReadableDOMStream(e)?this.source=new sr(ir.default.fromDOMStream(e)):ln.isFetchResponse(e)?this.source=new sr(ir.default.fromDOMStream(e.body)):ln.isIterable(e)?this.source=new sr(ir.default.fromIterable(e)):ln.isPromise(e)?this.source=new sr(ir.default.fromAsyncIterable(e)):ln.isAsyncIterable(e)&&(this.source=new sr(ir.default.fromAsyncIterable(e)))}[Symbol.asyncIterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}get closed(){return this.source.closed}cancel(e){return this.source.cancel(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}};ar.AsyncByteStream=Fs;var vf=class{constructor(e){this.source=e}cancel(e){this.return(e)}peek(e){return this.next(e,"peek").value}read(e){return this.next(e,"read").value}next(e,r="read"){return this.source.next({cmd:r,size:e})}throw(e){return Object.create(this.source.throw&&this.source.throw(e)||ii.ITERATOR_DONE)}return(e){return Object.create(this.source.return&&this.source.return(e)||ii.ITERATOR_DONE)}},sr=class{constructor(e){this.source=e,this._closedPromise=new Promise(r=>this._closedPromiseResolve=r)}async cancel(e){await this.return(e)}get closed(){return this._closedPromise}async read(e){return(await this.next(e,"read")).value}async peek(e){return(await this.next(e,"peek")).value}async next(e,r="read"){return await this.source.next({cmd:r,size:e})}async throw(e){let r=this.source.throw&&await this.source.throw(e)||ii.ITERATOR_DONE;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(r)}async return(e){let r=this.source.return&&await this.source.return(e)||ii.ITERATOR_DONE;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(r)}}});var sc=m(dn=>{"use strict";Object.defineProperty(dn,"__esModule",{value:!0});dn.AsyncRandomAccessFile=dn.RandomAccessFile=void 0;var Sf=or(),Wg=de(),Of=class extends Sf.ByteStream{constructor(e,r){super();this.position=0,this.buffer=Wg.toUint8Array(e),this.size=typeof r=="undefined"?this.buffer.byteLength:r}readInt32(e){let{buffer:r,byteOffset:n}=this.readAt(e,4);return new DataView(r,n).getInt32(0,!0)}seek(e){return this.position=Math.min(e,this.size),e<this.size}read(e){let{buffer:r,size:n,position:s}=this;return r&&s<n?(typeof e!="number"&&(e=1/0),this.position=Math.min(n,s+Math.min(n-s,e)),r.subarray(s,this.position)):null}readAt(e,r){let n=this.buffer,s=Math.min(this.size,e+r);return n?n.subarray(e,s):new Uint8Array(r)}close(){this.buffer&&(this.buffer=null)}throw(e){return this.close(),{done:!0,value:e}}return(e){return this.close(),{done:!0,value:e}}};dn.RandomAccessFile=Of;var Af=class extends Sf.AsyncByteStream{constructor(e,r){super();this.position=0,this._handle=e,typeof r=="number"?this.size=r:this._pending=(async()=>{this.size=(await e.stat()).size,delete this._pending})()}async readInt32(e){let{buffer:r,byteOffset:n}=await this.readAt(e,4);return new DataView(r,n).getInt32(0,!0)}async seek(e){return this._pending&&await this._pending,this.position=Math.min(e,this.size),e<this.size}async read(e){this._pending&&await this._pending;let{_handle:r,size:n,position:s}=this;if(r&&s<n){typeof e!="number"&&(e=1/0);let a=s,o=0,c=0,f=Math.min(n,a+Math.min(n-a,e)),i=new Uint8Array(Math.max(0,(this.position=f)-a));for(;(a+=c)<f&&(o+=c)<i.byteLength;)({bytesRead:c}=await r.read(i,o,i.byteLength-o,a));return i}return null}async readAt(e,r){this._pending&&await this._pending;let{_handle:n,size:s}=this;if(n&&e+r<s){let a=Math.min(s,e+r),o=new Uint8Array(a-e);return(await n.read(o,0,r,e)).buffer}return new Uint8Array(r)}async close(){let e=this._handle;this._handle=null,e&&await e.close()}async throw(e){return await this.close(),{done:!0,value:e}}async return(e){return await this.close(),{done:!0,value:e}}};dn.AsyncRandomAccessFile=Af});var oc=m(Bt=>{"use strict";Object.defineProperty(Bt,"__esModule",{value:!0});Bt.Int128=Bt.Int64=Bt.Uint64=Bt.BaseInt64=void 0;var zg=1<<16;function fn(t){return t<0&&(t=4294967295+t+1),`0x${t.toString(16)}`}var hn=8,ac=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8],Ds=class{constructor(e){this.buffer=e}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(e){let r=new Uint32Array([this.buffer[1]>>>16,this.buffer[1]&65535,this.buffer[0]>>>16,this.buffer[0]&65535]),n=new Uint32Array([e.buffer[1]>>>16,e.buffer[1]&65535,e.buffer[0]>>>16,e.buffer[0]&65535]),s=r[3]*n[3];this.buffer[0]=s&65535;let a=s>>>16;return s=r[2]*n[3],a+=s,s=r[3]*n[2]>>>0,a+=s,this.buffer[0]+=a<<16,this.buffer[1]=a>>>0<s?zg:0,this.buffer[1]+=a>>>16,this.buffer[1]+=r[1]*n[3]+r[2]*n[2]+r[3]*n[1],this.buffer[1]+=r[0]*n[3]+r[1]*n[2]+r[2]*n[1]+r[3]*n[0]<<16,this}_plus(e){let r=this.buffer[0]+e.buffer[0]>>>0;this.buffer[1]+=e.buffer[1],r<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=r}lessThan(e){return this.buffer[1]<e.buffer[1]||this.buffer[1]===e.buffer[1]&&this.buffer[0]<e.buffer[0]}equals(e){return this.buffer[1]===e.buffer[1]&&this.buffer[0]==e.buffer[0]}greaterThan(e){return e.lessThan(this)}hex(){return`${fn(this.buffer[1])} ${fn(this.buffer[0])}`}};Bt.BaseInt64=Ds;var Q=class extends Ds{times(e){return this._times(e),this}plus(e){return this._plus(e),this}static from(e,r=new Uint32Array(2)){return Q.fromString(typeof e=="string"?e:e.toString(),r)}static fromNumber(e,r=new Uint32Array(2)){return Q.fromString(e.toString(),r)}static fromString(e,r=new Uint32Array(2)){let n=e.length,s=new Q(r);for(let a=0;a<n;){let o=hn<n-a?hn:n-a,c=new Q(new Uint32Array([parseInt(e.substr(a,o),10),0])),f=new Q(new Uint32Array([ac[o],0]));s.times(f),s.plus(c),a+=o}return s}static convertArray(e){let r=new Uint32Array(e.length*2);for(let n=-1,s=e.length;++n<s;)Q.from(e[n],new Uint32Array(r.buffer,r.byteOffset+2*n*4,2));return r}static multiply(e,r){return new Q(new Uint32Array(e.buffer)).times(r)}static add(e,r){return new Q(new Uint32Array(e.buffer)).plus(r)}};Bt.Uint64=Q;var je=class extends Ds{negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[0]==0&&++this.buffer[1],this}times(e){return this._times(e),this}plus(e){return this._plus(e),this}lessThan(e){let r=this.buffer[1]<<0,n=e.buffer[1]<<0;return r<n||r===n&&this.buffer[0]<e.buffer[0]}static from(e,r=new Uint32Array(2)){return je.fromString(typeof e=="string"?e:e.toString(),r)}static fromNumber(e,r=new Uint32Array(2)){return je.fromString(e.toString(),r)}static fromString(e,r=new Uint32Array(2)){let n=e.startsWith("-"),s=e.length,a=new je(r);for(let o=n?1:0;o<s;){let c=hn<s-o?hn:s-o,f=new je(new Uint32Array([parseInt(e.substr(o,c),10),0])),i=new je(new Uint32Array([ac[c],0]));a.times(i),a.plus(f),o+=c}return n?a.negate():a}static convertArray(e){let r=new Uint32Array(e.length*2);for(let n=-1,s=e.length;++n<s;)je.from(e[n],new Uint32Array(r.buffer,r.byteOffset+2*n*4,2));return r}static multiply(e,r){return new je(new Uint32Array(e.buffer)).times(r)}static add(e,r){return new je(new Uint32Array(e.buffer)).plus(r)}};Bt.Int64=je;var ot=class{constructor(e){this.buffer=e}high(){return new je(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new je(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],this.buffer[0]==0&&++this.buffer[1],this.buffer[1]==0&&++this.buffer[2],this.buffer[2]==0&&++this.buffer[3],this}times(e){let r=new Q(new Uint32Array([this.buffer[3],0])),n=new Q(new Uint32Array([this.buffer[2],0])),s=new Q(new Uint32Array([this.buffer[1],0])),a=new Q(new Uint32Array([this.buffer[0],0])),o=new Q(new Uint32Array([e.buffer[3],0])),c=new Q(new Uint32Array([e.buffer[2],0])),f=new Q(new Uint32Array([e.buffer[1],0])),i=new Q(new Uint32Array([e.buffer[0],0])),u=Q.multiply(a,i);this.buffer[0]=u.low();let y=new Q(new Uint32Array([u.high(),0]));return u=Q.multiply(s,i),y.plus(u),u=Q.multiply(a,f),y.plus(u),this.buffer[1]=y.low(),this.buffer[3]=y.lessThan(u)?1:0,this.buffer[2]=y.high(),new Q(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(Q.multiply(n,i)).plus(Q.multiply(s,f)).plus(Q.multiply(a,c)),this.buffer[3]+=Q.multiply(r,i).plus(Q.multiply(n,f)).plus(Q.multiply(s,c)).plus(Q.multiply(a,o)).low(),this}plus(e){let r=new Uint32Array(4);return r[3]=this.buffer[3]+e.buffer[3]>>>0,r[2]=this.buffer[2]+e.buffer[2]>>>0,r[1]=this.buffer[1]+e.buffer[1]>>>0,r[0]=this.buffer[0]+e.buffer[0]>>>0,r[0]<this.buffer[0]>>>0&&++r[1],r[1]<this.buffer[1]>>>0&&++r[2],r[2]<this.buffer[2]>>>0&&++r[3],this.buffer[3]=r[3],this.buffer[2]=r[2],this.buffer[1]=r[1],this.buffer[0]=r[0],this}hex(){return`${fn(this.buffer[3])} ${fn(this.buffer[2])} ${fn(this.buffer[1])} ${fn(this.buffer[0])}`}static multiply(e,r){return new ot(new Uint32Array(e.buffer)).times(r)}static add(e,r){return new ot(new Uint32Array(e.buffer)).plus(r)}static from(e,r=new Uint32Array(4)){return ot.fromString(typeof e=="string"?e:e.toString(),r)}static fromNumber(e,r=new Uint32Array(4)){return ot.fromString(e.toString(),r)}static fromString(e,r=new Uint32Array(4)){let n=e.startsWith("-"),s=e.length,a=new ot(r);for(let o=n?1:0;o<s;){let c=hn<s-o?hn:s-o,f=new ot(new Uint32Array([parseInt(e.substr(o,c),10),0,0,0])),i=new ot(new Uint32Array([ac[c],0,0,0]));a.times(i),a.plus(f),o+=c}return n?a.negate():a}static convertArray(e){let r=new Uint32Array(e.length*4);for(let n=-1,s=e.length;++n<s;)ot.from(e[n],new Uint32Array(r.buffer,r.byteOffset+4*4*n,4));return r}};Bt.Int128=ot});var Ef=m(pn=>{"use strict";Object.defineProperty(pn,"__esModule",{value:!0});pn.JSONVectorLoader=pn.VectorLoader=void 0;var me=st(),Yg=_e(),xt=K(),Gg=ve(),Ff=pt(),Hg=Ir(),Rs=oc(),Df=ee(),It=de(),cc=class extends Gg.Visitor{constructor(e,r,n,s){super();this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=e,this.nodes=r,this.buffers=n,this.dictionaries=s}visit(e){return super.visit(e instanceof Yg.Field?e.type:e)}visitNull(e,{length:r}=this.nextFieldNode()){return me.Data.Null(e,0,r)}visitBool(e,{length:r,nullCount:n}=this.nextFieldNode()){return me.Data.Bool(e,0,r,n,this.readNullBitmap(e,n),this.readData(e))}visitInt(e,{length:r,nullCount:n}=this.nextFieldNode()){return me.Data.Int(e,0,r,n,this.readNullBitmap(e,n),this.readData(e))}visitFloat(e,{length:r,nullCount:n}=this.nextFieldNode()){return me.Data.Float(e,0,r,n,this.readNullBitmap(e,n),this.readData(e))}visitUtf8(e,{length:r,nullCount:n}=this.nextFieldNode()){return me.Data.Utf8(e,0,r,n,this.readNullBitmap(e,n),this.readOffsets(e),this.readData(e))}visitBinary(e,{length:r,nullCount:n}=this.nextFieldNode()){return me.Data.Binary(e,0,r,n,this.readNullBitmap(e,n),this.readOffsets(e),this.readData(e))}visitFixedSizeBinary(e,{length:r,nullCount:n}=this.nextFieldNode()){return me.Data.FixedSizeBinary(e,0,r,n,this.readNullBitmap(e,n),this.readData(e))}visitDate(e,{length:r,nullCount:n}=this.nextFieldNode()){return me.Data.Date(e,0,r,n,this.readNullBitmap(e,n),this.readData(e))}visitTimestamp(e,{length:r,nullCount:n}=this.nextFieldNode()){return me.Data.Timestamp(e,0,r,n,this.readNullBitmap(e,n),this.readData(e))}visitTime(e,{length:r,nullCount:n}=this.nextFieldNode()){return me.Data.Time(e,0,r,n,this.readNullBitmap(e,n),this.readData(e))}visitDecimal(e,{length:r,nullCount:n}=this.nextFieldNode()){return me.Data.Decimal(e,0,r,n,this.readNullBitmap(e,n),this.readData(e))}visitList(e,{length:r,nullCount:n}=this.nextFieldNode()){return me.Data.List(e,0,r,n,this.readNullBitmap(e,n),this.readOffsets(e),this.visit(e.children[0]))}visitStruct(e,{length:r,nullCount:n}=this.nextFieldNode()){return me.Data.Struct(e,0,r,n,this.readNullBitmap(e,n),this.visitMany(e.children))}visitUnion(e){return e.mode===Df.UnionMode.Sparse?this.visitSparseUnion(e):this.visitDenseUnion(e)}visitDenseUnion(e,{length:r,nullCount:n}=this.nextFieldNode()){return me.Data.Union(e,0,r,n,this.readNullBitmap(e,n),this.readTypeIds(e),this.readOffsets(e),this.visitMany(e.children))}visitSparseUnion(e,{length:r,nullCount:n}=this.nextFieldNode()){return me.Data.Union(e,0,r,n,this.readNullBitmap(e,n),this.readTypeIds(e),this.visitMany(e.children))}visitDictionary(e,{length:r,nullCount:n}=this.nextFieldNode()){return me.Data.Dictionary(e,0,r,n,this.readNullBitmap(e,n),this.readData(e.indices),this.readDictionary(e))}visitInterval(e,{length:r,nullCount:n}=this.nextFieldNode()){return me.Data.Interval(e,0,r,n,this.readNullBitmap(e,n),this.readData(e))}visitFixedSizeList(e,{length:r,nullCount:n}=this.nextFieldNode()){return me.Data.FixedSizeList(e,0,r,n,this.readNullBitmap(e,n),this.visit(e.children[0]))}visitMap(e,{length:r,nullCount:n}=this.nextFieldNode()){return me.Data.Map(e,0,r,n,this.readNullBitmap(e,n),this.readOffsets(e),this.visit(e.children[0]))}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(e,r,n=this.nextBufferRange()){return r>0&&this.readData(e,n)||new Uint8Array(0)}readOffsets(e,r){return this.readData(e,r)}readTypeIds(e,r){return this.readData(e,r)}readData(e,{length:r,offset:n}=this.nextBufferRange()){return this.bytes.subarray(n,n+r)}readDictionary(e){return this.dictionaries.get(e.id)}};pn.VectorLoader=cc;var Rf=class extends cc{constructor(e,r,n,s){super(new Uint8Array(0),r,n,s);this.sources=e}readNullBitmap(e,r,{offset:n}=this.nextBufferRange()){return r<=0?new Uint8Array(0):Ff.packBools(this.sources[n])}readOffsets(e,{offset:r}=this.nextBufferRange()){return It.toArrayBufferView(Uint8Array,It.toArrayBufferView(Int32Array,this.sources[r]))}readTypeIds(e,{offset:r}=this.nextBufferRange()){return It.toArrayBufferView(Uint8Array,It.toArrayBufferView(e.ArrayType,this.sources[r]))}readData(e,{offset:r}=this.nextBufferRange()){let{sources:n}=this;return xt.DataType.isTimestamp(e)||(xt.DataType.isInt(e)||xt.DataType.isTime(e))&&e.bitWidth===64||xt.DataType.isDate(e)&&e.unit===Df.DateUnit.MILLISECOND?It.toArrayBufferView(Uint8Array,Rs.Int64.convertArray(n[r])):xt.DataType.isDecimal(e)?It.toArrayBufferView(Uint8Array,Rs.Int128.convertArray(n[r])):xt.DataType.isBinary(e)||xt.DataType.isFixedSizeBinary(e)?$g(n[r]):xt.DataType.isBool(e)?Ff.packBools(n[r]):xt.DataType.isUtf8(e)?Hg.encodeUtf8(n[r].join("")):It.toArrayBufferView(Uint8Array,It.toArrayBufferView(e.ArrayType,n[r].map(s=>+s)))}};pn.JSONVectorLoader=Rf;function $g(t){let e=t.join(""),r=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2)r[n>>1]=parseInt(e.substr(n,2),16);return r}});var xf=m(bn=>{"use strict";Object.defineProperty(bn,"__esModule",{value:!0});bn.instance=bn.TypeAssembler=void 0;var Jg=jr(),Kg=Jg.flatbuffers.Long,Te=zr(),Qg=ve(),Uf=Te.org.apache.arrow.flatbuf.Null,Es=Te.org.apache.arrow.flatbuf.Int,uc=Te.org.apache.arrow.flatbuf.FloatingPoint,Vf=Te.org.apache.arrow.flatbuf.Binary,Mf=Te.org.apache.arrow.flatbuf.Bool,Pf=Te.org.apache.arrow.flatbuf.Utf8,Us=Te.org.apache.arrow.flatbuf.Decimal,lc=Te.org.apache.arrow.flatbuf.Date,Vs=Te.org.apache.arrow.flatbuf.Time,Ms=Te.org.apache.arrow.flatbuf.Timestamp,dc=Te.org.apache.arrow.flatbuf.Interval,Nf=Te.org.apache.arrow.flatbuf.List,Lf=Te.org.apache.arrow.flatbuf.Struct_,yn=Te.org.apache.arrow.flatbuf.Union,si=Te.org.apache.arrow.flatbuf.DictionaryEncoding,fc=Te.org.apache.arrow.flatbuf.FixedSizeBinary,hc=Te.org.apache.arrow.flatbuf.FixedSizeList,pc=Te.org.apache.arrow.flatbuf.Map,yc=class extends Qg.Visitor{visit(e,r){return e==null||r==null?void 0:super.visit(e,r)}visitNull(e,r){return Uf.startNull(r),Uf.endNull(r)}visitInt(e,r){return Es.startInt(r),Es.addBitWidth(r,e.bitWidth),Es.addIsSigned(r,e.isSigned),Es.endInt(r)}visitFloat(e,r){return uc.startFloatingPoint(r),uc.addPrecision(r,e.precision),uc.endFloatingPoint(r)}visitBinary(e,r){return Vf.startBinary(r),Vf.endBinary(r)}visitBool(e,r){return Mf.startBool(r),Mf.endBool(r)}visitUtf8(e,r){return Pf.startUtf8(r),Pf.endUtf8(r)}visitDecimal(e,r){return Us.startDecimal(r),Us.addScale(r,e.scale),Us.addPrecision(r,e.precision),Us.endDecimal(r)}visitDate(e,r){return lc.startDate(r),lc.addUnit(r,e.unit),lc.endDate(r)}visitTime(e,r){return Vs.startTime(r),Vs.addUnit(r,e.unit),Vs.addBitWidth(r,e.bitWidth),Vs.endTime(r)}visitTimestamp(e,r){let n=e.timezone&&r.createString(e.timezone)||void 0;return Ms.startTimestamp(r),Ms.addUnit(r,e.unit),n!==void 0&&Ms.addTimezone(r,n),Ms.endTimestamp(r)}visitInterval(e,r){return dc.startInterval(r),dc.addUnit(r,e.unit),dc.endInterval(r)}visitList(e,r){return Nf.startList(r),Nf.endList(r)}visitStruct(e,r){return Lf.startStruct_(r),Lf.endStruct_(r)}visitUnion(e,r){yn.startTypeIdsVector(r,e.typeIds.length);let n=yn.createTypeIdsVector(r,e.typeIds);return yn.startUnion(r),yn.addMode(r,e.mode),yn.addTypeIds(r,n),yn.endUnion(r)}visitDictionary(e,r){let n=this.visit(e.indices,r);return si.startDictionaryEncoding(r),si.addId(r,new Kg(e.id,0)),si.addIsOrdered(r,e.isOrdered),n!==void 0&&si.addIndexType(r,n),si.endDictionaryEncoding(r)}visitFixedSizeBinary(e,r){return fc.startFixedSizeBinary(r),fc.addByteWidth(r,e.byteWidth),fc.endFixedSizeBinary(r)}visitFixedSizeList(e,r){return hc.startFixedSizeList(r),hc.addListSize(r,e.listSize),hc.endFixedSizeList(r)}visitMap(e,r){return pc.startMap(r),pc.addKeysSorted(r,e.keysSorted),pc.endMap(r)}};bn.TypeAssembler=yc;bn.instance=new yc});var Yf=m(wt=>{"use strict";Object.defineProperty(wt,"__esModule",{value:!0});wt.fieldFromJSON=wt.dictionaryBatchFromJSON=wt.recordBatchFromJSON=wt.schemaFromJSON=void 0;var mn=_e(),re=K(),Dr=Rr(),gn=ee();function Zg(t,e=new Map){return new mn.Schema(e_(t,e),Ps(t.customMetadata),e)}wt.schemaFromJSON=Zg;function jf(t){return new Dr.RecordBatch(t.count,Cf(t.columns),qf(t.columns))}wt.recordBatchFromJSON=jf;function Xg(t){return new Dr.DictionaryBatch(jf(t.data),t.id,t.isDelta)}wt.dictionaryBatchFromJSON=Xg;function e_(t,e){return(t.fields||[]).filter(Boolean).map(r=>mn.Field.fromJSON(r,e))}function kf(t,e){return(t.children||[]).filter(Boolean).map(r=>mn.Field.fromJSON(r,e))}function Cf(t){return(t||[]).reduce((e,r)=>[...e,new Dr.FieldNode(r.count,t_(r.VALIDITY)),...Cf(r.children)],[])}function qf(t,e=[]){for(let r=-1,n=(t||[]).length;++r<n;){let s=t[r];s.VALIDITY&&e.push(new Dr.BufferRegion(e.length,s.VALIDITY.length)),s.TYPE&&e.push(new Dr.BufferRegion(e.length,s.TYPE.length)),s.OFFSET&&e.push(new Dr.BufferRegion(e.length,s.OFFSET.length)),s.DATA&&e.push(new Dr.BufferRegion(e.length,s.DATA.length)),e=qf(s.children,e)}return e}function t_(t){return(t||[]).reduce((e,r)=>e+ +(r===0),0)}function r_(t,e){let r,n,s,a,o,c;return!e||!(a=t.dictionary)?(o=zf(t,kf(t,e)),s=new mn.Field(t.name,o,t.nullable,Ps(t.customMetadata))):e.has(r=a.id)?(n=(n=a.indexType)?Wf(n):new re.Int32,c=new re.Dictionary(e.get(r),n,r,a.isOrdered),s=new mn.Field(t.name,c,t.nullable,Ps(t.customMetadata))):(n=(n=a.indexType)?Wf(n):new re.Int32,e.set(r,o=zf(t,kf(t,e))),c=new re.Dictionary(o,n,r,a.isOrdered),s=new mn.Field(t.name,c,t.nullable,Ps(t.customMetadata))),s||null}wt.fieldFromJSON=r_;function Ps(t){return new Map(Object.entries(t||{}))}function Wf(t){return new re.Int(t.isSigned,t.bitWidth)}function zf(t,e){let r=t.type.name;switch(r){case"NONE":return new re.Null;case"null":return new re.Null;case"binary":return new re.Binary;case"utf8":return new re.Utf8;case"bool":return new re.Bool;case"list":return new re.List((e||[])[0]);case"struct":return new re.Struct(e||[]);case"struct_":return new re.Struct(e||[])}switch(r){case"int":{let n=t.type;return new re.Int(n.isSigned,n.bitWidth)}case"floatingpoint":{let n=t.type;return new re.Float(gn.Precision[n.precision])}case"decimal":{let n=t.type;return new re.Decimal(n.scale,n.precision)}case"date":{let n=t.type;return new re.Date_(gn.DateUnit[n.unit])}case"time":{let n=t.type;return new re.Time(gn.TimeUnit[n.unit],n.bitWidth)}case"timestamp":{let n=t.type;return new re.Timestamp(gn.TimeUnit[n.unit],n.timezone)}case"interval":{let n=t.type;return new re.Interval(gn.IntervalUnit[n.unit])}case"union":{let n=t.type;return new re.Union(gn.UnionMode[n.mode],n.typeIds||[],e||[])}case"fixedsizebinary":{let n=t.type;return new re.FixedSizeBinary(n.byteWidth)}case"fixedsizelist":{let n=t.type;return new re.FixedSizeList(n.listSize,(e||[])[0])}case"map":{let n=t.type;return new re.Map_((e||[])[0],n.keysSorted)}}throw new Error(`Unrecognized type: "${r}"`)}});var Rr=m(Je=>{"use strict";Object.defineProperty(Je,"__esModule",{value:!0});Je.FieldNode=Je.BufferRegion=Je.DictionaryBatch=Je.RecordBatch=Je.Message=void 0;var bc=jr(),Oe=zr(),Ns=Ya(),Be=_e(),n_=de(),oe=ee(),mc=xf(),Ls=Yf(),Er=bc.flatbuffers.Long,i_=bc.flatbuffers.Builder,s_=bc.flatbuffers.ByteBuffer,ge=Oe.org.apache.arrow.flatbuf.Type,ct=Oe.org.apache.arrow.flatbuf.Field,jt=Oe.org.apache.arrow.flatbuf.Schema,a_=Oe.org.apache.arrow.flatbuf.Buffer,cr=Ns.org.apache.arrow.flatbuf.Message,ur=Oe.org.apache.arrow.flatbuf.KeyValue,o_=Ns.org.apache.arrow.flatbuf.FieldNode,Gf=Oe.org.apache.arrow.flatbuf.Endianness,lr=Ns.org.apache.arrow.flatbuf.RecordBatch,_n=Ns.org.apache.arrow.flatbuf.DictionaryBatch,ne=K(),dr=class{constructor(e,r,n,s){this._version=r,this._headerType=n,this.body=new Uint8Array(0),s&&(this._createHeader=()=>s),this._bodyLength=typeof e=="number"?e:e.low}static fromJSON(e,r){let n=new dr(0,oe.MetadataVersion.V4,r);return n._createHeader=c_(e,r),n}static decode(e){e=new s_(n_.toUint8Array(e));let r=cr.getRootAsMessage(e),n=r.bodyLength(),s=r.version(),a=r.headerType(),o=new dr(n,s,a);return o._createHeader=u_(r,a),o}static encode(e){let r=new i_,n=-1;return e.isSchema()?n=Be.Schema.encode(r,e.header()):e.isRecordBatch()?n=$e.encode(r,e.header()):e.isDictionaryBatch()&&(n=vt.encode(r,e.header())),cr.startMessage(r),cr.addVersion(r,oe.MetadataVersion.V4),cr.addHeader(r,n),cr.addHeaderType(r,e.headerType),cr.addBodyLength(r,new Er(e.bodyLength,0)),cr.finishMessageBuffer(r,cr.endMessage(r)),r.asUint8Array()}static from(e,r=0){if(e instanceof Be.Schema)return new dr(0,oe.MetadataVersion.V4,oe.MessageHeader.Schema,e);if(e instanceof $e)return new dr(r,oe.MetadataVersion.V4,oe.MessageHeader.RecordBatch,e);if(e instanceof vt)return new dr(r,oe.MetadataVersion.V4,oe.MessageHeader.DictionaryBatch,e);throw new Error(`Unrecognized Message header: ${e}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===oe.MessageHeader.Schema}isRecordBatch(){return this.headerType===oe.MessageHeader.RecordBatch}isDictionaryBatch(){return this.headerType===oe.MessageHeader.DictionaryBatch}};Je.Message=dr;var $e=class{constructor(e,r,n){this._nodes=r,this._buffers=n,this._length=typeof e=="number"?e:e.low}get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}};Je.RecordBatch=$e;var vt=class{constructor(e,r,n=!1){this._data=e,this._isDelta=n,this._id=typeof r=="number"?r:r.low}get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}};Je.DictionaryBatch=vt;var Ur=class{constructor(e,r){this.offset=typeof e=="number"?e:e.low,this.length=typeof r=="number"?r:r.low}};Je.BufferRegion=Ur;var Vr=class{constructor(e,r){this.length=typeof e=="number"?e:e.low,this.nullCount=typeof r=="number"?r:r.low}};Je.FieldNode=Vr;function c_(t,e){return()=>{switch(e){case oe.MessageHeader.Schema:return Be.Schema.fromJSON(t);case oe.MessageHeader.RecordBatch:return $e.fromJSON(t);case oe.MessageHeader.DictionaryBatch:return vt.fromJSON(t)}throw new Error(`Unrecognized Message type: { name: ${oe.MessageHeader[e]}, type: ${e} }`)}}function u_(t,e){return()=>{switch(e){case oe.MessageHeader.Schema:return Be.Schema.decode(t.header(new jt));case oe.MessageHeader.RecordBatch:return $e.decode(t.header(new lr),t.version());case oe.MessageHeader.DictionaryBatch:return vt.decode(t.header(new _n),t.version())}throw new Error(`Unrecognized Message type: { name: ${oe.MessageHeader[e]}, type: ${e} }`)}}Be.Field.encode=T_;Be.Field.decode=g_;Be.Field.fromJSON=Ls.fieldFromJSON;Be.Schema.encode=__;Be.Schema.decode=l_;Be.Schema.fromJSON=Ls.schemaFromJSON;$e.encode=B_;$e.decode=d_;$e.fromJSON=Ls.recordBatchFromJSON;vt.encode=I_;vt.decode=f_;vt.fromJSON=Ls.dictionaryBatchFromJSON;Vr.encode=w_;Vr.decode=p_;Ur.encode=v_;Ur.decode=h_;function l_(t,e=new Map){let r=m_(t,e);return new Be.Schema(r,xs(t),e)}function d_(t,e=oe.MetadataVersion.V4){return new $e(t.length(),y_(t),b_(t,e))}function f_(t,e=oe.MetadataVersion.V4){return new vt($e.decode(t.data(),e),t.id(),t.isDelta())}function h_(t){return new Ur(t.offset(),t.length())}function p_(t){return new Vr(t.length(),t.nullCount())}function y_(t){let e=[];for(let r,n=-1,s=-1,a=t.nodesLength();++n<a;)(r=t.nodes(n))&&(e[++s]=Vr.decode(r));return e}function b_(t,e){let r=[];for(let n,s=-1,a=-1,o=t.buffersLength();++s<o;)(n=t.buffers(s))&&(e<oe.MetadataVersion.V4&&(n.bb_pos+=8*(s+1)),r[++a]=Ur.decode(n));return r}function m_(t,e){let r=[];for(let n,s=-1,a=-1,o=t.fieldsLength();++s<o;)(n=t.fields(s))&&(r[++a]=Be.Field.decode(n,e));return r}function Hf(t,e){let r=[];for(let n,s=-1,a=-1,o=t.childrenLength();++s<o;)(n=t.children(s))&&(r[++a]=Be.Field.decode(n,e));return r}function g_(t,e){let r,n,s,a,o,c;return!e||!(c=t.dictionary())?(s=Jf(t,Hf(t,e)),n=new Be.Field(t.name(),s,t.nullable(),xs(t))):e.has(r=c.id().low)?(a=(a=c.indexType())?$f(a):new ne.Int32,o=new ne.Dictionary(e.get(r),a,r,c.isOrdered()),n=new Be.Field(t.name(),o,t.nullable(),xs(t))):(a=(a=c.indexType())?$f(a):new ne.Int32,e.set(r,s=Jf(t,Hf(t,e))),o=new ne.Dictionary(s,a,r,c.isOrdered()),n=new Be.Field(t.name(),o,t.nullable(),xs(t))),n||null}function xs(t){let e=new Map;if(t)for(let r,n,s=-1,a=t.customMetadataLength()|0;++s<a;)(r=t.customMetadata(s))&&(n=r.key())!=null&&e.set(n,r.value());return e}function $f(t){return new ne.Int(t.isSigned(),t.bitWidth())}function Jf(t,e){let r=t.typeType();switch(r){case ge.NONE:return new ne.Null;case ge.Null:return new ne.Null;case ge.Binary:return new ne.Binary;case ge.Utf8:return new ne.Utf8;case ge.Bool:return new ne.Bool;case ge.List:return new ne.List((e||[])[0]);case ge.Struct_:return new ne.Struct(e||[])}switch(r){case ge.Int:{let n=t.type(new Oe.org.apache.arrow.flatbuf.Int);return new ne.Int(n.isSigned(),n.bitWidth())}case ge.FloatingPoint:{let n=t.type(new Oe.org.apache.arrow.flatbuf.FloatingPoint);return new ne.Float(n.precision())}case ge.Decimal:{let n=t.type(new Oe.org.apache.arrow.flatbuf.Decimal);return new ne.Decimal(n.scale(),n.precision())}case ge.Date:{let n=t.type(new Oe.org.apache.arrow.flatbuf.Date);return new ne.Date_(n.unit())}case ge.Time:{let n=t.type(new Oe.org.apache.arrow.flatbuf.Time);return new ne.Time(n.unit(),n.bitWidth())}case ge.Timestamp:{let n=t.type(new Oe.org.apache.arrow.flatbuf.Timestamp);return new ne.Timestamp(n.unit(),n.timezone())}case ge.Interval:{let n=t.type(new Oe.org.apache.arrow.flatbuf.Interval);return new ne.Interval(n.unit())}case ge.Union:{let n=t.type(new Oe.org.apache.arrow.flatbuf.Union);return new ne.Union(n.mode(),n.typeIdsArray()||[],e||[])}case ge.FixedSizeBinary:{let n=t.type(new Oe.org.apache.arrow.flatbuf.FixedSizeBinary);return new ne.FixedSizeBinary(n.byteWidth())}case ge.FixedSizeList:{let n=t.type(new Oe.org.apache.arrow.flatbuf.FixedSizeList);return new ne.FixedSizeList(n.listSize(),(e||[])[0])}case ge.Map:{let n=t.type(new Oe.org.apache.arrow.flatbuf.Map);return new ne.Map_((e||[])[0],n.keysSorted())}}throw new Error(`Unrecognized type: "${ge[r]}" (${r})`)}function __(t,e){let r=e.fields.map(a=>Be.Field.encode(t,a));jt.startFieldsVector(t,r.length);let n=jt.createFieldsVector(t,r),s=e.metadata&&e.metadata.size>0?jt.createCustomMetadataVector(t,[...e.metadata].map(([a,o])=>{let c=t.createString(`${a}`),f=t.createString(`${o}`);return ur.startKeyValue(t),ur.addKey(t,c),ur.addValue(t,f),ur.endKeyValue(t)})):-1;return jt.startSchema(t),jt.addFields(t,n),jt.addEndianness(t,S_?Gf.Little:Gf.Big),s!==-1&&jt.addCustomMetadata(t,s),jt.endSchema(t)}function T_(t,e){let r=-1,n=-1,s=-1,a=e.type,o=e.typeId;ne.DataType.isDictionary(a)?(o=a.dictionary.typeId,s=mc.instance.visit(a,t),n=mc.instance.visit(a.dictionary,t)):n=mc.instance.visit(a,t);let c=(a.children||[]).map(u=>Be.Field.encode(t,u)),f=ct.createChildrenVector(t,c),i=e.metadata&&e.metadata.size>0?ct.createCustomMetadataVector(t,[...e.metadata].map(([u,y])=>{let N=t.createString(`${u}`),Z=t.createString(`${y}`);return ur.startKeyValue(t),ur.addKey(t,N),ur.addValue(t,Z),ur.endKeyValue(t)})):-1;return e.name&&(r=t.createString(e.name)),ct.startField(t),ct.addType(t,n),ct.addTypeType(t,o),ct.addChildren(t,f),ct.addNullable(t,!!e.nullable),r!==-1&&ct.addName(t,r),s!==-1&&ct.addDictionary(t,s),i!==-1&&ct.addCustomMetadata(t,i),ct.endField(t)}function B_(t,e){let r=e.nodes||[],n=e.buffers||[];lr.startNodesVector(t,r.length),r.slice().reverse().forEach(o=>Vr.encode(t,o));let s=t.endVector();lr.startBuffersVector(t,n.length),n.slice().reverse().forEach(o=>Ur.encode(t,o));let a=t.endVector();return lr.startRecordBatch(t),lr.addLength(t,new Er(e.length,0)),lr.addNodes(t,s),lr.addBuffers(t,a),lr.endRecordBatch(t)}function I_(t,e){let r=$e.encode(t,e.data);return _n.startDictionaryBatch(t),_n.addId(t,new Er(e.id,0)),_n.addIsDelta(t,e.isDelta),_n.addData(t,r),_n.endDictionaryBatch(t)}function w_(t,e){return o_.createFieldNode(t,new Er(e.length,0),new Er(e.nullCount,0))}function v_(t,e){return a_.createBuffer(t,new Er(e.offset,0),new Er(e.length,0))}var S_=function(){let t=new ArrayBuffer(2);return new DataView(t).setInt16(0,256,!0),new Int16Array(t)[0]===256}()});var ks=m(H=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});H.magicX2AndPadding=H.magicAndPadding=H.magicLength=H.checkForMagicArrowString=H.MAGIC=H.MAGIC_STR=H.PADDING=H.JSONMessageReader=H.AsyncMessageReader=H.MessageReader=void 0;var fr=ee(),O_=jr(),Kf=O_.flatbuffers.ByteBuffer,ai=Rr(),A_=Ae(),F_=sc(),Qf=de(),js=or(),ut=qr(),gc=t=>`Expected ${fr.MessageHeader[t]} Message in stream, but was null or length 0.`,_c=t=>`Header pointer of flatbuffer-encoded ${fr.MessageHeader[t]} Message is null or length 0.`,Zf=(t,e)=>`Expected to read ${t} metadata bytes, but only read ${e}.`,Xf=(t,e)=>`Expected to read ${t} bytes for message body, but only read ${e}.`,Tc=class{constructor(e){this.source=e instanceof js.ByteStream?e:new js.ByteStream(e)}[Symbol.iterator](){return this}next(){let e;return(e=this.readMetadataLength()).done||e.value===-1&&(e=this.readMetadataLength()).done||(e=this.readMetadata(e.value)).done?ut.ITERATOR_DONE:e}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}readMessage(e){let r;if((r=this.next()).done)return null;if(e!=null&&r.value.headerType!==e)throw new Error(gc(e));return r.value}readMessageBody(e){if(e<=0)return new Uint8Array(0);let r=Qf.toUint8Array(this.source.read(e));if(r.byteLength<e)throw new Error(Xf(e,r.byteLength));return r.byteOffset%8==0&&r.byteOffset+r.byteLength<=r.buffer.byteLength?r:r.slice()}readSchema(e=!1){let r=fr.MessageHeader.Schema,n=this.readMessage(r),s=n&&n.header();if(e&&!s)throw new Error(_c(r));return s}readMetadataLength(){let e=this.source.read(H.PADDING),r=e&&new Kf(e),n=r&&r.readInt32(0)||0;return{done:n===0,value:n}}readMetadata(e){let r=this.source.read(e);if(!r)return ut.ITERATOR_DONE;if(r.byteLength<e)throw new Error(Zf(e,r.byteLength));return{done:!1,value:ai.Message.decode(r)}}};H.MessageReader=Tc;var eh=class{constructor(e,r){this.source=e instanceof js.AsyncByteStream?e:A_.isFileHandle(e)?new F_.AsyncRandomAccessFile(e,r):new js.AsyncByteStream(e)}[Symbol.asyncIterator](){return this}async next(){let e;return(e=await this.readMetadataLength()).done||e.value===-1&&(e=await this.readMetadataLength()).done||(e=await this.readMetadata(e.value)).done?ut.ITERATOR_DONE:e}async throw(e){return await this.source.throw(e)}async return(e){return await this.source.return(e)}async readMessage(e){let r;if((r=await this.next()).done)return null;if(e!=null&&r.value.headerType!==e)throw new Error(gc(e));return r.value}async readMessageBody(e){if(e<=0)return new Uint8Array(0);let r=Qf.toUint8Array(await this.source.read(e));if(r.byteLength<e)throw new Error(Xf(e,r.byteLength));return r.byteOffset%8==0&&r.byteOffset+r.byteLength<=r.buffer.byteLength?r:r.slice()}async readSchema(e=!1){let r=fr.MessageHeader.Schema,n=await this.readMessage(r),s=n&&n.header();if(e&&!s)throw new Error(_c(r));return s}async readMetadataLength(){let e=await this.source.read(H.PADDING),r=e&&new Kf(e),n=r&&r.readInt32(0)||0;return{done:n===0,value:n}}async readMetadata(e){let r=await this.source.read(e);if(!r)return ut.ITERATOR_DONE;if(r.byteLength<e)throw new Error(Zf(e,r.byteLength));return{done:!1,value:ai.Message.decode(r)}}};H.AsyncMessageReader=eh;var th=class extends Tc{constructor(e){super(new Uint8Array(0));this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=e instanceof ut.ArrowJSON?e:new ut.ArrowJSON(e)}next(){let{_json:e}=this;if(!this._schema){this._schema=!0;let r=ai.Message.fromJSON(e.schema,fr.MessageHeader.Schema);return{done:!1,value:r}}if(this._dictionaryIndex<e.dictionaries.length){let r=e.dictionaries[this._dictionaryIndex++];this._body=r.data.columns;let n=ai.Message.fromJSON(r,fr.MessageHeader.DictionaryBatch);return{done:!1,value:n}}if(this._batchIndex<e.batches.length){let r=e.batches[this._batchIndex++];this._body=r.columns;let n=ai.Message.fromJSON(r,fr.MessageHeader.RecordBatch);return{done:!1,value:n}}return this._body=[],ut.ITERATOR_DONE}readMessageBody(e){return r(this._body);function r(n){return(n||[]).reduce((s,a)=>[...s,...a.VALIDITY&&[a.VALIDITY]||[],...a.TYPE&&[a.TYPE]||[],...a.OFFSET&&[a.OFFSET]||[],...a.DATA&&[a.DATA]||[],...r(a.children)],[])}}readMessage(e){let r;if((r=this.next()).done)return null;if(e!=null&&r.value.headerType!==e)throw new Error(gc(e));return r.value}readSchema(){let e=fr.MessageHeader.Schema,r=this.readMessage(e),n=r&&r.header();if(!r||!n)throw new Error(_c(e));return n}};H.JSONMessageReader=th;H.PADDING=4;H.MAGIC_STR="ARROW1";H.MAGIC=new Uint8Array(H.MAGIC_STR.length);for(let t=0;t<H.MAGIC_STR.length;t+=1|0)H.MAGIC[t]=H.MAGIC_STR.charCodeAt(t);function D_(t,e=0){for(let r=-1,n=H.MAGIC.length;++r<n;)if(H.MAGIC[r]!==t[e+r])return!1;return!0}H.checkForMagicArrowString=D_;H.magicLength=H.MAGIC.length;H.magicAndPadding=H.magicLength+H.PADDING;H.magicX2AndPadding=H.magicLength*2+H.PADDING});var ah=m(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});Cs.VectorAssembler=void 0;var R_=ve(),rh=ee(),E_=kt(),Bc=de(),Ic=pt(),U_=Xt(),nh=Rr(),ih=K(),pe=class extends R_.Visitor{constructor(){super();this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}static assemble(...e){let r=new pe,n=U_.selectVectorChildrenArgs(E_.RecordBatch,e),[s=r]=r.visitMany(n);return s}visit(e){if(!ih.DataType.isDictionary(e.type)){let{data:r,length:n,nullCount:s}=e;if(n>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");ih.DataType.isNull(e.type)||lt.call(this,s<=0?new Uint8Array(0):Ic.truncateBitmap(r.offset,n,r.nullBitmap)),this.nodes.push(new nh.FieldNode(n,s))}return super.visit(e)}visitNull(e){return this}visitDictionary(e){return this.visit(e.indices)}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}};Cs.VectorAssembler=pe;function lt(t){let e=t.byteLength+7&~7;return this.buffers.push(t),this.bufferRegions.push(new nh.BufferRegion(this._byteLength,e)),this._byteLength+=e,this}function V_(t){let{type:e,length:r,typeIds:n,valueOffsets:s}=t;if(lt.call(this,n),e.mode===rh.UnionMode.Sparse)return vc.call(this,t);if(e.mode===rh.UnionMode.Dense){if(t.offset<=0)return lt.call(this,s),vc.call(this,t);{let a=n.reduce((u,y)=>Math.max(u,y),n[0]),o=new Int32Array(a+1),c=new Int32Array(a+1).fill(-1),f=new Int32Array(r),i=Bc.rebaseValueOffsets(-s[0],r,s);for(let u,y,N=-1;++N<r;)(y=c[u=n[N]])===-1&&(y=c[u]=i[u]),f[N]=i[N]-y,++o[u];lt.call(this,f);for(let u,y=-1,N=e.children.length;++y<N;)if(u=t.getChildAt(y)){let Z=e.typeIds[y],ke=Math.min(r,o[Z]);this.visit(u.slice(c[Z],ke))}}}return this}function M_(t){let e;return t.nullCount>=t.length?lt.call(this,new Uint8Array(0)):(e=t.values)instanceof Uint8Array?lt.call(this,Ic.truncateBitmap(t.offset,t.length,e)):lt.call(this,Ic.packBools(t))}function hr(t){return lt.call(this,t.values.subarray(0,t.length*t.stride))}function sh(t){let{length:e,values:r,valueOffsets:n}=t,s=n[0],a=n[e],o=Math.min(a-s,r.byteLength-s);return lt.call(this,Bc.rebaseValueOffsets(-n[0],e,n)),lt.call(this,r.subarray(s,s+o)),this}function wc(t){let{length:e,valueOffsets:r}=t;return r&&lt.call(this,Bc.rebaseValueOffsets(r[0],e,r)),this.visit(t.getChildAt(0))}function vc(t){return this.visitMany(t.type.children.map((e,r)=>t.getChildAt(r)).filter(Boolean))[0]}pe.prototype.visitBool=M_;pe.prototype.visitInt=hr;pe.prototype.visitFloat=hr;pe.prototype.visitUtf8=sh;pe.prototype.visitBinary=sh;pe.prototype.visitFixedSizeBinary=hr;pe.prototype.visitDate=hr;pe.prototype.visitTimestamp=hr;pe.prototype.visitTime=hr;pe.prototype.visitDecimal=hr;pe.prototype.visitList=wc;pe.prototype.visitStruct=vc;pe.prototype.visitUnion=V_;pe.prototype.visitInterval=hr;pe.prototype.visitFixedSizeList=wc;pe.prototype.visitMap=wc});var ch=m(qs=>{"use strict";Object.defineProperty(qs,"__esModule",{value:!0});qs.JSONTypeAssembler=void 0;var P_=ve(),ie=ee(),oh=class extends P_.Visitor{visit(e){return e==null?void 0:super.visit(e)}visitNull({typeId:e}){return{name:ie.ArrowType[e].toLowerCase()}}visitInt({typeId:e,bitWidth:r,isSigned:n}){return{name:ie.ArrowType[e].toLowerCase(),bitWidth:r,isSigned:n}}visitFloat({typeId:e,precision:r}){return{name:ie.ArrowType[e].toLowerCase(),precision:ie.Precision[r]}}visitBinary({typeId:e}){return{name:ie.ArrowType[e].toLowerCase()}}visitBool({typeId:e}){return{name:ie.ArrowType[e].toLowerCase()}}visitUtf8({typeId:e}){return{name:ie.ArrowType[e].toLowerCase()}}visitDecimal({typeId:e,scale:r,precision:n}){return{name:ie.ArrowType[e].toLowerCase(),scale:r,precision:n}}visitDate({typeId:e,unit:r}){return{name:ie.ArrowType[e].toLowerCase(),unit:ie.DateUnit[r]}}visitTime({typeId:e,unit:r,bitWidth:n}){return{name:ie.ArrowType[e].toLowerCase(),unit:ie.TimeUnit[r],bitWidth:n}}visitTimestamp({typeId:e,timezone:r,unit:n}){return{name:ie.ArrowType[e].toLowerCase(),unit:ie.TimeUnit[n],timezone:r}}visitInterval({typeId:e,unit:r}){return{name:ie.ArrowType[e].toLowerCase(),unit:ie.IntervalUnit[r]}}visitList({typeId:e}){return{name:ie.ArrowType[e].toLowerCase()}}visitStruct({typeId:e}){return{name:ie.ArrowType[e].toLowerCase()}}visitUnion({typeId:e,mode:r,typeIds:n}){return{name:ie.ArrowType[e].toLowerCase(),mode:ie.UnionMode[r],typeIds:[...n]}}visitDictionary(e){return this.visit(e.dictionary)}visitFixedSizeBinary({typeId:e,byteWidth:r}){return{name:ie.ArrowType[e].toLowerCase(),byteWidth:r}}visitFixedSizeList({typeId:e,listSize:r}){return{name:ie.ArrowType[e].toLowerCase(),listSize:r}}visitMap({typeId:e,keysSorted:r}){return{name:ie.ArrowType[e].toLowerCase(),keysSorted:r}}};qs.JSONTypeAssembler=oh});var dh=m(Ys=>{"use strict";Object.defineProperty(Ys,"__esModule",{value:!0});Ys.JSONVectorAssembler=void 0;var N_=Jn(),oi=sn(),L_=ue(),x_=ve(),j_=ee(),k_=kt(),Sc=ee(),Ws=pt(),C_=Xt(),uh=K(),zs=class extends x_.Visitor{static assemble(...e){return new zs().visitMany(C_.selectColumnChildrenArgs(k_.RecordBatch,e))}visit(e){let{data:r,name:n,length:s}=e,{offset:a,nullCount:o,nullBitmap:c}=r,f=uh.DataType.isDictionary(e.type)?e.type.indices:e.type,i=Object.assign([],r.buffers,{[j_.BufferType.VALIDITY]:void 0});return{name:n,count:s,VALIDITY:uh.DataType.isNull(f)?void 0:o<=0?Array.from({length:s},()=>1):[...Ws.iterateBits(c,a,s,null,Ws.getBit)],...super.visit(L_.Vector.new(r.clone(f,a,s,0,i)))}}visitNull(){return{}}visitBool({values:e,offset:r,length:n}){return{DATA:[...Ws.iterateBits(e,r,n,null,Ws.getBool)]}}visitInt(e){return{DATA:e.type.bitWidth<64?[...e.values]:[...ci(e.values,2)]}}visitFloat(e){return{DATA:[...e.values]}}visitUtf8(e){return{DATA:[...e],OFFSET:[...e.valueOffsets]}}visitBinary(e){return{DATA:[...lh(e)],OFFSET:[...e.valueOffsets]}}visitFixedSizeBinary(e){return{DATA:[...lh(e)]}}visitDate(e){return{DATA:e.type.unit===Sc.DateUnit.DAY?[...e.values]:[...ci(e.values,2)]}}visitTimestamp(e){return{DATA:[...ci(e.values,2)]}}visitTime(e){return{DATA:e.type.unit<Sc.TimeUnit.MICROSECOND?[...e.values]:[...ci(e.values,2)]}}visitDecimal(e){return{DATA:[...ci(e.values,4)]}}visitList(e){return{OFFSET:[...e.valueOffsets],children:e.type.children.map((r,n)=>this.visit(new oi.Column(r,[e.getChildAt(n)])))}}visitStruct(e){return{children:e.type.children.map((r,n)=>this.visit(new oi.Column(r,[e.getChildAt(n)])))}}visitUnion(e){return{TYPE:[...e.typeIds],OFFSET:e.type.mode===Sc.UnionMode.Dense?[...e.valueOffsets]:void 0,children:e.type.children.map((r,n)=>this.visit(new oi.Column(r,[e.getChildAt(n)])))}}visitInterval(e){return{DATA:[...e.values]}}visitFixedSizeList(e){return{children:e.type.children.map((r,n)=>this.visit(new oi.Column(r,[e.getChildAt(n)])))}}visitMap(e){return{OFFSET:[...e.valueOffsets],children:e.type.children.map((r,n)=>this.visit(new oi.Column(r,[e.getChildAt(n)])))}}};Ys.JSONVectorAssembler=zs;function*lh(t){for(let e of t)yield e.reduce((r,n)=>`${r}${("0"+(n&255).toString(16)).slice(-2)}`,"").toUpperCase()}function*ci(t,e){for(let r=-1,n=t.length/e;++r<n;)yield`${N_.BN.new(t.subarray((r+0)*e,(r+1)*e),!1)}`}});var Ks=m(Ot=>{"use strict";Object.defineProperty(Ot,"__esModule",{value:!0});Ot.RecordBatchJSONWriter=Ot.RecordBatchFileWriter=Ot.RecordBatchStreamWriter=Ot.RecordBatchWriter=void 0;var Oc=li(),q_=ks(),W_=sn(),z_=K(),Y_=_e(),Gs=Rr(),Ac=Rr(),Tn=rc(),Fc=ee(),Dc=or(),fh=ah(),G_=ch(),hh=dh(),H_=de(),Rc=kt(),$_=qr(),St=Ae(),ui=class extends $_.ReadableInterop{constructor(e){super();this._position=0,this._started=!1,this._sink=new Dc.AsyncByteQueue,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,St.isObject(e)||(e={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy=typeof e.autoDestroy=="boolean"?e.autoDestroy:!0,this._writeLegacyIpcFormat=typeof e.writeLegacyIpcFormat=="boolean"?e.writeLegacyIpcFormat:!1}static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e,r){throw new Error('"throughDOM" not available in this environment')}toString(e=!1){return this._sink.toString(e)}toUint8Array(e=!1){return this._sink.toUint8Array(e)}writeAll(e){return St.isPromise(e)?e.then(r=>this.writeAll(r)):St.isAsyncIterable(e)?Uc(this,e):Ec(this,e)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(e){return this._sink.toDOMStream(e)}toNodeStream(e){return this._sink.toNodeStream(e)}close(){return this.reset()._sink.close()}abort(e){return this.reset()._sink.abort(e)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(e=this._sink,r=null){return e===this._sink||e instanceof Dc.AsyncByteQueue?this._sink=e:(this._sink=new Dc.AsyncByteQueue,e&&St.isWritableDOMStream(e)?this.toDOMStream({type:"bytes"}).pipeTo(e):e&&St.isWritableNodeStream(e)&&this.toNodeStream({objectMode:!1}).pipe(e)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,(!r||!r.compareTo(this._schema))&&(r===null?(this._position=0,this._schema=null):(this._started=!0,this._schema=r,this._writeSchema(r))),this}write(e){let r=null;if(this._sink){if(e==null)return this.finish()&&void 0;if(e instanceof Oc.Table&&!(r=e.schema))return this.finish()&&void 0;if(e instanceof Rc.RecordBatch&&!(r=e.schema))return this.finish()&&void 0}else throw new Error("RecordBatchWriter is closed");if(r&&!r.compareTo(this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,r)}e instanceof Rc.RecordBatch?e instanceof Rc._InternalEmptyPlaceholderRecordBatch||this._writeRecordBatch(e):e instanceof Oc.Table?this.writeAll(e.chunks):St.isIterable(e)&&this.writeAll(e)}_writeMessage(e,r=8){let n=r-1,s=Gs.Message.encode(e),a=s.byteLength,o=this._writeLegacyIpcFormat?4:8,c=a+o+n&~n,f=c-a-o;return e.headerType===Fc.MessageHeader.RecordBatch?this._recordBatchBlocks.push(new Tn.FileBlock(c,e.bodyLength,this._position)):e.headerType===Fc.MessageHeader.DictionaryBatch&&this._dictionaryBlocks.push(new Tn.FileBlock(c,e.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(c-o)),a>0&&this._write(s),this._writePadding(f)}_write(e){if(this._started){let r=H_.toUint8Array(e);r&&r.byteLength>0&&(this._sink.write(r),this._position+=r.byteLength)}return this}_writeSchema(e){return this._writeMessage(Gs.Message.from(e))}_writeFooter(e){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(q_.MAGIC)}_writePadding(e){return e>0?this._write(new Uint8Array(e)):this}_writeRecordBatch(e){let{byteLength:r,nodes:n,bufferRegions:s,buffers:a}=fh.VectorAssembler.assemble(e),o=new Ac.RecordBatch(e.length,n,s),c=Gs.Message.from(o,r);return this._writeDictionaries(e)._writeMessage(c)._writeBodyBuffers(a)}_writeDictionaryBatch(e,r,n=!1){this._dictionaryDeltaOffsets.set(r,e.length+(this._dictionaryDeltaOffsets.get(r)||0));let{byteLength:s,nodes:a,bufferRegions:o,buffers:c}=fh.VectorAssembler.assemble(e),f=new Ac.RecordBatch(e.length,a,o),i=new Ac.DictionaryBatch(f,r,n),u=Gs.Message.from(i,s);return this._writeMessage(u)._writeBodyBuffers(c)}_writeBodyBuffers(e){let r,n,s;for(let a=-1,o=e.length;++a<o;)(r=e[a])&&(n=r.byteLength)>0&&(this._write(r),(s=(n+7&~7)-n)>0&&this._writePadding(s));return this}_writeDictionaries(e){for(let[r,n]of e.dictionaries){let s=this._dictionaryDeltaOffsets.get(r)||0;if(s===0||(n=n.slice(s)).length>0){let a="chunks"in n?n.chunks:[n];for(let o of a)this._writeDictionaryBatch(o,r,s>0),s+=o.length}}return this}};Ot.RecordBatchWriter=ui;var Hs=class extends ui{static writeAll(e,r){let n=new Hs(r);return St.isPromise(e)?e.then(s=>n.writeAll(s)):St.isAsyncIterable(e)?Uc(n,e):Ec(n,e)}};Ot.RecordBatchStreamWriter=Hs;var $s=class extends ui{static writeAll(e){let r=new $s;return St.isPromise(e)?e.then(n=>r.writeAll(n)):St.isAsyncIterable(e)?Uc(r,e):Ec(r,e)}constructor(){super();this._autoDestroy=!0}_writeSchema(e){return this._writeMagic()._writePadding(2)}_writeFooter(e){let r=Tn.Footer.encode(new Tn.Footer(e,Fc.MetadataVersion.V4,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(e)._write(r)._write(Int32Array.of(r.byteLength))._writeMagic()}};Ot.RecordBatchFileWriter=$s;var Js=class extends ui{constructor(){super();this._autoDestroy=!0,this._recordBatches=[],this._dictionaries=[]}static writeAll(e){return new Js().writeAll(e)}_writeMessage(){return this}_writeFooter(e){return this}_writeSchema(e){return this._write(`{
  "schema": ${JSON.stringify({fields:e.fields.map(ph)},null,2)}`)}_writeDictionaries(e){return e.dictionaries.size>0&&this._dictionaries.push(e),this}_writeDictionaryBatch(e,r,n=!1){return this._dictionaryDeltaOffsets.set(r,e.length+(this._dictionaryDeltaOffsets.get(r)||0)),this._write(this._dictionaryBlocks.length===0?"    ":`,
    `),this._write(`${J_(e,r,n)}`),this._dictionaryBlocks.push(new Tn.FileBlock(0,0,0)),this}_writeRecordBatch(e){return this._writeDictionaries(e),this._recordBatches.push(e),this}close(){if(this._dictionaries.length>0){this._write(`,
  "dictionaries": [
`);for(let e of this._dictionaries)super._writeDictionaries(e);this._write(`
  ]`)}if(this._recordBatches.length>0){for(let e=-1,r=this._recordBatches.length;++e<r;)this._write(e===0?`,
  "batches": [
    `:`,
    `),this._write(`${K_(this._recordBatches[e])}`),this._recordBatchBlocks.push(new Tn.FileBlock(0,0,0));this._write(`
  ]`)}return this._schema&&this._write(`
}`),this._dictionaries=[],this._recordBatches=[],super.close()}};Ot.RecordBatchJSONWriter=Js;function Ec(t,e){let r=e;e instanceof Oc.Table&&(r=e.chunks,t.reset(void 0,e.schema));for(let n of r)t.write(n);return t.finish()}async function Uc(t,e){for await(let r of e)t.write(r);return t.finish()}function ph({name:t,type:e,nullable:r}){let n=new G_.JSONTypeAssembler;return{name:t,nullable:r,type:n.visit(e),children:(e.children||[]).map(ph),dictionary:z_.DataType.isDictionary(e)?{id:e.id,isOrdered:e.isOrdered,indexType:n.visit(e.indices)}:void 0}}function J_(t,e,r=!1){let n=new Y_.Field(`${e}`,t.type,t.nullCount>0),s=hh.JSONVectorAssembler.assemble(new W_.Column(n,[t]));return JSON.stringify({id:e,isDelta:r,data:{count:t.length,columns:s}},null,2)}function K_(t){return JSON.stringify({count:t.length,columns:hh.JSONVectorAssembler.assemble(t)},null,2)}});var Pc=m(pr=>{"use strict";Object.defineProperty(pr,"__esModule",{value:!0});pr.distributeVectorsIntoRecordBatches=pr.distributeColumnsIntoRecordBatches=pr.ensureSameLengthData=void 0;var yh=st(),Vc=_e(),Q_=Zt(),Z_=kt(),Mc=new Uint8Array(0),bh=t=>[Mc,Mc,new Uint8Array(t),Mc];function X_(t,e,r=e.reduce((n,s)=>Math.max(n,s.length),0)){let n,s,a=-1,o=e.length,c=[...t.fields],f=[],i=(r+63&~63)>>3;for(;++a<o;)(n=e[a])&&n.length===r?f[a]=n:((s=c[a]).nullable||(c[a]=c[a].clone({nullable:!0})),f[a]=n?n._changeLengthAndBackfillNullBitmap(r):yh.Data.new(s.type,0,r,r,bh(i)));return[new Vc.Schema(c),r,f]}pr.ensureSameLengthData=X_;function eT(t){return mh(new Vc.Schema(t.map(({field:e})=>e)),t)}pr.distributeColumnsIntoRecordBatches=eT;function mh(t,e){return tT(t,e.map(r=>r instanceof Q_.Chunked?r.chunks.map(n=>n.data):[r.data]))}pr.distributeVectorsIntoRecordBatches=mh;function tT(t,e){let r=[...t.fields],n=[],s={numBatches:e.reduce((y,N)=>Math.max(y,N.length),0)},a=0,o=0,c=-1,f=e.length,i,u=[];for(;s.numBatches-- >0;){for(o=Number.POSITIVE_INFINITY,c=-1;++c<f;)u[c]=i=e[c].shift(),o=Math.min(o,i?i.length:o);isFinite(o)&&(u=rT(r,o,u,e,s),o>0&&(n[a++]=[o,u.slice()]))}return[t=new Vc.Schema(r,t.metadata),n.map(y=>new Z_.RecordBatch(t,...y))]}function rT(t,e,r,n,s){let a,o,c=0,f=-1,i=n.length,u=(e+63&~63)>>3;for(;++f<i;)(a=r[f])&&(c=a.length)>=e?c===e?r[f]=a:(r[f]=a.slice(0,e),a=a.slice(e,c-e),s.numBatches=Math.max(s.numBatches,n[f].unshift(a))):((o=t[f]).nullable||(t[f]=o.clone({nullable:!0})),r[f]=a?a._changeLengthAndBackfillNullBitmap(e):yh.Data.new(o.type,0,e,e,bh(u)));return r}});var le=m(Qs=>{"use strict";Object.defineProperty(Qs,"__esModule",{value:!0});Qs.BaseVector=void 0;var nT=ee(),iT=Zt(),sT=Zn(),Nc=ue(),Lc=class extends Nc.AbstractVector{constructor(e,r){super();this._children=r,this.numChildren=e.childData.length,this._bindDataAccessors(this.data=e)}get type(){return this.data.type}get typeId(){return this.data.typeId}get length(){return this.data.length}get offset(){return this.data.offset}get stride(){return this.data.stride}get nullCount(){return this.data.nullCount}get byteLength(){return this.data.byteLength}get VectorName(){return`${nT.Type[this.typeId]}Vector`}get ArrayType(){return this.type.ArrayType}get values(){return this.data.values}get typeIds(){return this.data.typeIds}get nullBitmap(){return this.data.nullBitmap}get valueOffsets(){return this.data.valueOffsets}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}clone(e,r=this._children){return Nc.Vector.new(e,r)}concat(...e){return iT.Chunked.concat(this,...e)}slice(e,r){return sT.clampRange(this,e,r,this._sliceInternal)}isValid(e){if(this.nullCount>0){let r=this.offset+e;return(this.nullBitmap[r>>3]&1<<r%8)!==0}return!0}getChildAt(e){return e<0||e>=this.numChildren?null:(this._children||(this._children=[]))[e]||(this._children[e]=Nc.Vector.new(this.data.childData[e]))}toJSON(){return[...this]}_sliceInternal(e,r,n){return e.clone(e.data.slice(r,n-r),null)}_bindDataAccessors(e){}};Qs.BaseVector=Lc;Lc.prototype[Symbol.isConcatSpreadable]=!0});var xc=m(Zs=>{"use strict";Object.defineProperty(Zs,"__esModule",{value:!0});Zs.BinaryVector=void 0;var aT=ue(),oT=le(),cT=K(),gh=class extends oT.BaseVector{asUtf8(){return aT.Vector.new(this.data.clone(new cT.Utf8))}};Zs.BinaryVector=gh});var jc=m(Xs=>{"use strict";Object.defineProperty(Xs,"__esModule",{value:!0});Xs.BoolVector=void 0;var uT=K(),lT=le(),dT=At(),_h=class extends lT.BaseVector{static from(e){return dT.vectorFromValuesWithType(()=>new uT.Bool,e)}};Xs.BoolVector=_h});var Cc=m(yr=>{"use strict";Object.defineProperty(yr,"__esModule",{value:!0});yr.DateMillisecondVector=yr.DateDayVector=yr.DateVector=void 0;var fT=ee(),hT=le(),Th=At(),kc=K(),ea=class extends hT.BaseVector{static from(...e){return e.length===2?Th.vectorFromValuesWithType(()=>e[1]===fT.DateUnit.DAY?new kc.DateDay:new kc.DateMillisecond,e[0]):Th.vectorFromValuesWithType(()=>new kc.DateMillisecond,e[0])}};yr.DateVector=ea;var Bh=class extends ea{};yr.DateDayVector=Bh;var Ih=class extends ea{};yr.DateMillisecondVector=Ih});var qc=m(ta=>{"use strict";Object.defineProperty(ta,"__esModule",{value:!0});ta.DecimalVector=void 0;var pT=le(),wh=class extends pT.BaseVector{};ta.DecimalVector=wh});var na=m(ra=>{"use strict";Object.defineProperty(ra,"__esModule",{value:!0});ra.DictionaryVector=void 0;var yT=st(),vh=ue(),bT=le(),mT=At(),gT=K(),Wc=class extends bT.BaseVector{constructor(e){super(e);this.indices=vh.Vector.new(e.clone(this.type.indices))}static from(...e){if(e.length===3){let[r,n,s]=e,a=new gT.Dictionary(r.type,n,null,null);return vh.Vector.new(yT.Data.Dictionary(a,0,s.length,0,null,s,r))}return mT.vectorFromValuesWithType(()=>e[0].type,e[0])}get dictionary(){return this.data.dictionary}reverseLookup(e){return this.dictionary.indexOf(e)}getKey(e){return this.indices.get(e)}getValue(e){return this.dictionary.get(e)}setKey(e,r){return this.indices.set(e,r)}setValue(e,r){return this.dictionary.set(e,r)}};ra.DictionaryVector=Wc;Wc.prototype.indices=null});var zc=m(ia=>{"use strict";Object.defineProperty(ia,"__esModule",{value:!0});ia.FixedSizeBinaryVector=void 0;var _T=le(),Sh=class extends _T.BaseVector{};ia.FixedSizeBinaryVector=Sh});var Yc=m(sa=>{"use strict";Object.defineProperty(sa,"__esModule",{value:!0});sa.FixedSizeListVector=void 0;var TT=le(),Oh=class extends TT.BaseVector{};sa.FixedSizeListVector=Oh});var Jc=m(Ft=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});Ft.Float64Vector=Ft.Float32Vector=Ft.Float16Vector=Ft.FloatVector=void 0;var BT=st(),IT=ue(),wT=le(),vT=At(),Mr=K(),di=class extends wT.BaseVector{static from(e){let r=AT(this);if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)){let n=OT(e.constructor)||r;if(r===null&&(r=n),r&&r===n){let s=new r,a=e.byteLength/s.ArrayType.BYTES_PER_ELEMENT;if(!ST(r,e.constructor))return IT.Vector.new(BT.Data.Float(s,0,a,0,null,e))}}if(r)return vT.vectorFromValuesWithType(()=>new r,e);throw e instanceof DataView||e instanceof ArrayBuffer?new TypeError(`Cannot infer float type from instance of ${e.constructor.name}`):new TypeError("Unrecognized FloatVector input")}};Ft.FloatVector=di;var Gc=class extends di{toFloat32Array(){return new Float32Array(this)}toFloat64Array(){return new Float64Array(this)}};Ft.Float16Vector=Gc;var Hc=class extends di{};Ft.Float32Vector=Hc;var $c=class extends di{};Ft.Float64Vector=$c;var ST=(t,e)=>t===Mr.Float16&&e!==Uint16Array,OT=t=>{switch(t){case Uint16Array:return Mr.Float16;case Float32Array:return Mr.Float32;case Float64Array:return Mr.Float64;default:return null}},AT=t=>{switch(t){case Gc:return Mr.Float16;case Hc:return Mr.Float32;case $c:return Mr.Float64;default:return null}}});var Kc=m(br=>{"use strict";Object.defineProperty(br,"__esModule",{value:!0});br.IntervalYearMonthVector=br.IntervalDayTimeVector=br.IntervalVector=void 0;var FT=le(),aa=class extends FT.BaseVector{};br.IntervalVector=aa;var Ah=class extends aa{};br.IntervalDayTimeVector=Ah;var Fh=class extends aa{};br.IntervalYearMonthVector=Fh});var oa=m(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});ye.Uint64Vector=ye.Uint32Vector=ye.Uint16Vector=ye.Uint8Vector=ye.Int64Vector=ye.Int32Vector=ye.Int16Vector=ye.Int8Vector=ye.IntVector=void 0;var DT=st(),RT=ue(),ET=le(),UT=At(),Dh=Ae(),Rh=de(),ce=K(),Dt=class extends ET.BaseVector{static from(...e){let[r,n=!1]=e,s=PT(this,n);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)){let a=MT(r.constructor,n)||s;if(s===null&&(s=a),s&&s===a){let o=new s,c=r.byteLength/o.ArrayType.BYTES_PER_ELEMENT;return VT(s,r.constructor)&&(c*=.5),RT.Vector.new(DT.Data.Int(o,0,c,0,null,r))}}if(s)return UT.vectorFromValuesWithType(()=>new s,r);throw r instanceof DataView||r instanceof ArrayBuffer?new TypeError(`Cannot infer integer type from instance of ${r.constructor.name}`):new TypeError("Unrecognized IntVector input")}};ye.IntVector=Dt;var Qc=class extends Dt{};ye.Int8Vector=Qc;var Zc=class extends Dt{};ye.Int16Vector=Zc;var Xc=class extends Dt{};ye.Int32Vector=Xc;var eu=class extends Dt{toBigInt64Array(){return Rh.toBigInt64Array(this.values)}get values64(){return this._values64||(this._values64=this.toBigInt64Array())}};ye.Int64Vector=eu;var tu=class extends Dt{};ye.Uint8Vector=tu;var ru=class extends Dt{};ye.Uint16Vector=ru;var nu=class extends Dt{};ye.Uint32Vector=nu;var iu=class extends Dt{toBigUint64Array(){return Rh.toBigUint64Array(this.values)}get values64(){return this._values64||(this._values64=this.toBigUint64Array())}};ye.Uint64Vector=iu;var VT=(t,e)=>(t===ce.Int64||t===ce.Uint64)&&(e===Int32Array||e===Uint32Array),MT=(t,e)=>{switch(t){case Int8Array:return ce.Int8;case Int16Array:return ce.Int16;case Int32Array:return e?ce.Int64:ce.Int32;case Dh.BigInt64Array:return ce.Int64;case Uint8Array:return ce.Uint8;case Uint16Array:return ce.Uint16;case Uint32Array:return e?ce.Uint64:ce.Uint32;case Dh.BigUint64Array:return ce.Uint64;default:return null}},PT=(t,e)=>{switch(t){case Qc:return ce.Int8;case Zc:return ce.Int16;case Xc:return e?ce.Int64:ce.Int32;case eu:return ce.Int64;case tu:return ce.Uint8;case ru:return ce.Uint16;case nu:return e?ce.Uint64:ce.Uint32;case iu:return ce.Uint64;default:return null}}});var su=m(ca=>{"use strict";Object.defineProperty(ca,"__esModule",{value:!0});ca.ListVector=void 0;var NT=le(),Eh=class extends NT.BaseVector{};ca.ListVector=Eh});var au=m(ua=>{"use strict";Object.defineProperty(ua,"__esModule",{value:!0});ua.MapVector=void 0;var LT=Kn(),xT=ue(),jT=le(),kT=K(),Uh=class extends jT.BaseVector{asList(){let e=this.type.children[0];return xT.Vector.new(this.data.clone(new kT.List(e)))}bind(e){let r=this.getChildAt(0),{[e]:n,[e+1]:s}=this.valueOffsets;return new LT.MapRow(r.slice(n,s))}};ua.MapVector=Uh});var ou=m(la=>{"use strict";Object.defineProperty(la,"__esModule",{value:!0});la.NullVector=void 0;var CT=le(),Vh=class extends CT.BaseVector{};la.NullVector=Vh});var cu=m(da=>{"use strict";Object.defineProperty(da,"__esModule",{value:!0});da.StructVector=void 0;var qT=Kn(),WT=le(),zT=Symbol.for("rowIndex"),Mh=class extends WT.BaseVector{bind(e){let r=this._row||(this._row=new qT.StructRow(this)),n=Object.create(r);return n[zT]=e,n}};da.StructVector=Mh});var uu=m(Ke=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});Ke.TimestampNanosecondVector=Ke.TimestampMicrosecondVector=Ke.TimestampMillisecondVector=Ke.TimestampSecondVector=Ke.TimestampVector=void 0;var YT=le(),Bn=class extends YT.BaseVector{};Ke.TimestampVector=Bn;var Ph=class extends Bn{};Ke.TimestampSecondVector=Ph;var Nh=class extends Bn{};Ke.TimestampMillisecondVector=Nh;var Lh=class extends Bn{};Ke.TimestampMicrosecondVector=Lh;var xh=class extends Bn{};Ke.TimestampNanosecondVector=xh});var lu=m(Qe=>{"use strict";Object.defineProperty(Qe,"__esModule",{value:!0});Qe.TimeNanosecondVector=Qe.TimeMicrosecondVector=Qe.TimeMillisecondVector=Qe.TimeSecondVector=Qe.TimeVector=void 0;var GT=le(),In=class extends GT.BaseVector{};Qe.TimeVector=In;var jh=class extends In{};Qe.TimeSecondVector=jh;var kh=class extends In{};Qe.TimeMillisecondVector=kh;var Ch=class extends In{};Qe.TimeMicrosecondVector=Ch;var qh=class extends In{};Qe.TimeNanosecondVector=qh});var du=m(mr=>{"use strict";Object.defineProperty(mr,"__esModule",{value:!0});mr.SparseUnionVector=mr.DenseUnionVector=mr.UnionVector=void 0;var HT=le(),fa=class extends HT.BaseVector{get typeIdToChildIndex(){return this.data.type.typeIdToChildIndex}};mr.UnionVector=fa;var Wh=class extends fa{get valueOffsets(){return this.data.valueOffsets}};mr.DenseUnionVector=Wh;var zh=class extends fa{};mr.SparseUnionVector=zh});var fu=m(ha=>{"use strict";Object.defineProperty(ha,"__esModule",{value:!0});ha.Utf8Vector=void 0;var $T=ue(),JT=le(),Yh=K(),KT=At(),Gh=class extends JT.BaseVector{static from(e){return KT.vectorFromValuesWithType(()=>new Yh.Utf8,e)}asBinary(){return $T.Vector.new(this.data.clone(new Yh.Binary))}};ha.Utf8Vector=Gh});var Hh=m(gr=>{"use strict";Object.defineProperty(gr,"__esModule",{value:!0});gr.partial2=gr.partial1=gr.partial0=void 0;function QT(t){return function(){return t(this)}}gr.partial0=QT;function ZT(t){return function(e){return t(this,e)}}gr.partial1=ZT;function XT(t){return function(e,r){return t(this,e,r)}}gr.partial2=XT});var yu=m(wn=>{"use strict";Object.defineProperty(wn,"__esModule",{value:!0});wn.instance=wn.GetVisitor=void 0;var pa=Jn(),eB=ve(),tB=Ir(),rB=Yn(),Ze=ee(),D=class extends eB.Visitor{};wn.GetVisitor=D;var nB=(t,e)=>864e5*t[e],hu=(t,e)=>4294967296*t[e+1]+(t[e]>>>0),iB=(t,e)=>4294967296*(t[e+1]/1e3)+(t[e]>>>0)/1e3,sB=(t,e)=>4294967296*(t[e+1]/1e6)+(t[e]>>>0)/1e6,$h=t=>new Date(t),aB=(t,e)=>$h(nB(t,e)),oB=(t,e)=>$h(hu(t,e)),cB=(t,e)=>null,Jh=(t,e,r)=>{let{[r]:n,[r+1]:s}=e;return n!=null&&s!=null?t.subarray(n,s):null},uB=({offset:t,values:e},r)=>{let n=t+r;return(e[n>>3]&1<<n%8)!=0},Kh=({values:t},e)=>aB(t,e),Qh=({values:t},e)=>oB(t,e*2),Rt=({stride:t,values:e},r)=>e[t*r],Zh=({stride:t,values:e},r)=>rB.uint16ToFloat64(e[t*r]),pu=({stride:t,values:e,type:r},n)=>pa.BN.new(e.subarray(t*n,t*(n+1)),r.isSigned),lB=({stride:t,values:e},r)=>e.subarray(t*r,t*(r+1)),dB=({values:t,valueOffsets:e},r)=>Jh(t,e,r),fB=({values:t,valueOffsets:e},r)=>{let n=Jh(t,e,r);return n!==null?tB.decodeUtf8(n):null},hB=(t,e)=>t.type.bitWidth<64?Rt(t,e):pu(t,e),pB=(t,e)=>t.type.precision!==Ze.Precision.HALF?Rt(t,e):Zh(t,e),yB=(t,e)=>t.type.unit===Ze.DateUnit.DAY?Kh(t,e):Qh(t,e),Xh=({values:t},e)=>1e3*hu(t,e*2),ep=({values:t},e)=>hu(t,e*2),tp=({values:t},e)=>iB(t,e*2),rp=({values:t},e)=>sB(t,e*2),bB=(t,e)=>{switch(t.type.unit){case Ze.TimeUnit.SECOND:return Xh(t,e);case Ze.TimeUnit.MILLISECOND:return ep(t,e);case Ze.TimeUnit.MICROSECOND:return tp(t,e);case Ze.TimeUnit.NANOSECOND:return rp(t,e)}},np=({values:t,stride:e},r)=>t[e*r],ip=({values:t,stride:e},r)=>t[e*r],sp=({values:t},e)=>pa.BN.signed(t.subarray(2*e,2*(e+1))),ap=({values:t},e)=>pa.BN.signed(t.subarray(2*e,2*(e+1))),mB=(t,e)=>{switch(t.type.unit){case Ze.TimeUnit.SECOND:return np(t,e);case Ze.TimeUnit.MILLISECOND:return ip(t,e);case Ze.TimeUnit.MICROSECOND:return sp(t,e);case Ze.TimeUnit.NANOSECOND:return ap(t,e)}},gB=({values:t},e)=>pa.BN.decimal(t.subarray(4*e,4*(e+1))),_B=(t,e)=>{let r=t.getChildAt(0),{valueOffsets:n,stride:s}=t;return r.slice(n[e*s],n[e*s+1])},TB=(t,e)=>t.bind(e),BB=(t,e)=>t.bind(e),IB=(t,e)=>t.type.mode===Ze.UnionMode.Dense?op(t,e):cp(t,e),op=(t,e)=>{let r=t.typeIdToChildIndex[t.typeIds[e]],n=t.getChildAt(r);return n?n.get(t.valueOffsets[e]):null},cp=(t,e)=>{let r=t.typeIdToChildIndex[t.typeIds[e]],n=t.getChildAt(r);return n?n.get(e):null},wB=(t,e)=>t.getValue(t.getKey(e)),vB=(t,e)=>t.type.unit===Ze.IntervalUnit.DAY_TIME?up(t,e):lp(t,e),up=({values:t},e)=>t.subarray(2*e,2*(e+1)),lp=({values:t},e)=>{let r=t[e],n=new Int32Array(2);return n[0]=r/12|0,n[1]=r%12|0,n},SB=(t,e)=>{let r=t.getChildAt(0),{stride:n}=t;return r.slice(e*n,(e+1)*n)};D.prototype.visitNull=cB;D.prototype.visitBool=uB;D.prototype.visitInt=hB;D.prototype.visitInt8=Rt;D.prototype.visitInt16=Rt;D.prototype.visitInt32=Rt;D.prototype.visitInt64=pu;D.prototype.visitUint8=Rt;D.prototype.visitUint16=Rt;D.prototype.visitUint32=Rt;D.prototype.visitUint64=pu;D.prototype.visitFloat=pB;D.prototype.visitFloat16=Zh;D.prototype.visitFloat32=Rt;D.prototype.visitFloat64=Rt;D.prototype.visitUtf8=fB;D.prototype.visitBinary=dB;D.prototype.visitFixedSizeBinary=lB;D.prototype.visitDate=yB;D.prototype.visitDateDay=Kh;D.prototype.visitDateMillisecond=Qh;D.prototype.visitTimestamp=bB;D.prototype.visitTimestampSecond=Xh;D.prototype.visitTimestampMillisecond=ep;D.prototype.visitTimestampMicrosecond=tp;D.prototype.visitTimestampNanosecond=rp;D.prototype.visitTime=mB;D.prototype.visitTimeSecond=np;D.prototype.visitTimeMillisecond=ip;D.prototype.visitTimeMicrosecond=sp;D.prototype.visitTimeNanosecond=ap;D.prototype.visitDecimal=gB;D.prototype.visitList=_B;D.prototype.visitStruct=BB;D.prototype.visitUnion=IB;D.prototype.visitDenseUnion=op;D.prototype.visitSparseUnion=cp;D.prototype.visitDictionary=wB;D.prototype.visitInterval=vB;D.prototype.visitIntervalDayTime=up;D.prototype.visitIntervalYearMonth=lp;D.prototype.visitFixedSizeList=SB;D.prototype.visitMap=TB;wn.instance=new D});var pp=m(vn=>{"use strict";Object.defineProperty(vn,"__esModule",{value:!0});vn.instance=vn.IndexOfVisitor=void 0;var OB=ve(),dp=pt(),fp=Zn(),R=class extends OB.Visitor{};vn.IndexOfVisitor=R;function AB(t,e){return e===null&&t.length>0?0:-1}function FB(t,e){let{nullBitmap:r}=t.data;if(!r||t.nullCount<=0)return-1;let n=0;for(let s of dp.iterateBits(r,t.data.offset+(e||0),t.length,r,dp.getBool)){if(!s)return n;++n}return-1}function C(t,e,r){if(e===void 0)return-1;if(e===null)return FB(t,r);let n=fp.createElementComparator(e);for(let s=(r||0)-1,a=t.length;++s<a;)if(n(t.get(s)))return s;return-1}function hp(t,e,r){let n=fp.createElementComparator(e);for(let s=(r||0)-1,a=t.length;++s<a;)if(n(t.get(s)))return s;return-1}R.prototype.visitNull=AB;R.prototype.visitBool=C;R.prototype.visitInt=C;R.prototype.visitInt8=C;R.prototype.visitInt16=C;R.prototype.visitInt32=C;R.prototype.visitInt64=C;R.prototype.visitUint8=C;R.prototype.visitUint16=C;R.prototype.visitUint32=C;R.prototype.visitUint64=C;R.prototype.visitFloat=C;R.prototype.visitFloat16=C;R.prototype.visitFloat32=C;R.prototype.visitFloat64=C;R.prototype.visitUtf8=C;R.prototype.visitBinary=C;R.prototype.visitFixedSizeBinary=C;R.prototype.visitDate=C;R.prototype.visitDateDay=C;R.prototype.visitDateMillisecond=C;R.prototype.visitTimestamp=C;R.prototype.visitTimestampSecond=C;R.prototype.visitTimestampMillisecond=C;R.prototype.visitTimestampMicrosecond=C;R.prototype.visitTimestampNanosecond=C;R.prototype.visitTime=C;R.prototype.visitTimeSecond=C;R.prototype.visitTimeMillisecond=C;R.prototype.visitTimeMicrosecond=C;R.prototype.visitTimeNanosecond=C;R.prototype.visitDecimal=C;R.prototype.visitList=C;R.prototype.visitStruct=C;R.prototype.visitUnion=C;R.prototype.visitDenseUnion=hp;R.prototype.visitSparseUnion=hp;R.prototype.visitDictionary=C;R.prototype.visitInterval=C;R.prototype.visitIntervalDayTime=C;R.prototype.visitIntervalYearMonth=C;R.prototype.visitFixedSizeList=C;R.prototype.visitMap=C;vn.instance=new R});var bu=m(Sn=>{"use strict";Object.defineProperty(Sn,"__esModule",{value:!0});Sn.instance=Sn.IteratorVisitor=void 0;var ya=ee(),DB=ve(),RB=pt(),yp=yu(),E=class extends DB.Visitor{};Sn.IteratorVisitor=E;function EB(t){let e=yp.instance.getVisitFn(t);return RB.iterateBits(t.data.nullBitmap,t.data.offset,t.length,t,(r,n,s,a)=>(s&1<<a)!=0?e(r,n):null)}function j(t){if(t.nullCount>0)return EB(t);let{type:e,typeId:r,length:n}=t;return t.stride===1&&(r===ya.Type.Timestamp||r===ya.Type.Int&&e.bitWidth!==64||r===ya.Type.Time&&e.bitWidth!==64||r===ya.Type.Float&&e.precision>0)?t.data.values.subarray(0,n)[Symbol.iterator]():function*(s){for(let a=-1;++a<n;)yield s(t,a)}(yp.instance.getVisitFn(t))}E.prototype.visitNull=j;E.prototype.visitBool=j;E.prototype.visitInt=j;E.prototype.visitInt8=j;E.prototype.visitInt16=j;E.prototype.visitInt32=j;E.prototype.visitInt64=j;E.prototype.visitUint8=j;E.prototype.visitUint16=j;E.prototype.visitUint32=j;E.prototype.visitUint64=j;E.prototype.visitFloat=j;E.prototype.visitFloat16=j;E.prototype.visitFloat32=j;E.prototype.visitFloat64=j;E.prototype.visitUtf8=j;E.prototype.visitBinary=j;E.prototype.visitFixedSizeBinary=j;E.prototype.visitDate=j;E.prototype.visitDateDay=j;E.prototype.visitDateMillisecond=j;E.prototype.visitTimestamp=j;E.prototype.visitTimestampSecond=j;E.prototype.visitTimestampMillisecond=j;E.prototype.visitTimestampMicrosecond=j;E.prototype.visitTimestampNanosecond=j;E.prototype.visitTime=j;E.prototype.visitTimeSecond=j;E.prototype.visitTimeMillisecond=j;E.prototype.visitTimeMicrosecond=j;E.prototype.visitTimeNanosecond=j;E.prototype.visitDecimal=j;E.prototype.visitList=j;E.prototype.visitStruct=j;E.prototype.visitUnion=j;E.prototype.visitDenseUnion=j;E.prototype.visitSparseUnion=j;E.prototype.visitDictionary=j;E.prototype.visitInterval=j;E.prototype.visitIntervalDayTime=j;E.prototype.visitIntervalYearMonth=j;E.prototype.visitFixedSizeList=j;E.prototype.visitMap=j;Sn.instance=new E});var bp=m(On=>{"use strict";Object.defineProperty(On,"__esModule",{value:!0});On.instance=On.ToArrayVisitor=void 0;var fi=ee(),UB=ve(),VB=bu(),U=class extends UB.Visitor{};On.ToArrayVisitor=U;function k(t){let{type:e,length:r,stride:n}=t;switch(e.typeId){case fi.Type.Int:case fi.Type.Float:case fi.Type.Decimal:case fi.Type.Time:case fi.Type.Timestamp:return t.data.values.subarray(0,r*n)}return[...VB.instance.visit(t)]}U.prototype.visitNull=k;U.prototype.visitBool=k;U.prototype.visitInt=k;U.prototype.visitInt8=k;U.prototype.visitInt16=k;U.prototype.visitInt32=k;U.prototype.visitInt64=k;U.prototype.visitUint8=k;U.prototype.visitUint16=k;U.prototype.visitUint32=k;U.prototype.visitUint64=k;U.prototype.visitFloat=k;U.prototype.visitFloat16=k;U.prototype.visitFloat32=k;U.prototype.visitFloat64=k;U.prototype.visitUtf8=k;U.prototype.visitBinary=k;U.prototype.visitFixedSizeBinary=k;U.prototype.visitDate=k;U.prototype.visitDateDay=k;U.prototype.visitDateMillisecond=k;U.prototype.visitTimestamp=k;U.prototype.visitTimestampSecond=k;U.prototype.visitTimestampMillisecond=k;U.prototype.visitTimestampMicrosecond=k;U.prototype.visitTimestampNanosecond=k;U.prototype.visitTime=k;U.prototype.visitTimeSecond=k;U.prototype.visitTimeMillisecond=k;U.prototype.visitTimeMicrosecond=k;U.prototype.visitTimeNanosecond=k;U.prototype.visitDecimal=k;U.prototype.visitList=k;U.prototype.visitStruct=k;U.prototype.visitUnion=k;U.prototype.visitDenseUnion=k;U.prototype.visitSparseUnion=k;U.prototype.visitDictionary=k;U.prototype.visitInterval=k;U.prototype.visitIntervalDayTime=k;U.prototype.visitIntervalYearMonth=k;U.prototype.visitFixedSizeList=k;U.prototype.visitMap=k;On.instance=new U});var mp=m(An=>{"use strict";Object.defineProperty(An,"__esModule",{value:!0});An.instance=An.ByteWidthVisitor=void 0;var MB=ve(),PB=ee(),hi=(t,e)=>t+e,mu=t=>`Cannot compute the byte width of variable-width column ${t}`,gu=class extends MB.Visitor{visitNull(e){return 0}visitInt(e){return e.bitWidth/8}visitFloat(e){return e.ArrayType.BYTES_PER_ELEMENT}visitBinary(e){throw new Error(mu(e))}visitUtf8(e){throw new Error(mu(e))}visitBool(e){return 1/8}visitDecimal(e){return 16}visitDate(e){return(e.unit+1)*4}visitTime(e){return e.bitWidth/8}visitTimestamp(e){return e.unit===PB.TimeUnit.SECOND?4:8}visitInterval(e){return(e.unit+1)*4}visitList(e){throw new Error(mu(e))}visitStruct(e){return this.visitFields(e.children).reduce(hi,0)}visitUnion(e){return this.visitFields(e.children).reduce(hi,0)}visitFixedSizeBinary(e){return e.byteWidth}visitFixedSizeList(e){return e.listSize*this.visitFields(e.children).reduce(hi,0)}visitMap(e){return this.visitFields(e.children).reduce(hi,0)}visitDictionary(e){return this.visit(e.indices)}visitFields(e){return(e||[]).map(r=>this.visit(r.type))}visitSchema(e){return this.visitFields(e.fields).reduce(hi,0)}};An.ByteWidthVisitor=gu;An.instance=new gu});var gp=m(Fn=>{"use strict";Object.defineProperty(Fn,"__esModule",{value:!0});Fn.instance=Fn.GetVectorConstructor=void 0;var NB=ve(),LB=xc(),xB=jc(),_u=Cc(),jB=qc(),kB=na(),CB=zc(),qB=Yc(),ba=Jc(),Tu=Kc(),Ct=oa(),WB=su(),zB=au(),YB=ou(),GB=cu(),pi=uu(),yi=lu(),Bu=du(),HB=fu(),Iu=class extends NB.Visitor{visitNull(){return YB.NullVector}visitBool(){return xB.BoolVector}visitInt(){return Ct.IntVector}visitInt8(){return Ct.Int8Vector}visitInt16(){return Ct.Int16Vector}visitInt32(){return Ct.Int32Vector}visitInt64(){return Ct.Int64Vector}visitUint8(){return Ct.Uint8Vector}visitUint16(){return Ct.Uint16Vector}visitUint32(){return Ct.Uint32Vector}visitUint64(){return Ct.Uint64Vector}visitFloat(){return ba.FloatVector}visitFloat16(){return ba.Float16Vector}visitFloat32(){return ba.Float32Vector}visitFloat64(){return ba.Float64Vector}visitUtf8(){return HB.Utf8Vector}visitBinary(){return LB.BinaryVector}visitFixedSizeBinary(){return CB.FixedSizeBinaryVector}visitDate(){return _u.DateVector}visitDateDay(){return _u.DateDayVector}visitDateMillisecond(){return _u.DateMillisecondVector}visitTimestamp(){return pi.TimestampVector}visitTimestampSecond(){return pi.TimestampSecondVector}visitTimestampMillisecond(){return pi.TimestampMillisecondVector}visitTimestampMicrosecond(){return pi.TimestampMicrosecondVector}visitTimestampNanosecond(){return pi.TimestampNanosecondVector}visitTime(){return yi.TimeVector}visitTimeSecond(){return yi.TimeSecondVector}visitTimeMillisecond(){return yi.TimeMillisecondVector}visitTimeMicrosecond(){return yi.TimeMicrosecondVector}visitTimeNanosecond(){return yi.TimeNanosecondVector}visitDecimal(){return jB.DecimalVector}visitList(){return WB.ListVector}visitStruct(){return GB.StructVector}visitUnion(){return Bu.UnionVector}visitDenseUnion(){return Bu.DenseUnionVector}visitSparseUnion(){return Bu.SparseUnionVector}visitDictionary(){return kB.DictionaryVector}visitInterval(){return Tu.IntervalVector}visitIntervalDayTime(){return Tu.IntervalDayTimeVector}visitIntervalYearMonth(){return Tu.IntervalYearMonthVector}visitFixedSizeList(){return qB.FixedSizeListVector}visitMap(){return zB.MapVector}};Fn.GetVectorConstructor=Iu;Fn.instance=new Iu});var At=m(g=>{"use strict";Object.defineProperty(g,"__esModule",{value:!0});g.vectorFromValuesWithType=g.StructRow=g.MapRow=g.Utf8Vector=g.SparseUnionVector=g.DenseUnionVector=g.UnionVector=g.TimeNanosecondVector=g.TimeMicrosecondVector=g.TimeMillisecondVector=g.TimeSecondVector=g.TimeVector=g.TimestampNanosecondVector=g.TimestampMicrosecondVector=g.TimestampMillisecondVector=g.TimestampSecondVector=g.TimestampVector=g.StructVector=g.NullVector=g.MapVector=g.ListVector=g.Uint64Vector=g.Uint32Vector=g.Uint16Vector=g.Uint8Vector=g.Int64Vector=g.Int32Vector=g.Int16Vector=g.Int8Vector=g.IntVector=g.IntervalYearMonthVector=g.IntervalDayTimeVector=g.IntervalVector=g.Float64Vector=g.Float32Vector=g.Float16Vector=g.FloatVector=g.FixedSizeListVector=g.FixedSizeBinaryVector=g.DictionaryVector=g.DecimalVector=g.DateMillisecondVector=g.DateDayVector=g.DateVector=g.Chunked=g.BoolVector=g.BinaryVector=g.BaseVector=g.Vector=void 0;var $B=ue();Object.defineProperty(g,"Vector",{enumerable:!0,get:function(){return $B.Vector}});var JB=le();Object.defineProperty(g,"BaseVector",{enumerable:!0,get:function(){return JB.BaseVector}});var KB=xc();Object.defineProperty(g,"BinaryVector",{enumerable:!0,get:function(){return KB.BinaryVector}});var QB=jc();Object.defineProperty(g,"BoolVector",{enumerable:!0,get:function(){return QB.BoolVector}});var ZB=Zt();Object.defineProperty(g,"Chunked",{enumerable:!0,get:function(){return ZB.Chunked}});var wu=Cc();Object.defineProperty(g,"DateVector",{enumerable:!0,get:function(){return wu.DateVector}});Object.defineProperty(g,"DateDayVector",{enumerable:!0,get:function(){return wu.DateDayVector}});Object.defineProperty(g,"DateMillisecondVector",{enumerable:!0,get:function(){return wu.DateMillisecondVector}});var XB=qc();Object.defineProperty(g,"DecimalVector",{enumerable:!0,get:function(){return XB.DecimalVector}});var eI=na();Object.defineProperty(g,"DictionaryVector",{enumerable:!0,get:function(){return eI.DictionaryVector}});var tI=zc();Object.defineProperty(g,"FixedSizeBinaryVector",{enumerable:!0,get:function(){return tI.FixedSizeBinaryVector}});var rI=Yc();Object.defineProperty(g,"FixedSizeListVector",{enumerable:!0,get:function(){return rI.FixedSizeListVector}});var ma=Jc();Object.defineProperty(g,"FloatVector",{enumerable:!0,get:function(){return ma.FloatVector}});Object.defineProperty(g,"Float16Vector",{enumerable:!0,get:function(){return ma.Float16Vector}});Object.defineProperty(g,"Float32Vector",{enumerable:!0,get:function(){return ma.Float32Vector}});Object.defineProperty(g,"Float64Vector",{enumerable:!0,get:function(){return ma.Float64Vector}});var vu=Kc();Object.defineProperty(g,"IntervalVector",{enumerable:!0,get:function(){return vu.IntervalVector}});Object.defineProperty(g,"IntervalDayTimeVector",{enumerable:!0,get:function(){return vu.IntervalDayTimeVector}});Object.defineProperty(g,"IntervalYearMonthVector",{enumerable:!0,get:function(){return vu.IntervalYearMonthVector}});var qt=oa();Object.defineProperty(g,"IntVector",{enumerable:!0,get:function(){return qt.IntVector}});Object.defineProperty(g,"Int8Vector",{enumerable:!0,get:function(){return qt.Int8Vector}});Object.defineProperty(g,"Int16Vector",{enumerable:!0,get:function(){return qt.Int16Vector}});Object.defineProperty(g,"Int32Vector",{enumerable:!0,get:function(){return qt.Int32Vector}});Object.defineProperty(g,"Int64Vector",{enumerable:!0,get:function(){return qt.Int64Vector}});Object.defineProperty(g,"Uint8Vector",{enumerable:!0,get:function(){return qt.Uint8Vector}});Object.defineProperty(g,"Uint16Vector",{enumerable:!0,get:function(){return qt.Uint16Vector}});Object.defineProperty(g,"Uint32Vector",{enumerable:!0,get:function(){return qt.Uint32Vector}});Object.defineProperty(g,"Uint64Vector",{enumerable:!0,get:function(){return qt.Uint64Vector}});var nI=su();Object.defineProperty(g,"ListVector",{enumerable:!0,get:function(){return nI.ListVector}});var iI=au();Object.defineProperty(g,"MapVector",{enumerable:!0,get:function(){return iI.MapVector}});var sI=ou();Object.defineProperty(g,"NullVector",{enumerable:!0,get:function(){return sI.NullVector}});var aI=cu();Object.defineProperty(g,"StructVector",{enumerable:!0,get:function(){return aI.StructVector}});var bi=uu();Object.defineProperty(g,"TimestampVector",{enumerable:!0,get:function(){return bi.TimestampVector}});Object.defineProperty(g,"TimestampSecondVector",{enumerable:!0,get:function(){return bi.TimestampSecondVector}});Object.defineProperty(g,"TimestampMillisecondVector",{enumerable:!0,get:function(){return bi.TimestampMillisecondVector}});Object.defineProperty(g,"TimestampMicrosecondVector",{enumerable:!0,get:function(){return bi.TimestampMicrosecondVector}});Object.defineProperty(g,"TimestampNanosecondVector",{enumerable:!0,get:function(){return bi.TimestampNanosecondVector}});var mi=lu();Object.defineProperty(g,"TimeVector",{enumerable:!0,get:function(){return mi.TimeVector}});Object.defineProperty(g,"TimeSecondVector",{enumerable:!0,get:function(){return mi.TimeSecondVector}});Object.defineProperty(g,"TimeMillisecondVector",{enumerable:!0,get:function(){return mi.TimeMillisecondVector}});Object.defineProperty(g,"TimeMicrosecondVector",{enumerable:!0,get:function(){return mi.TimeMicrosecondVector}});Object.defineProperty(g,"TimeNanosecondVector",{enumerable:!0,get:function(){return mi.TimeNanosecondVector}});var Su=du();Object.defineProperty(g,"UnionVector",{enumerable:!0,get:function(){return Su.UnionVector}});Object.defineProperty(g,"DenseUnionVector",{enumerable:!0,get:function(){return Su.DenseUnionVector}});Object.defineProperty(g,"SparseUnionVector",{enumerable:!0,get:function(){return Su.SparseUnionVector}});var oI=fu();Object.defineProperty(g,"Utf8Vector",{enumerable:!0,get:function(){return oI.Utf8Vector}});var _p=Kn();Object.defineProperty(g,"MapRow",{enumerable:!0,get:function(){return _p.MapRow}});Object.defineProperty(g,"StructRow",{enumerable:!0,get:function(){return _p.StructRow}});var gi=Hh(),Ou=ee(),Dn=ue(),Tp=Zt(),Pr=le(),cI=pt(),ga=Ae(),Bp=ae(),Ip=yu(),wp=zo(),vp=pp(),Sp=bp(),Op=bu(),Ap=mp(),Fp=gp();Dn.Vector.new=uI;Dn.Vector.from=dI;function uI(t,...e){return new(Fp.instance.getVisitFn(t)())(t,...e)}function lI(t,e){if(ga.isIterable(e))return Dn.Vector.from({nullValues:[null,void 0],type:t(),values:e});if(ga.isAsyncIterable(e))return Dn.Vector.from({nullValues:[null,void 0],type:t(),values:e});let{values:r=[],type:n=t(),nullValues:s=[null,void 0]}={...e};return ga.isIterable(r)?Dn.Vector.from({nullValues:s,...e,type:n}):Dn.Vector.from({nullValues:s,...e,type:n})}g.vectorFromValuesWithType=lI;function dI(t){let{values:e=[],...r}={nullValues:[null,void 0],...t};if(ga.isIterable(e)){let n=[...Bp.Builder.throughIterable(r)(e)];return n.length===1?n[0]:Tp.Chunked.concat(n)}return(async n=>{let s=Bp.Builder.throughAsyncIterable(r);for await(let a of s(e))n.push(a);return n.length===1?n[0]:Tp.Chunked.concat(n)})([])}Pr.BaseVector.prototype.get=function(e){return Ip.instance.visit(this,e)};Pr.BaseVector.prototype.set=function(e,r){return wp.instance.visit(this,e,r)};Pr.BaseVector.prototype.indexOf=function(e,r){return vp.instance.visit(this,e,r)};Pr.BaseVector.prototype.toArray=function(){return Sp.instance.visit(this)};Pr.BaseVector.prototype.getByteWidth=function(){return Ap.instance.visit(this.type)};Pr.BaseVector.prototype[Symbol.iterator]=function(){return Op.instance.visit(this)};Pr.BaseVector.prototype._bindDataAccessors=yI;Object.keys(Ou.Type).map(t=>Ou.Type[t]).filter(t=>typeof t=="number").filter(t=>t!==Ou.Type.NONE).forEach(t=>{let e=Fp.instance.visit(t);e.prototype.get=gi.partial1(Ip.instance.getVisitFn(t)),e.prototype.set=gi.partial2(wp.instance.getVisitFn(t)),e.prototype.indexOf=gi.partial2(vp.instance.getVisitFn(t)),e.prototype.toArray=gi.partial0(Sp.instance.getVisitFn(t)),e.prototype.getByteWidth=fI(Ap.instance.getVisitFn(t)),e.prototype[Symbol.iterator]=gi.partial0(Op.instance.getVisitFn(t))});function fI(t){return function(){return t(this.type)}}function hI(t){return function(e){return this.isValid(e)?t.call(this,e):null}}function pI(t){return function(e,r){cI.setBool(this.nullBitmap,this.offset+e,r!=null)&&t.call(this,e,r)}}function yI(){let t=this.nullBitmap;t&&t.byteLength>0&&(this.get=hI(this.get),this.set=pI(this.set))}});var li=m(_a=>{"use strict";Object.defineProperty(_a,"__esModule",{value:!0});_a.Table=void 0;var bI=sn(),Dp=_e(),Au=kt(),mI=_i(),Fu=K(),Rp=Xt(),Du=Ae(),Ep=Ks(),Up=Pc(),Ru=At(),Ie=class extends Ru.Chunked{constructor(...e){let r=null;e[0]instanceof Dp.Schema&&(r=e.shift());let n=Rp.selectArgs(Au.RecordBatch,e);if(!r&&!(r=n[0]&&n[0].schema))throw new TypeError("Table must be initialized with a Schema or at least one RecordBatch");n[0]||(n[0]=new Au._InternalEmptyPlaceholderRecordBatch(r));super(new Fu.Struct(r.fields),n);this._schema=r,this._chunks=n}static empty(e=new Dp.Schema([])){return new Ie(e,[])}static from(e){if(!e)return Ie.empty();if(typeof e=="object"){let n=Du.isIterable(e.values)?gI(e):Du.isAsyncIterable(e.values)?_I(e):null;if(n!==null)return n}let r=mI.RecordBatchReader.from(e);return Du.isPromise(r)?(async()=>await Ie.from(await r))():r.isSync()&&(r=r.open())?r.schema?new Ie(r.schema,[...r]):Ie.empty():(async n=>{let s=await n,a=s.schema,o=[];if(a){for await(let c of s)o.push(c);return new Ie(a,o)}return Ie.empty()})(r.open())}static async fromAsync(e){return await Ie.from(e)}static fromStruct(e){return Ie.new(e.data.childData,e.type.children)}static new(...e){return new Ie(...Up.distributeColumnsIntoRecordBatches(Rp.selectColumnArgs(e)))}get schema(){return this._schema}get length(){return this._length}get chunks(){return this._chunks}get numCols(){return this._numChildren}clone(e=this._chunks){return new Ie(this._schema,e)}getColumn(e){return this.getColumnAt(this.getColumnIndex(e))}getColumnAt(e){return this.getChildAt(e)}getColumnIndex(e){return this._schema.fields.findIndex(r=>r.name===e)}getChildAt(e){if(e<0||e>=this.numChildren)return null;let r,n,s=this._schema.fields,a=this._children||(this._children=[]);if(n=a[e])return n;if(r=s[e]){let o=this._chunks.map(c=>c.getChildAt(e)).filter(c=>c!=null);if(o.length>0)return a[e]=new bI.Column(r,o)}return null}serialize(e="binary",r=!0){return(r?Ep.RecordBatchStreamWriter:Ep.RecordBatchFileWriter).writeAll(this).toUint8Array(!0)}count(){return this._length}select(...e){let r=this._schema.fields.reduce((n,s,a)=>n.set(s.name,a),new Map);return this.selectAt(...e.map(n=>r.get(n)).filter(n=>n>-1))}selectAt(...e){let r=this._schema.selectAt(...e);return new Ie(r,this._chunks.map(({length:n,data:{childData:s}})=>new Au.RecordBatch(r,n,e.map(a=>s[a]).filter(Boolean))))}assign(e){let r=this._schema.fields,[n,s]=e.schema.fields.reduce((c,f,i)=>{let[u,y]=c,N=r.findIndex(Z=>Z.name===f.name);return~N?y[N]=i:u.push(i),c},[[],[]]),a=this._schema.assign(e.schema),o=[...r.map((c,f,i,u=s[f])=>u===void 0?this.getColumnAt(f):e.getColumnAt(u)),...n.map(c=>e.getColumnAt(c))].filter(Boolean);return new Ie(...Up.distributeVectorsIntoRecordBatches(a,o))}};_a.Table=Ie;function gI(t){let{type:e}=t;return e instanceof Fu.Struct?Ie.fromStruct(Ru.StructVector.from(t)):null}function _I(t){let{type:e}=t;return e instanceof Fu.Struct?Ru.StructVector.from(t).then(r=>Ie.fromStruct(r)):null}});var kt=m(Rn=>{"use strict";Object.defineProperty(Rn,"__esModule",{value:!0});Rn._InternalEmptyPlaceholderRecordBatch=Rn.RecordBatch=void 0;var Eu=st(),Uu=li(),TI=ue(),BI=ve(),II=_e(),wI=Ae(),vI=Zt(),SI=Xt(),Vu=K(),OI=Pc(),AI=At(),_r=class extends AI.StructVector{constructor(...e){let r,n=e[0],s;if(e[1]instanceof Eu.Data)[,r,s]=e;else{let a=n.fields,[,o,c]=e;r=Eu.Data.Struct(new Vu.Struct(a),0,o,0,null,c)}super(r,s);this._schema=n}static from(e){return wI.isIterable(e.values),Uu.Table.from(e)}static new(...e){let[r,n]=SI.selectFieldArgs(e),s=n.filter(a=>a instanceof TI.Vector);return new _r(...OI.ensureSameLengthData(new II.Schema(r),s.map(a=>a.data)))}clone(e,r=this._children){return new _r(this._schema,e,r)}concat(...e){let r=this._schema,n=vI.Chunked.flatten(this,...e);return new Uu.Table(r,n.map(({data:s})=>new _r(r,s)))}get schema(){return this._schema}get numCols(){return this._schema.fields.length}get dictionaries(){return this._dictionaries||(this._dictionaries=Ta.collect(this))}select(...e){let r=this._schema.fields.reduce((n,s,a)=>n.set(s.name,a),new Map);return this.selectAt(...e.map(n=>r.get(n)).filter(n=>n>-1))}selectAt(...e){let r=this._schema.selectAt(...e),n=e.map(s=>this.data.childData[s]).filter(Boolean);return new _r(r,this.length,n)}};Rn.RecordBatch=_r;var Vp=class extends _r{constructor(e){super(e,0,e.fields.map(r=>Eu.Data.new(r.type,0,0,0)))}};Rn._InternalEmptyPlaceholderRecordBatch=Vp;var Ta=class extends BI.Visitor{constructor(){super(...arguments);this.dictionaries=new Map}static collect(e){return new Ta().visit(e.data,new Vu.Struct(e.schema.fields)).dictionaries}visit(e,r){return Vu.DataType.isDictionary(r)?this.visitDictionary(e,r):(e.childData.forEach((n,s)=>this.visit(n,r.children[s].type)),this)}visitDictionary(e,r){let n=e.dictionary;return n&&n.length>0&&this.dictionaries.set(r.id,n),this}}});var _i=m(tt=>{"use strict";Object.defineProperty(tt,"__esModule",{value:!0});tt.AsyncRecordBatchFileReader=tt.RecordBatchFileReader=tt.AsyncRecordBatchStreamReader=tt.RecordBatchStreamReader=tt.RecordBatchReader=void 0;var Mp=ue(),Ba=ee(),Pp=rc(),Np=jn(),Lp=or(),Ti=sc(),xp=Ef(),Mu=kt(),Nr=qr(),Xe=ks(),et=Ae(),Et=class extends Nr.ReadableInterop{constructor(e){super();this._impl=e}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(e){return this._impl.throw(e)}return(e){return this._impl.return(e)}cancel(){return this._impl.cancel()}reset(e){return this._impl.reset(e),this._DOMStream=void 0,this._nodeStream=void 0,this}open(e){let r=this._impl.open(e);return et.isPromise(r)?r.then(()=>this):this}readRecordBatch(e){return this._impl.isFile()?this._impl.readRecordBatch(e):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return Np.default.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return Np.default.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e,r){throw new Error('"throughDOM" not available in this environment')}static from(e){return e instanceof Et?e:et.isArrowJSON(e)?FI(e):et.isFileHandle(e)?EI(e):et.isPromise(e)?(async()=>await Et.from(await e))():et.isFetchResponse(e)||et.isReadableDOMStream(e)||et.isReadableNodeStream(e)||et.isAsyncIterable(e)?RI(new Lp.AsyncByteStream(e)):DI(new Lp.ByteStream(e))}static readAll(e){return e instanceof Et?e.isSync()?qp(e):Wp(e):et.isArrowJSON(e)||ArrayBuffer.isView(e)||et.isIterable(e)||et.isIteratorResult(e)?qp(e):Wp(e)}};tt.RecordBatchReader=Et;var En=class extends Et{constructor(e){super(e);this._impl=e}[Symbol.iterator](){return this._impl[Symbol.iterator]()}async*[Symbol.asyncIterator](){yield*this[Symbol.iterator]()}};tt.RecordBatchStreamReader=En;var Un=class extends Et{constructor(e){super(e);this._impl=e}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}};tt.AsyncRecordBatchStreamReader=Un;var Ia=class extends En{constructor(e){super(e);this._impl=e}};tt.RecordBatchFileReader=Ia;var Pu=class extends Un{constructor(e){super(e);this._impl=e}};tt.AsyncRecordBatchFileReader=Pu;var Nu=class{constructor(e=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=e}get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(e){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=e,this.dictionaries=new Map,this}_loadRecordBatch(e,r){return new Mu.RecordBatch(this.schema,e.length,this._loadVectors(e,r,this.schema.fields))}_loadDictionaryBatch(e,r){let{id:n,isDelta:s,data:a}=e,{dictionaries:o,schema:c}=this,f=o.get(n);if(s||!f){let i=c.dictionaries.get(n);return f&&s?f.concat(Mp.Vector.new(this._loadVectors(a,r,[i])[0])):Mp.Vector.new(this._loadVectors(a,r,[i])[0])}return f}_loadVectors(e,r,n){return new xp.VectorLoader(r,e.nodes,e.buffers,this.dictionaries).visitMany(n)}},Bi=class extends Nu{constructor(e,r){super(r);this._reader=et.isArrowJSON(e)?new Xe.JSONMessageReader(this._handle=e):new Xe.MessageReader(this._handle=e)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(e){return this.closed||(this.autoDestroy=Cp(this,e),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(e):Nr.ITERATOR_DONE}return(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(e):Nr.ITERATOR_DONE}next(){if(this.closed)return Nr.ITERATOR_DONE;let e,{_reader:r}=this;for(;e=this._readNextMessageAndValidate();)if(e.isSchema())this.reset(e.header());else if(e.isRecordBatch()){this._recordBatchIndex++;let n=e.header(),s=r.readMessageBody(e.bodyLength),a=this._loadRecordBatch(n,s);return{done:!1,value:a}}else if(e.isDictionaryBatch()){this._dictionaryIndex++;let n=e.header(),s=r.readMessageBody(e.bodyLength),a=this._loadDictionaryBatch(n,s);this.dictionaries.set(n.id,a)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new Mu._InternalEmptyPlaceholderRecordBatch(this.schema)}):this.return()}_readNextMessageAndValidate(e){return this._reader.readMessage(e)}},Ii=class extends Nu{constructor(e,r){super(r);this._reader=new Xe.AsyncMessageReader(this._handle=e)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}async cancel(){!this.closed&&(this.closed=!0)&&(await this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}async open(e){return this.closed||(this.autoDestroy=Cp(this,e),this.schema||(this.schema=await this._reader.readSchema())||await this.cancel()),this}async throw(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?await this.reset()._reader.throw(e):Nr.ITERATOR_DONE}async return(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?await this.reset()._reader.return(e):Nr.ITERATOR_DONE}async next(){if(this.closed)return Nr.ITERATOR_DONE;let e,{_reader:r}=this;for(;e=await this._readNextMessageAndValidate();)if(e.isSchema())await this.reset(e.header());else if(e.isRecordBatch()){this._recordBatchIndex++;let n=e.header(),s=await r.readMessageBody(e.bodyLength),a=this._loadRecordBatch(n,s);return{done:!1,value:a}}else if(e.isDictionaryBatch()){this._dictionaryIndex++;let n=e.header(),s=await r.readMessageBody(e.bodyLength),a=this._loadDictionaryBatch(n,s);this.dictionaries.set(n.id,a)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new Mu._InternalEmptyPlaceholderRecordBatch(this.schema)}):await this.return()}async _readNextMessageAndValidate(e){return await this._reader.readMessage(e)}},Lu=class extends Bi{constructor(e,r){super(e instanceof Ti.RandomAccessFile?e:new Ti.RandomAccessFile(e),r)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(e){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(let r of this._footer.dictionaryBatches())r&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(e)}readRecordBatch(e){if(this.closed)return null;this._footer||this.open();let r=this._footer&&this._footer.getRecordBatch(e);if(r&&this._handle.seek(r.offset)){let n=this._reader.readMessage(Ba.MessageHeader.RecordBatch);if(n&&n.isRecordBatch()){let s=n.header(),a=this._reader.readMessageBody(n.bodyLength);return this._loadRecordBatch(s,a)}}return null}_readDictionaryBatch(e){let r=this._footer&&this._footer.getDictionaryBatch(e);if(r&&this._handle.seek(r.offset)){let n=this._reader.readMessage(Ba.MessageHeader.DictionaryBatch);if(n&&n.isDictionaryBatch()){let s=n.header(),a=this._reader.readMessageBody(n.bodyLength),o=this._loadDictionaryBatch(s,a);this.dictionaries.set(s.id,o)}}}_readFooter(){let{_handle:e}=this,r=e.size-Xe.magicAndPadding,n=e.readInt32(r),s=e.readAt(r-n,n);return Pp.Footer.decode(s)}_readNextMessageAndValidate(e){if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){let r=this._footer&&this._footer.getRecordBatch(this._recordBatchIndex);if(r&&this._handle.seek(r.offset))return this._reader.readMessage(e)}return null}},jp=class extends Ii{constructor(e,...r){let n=typeof r[0]!="number"?r.shift():void 0,s=r[0]instanceof Map?r.shift():void 0;super(e instanceof Ti.AsyncRandomAccessFile?e:new Ti.AsyncRandomAccessFile(e,n),s)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}async open(e){if(!this.closed&&!this._footer){this.schema=(this._footer=await this._readFooter()).schema;for(let r of this._footer.dictionaryBatches())r&&await this._readDictionaryBatch(this._dictionaryIndex++)}return await super.open(e)}async readRecordBatch(e){if(this.closed)return null;this._footer||await this.open();let r=this._footer&&this._footer.getRecordBatch(e);if(r&&await this._handle.seek(r.offset)){let n=await this._reader.readMessage(Ba.MessageHeader.RecordBatch);if(n&&n.isRecordBatch()){let s=n.header(),a=await this._reader.readMessageBody(n.bodyLength);return this._loadRecordBatch(s,a)}}return null}async _readDictionaryBatch(e){let r=this._footer&&this._footer.getDictionaryBatch(e);if(r&&await this._handle.seek(r.offset)){let n=await this._reader.readMessage(Ba.MessageHeader.DictionaryBatch);if(n&&n.isDictionaryBatch()){let s=n.header(),a=await this._reader.readMessageBody(n.bodyLength),o=this._loadDictionaryBatch(s,a);this.dictionaries.set(s.id,o)}}}async _readFooter(){let{_handle:e}=this;e._pending&&await e._pending;let r=e.size-Xe.magicAndPadding,n=await e.readInt32(r),s=await e.readAt(r-n,n);return Pp.Footer.decode(s)}async _readNextMessageAndValidate(e){if(this._footer||await this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){let r=this._footer.getRecordBatch(this._recordBatchIndex);if(r&&await this._handle.seek(r.offset))return await this._reader.readMessage(e)}return null}},kp=class extends Bi{constructor(e,r){super(e,r)}_loadVectors(e,r,n){return new xp.JSONVectorLoader(r,e.nodes,e.buffers,this.dictionaries).visitMany(n)}};function Cp(t,e){return e&&typeof e.autoDestroy=="boolean"?e.autoDestroy:t.autoDestroy}function*qp(t){let e=Et.from(t);try{if(!e.open({autoDestroy:!1}).closed)do yield e;while(!e.reset().open().closed)}finally{e.cancel()}}async function*Wp(t){let e=await Et.from(t);try{if(!(await e.open({autoDestroy:!1})).closed)do yield e;while(!(await e.reset().open()).closed)}finally{await e.cancel()}}function FI(t){return new En(new kp(t))}function DI(t){let e=t.peek(Xe.magicLength+7&~7);return e&&e.byteLength>=4?Xe.checkForMagicArrowString(e)?new Ia(new Lu(t.read())):new En(new Bi(t)):new En(new Bi(function*(){}()))}async function RI(t){let e=await t.peek(Xe.magicLength+7&~7);return e&&e.byteLength>=4?Xe.checkForMagicArrowString(e)?new Ia(new Lu(await t.read())):new Un(new Ii(t)):new Un(new Ii(async function*(){}()))}async function EI(t){let{size:e}=await t.stat(),r=new Ti.AsyncRandomAccessFile(t,e);return e>=Xe.magicX2AndPadding&&Xe.checkForMagicArrowString(await r.readAt(0,Xe.magicLength+7&~7))?new Pu(new jp(r)):new Un(new Ii(r))}});var Gp=m(wa=>{"use strict";Object.defineProperty(wa,"__esModule",{value:!0});wa.toDOMStream=void 0;var zp=de(),Yp=Ae();function UI(t,e){if(Yp.isAsyncIterable(t))return MI(t,e);if(Yp.isIterable(t))return VI(t,e);throw new Error("toDOMStream() must be called with an Iterable or AsyncIterable")}wa.toDOMStream=UI;function VI(t,e){let r=null,n=e&&e.type==="bytes"||!1,s=e&&e.highWaterMark||2**24;return new ReadableStream({...e,start(o){a(o,r||(r=t[Symbol.iterator]()))},pull(o){r?a(o,r):o.close()},cancel(){(r&&r.return&&r.return()||!0)&&(r=null)}},{highWaterMark:n?s:void 0,...e});function a(o,c){let f,i=null,u=o.desiredSize||null;for(;!(i=c.next(n?u:null)).done;)if(ArrayBuffer.isView(i.value)&&(f=zp.toUint8Array(i.value))&&(u!=null&&n&&(u=u-f.byteLength+1),i.value=f),o.enqueue(i.value),u!=null&&--u<=0)return;o.close()}}function MI(t,e){let r=null,n=e&&e.type==="bytes"||!1,s=e&&e.highWaterMark||2**24;return new ReadableStream({...e,async start(o){await a(o,r||(r=t[Symbol.asyncIterator]()))},async pull(o){r?await a(o,r):o.close()},async cancel(){(r&&r.return&&await r.return()||!0)&&(r=null)}},{highWaterMark:n?s:void 0,...e});async function a(o,c){let f,i=null,u=o.desiredSize||null;for(;!(i=await c.next(n?u:null)).done;)if(ArrayBuffer.isView(i.value)&&(f=zp.toUint8Array(i.value))&&(u!=null&&n&&(u=u-f.byteLength+1),i.value=f),o.enqueue(i.value),u!=null&&--u<=0)return;o.close()}}});var Jp=m(Vn=>{"use strict";Object.defineProperty(Vn,"__esModule",{value:!0});Vn.BuilderTransform=Vn.builderThroughDOMStream=void 0;var PI=As();function NI(t){return new xu(t)}Vn.builderThroughDOMStream=NI;var xu=class{constructor(e){this._numChunks=0,this._finished=!1,this._bufferedSize=0;let{["readableStrategy"]:r,["writableStrategy"]:n,["queueingStrategy"]:s="count",...a}=e;this._controller=null,this._builder=PI.Builder.new(a),this._getSize=s!=="bytes"?Hp:$p;let{["highWaterMark"]:o=s==="bytes"?2**14:1e3}={...r},{["highWaterMark"]:c=s==="bytes"?2**14:1e3}={...n};this.readable=new ReadableStream({cancel:()=>{this._builder.clear()},pull:f=>{this._maybeFlush(this._builder,this._controller=f)},start:f=>{this._maybeFlush(this._builder,this._controller=f)}},{highWaterMark:o,size:s!=="bytes"?Hp:$p}),this.writable=new WritableStream({abort:()=>{this._builder.clear()},write:()=>{this._maybeFlush(this._builder,this._controller)},close:()=>{this._maybeFlush(this._builder.finish(),this._controller)}},{highWaterMark:c,size:f=>this._writeValueAndReturnChunkSize(f)})}_writeValueAndReturnChunkSize(e){let r=this._bufferedSize;return this._bufferedSize=this._getSize(this._builder.append(e)),this._bufferedSize-r}_maybeFlush(e,r){r!==null&&(this._bufferedSize>=r.desiredSize&&++this._numChunks&&this._enqueue(r,e.toVector()),e.finished&&((e.length>0||this._numChunks===0)&&++this._numChunks&&this._enqueue(r,e.toVector()),!this._finished&&(this._finished=!0)&&this._enqueue(r,null)))}_enqueue(e,r){this._bufferedSize=0,this._controller=null,r===null?e.close():e.enqueue(r)}};Vn.BuilderTransform=xu;var Hp=t=>t.length,$p=t=>t.byteLength});var Kp=m(va=>{"use strict";Object.defineProperty(va,"__esModule",{value:!0});va.recordBatchReaderThroughDOMStream=void 0;var LI=or(),xI=_i();function jI(t,e){let r=new LI.AsyncByteQueue,n=null,s=new ReadableStream({async cancel(){await r.close()},async start(c){await o(c,n||(n=await a()))},async pull(c){n?await o(c,n):c.close()}});return{writable:new WritableStream(r,{highWaterMark:2**14,...t}),readable:s};async function a(){return await(await xI.RecordBatchReader.from(r)).open(e)}async function o(c,f){let i=c.desiredSize,u=null;for(;!(u=await f.next()).done;)if(c.enqueue(u.value),i!=null&&--i<=0)return;c.close()}}va.recordBatchReaderThroughDOMStream=jI});var Qp=m(Sa=>{"use strict";Object.defineProperty(Sa,"__esModule",{value:!0});Sa.recordBatchWriterThroughDOMStream=void 0;var kI=or();function CI(t,e){let r=new this(t),n=new kI.AsyncByteStream(r),s=new ReadableStream({type:"bytes",async cancel(){await n.cancel()},async pull(o){await a(o)},async start(o){await a(o)}},{highWaterMark:2**14,...e});return{writable:new WritableStream(r,t),readable:s};async function a(o){let c=null,f=o.desiredSize;for(;c=await n.read(f||null);)if(o.enqueue(c),f!=null&&(f-=c.byteLength)<=0)return;o.close()}}Sa.recordBatchWriterThroughDOMStream=CI});var zu=m(q=>{"use strict";Object.defineProperty(q,"__esModule",{value:!0});q.custom=q.or=q.and=q.col=q.lit=q.CustomPredicate=q.Not=q.GTeq=q.LTeq=q.Equals=q.Or=q.And=q.CombinationPredicate=q.ComparisonPredicate=q.Predicate=q.Col=q.Literal=q.Value=void 0;var qI=na(),Tr=class{eq(e){return e instanceof Tr||(e=new Wt(e)),new ku(this,e)}le(e){return e instanceof Tr||(e=new Wt(e)),new Cu(this,e)}ge(e){return e instanceof Tr||(e=new Wt(e)),new qu(this,e)}lt(e){return new Ln(this.ge(e))}gt(e){return new Ln(this.le(e))}ne(e){return new Ln(this.eq(e))}};q.Value=Tr;var Wt=class extends Tr{constructor(e){super();this.v=e}};q.Literal=Wt;var ju=class extends Tr{constructor(e){super();this.name=e}bind(e){if(!this.colidx){this.colidx=-1;let n=e.schema.fields;for(let s=-1;++s<n.length;)if(n[s].name===this.name){this.colidx=s;break}if(this.colidx<0)throw new Error(`Failed to bind Col "${this.name}"`)}let r=this.vector=e.getChildAt(this.colidx);return n=>r.get(n)}};q.Col=ju;var Mn=class{and(...e){return new Pn(this,...e)}or(...e){return new Nn(this,...e)}not(){return new Ln(this)}};q.Predicate=Mn;var wi=class extends Mn{constructor(e,r){super();this.left=e,this.right=r}bind(e){return this.left instanceof Wt?this.right instanceof Wt?this._bindLitLit(e,this.left,this.right):this._bindLitCol(e,this.left,this.right):this.right instanceof Wt?this._bindColLit(e,this.left,this.right):this._bindColCol(e,this.left,this.right)}};q.ComparisonPredicate=wi;var vi=class extends Mn{constructor(...e){super();this.children=e}};q.CombinationPredicate=vi;vi.prototype.children=Object.freeze([]);var Pn=class extends vi{constructor(...e){e=e.reduce((r,n)=>r.concat(n instanceof Pn?n.children:n),[]);super(...e)}bind(e){let r=this.children.map(n=>n.bind(e));return(n,s)=>r.every(a=>a(n,s))}};q.And=Pn;var Nn=class extends vi{constructor(...e){e=e.reduce((r,n)=>r.concat(n instanceof Nn?n.children:n),[]);super(...e)}bind(e){let r=this.children.map(n=>n.bind(e));return(n,s)=>r.some(a=>a(n,s))}};q.Or=Nn;var ku=class extends wi{_bindLitLit(e,r,n){let s=r.v==n.v;return()=>s}_bindColCol(e,r,n){let s=r.bind(e),a=n.bind(e);return(o,c)=>s(o,c)==a(o,c)}_bindColLit(e,r,n){let s=r.bind(e);if(r.vector instanceof qI.DictionaryVector){let a,o=r.vector;return o.dictionary!==this.lastDictionary?(a=o.reverseLookup(n.v),this.lastDictionary=o.dictionary,this.lastKey=a):a=this.lastKey,a===-1?()=>!1:c=>o.getKey(c)===a}else return(a,o)=>s(a,o)==n.v}_bindLitCol(e,r,n){return this._bindColLit(e,n,r)}};q.Equals=ku;var Cu=class extends wi{_bindLitLit(e,r,n){let s=r.v<=n.v;return()=>s}_bindColCol(e,r,n){let s=r.bind(e),a=n.bind(e);return(o,c)=>s(o,c)<=a(o,c)}_bindColLit(e,r,n){let s=r.bind(e);return(a,o)=>s(a,o)<=n.v}_bindLitCol(e,r,n){let s=n.bind(e);return(a,o)=>r.v<=s(a,o)}};q.LTeq=Cu;var qu=class extends wi{_bindLitLit(e,r,n){let s=r.v>=n.v;return()=>s}_bindColCol(e,r,n){let s=r.bind(e),a=n.bind(e);return(o,c)=>s(o,c)>=a(o,c)}_bindColLit(e,r,n){let s=r.bind(e);return(a,o)=>s(a,o)>=n.v}_bindLitCol(e,r,n){let s=n.bind(e);return(a,o)=>r.v>=s(a,o)}};q.GTeq=qu;var Ln=class extends Mn{constructor(e){super();this.child=e}bind(e){let r=this.child.bind(e);return(n,s)=>!r(n,s)}};q.Not=Ln;var Wu=class extends Mn{constructor(e,r){super();this.next=e,this.bind_=r}bind(e){return this.bind_(e),this.next}};q.CustomPredicate=Wu;function WI(t){return new Wt(t)}q.lit=WI;function zI(t){return new ju(t)}q.col=zI;function YI(...t){return new Pn(...t)}q.and=YI;function GI(...t){return new Nn(...t)}q.or=GI;function HI(t,e){return new Wu(t,e)}q.custom=HI});var ty=m(Br=>{"use strict";Object.defineProperty(Br,"__esModule",{value:!0});Br.FilteredDataFrame=Br.CountByResult=Br.DataFrame=void 0;var xn=li(),Zp=oa(),Yu=_e(),Xp=zu(),$I=kt(),ey=K();xn.Table.prototype.countBy=function(t){return new Lr(this.chunks).countBy(t)};xn.Table.prototype.scan=function(t,e){return new Lr(this.chunks).scan(t,e)};xn.Table.prototype.scanReverse=function(t,e){return new Lr(this.chunks).scanReverse(t,e)};xn.Table.prototype.filter=function(t){return new Lr(this.chunks).filter(t)};var Lr=class extends xn.Table{filter(e){return new Si(this.chunks,e)}scan(e,r){let n=this.chunks,s=n.length;for(let a=-1;++a<s;){let o=n[a];r&&r(o);for(let c=-1,f=o.length;++c<f;)e(c,o)}}scanReverse(e,r){let n=this.chunks,s=n.length;for(let a=s;--a>=0;){let o=n[a];r&&r(o);for(let c=o.length;--c>=0;)e(c,o)}}countBy(e){let r=this.chunks,n=r.length,s=typeof e=="string"?new Xp.Col(e):e;s.bind(r[n-1]);let a=s.vector;if(!ey.DataType.isDictionary(a.type))throw new Error("countBy currently only supports dictionary-encoded columns");let o=Math.ceil(Math.log(a.length)/Math.log(256)),c=o==4?Uint32Array:o>=2?Uint16Array:Uint8Array,f=new c(a.dictionary.length);for(let i=-1;++i<n;){let u=r[i];s.bind(u);let y=s.vector.indices;for(let N=-1,Z=u.length;++N<Z;){let ke=y.get(N);ke!==null&&f[ke]++}}return new Oa(a.dictionary,Zp.IntVector.from(f))}};Br.DataFrame=Lr;var Oa=class extends xn.Table{constructor(e,r){let n=new Yu.Schema([new Yu.Field("values",e.type),new Yu.Field("counts",r.type)]);super(new $I.RecordBatch(n,r.length,[e,r]))}toJSON(){let e=this.getColumnAt(0),r=this.getColumnAt(1),n={};for(let s=-1;++s<this.length;)n[e.get(s)]=r.get(s);return n}};Br.CountByResult=Oa;var Si=class extends Lr{constructor(e,r){super(e);this._predicate=r}scan(e,r){let n=this._chunks,s=n.length;for(let a=-1;++a<s;){let o=n[a],c=this._predicate.bind(o),f=!1;for(let i=-1,u=o.length;++i<u;)c(i,o)&&(r&&!f&&(r(o),f=!0),e(i,o))}}scanReverse(e,r){let n=this._chunks,s=n.length;for(let a=s;--a>=0;){let o=n[a],c=this._predicate.bind(o),f=!1;for(let i=o.length;--i>=0;)c(i,o)&&(r&&!f&&(r(o),f=!0),e(i,o))}}count(){let e=0,r=this._chunks,n=r.length;for(let s=-1;++s<n;){let a=r[s],o=this._predicate.bind(a);for(let c=-1,f=a.length;++c<f;)o(c,a)&&++e}return e}*[Symbol.iterator](){let e=this._chunks,r=e.length;for(let n=-1;++n<r;){let s=e[n],a=this._predicate.bind(s);for(let o=-1,c=s.length;++o<c;)a(o,s)&&(yield s.get(o))}}filter(e){return new Si(this._chunks,this._predicate.and(e))}countBy(e){let r=this._chunks,n=r.length,s=typeof e=="string"?new Xp.Col(e):e;s.bind(r[n-1]);let a=s.vector;if(!ey.DataType.isDictionary(a.type))throw new Error("countBy currently only supports dictionary-encoded columns");let o=Math.ceil(Math.log(a.length)/Math.log(256)),c=o==4?Uint32Array:o>=2?Uint16Array:Uint8Array,f=new c(a.dictionary.length);for(let i=-1;++i<n;){let u=r[i],y=this._predicate.bind(u);s.bind(u);let N=s.vector.indices;for(let Z=-1,ke=u.length;++Z<ke;){let xr=N.get(Z);xr!==null&&y(Z,u)&&f[xr]++}}return new Oa(a.dictionary,Zp.IntVector.from(f))}};Br.FilteredDataFrame=Si});var ny=m(l=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0});l.util=l.predicate=l.CountByResult=l.FilteredDataFrame=l.DataFrame=l.RecordBatch=l.Message=l.JSONMessageReader=l.AsyncMessageReader=l.MessageReader=l.RecordBatchJSONWriter=l.RecordBatchStreamWriter=l.RecordBatchFileWriter=l.RecordBatchWriter=l.AsyncRecordBatchStreamReader=l.AsyncRecordBatchFileReader=l.RecordBatchStreamReader=l.RecordBatchFileReader=l.RecordBatchReader=l.AsyncByteQueue=l.AsyncByteStream=l.ByteStream=l.Utf8Builder=l.SparseUnionBuilder=l.DenseUnionBuilder=l.UnionBuilder=l.TimeNanosecondBuilder=l.TimeMicrosecondBuilder=l.TimeMillisecondBuilder=l.TimeSecondBuilder=l.TimeBuilder=l.TimestampNanosecondBuilder=l.TimestampMicrosecondBuilder=l.TimestampMillisecondBuilder=l.TimestampSecondBuilder=l.TimestampBuilder=l.StructBuilder=l.NullBuilder=l.MapBuilder=l.ListBuilder=l.Uint64Builder=l.Uint32Builder=l.Uint16Builder=l.Uint8Builder=l.Int64Builder=l.Int32Builder=l.Int16Builder=l.Int8Builder=l.IntBuilder=l.IntervalYearMonthBuilder=l.IntervalDayTimeBuilder=l.IntervalBuilder=l.Float64Builder=l.Float32Builder=l.Float16Builder=l.FloatBuilder=l.FixedSizeListBuilder=l.FixedSizeBinaryBuilder=l.DictionaryBuilder=l.DecimalBuilder=l.DateMillisecondBuilder=l.DateDayBuilder=l.DateBuilder=l.BoolBuilder=l.BinaryBuilder=l.Builder=l.Utf8Vector=l.SparseUnionVector=l.DenseUnionVector=l.UnionVector=l.TimeNanosecondVector=l.TimeMicrosecondVector=l.TimeMillisecondVector=l.TimeSecondVector=l.TimeVector=l.TimestampNanosecondVector=l.TimestampMicrosecondVector=l.TimestampMillisecondVector=l.TimestampSecondVector=l.TimestampVector=l.StructVector=l.NullVector=l.MapVector=l.ListVector=l.Uint64Vector=l.Uint32Vector=l.Uint16Vector=l.Uint8Vector=l.Int64Vector=l.Int32Vector=l.Int16Vector=l.Int8Vector=l.IntVector=l.IntervalYearMonthVector=l.IntervalDayTimeVector=l.IntervalVector=l.Float64Vector=l.Float32Vector=l.Float16Vector=l.FloatVector=l.FixedSizeListVector=l.FixedSizeBinaryVector=l.DictionaryVector=l.DecimalVector=l.DateMillisecondVector=l.DateDayVector=l.DateVector=l.Chunked=l.BoolVector=l.BinaryVector=l.BaseVector=l.Vector=l.Field=l.Schema=l.Visitor=l.Column=l.Table=l.Map_=l.FixedSizeList=l.IntervalYearMonth=l.IntervalDayTime=l.Interval=l.Dictionary=l.SparseUnion=l.DenseUnion=l.Union=l.Struct=l.List=l.Decimal=l.TimeNanosecond=l.TimeMicrosecond=l.TimeMillisecond=l.TimeSecond=l.Time=l.TimestampNanosecond=l.TimestampMicrosecond=l.TimestampMillisecond=l.TimestampSecond=l.Timestamp=l.DateMillisecond=l.DateDay=l.Date_=l.FixedSizeBinary=l.Binary=l.Utf8=l.Float64=l.Float32=l.Float16=l.Float=l.Uint64=l.Uint32=l.Uint16=l.Uint8=l.Int64=l.Int32=l.Int16=l.Int8=l.Int=l.Bool=l.Null=l.DataType=l.Data=l.BufferType=l.UnionMode=l.Type=l.TimeUnit=l.Precision=l.MetadataVersion=l.MessageHeader=l.IntervalUnit=l.DateUnit=l.ArrowType=void 0;var Ut=ee();Object.defineProperty(l,"ArrowType",{enumerable:!0,get:function(){return Ut.ArrowType}});Object.defineProperty(l,"DateUnit",{enumerable:!0,get:function(){return Ut.DateUnit}});Object.defineProperty(l,"IntervalUnit",{enumerable:!0,get:function(){return Ut.IntervalUnit}});Object.defineProperty(l,"MessageHeader",{enumerable:!0,get:function(){return Ut.MessageHeader}});Object.defineProperty(l,"MetadataVersion",{enumerable:!0,get:function(){return Ut.MetadataVersion}});Object.defineProperty(l,"Precision",{enumerable:!0,get:function(){return Ut.Precision}});Object.defineProperty(l,"TimeUnit",{enumerable:!0,get:function(){return Ut.TimeUnit}});Object.defineProperty(l,"Type",{enumerable:!0,get:function(){return Ut.Type}});Object.defineProperty(l,"UnionMode",{enumerable:!0,get:function(){return Ut.UnionMode}});Object.defineProperty(l,"BufferType",{enumerable:!0,get:function(){return Ut.BufferType}});var JI=st();Object.defineProperty(l,"Data",{enumerable:!0,get:function(){return JI.Data}});var L=K();Object.defineProperty(l,"DataType",{enumerable:!0,get:function(){return L.DataType}});Object.defineProperty(l,"Null",{enumerable:!0,get:function(){return L.Null}});Object.defineProperty(l,"Bool",{enumerable:!0,get:function(){return L.Bool}});Object.defineProperty(l,"Int",{enumerable:!0,get:function(){return L.Int}});Object.defineProperty(l,"Int8",{enumerable:!0,get:function(){return L.Int8}});Object.defineProperty(l,"Int16",{enumerable:!0,get:function(){return L.Int16}});Object.defineProperty(l,"Int32",{enumerable:!0,get:function(){return L.Int32}});Object.defineProperty(l,"Int64",{enumerable:!0,get:function(){return L.Int64}});Object.defineProperty(l,"Uint8",{enumerable:!0,get:function(){return L.Uint8}});Object.defineProperty(l,"Uint16",{enumerable:!0,get:function(){return L.Uint16}});Object.defineProperty(l,"Uint32",{enumerable:!0,get:function(){return L.Uint32}});Object.defineProperty(l,"Uint64",{enumerable:!0,get:function(){return L.Uint64}});Object.defineProperty(l,"Float",{enumerable:!0,get:function(){return L.Float}});Object.defineProperty(l,"Float16",{enumerable:!0,get:function(){return L.Float16}});Object.defineProperty(l,"Float32",{enumerable:!0,get:function(){return L.Float32}});Object.defineProperty(l,"Float64",{enumerable:!0,get:function(){return L.Float64}});Object.defineProperty(l,"Utf8",{enumerable:!0,get:function(){return L.Utf8}});Object.defineProperty(l,"Binary",{enumerable:!0,get:function(){return L.Binary}});Object.defineProperty(l,"FixedSizeBinary",{enumerable:!0,get:function(){return L.FixedSizeBinary}});Object.defineProperty(l,"Date_",{enumerable:!0,get:function(){return L.Date_}});Object.defineProperty(l,"DateDay",{enumerable:!0,get:function(){return L.DateDay}});Object.defineProperty(l,"DateMillisecond",{enumerable:!0,get:function(){return L.DateMillisecond}});Object.defineProperty(l,"Timestamp",{enumerable:!0,get:function(){return L.Timestamp}});Object.defineProperty(l,"TimestampSecond",{enumerable:!0,get:function(){return L.TimestampSecond}});Object.defineProperty(l,"TimestampMillisecond",{enumerable:!0,get:function(){return L.TimestampMillisecond}});Object.defineProperty(l,"TimestampMicrosecond",{enumerable:!0,get:function(){return L.TimestampMicrosecond}});Object.defineProperty(l,"TimestampNanosecond",{enumerable:!0,get:function(){return L.TimestampNanosecond}});Object.defineProperty(l,"Time",{enumerable:!0,get:function(){return L.Time}});Object.defineProperty(l,"TimeSecond",{enumerable:!0,get:function(){return L.TimeSecond}});Object.defineProperty(l,"TimeMillisecond",{enumerable:!0,get:function(){return L.TimeMillisecond}});Object.defineProperty(l,"TimeMicrosecond",{enumerable:!0,get:function(){return L.TimeMicrosecond}});Object.defineProperty(l,"TimeNanosecond",{enumerable:!0,get:function(){return L.TimeNanosecond}});Object.defineProperty(l,"Decimal",{enumerable:!0,get:function(){return L.Decimal}});Object.defineProperty(l,"List",{enumerable:!0,get:function(){return L.List}});Object.defineProperty(l,"Struct",{enumerable:!0,get:function(){return L.Struct}});Object.defineProperty(l,"Union",{enumerable:!0,get:function(){return L.Union}});Object.defineProperty(l,"DenseUnion",{enumerable:!0,get:function(){return L.DenseUnion}});Object.defineProperty(l,"SparseUnion",{enumerable:!0,get:function(){return L.SparseUnion}});Object.defineProperty(l,"Dictionary",{enumerable:!0,get:function(){return L.Dictionary}});Object.defineProperty(l,"Interval",{enumerable:!0,get:function(){return L.Interval}});Object.defineProperty(l,"IntervalDayTime",{enumerable:!0,get:function(){return L.IntervalDayTime}});Object.defineProperty(l,"IntervalYearMonth",{enumerable:!0,get:function(){return L.IntervalYearMonth}});Object.defineProperty(l,"FixedSizeList",{enumerable:!0,get:function(){return L.FixedSizeList}});Object.defineProperty(l,"Map_",{enumerable:!0,get:function(){return L.Map_}});var KI=li();Object.defineProperty(l,"Table",{enumerable:!0,get:function(){return KI.Table}});var QI=sn();Object.defineProperty(l,"Column",{enumerable:!0,get:function(){return QI.Column}});var ZI=ve();Object.defineProperty(l,"Visitor",{enumerable:!0,get:function(){return ZI.Visitor}});var ry=_e();Object.defineProperty(l,"Schema",{enumerable:!0,get:function(){return ry.Schema}});Object.defineProperty(l,"Field",{enumerable:!0,get:function(){return ry.Field}});var V=At();Object.defineProperty(l,"Vector",{enumerable:!0,get:function(){return V.Vector}});Object.defineProperty(l,"BaseVector",{enumerable:!0,get:function(){return V.BaseVector}});Object.defineProperty(l,"BinaryVector",{enumerable:!0,get:function(){return V.BinaryVector}});Object.defineProperty(l,"BoolVector",{enumerable:!0,get:function(){return V.BoolVector}});Object.defineProperty(l,"Chunked",{enumerable:!0,get:function(){return V.Chunked}});Object.defineProperty(l,"DateVector",{enumerable:!0,get:function(){return V.DateVector}});Object.defineProperty(l,"DateDayVector",{enumerable:!0,get:function(){return V.DateDayVector}});Object.defineProperty(l,"DateMillisecondVector",{enumerable:!0,get:function(){return V.DateMillisecondVector}});Object.defineProperty(l,"DecimalVector",{enumerable:!0,get:function(){return V.DecimalVector}});Object.defineProperty(l,"DictionaryVector",{enumerable:!0,get:function(){return V.DictionaryVector}});Object.defineProperty(l,"FixedSizeBinaryVector",{enumerable:!0,get:function(){return V.FixedSizeBinaryVector}});Object.defineProperty(l,"FixedSizeListVector",{enumerable:!0,get:function(){return V.FixedSizeListVector}});Object.defineProperty(l,"FloatVector",{enumerable:!0,get:function(){return V.FloatVector}});Object.defineProperty(l,"Float16Vector",{enumerable:!0,get:function(){return V.Float16Vector}});Object.defineProperty(l,"Float32Vector",{enumerable:!0,get:function(){return V.Float32Vector}});Object.defineProperty(l,"Float64Vector",{enumerable:!0,get:function(){return V.Float64Vector}});Object.defineProperty(l,"IntervalVector",{enumerable:!0,get:function(){return V.IntervalVector}});Object.defineProperty(l,"IntervalDayTimeVector",{enumerable:!0,get:function(){return V.IntervalDayTimeVector}});Object.defineProperty(l,"IntervalYearMonthVector",{enumerable:!0,get:function(){return V.IntervalYearMonthVector}});Object.defineProperty(l,"IntVector",{enumerable:!0,get:function(){return V.IntVector}});Object.defineProperty(l,"Int8Vector",{enumerable:!0,get:function(){return V.Int8Vector}});Object.defineProperty(l,"Int16Vector",{enumerable:!0,get:function(){return V.Int16Vector}});Object.defineProperty(l,"Int32Vector",{enumerable:!0,get:function(){return V.Int32Vector}});Object.defineProperty(l,"Int64Vector",{enumerable:!0,get:function(){return V.Int64Vector}});Object.defineProperty(l,"Uint8Vector",{enumerable:!0,get:function(){return V.Uint8Vector}});Object.defineProperty(l,"Uint16Vector",{enumerable:!0,get:function(){return V.Uint16Vector}});Object.defineProperty(l,"Uint32Vector",{enumerable:!0,get:function(){return V.Uint32Vector}});Object.defineProperty(l,"Uint64Vector",{enumerable:!0,get:function(){return V.Uint64Vector}});Object.defineProperty(l,"ListVector",{enumerable:!0,get:function(){return V.ListVector}});Object.defineProperty(l,"MapVector",{enumerable:!0,get:function(){return V.MapVector}});Object.defineProperty(l,"NullVector",{enumerable:!0,get:function(){return V.NullVector}});Object.defineProperty(l,"StructVector",{enumerable:!0,get:function(){return V.StructVector}});Object.defineProperty(l,"TimestampVector",{enumerable:!0,get:function(){return V.TimestampVector}});Object.defineProperty(l,"TimestampSecondVector",{enumerable:!0,get:function(){return V.TimestampSecondVector}});Object.defineProperty(l,"TimestampMillisecondVector",{enumerable:!0,get:function(){return V.TimestampMillisecondVector}});Object.defineProperty(l,"TimestampMicrosecondVector",{enumerable:!0,get:function(){return V.TimestampMicrosecondVector}});Object.defineProperty(l,"TimestampNanosecondVector",{enumerable:!0,get:function(){return V.TimestampNanosecondVector}});Object.defineProperty(l,"TimeVector",{enumerable:!0,get:function(){return V.TimeVector}});Object.defineProperty(l,"TimeSecondVector",{enumerable:!0,get:function(){return V.TimeSecondVector}});Object.defineProperty(l,"TimeMillisecondVector",{enumerable:!0,get:function(){return V.TimeMillisecondVector}});Object.defineProperty(l,"TimeMicrosecondVector",{enumerable:!0,get:function(){return V.TimeMicrosecondVector}});Object.defineProperty(l,"TimeNanosecondVector",{enumerable:!0,get:function(){return V.TimeNanosecondVector}});Object.defineProperty(l,"UnionVector",{enumerable:!0,get:function(){return V.UnionVector}});Object.defineProperty(l,"DenseUnionVector",{enumerable:!0,get:function(){return V.DenseUnionVector}});Object.defineProperty(l,"SparseUnionVector",{enumerable:!0,get:function(){return V.SparseUnionVector}});Object.defineProperty(l,"Utf8Vector",{enumerable:!0,get:function(){return V.Utf8Vector}});var x=As();Object.defineProperty(l,"Builder",{enumerable:!0,get:function(){return x.Builder}});Object.defineProperty(l,"BinaryBuilder",{enumerable:!0,get:function(){return x.BinaryBuilder}});Object.defineProperty(l,"BoolBuilder",{enumerable:!0,get:function(){return x.BoolBuilder}});Object.defineProperty(l,"DateBuilder",{enumerable:!0,get:function(){return x.DateBuilder}});Object.defineProperty(l,"DateDayBuilder",{enumerable:!0,get:function(){return x.DateDayBuilder}});Object.defineProperty(l,"DateMillisecondBuilder",{enumerable:!0,get:function(){return x.DateMillisecondBuilder}});Object.defineProperty(l,"DecimalBuilder",{enumerable:!0,get:function(){return x.DecimalBuilder}});Object.defineProperty(l,"DictionaryBuilder",{enumerable:!0,get:function(){return x.DictionaryBuilder}});Object.defineProperty(l,"FixedSizeBinaryBuilder",{enumerable:!0,get:function(){return x.FixedSizeBinaryBuilder}});Object.defineProperty(l,"FixedSizeListBuilder",{enumerable:!0,get:function(){return x.FixedSizeListBuilder}});Object.defineProperty(l,"FloatBuilder",{enumerable:!0,get:function(){return x.FloatBuilder}});Object.defineProperty(l,"Float16Builder",{enumerable:!0,get:function(){return x.Float16Builder}});Object.defineProperty(l,"Float32Builder",{enumerable:!0,get:function(){return x.Float32Builder}});Object.defineProperty(l,"Float64Builder",{enumerable:!0,get:function(){return x.Float64Builder}});Object.defineProperty(l,"IntervalBuilder",{enumerable:!0,get:function(){return x.IntervalBuilder}});Object.defineProperty(l,"IntervalDayTimeBuilder",{enumerable:!0,get:function(){return x.IntervalDayTimeBuilder}});Object.defineProperty(l,"IntervalYearMonthBuilder",{enumerable:!0,get:function(){return x.IntervalYearMonthBuilder}});Object.defineProperty(l,"IntBuilder",{enumerable:!0,get:function(){return x.IntBuilder}});Object.defineProperty(l,"Int8Builder",{enumerable:!0,get:function(){return x.Int8Builder}});Object.defineProperty(l,"Int16Builder",{enumerable:!0,get:function(){return x.Int16Builder}});Object.defineProperty(l,"Int32Builder",{enumerable:!0,get:function(){return x.Int32Builder}});Object.defineProperty(l,"Int64Builder",{enumerable:!0,get:function(){return x.Int64Builder}});Object.defineProperty(l,"Uint8Builder",{enumerable:!0,get:function(){return x.Uint8Builder}});Object.defineProperty(l,"Uint16Builder",{enumerable:!0,get:function(){return x.Uint16Builder}});Object.defineProperty(l,"Uint32Builder",{enumerable:!0,get:function(){return x.Uint32Builder}});Object.defineProperty(l,"Uint64Builder",{enumerable:!0,get:function(){return x.Uint64Builder}});Object.defineProperty(l,"ListBuilder",{enumerable:!0,get:function(){return x.ListBuilder}});Object.defineProperty(l,"MapBuilder",{enumerable:!0,get:function(){return x.MapBuilder}});Object.defineProperty(l,"NullBuilder",{enumerable:!0,get:function(){return x.NullBuilder}});Object.defineProperty(l,"StructBuilder",{enumerable:!0,get:function(){return x.StructBuilder}});Object.defineProperty(l,"TimestampBuilder",{enumerable:!0,get:function(){return x.TimestampBuilder}});Object.defineProperty(l,"TimestampSecondBuilder",{enumerable:!0,get:function(){return x.TimestampSecondBuilder}});Object.defineProperty(l,"TimestampMillisecondBuilder",{enumerable:!0,get:function(){return x.TimestampMillisecondBuilder}});Object.defineProperty(l,"TimestampMicrosecondBuilder",{enumerable:!0,get:function(){return x.TimestampMicrosecondBuilder}});Object.defineProperty(l,"TimestampNanosecondBuilder",{enumerable:!0,get:function(){return x.TimestampNanosecondBuilder}});Object.defineProperty(l,"TimeBuilder",{enumerable:!0,get:function(){return x.TimeBuilder}});Object.defineProperty(l,"TimeSecondBuilder",{enumerable:!0,get:function(){return x.TimeSecondBuilder}});Object.defineProperty(l,"TimeMillisecondBuilder",{enumerable:!0,get:function(){return x.TimeMillisecondBuilder}});Object.defineProperty(l,"TimeMicrosecondBuilder",{enumerable:!0,get:function(){return x.TimeMicrosecondBuilder}});Object.defineProperty(l,"TimeNanosecondBuilder",{enumerable:!0,get:function(){return x.TimeNanosecondBuilder}});Object.defineProperty(l,"UnionBuilder",{enumerable:!0,get:function(){return x.UnionBuilder}});Object.defineProperty(l,"DenseUnionBuilder",{enumerable:!0,get:function(){return x.DenseUnionBuilder}});Object.defineProperty(l,"SparseUnionBuilder",{enumerable:!0,get:function(){return x.SparseUnionBuilder}});Object.defineProperty(l,"Utf8Builder",{enumerable:!0,get:function(){return x.Utf8Builder}});var Gu=or();Object.defineProperty(l,"ByteStream",{enumerable:!0,get:function(){return Gu.ByteStream}});Object.defineProperty(l,"AsyncByteStream",{enumerable:!0,get:function(){return Gu.AsyncByteStream}});Object.defineProperty(l,"AsyncByteQueue",{enumerable:!0,get:function(){return Gu.AsyncByteQueue}});var Oi=_i();Object.defineProperty(l,"RecordBatchReader",{enumerable:!0,get:function(){return Oi.RecordBatchReader}});Object.defineProperty(l,"RecordBatchFileReader",{enumerable:!0,get:function(){return Oi.RecordBatchFileReader}});Object.defineProperty(l,"RecordBatchStreamReader",{enumerable:!0,get:function(){return Oi.RecordBatchStreamReader}});Object.defineProperty(l,"AsyncRecordBatchFileReader",{enumerable:!0,get:function(){return Oi.AsyncRecordBatchFileReader}});Object.defineProperty(l,"AsyncRecordBatchStreamReader",{enumerable:!0,get:function(){return Oi.AsyncRecordBatchStreamReader}});var Aa=Ks();Object.defineProperty(l,"RecordBatchWriter",{enumerable:!0,get:function(){return Aa.RecordBatchWriter}});Object.defineProperty(l,"RecordBatchFileWriter",{enumerable:!0,get:function(){return Aa.RecordBatchFileWriter}});Object.defineProperty(l,"RecordBatchStreamWriter",{enumerable:!0,get:function(){return Aa.RecordBatchStreamWriter}});Object.defineProperty(l,"RecordBatchJSONWriter",{enumerable:!0,get:function(){return Aa.RecordBatchJSONWriter}});var Hu=ks();Object.defineProperty(l,"MessageReader",{enumerable:!0,get:function(){return Hu.MessageReader}});Object.defineProperty(l,"AsyncMessageReader",{enumerable:!0,get:function(){return Hu.AsyncMessageReader}});Object.defineProperty(l,"JSONMessageReader",{enumerable:!0,get:function(){return Hu.JSONMessageReader}});var XI=Rr();Object.defineProperty(l,"Message",{enumerable:!0,get:function(){return XI.Message}});var ew=kt();Object.defineProperty(l,"RecordBatch",{enumerable:!0,get:function(){return ew.RecordBatch}});var $u=ty();Object.defineProperty(l,"DataFrame",{enumerable:!0,get:function(){return $u.DataFrame}});Object.defineProperty(l,"FilteredDataFrame",{enumerable:!0,get:function(){return $u.FilteredDataFrame}});Object.defineProperty(l,"CountByResult",{enumerable:!0,get:function(){return $u.CountByResult}});var tw=Jn(),rw=oc(),nw=pt(),iw=Yn(),sw=de(),aw=Zn(),ow=zu();l.predicate=ow;l.util={...tw,...rw,...nw,...iw,...sw,...aw}});var Fa=m(d=>{"use strict";Object.defineProperty(d,"__esModule",{value:!0});d.Utf8Builder=d.SparseUnionBuilder=d.DenseUnionBuilder=d.UnionBuilder=d.TimeNanosecondBuilder=d.TimeMicrosecondBuilder=d.TimeMillisecondBuilder=d.TimeSecondBuilder=d.TimeBuilder=d.TimestampNanosecondBuilder=d.TimestampMicrosecondBuilder=d.TimestampMillisecondBuilder=d.TimestampSecondBuilder=d.TimestampBuilder=d.StructBuilder=d.NullBuilder=d.MapBuilder=d.ListBuilder=d.Uint64Builder=d.Uint32Builder=d.Uint16Builder=d.Uint8Builder=d.Int64Builder=d.Int32Builder=d.Int16Builder=d.Int8Builder=d.IntBuilder=d.IntervalYearMonthBuilder=d.IntervalDayTimeBuilder=d.IntervalBuilder=d.Float64Builder=d.Float32Builder=d.Float16Builder=d.FloatBuilder=d.FixedSizeListBuilder=d.FixedSizeBinaryBuilder=d.DictionaryBuilder=d.DecimalBuilder=d.DateMillisecondBuilder=d.DateDayBuilder=d.DateBuilder=d.BoolBuilder=d.BinaryBuilder=d.Builder=d.util=d.predicate=d.CountByResult=d.FilteredDataFrame=d.DataFrame=d.RecordBatch=d.Message=d.JSONMessageReader=d.AsyncMessageReader=d.MessageReader=d.RecordBatchJSONWriter=d.RecordBatchStreamWriter=d.RecordBatchFileWriter=d.RecordBatchWriter=d.AsyncRecordBatchStreamReader=d.AsyncRecordBatchFileReader=d.RecordBatchStreamReader=d.RecordBatchFileReader=d.RecordBatchReader=d.AsyncByteQueue=d.AsyncByteStream=d.ByteStream=d.Utf8Vector=d.SparseUnionVector=d.DenseUnionVector=d.UnionVector=d.TimeNanosecondVector=d.TimeMicrosecondVector=d.TimeMillisecondVector=d.TimeSecondVector=d.TimeVector=d.TimestampNanosecondVector=d.TimestampMicrosecondVector=d.TimestampMillisecondVector=d.TimestampSecondVector=d.TimestampVector=d.StructVector=d.NullVector=d.MapVector=d.ListVector=d.Uint64Vector=d.Uint32Vector=d.Uint16Vector=d.Uint8Vector=d.Int64Vector=d.Int32Vector=d.Int16Vector=d.Int8Vector=d.IntVector=d.IntervalYearMonthVector=d.IntervalDayTimeVector=d.IntervalVector=d.Float64Vector=d.Float32Vector=d.Float16Vector=d.FloatVector=d.FixedSizeListVector=d.FixedSizeBinaryVector=d.DictionaryVector=d.DecimalVector=d.DateMillisecondVector=d.DateDayVector=d.DateVector=d.Chunked=d.BoolVector=d.BinaryVector=d.BaseVector=d.Vector=d.Visitor=d.Field=d.Schema=d.Column=d.Table=d.Map_=d.FixedSizeList=d.IntervalYearMonth=d.IntervalDayTime=d.Interval=d.Dictionary=d.SparseUnion=d.DenseUnion=d.Union=d.Struct=d.List=d.Decimal=d.TimeNanosecond=d.TimeMicrosecond=d.TimeMillisecond=d.TimeSecond=d.Time=d.TimestampNanosecond=d.TimestampMicrosecond=d.TimestampMillisecond=d.TimestampSecond=d.Timestamp=d.DateMillisecond=d.DateDay=d.Date_=d.FixedSizeBinary=d.Binary=d.Utf8=d.Float64=d.Float32=d.Float16=d.Float=d.Uint64=d.Uint32=d.Uint16=d.Uint8=d.Int64=d.Int32=d.Int16=d.Int8=d.Int=d.Bool=d.Null=d.DataType=d.Data=d.BufferType=d.UnionMode=d.Type=d.TimeUnit=d.Precision=d.MetadataVersion=d.MessageHeader=d.IntervalUnit=d.DateUnit=d.ArrowType=void 0;var cw=jn(),uw=As(),lw=_i(),dw=Ks(),fw=Gp(),hw=Jp(),pw=Kp(),yw=Qp();cw.default.toDOMStream=fw.toDOMStream;uw.Builder.throughDOM=hw.builderThroughDOMStream;lw.RecordBatchReader.throughDOM=pw.recordBatchReaderThroughDOMStream;dw.RecordBatchWriter.throughDOM=yw.recordBatchWriterThroughDOMStream;var h=ny();Object.defineProperty(d,"ArrowType",{enumerable:!0,get:function(){return h.ArrowType}});Object.defineProperty(d,"DateUnit",{enumerable:!0,get:function(){return h.DateUnit}});Object.defineProperty(d,"IntervalUnit",{enumerable:!0,get:function(){return h.IntervalUnit}});Object.defineProperty(d,"MessageHeader",{enumerable:!0,get:function(){return h.MessageHeader}});Object.defineProperty(d,"MetadataVersion",{enumerable:!0,get:function(){return h.MetadataVersion}});Object.defineProperty(d,"Precision",{enumerable:!0,get:function(){return h.Precision}});Object.defineProperty(d,"TimeUnit",{enumerable:!0,get:function(){return h.TimeUnit}});Object.defineProperty(d,"Type",{enumerable:!0,get:function(){return h.Type}});Object.defineProperty(d,"UnionMode",{enumerable:!0,get:function(){return h.UnionMode}});Object.defineProperty(d,"BufferType",{enumerable:!0,get:function(){return h.BufferType}});Object.defineProperty(d,"Data",{enumerable:!0,get:function(){return h.Data}});Object.defineProperty(d,"DataType",{enumerable:!0,get:function(){return h.DataType}});Object.defineProperty(d,"Null",{enumerable:!0,get:function(){return h.Null}});Object.defineProperty(d,"Bool",{enumerable:!0,get:function(){return h.Bool}});Object.defineProperty(d,"Int",{enumerable:!0,get:function(){return h.Int}});Object.defineProperty(d,"Int8",{enumerable:!0,get:function(){return h.Int8}});Object.defineProperty(d,"Int16",{enumerable:!0,get:function(){return h.Int16}});Object.defineProperty(d,"Int32",{enumerable:!0,get:function(){return h.Int32}});Object.defineProperty(d,"Int64",{enumerable:!0,get:function(){return h.Int64}});Object.defineProperty(d,"Uint8",{enumerable:!0,get:function(){return h.Uint8}});Object.defineProperty(d,"Uint16",{enumerable:!0,get:function(){return h.Uint16}});Object.defineProperty(d,"Uint32",{enumerable:!0,get:function(){return h.Uint32}});Object.defineProperty(d,"Uint64",{enumerable:!0,get:function(){return h.Uint64}});Object.defineProperty(d,"Float",{enumerable:!0,get:function(){return h.Float}});Object.defineProperty(d,"Float16",{enumerable:!0,get:function(){return h.Float16}});Object.defineProperty(d,"Float32",{enumerable:!0,get:function(){return h.Float32}});Object.defineProperty(d,"Float64",{enumerable:!0,get:function(){return h.Float64}});Object.defineProperty(d,"Utf8",{enumerable:!0,get:function(){return h.Utf8}});Object.defineProperty(d,"Binary",{enumerable:!0,get:function(){return h.Binary}});Object.defineProperty(d,"FixedSizeBinary",{enumerable:!0,get:function(){return h.FixedSizeBinary}});Object.defineProperty(d,"Date_",{enumerable:!0,get:function(){return h.Date_}});Object.defineProperty(d,"DateDay",{enumerable:!0,get:function(){return h.DateDay}});Object.defineProperty(d,"DateMillisecond",{enumerable:!0,get:function(){return h.DateMillisecond}});Object.defineProperty(d,"Timestamp",{enumerable:!0,get:function(){return h.Timestamp}});Object.defineProperty(d,"TimestampSecond",{enumerable:!0,get:function(){return h.TimestampSecond}});Object.defineProperty(d,"TimestampMillisecond",{enumerable:!0,get:function(){return h.TimestampMillisecond}});Object.defineProperty(d,"TimestampMicrosecond",{enumerable:!0,get:function(){return h.TimestampMicrosecond}});Object.defineProperty(d,"TimestampNanosecond",{enumerable:!0,get:function(){return h.TimestampNanosecond}});Object.defineProperty(d,"Time",{enumerable:!0,get:function(){return h.Time}});Object.defineProperty(d,"TimeSecond",{enumerable:!0,get:function(){return h.TimeSecond}});Object.defineProperty(d,"TimeMillisecond",{enumerable:!0,get:function(){return h.TimeMillisecond}});Object.defineProperty(d,"TimeMicrosecond",{enumerable:!0,get:function(){return h.TimeMicrosecond}});Object.defineProperty(d,"TimeNanosecond",{enumerable:!0,get:function(){return h.TimeNanosecond}});Object.defineProperty(d,"Decimal",{enumerable:!0,get:function(){return h.Decimal}});Object.defineProperty(d,"List",{enumerable:!0,get:function(){return h.List}});Object.defineProperty(d,"Struct",{enumerable:!0,get:function(){return h.Struct}});Object.defineProperty(d,"Union",{enumerable:!0,get:function(){return h.Union}});Object.defineProperty(d,"DenseUnion",{enumerable:!0,get:function(){return h.DenseUnion}});Object.defineProperty(d,"SparseUnion",{enumerable:!0,get:function(){return h.SparseUnion}});Object.defineProperty(d,"Dictionary",{enumerable:!0,get:function(){return h.Dictionary}});Object.defineProperty(d,"Interval",{enumerable:!0,get:function(){return h.Interval}});Object.defineProperty(d,"IntervalDayTime",{enumerable:!0,get:function(){return h.IntervalDayTime}});Object.defineProperty(d,"IntervalYearMonth",{enumerable:!0,get:function(){return h.IntervalYearMonth}});Object.defineProperty(d,"FixedSizeList",{enumerable:!0,get:function(){return h.FixedSizeList}});Object.defineProperty(d,"Map_",{enumerable:!0,get:function(){return h.Map_}});Object.defineProperty(d,"Table",{enumerable:!0,get:function(){return h.Table}});Object.defineProperty(d,"Column",{enumerable:!0,get:function(){return h.Column}});Object.defineProperty(d,"Schema",{enumerable:!0,get:function(){return h.Schema}});Object.defineProperty(d,"Field",{enumerable:!0,get:function(){return h.Field}});Object.defineProperty(d,"Visitor",{enumerable:!0,get:function(){return h.Visitor}});Object.defineProperty(d,"Vector",{enumerable:!0,get:function(){return h.Vector}});Object.defineProperty(d,"BaseVector",{enumerable:!0,get:function(){return h.BaseVector}});Object.defineProperty(d,"BinaryVector",{enumerable:!0,get:function(){return h.BinaryVector}});Object.defineProperty(d,"BoolVector",{enumerable:!0,get:function(){return h.BoolVector}});Object.defineProperty(d,"Chunked",{enumerable:!0,get:function(){return h.Chunked}});Object.defineProperty(d,"DateVector",{enumerable:!0,get:function(){return h.DateVector}});Object.defineProperty(d,"DateDayVector",{enumerable:!0,get:function(){return h.DateDayVector}});Object.defineProperty(d,"DateMillisecondVector",{enumerable:!0,get:function(){return h.DateMillisecondVector}});Object.defineProperty(d,"DecimalVector",{enumerable:!0,get:function(){return h.DecimalVector}});Object.defineProperty(d,"DictionaryVector",{enumerable:!0,get:function(){return h.DictionaryVector}});Object.defineProperty(d,"FixedSizeBinaryVector",{enumerable:!0,get:function(){return h.FixedSizeBinaryVector}});Object.defineProperty(d,"FixedSizeListVector",{enumerable:!0,get:function(){return h.FixedSizeListVector}});Object.defineProperty(d,"FloatVector",{enumerable:!0,get:function(){return h.FloatVector}});Object.defineProperty(d,"Float16Vector",{enumerable:!0,get:function(){return h.Float16Vector}});Object.defineProperty(d,"Float32Vector",{enumerable:!0,get:function(){return h.Float32Vector}});Object.defineProperty(d,"Float64Vector",{enumerable:!0,get:function(){return h.Float64Vector}});Object.defineProperty(d,"IntervalVector",{enumerable:!0,get:function(){return h.IntervalVector}});Object.defineProperty(d,"IntervalDayTimeVector",{enumerable:!0,get:function(){return h.IntervalDayTimeVector}});Object.defineProperty(d,"IntervalYearMonthVector",{enumerable:!0,get:function(){return h.IntervalYearMonthVector}});Object.defineProperty(d,"IntVector",{enumerable:!0,get:function(){return h.IntVector}});Object.defineProperty(d,"Int8Vector",{enumerable:!0,get:function(){return h.Int8Vector}});Object.defineProperty(d,"Int16Vector",{enumerable:!0,get:function(){return h.Int16Vector}});Object.defineProperty(d,"Int32Vector",{enumerable:!0,get:function(){return h.Int32Vector}});Object.defineProperty(d,"Int64Vector",{enumerable:!0,get:function(){return h.Int64Vector}});Object.defineProperty(d,"Uint8Vector",{enumerable:!0,get:function(){return h.Uint8Vector}});Object.defineProperty(d,"Uint16Vector",{enumerable:!0,get:function(){return h.Uint16Vector}});Object.defineProperty(d,"Uint32Vector",{enumerable:!0,get:function(){return h.Uint32Vector}});Object.defineProperty(d,"Uint64Vector",{enumerable:!0,get:function(){return h.Uint64Vector}});Object.defineProperty(d,"ListVector",{enumerable:!0,get:function(){return h.ListVector}});Object.defineProperty(d,"MapVector",{enumerable:!0,get:function(){return h.MapVector}});Object.defineProperty(d,"NullVector",{enumerable:!0,get:function(){return h.NullVector}});Object.defineProperty(d,"StructVector",{enumerable:!0,get:function(){return h.StructVector}});Object.defineProperty(d,"TimestampVector",{enumerable:!0,get:function(){return h.TimestampVector}});Object.defineProperty(d,"TimestampSecondVector",{enumerable:!0,get:function(){return h.TimestampSecondVector}});Object.defineProperty(d,"TimestampMillisecondVector",{enumerable:!0,get:function(){return h.TimestampMillisecondVector}});Object.defineProperty(d,"TimestampMicrosecondVector",{enumerable:!0,get:function(){return h.TimestampMicrosecondVector}});Object.defineProperty(d,"TimestampNanosecondVector",{enumerable:!0,get:function(){return h.TimestampNanosecondVector}});Object.defineProperty(d,"TimeVector",{enumerable:!0,get:function(){return h.TimeVector}});Object.defineProperty(d,"TimeSecondVector",{enumerable:!0,get:function(){return h.TimeSecondVector}});Object.defineProperty(d,"TimeMillisecondVector",{enumerable:!0,get:function(){return h.TimeMillisecondVector}});Object.defineProperty(d,"TimeMicrosecondVector",{enumerable:!0,get:function(){return h.TimeMicrosecondVector}});Object.defineProperty(d,"TimeNanosecondVector",{enumerable:!0,get:function(){return h.TimeNanosecondVector}});Object.defineProperty(d,"UnionVector",{enumerable:!0,get:function(){return h.UnionVector}});Object.defineProperty(d,"DenseUnionVector",{enumerable:!0,get:function(){return h.DenseUnionVector}});Object.defineProperty(d,"SparseUnionVector",{enumerable:!0,get:function(){return h.SparseUnionVector}});Object.defineProperty(d,"Utf8Vector",{enumerable:!0,get:function(){return h.Utf8Vector}});Object.defineProperty(d,"ByteStream",{enumerable:!0,get:function(){return h.ByteStream}});Object.defineProperty(d,"AsyncByteStream",{enumerable:!0,get:function(){return h.AsyncByteStream}});Object.defineProperty(d,"AsyncByteQueue",{enumerable:!0,get:function(){return h.AsyncByteQueue}});Object.defineProperty(d,"RecordBatchReader",{enumerable:!0,get:function(){return h.RecordBatchReader}});Object.defineProperty(d,"RecordBatchFileReader",{enumerable:!0,get:function(){return h.RecordBatchFileReader}});Object.defineProperty(d,"RecordBatchStreamReader",{enumerable:!0,get:function(){return h.RecordBatchStreamReader}});Object.defineProperty(d,"AsyncRecordBatchFileReader",{enumerable:!0,get:function(){return h.AsyncRecordBatchFileReader}});Object.defineProperty(d,"AsyncRecordBatchStreamReader",{enumerable:!0,get:function(){return h.AsyncRecordBatchStreamReader}});Object.defineProperty(d,"RecordBatchWriter",{enumerable:!0,get:function(){return h.RecordBatchWriter}});Object.defineProperty(d,"RecordBatchFileWriter",{enumerable:!0,get:function(){return h.RecordBatchFileWriter}});Object.defineProperty(d,"RecordBatchStreamWriter",{enumerable:!0,get:function(){return h.RecordBatchStreamWriter}});Object.defineProperty(d,"RecordBatchJSONWriter",{enumerable:!0,get:function(){return h.RecordBatchJSONWriter}});Object.defineProperty(d,"MessageReader",{enumerable:!0,get:function(){return h.MessageReader}});Object.defineProperty(d,"AsyncMessageReader",{enumerable:!0,get:function(){return h.AsyncMessageReader}});Object.defineProperty(d,"JSONMessageReader",{enumerable:!0,get:function(){return h.JSONMessageReader}});Object.defineProperty(d,"Message",{enumerable:!0,get:function(){return h.Message}});Object.defineProperty(d,"RecordBatch",{enumerable:!0,get:function(){return h.RecordBatch}});Object.defineProperty(d,"DataFrame",{enumerable:!0,get:function(){return h.DataFrame}});Object.defineProperty(d,"FilteredDataFrame",{enumerable:!0,get:function(){return h.FilteredDataFrame}});Object.defineProperty(d,"CountByResult",{enumerable:!0,get:function(){return h.CountByResult}});Object.defineProperty(d,"predicate",{enumerable:!0,get:function(){return h.predicate}});Object.defineProperty(d,"util",{enumerable:!0,get:function(){return h.util}});Object.defineProperty(d,"Builder",{enumerable:!0,get:function(){return h.Builder}});Object.defineProperty(d,"BinaryBuilder",{enumerable:!0,get:function(){return h.BinaryBuilder}});Object.defineProperty(d,"BoolBuilder",{enumerable:!0,get:function(){return h.BoolBuilder}});Object.defineProperty(d,"DateBuilder",{enumerable:!0,get:function(){return h.DateBuilder}});Object.defineProperty(d,"DateDayBuilder",{enumerable:!0,get:function(){return h.DateDayBuilder}});Object.defineProperty(d,"DateMillisecondBuilder",{enumerable:!0,get:function(){return h.DateMillisecondBuilder}});Object.defineProperty(d,"DecimalBuilder",{enumerable:!0,get:function(){return h.DecimalBuilder}});Object.defineProperty(d,"DictionaryBuilder",{enumerable:!0,get:function(){return h.DictionaryBuilder}});Object.defineProperty(d,"FixedSizeBinaryBuilder",{enumerable:!0,get:function(){return h.FixedSizeBinaryBuilder}});Object.defineProperty(d,"FixedSizeListBuilder",{enumerable:!0,get:function(){return h.FixedSizeListBuilder}});Object.defineProperty(d,"FloatBuilder",{enumerable:!0,get:function(){return h.FloatBuilder}});Object.defineProperty(d,"Float16Builder",{enumerable:!0,get:function(){return h.Float16Builder}});Object.defineProperty(d,"Float32Builder",{enumerable:!0,get:function(){return h.Float32Builder}});Object.defineProperty(d,"Float64Builder",{enumerable:!0,get:function(){return h.Float64Builder}});Object.defineProperty(d,"IntervalBuilder",{enumerable:!0,get:function(){return h.IntervalBuilder}});Object.defineProperty(d,"IntervalDayTimeBuilder",{enumerable:!0,get:function(){return h.IntervalDayTimeBuilder}});Object.defineProperty(d,"IntervalYearMonthBuilder",{enumerable:!0,get:function(){return h.IntervalYearMonthBuilder}});Object.defineProperty(d,"IntBuilder",{enumerable:!0,get:function(){return h.IntBuilder}});Object.defineProperty(d,"Int8Builder",{enumerable:!0,get:function(){return h.Int8Builder}});Object.defineProperty(d,"Int16Builder",{enumerable:!0,get:function(){return h.Int16Builder}});Object.defineProperty(d,"Int32Builder",{enumerable:!0,get:function(){return h.Int32Builder}});Object.defineProperty(d,"Int64Builder",{enumerable:!0,get:function(){return h.Int64Builder}});Object.defineProperty(d,"Uint8Builder",{enumerable:!0,get:function(){return h.Uint8Builder}});Object.defineProperty(d,"Uint16Builder",{enumerable:!0,get:function(){return h.Uint16Builder}});Object.defineProperty(d,"Uint32Builder",{enumerable:!0,get:function(){return h.Uint32Builder}});Object.defineProperty(d,"Uint64Builder",{enumerable:!0,get:function(){return h.Uint64Builder}});Object.defineProperty(d,"ListBuilder",{enumerable:!0,get:function(){return h.ListBuilder}});Object.defineProperty(d,"MapBuilder",{enumerable:!0,get:function(){return h.MapBuilder}});Object.defineProperty(d,"NullBuilder",{enumerable:!0,get:function(){return h.NullBuilder}});Object.defineProperty(d,"StructBuilder",{enumerable:!0,get:function(){return h.StructBuilder}});Object.defineProperty(d,"TimestampBuilder",{enumerable:!0,get:function(){return h.TimestampBuilder}});Object.defineProperty(d,"TimestampSecondBuilder",{enumerable:!0,get:function(){return h.TimestampSecondBuilder}});Object.defineProperty(d,"TimestampMillisecondBuilder",{enumerable:!0,get:function(){return h.TimestampMillisecondBuilder}});Object.defineProperty(d,"TimestampMicrosecondBuilder",{enumerable:!0,get:function(){return h.TimestampMicrosecondBuilder}});Object.defineProperty(d,"TimestampNanosecondBuilder",{enumerable:!0,get:function(){return h.TimestampNanosecondBuilder}});Object.defineProperty(d,"TimeBuilder",{enumerable:!0,get:function(){return h.TimeBuilder}});Object.defineProperty(d,"TimeSecondBuilder",{enumerable:!0,get:function(){return h.TimeSecondBuilder}});Object.defineProperty(d,"TimeMillisecondBuilder",{enumerable:!0,get:function(){return h.TimeMillisecondBuilder}});Object.defineProperty(d,"TimeMicrosecondBuilder",{enumerable:!0,get:function(){return h.TimeMicrosecondBuilder}});Object.defineProperty(d,"TimeNanosecondBuilder",{enumerable:!0,get:function(){return h.TimeNanosecondBuilder}});Object.defineProperty(d,"UnionBuilder",{enumerable:!0,get:function(){return h.UnionBuilder}});Object.defineProperty(d,"DenseUnionBuilder",{enumerable:!0,get:function(){return h.DenseUnionBuilder}});Object.defineProperty(d,"SparseUnionBuilder",{enumerable:!0,get:function(){return h.SparseUnionBuilder}});Object.defineProperty(d,"Utf8Builder",{enumerable:!0,get:function(){return h.Utf8Builder}})});var Mw={};Ty(Mw,{AsyncDuckDB:()=>sy,AsyncDuckDBConnection:()=>Da,AsyncDuckDBDispatcher:()=>ay,AsyncPreparedStatement:()=>Ku,AsyncResultStreamIterator:()=>Ra,ConsoleLogger:()=>sl,LogEvent:()=>Ce,LogLevel:()=>rt,LogOrigin:()=>nt,LogTopic:()=>ft,StatusCode:()=>Ma,VoidLogger:()=>il,WorkerRequestType:()=>_,WorkerResponseType:()=>W,WorkerTask:()=>J,getJsDelivrBundles:()=>Ew,getLogEventLabel:()=>wy,getLogLevelLabel:()=>Iy,getLogOriginLabel:()=>Sy,getLogTopicLabel:()=>vy,getPlatformFeatures:()=>hy,selectBundle:()=>Vw});var rt;(function(a){a[a.NONE=0]="NONE",a[a.DEBUG=1]="DEBUG",a[a.INFO=2]="INFO",a[a.WARNING=3]="WARNING",a[a.ERROR=4]="ERROR"})(rt||(rt={}));var ft;(function(a){a[a.NONE=0]="NONE",a[a.CONNECT=1]="CONNECT",a[a.DISCONNECT=2]="DISCONNECT",a[a.OPEN=3]="OPEN",a[a.QUERY=4]="QUERY"})(ft||(ft={}));var Ce;(function(o){o[o.NONE=0]="NONE",o[o.OK=1]="OK",o[o.ERROR=2]="ERROR",o[o.START=3]="START",o[o.RUN=4]="RUN",o[o.CAPTURE=5]="CAPTURE"})(Ce||(Ce={}));var nt;(function(a){a[a.NONE=0]="NONE",a[a.WEB_WORKER=1]="WEB_WORKER",a[a.NODE_WORKER=2]="NODE_WORKER",a[a.BINDINGS=3]="BINDINGS",a[a.ASYNC_DUCKDB=4]="ASYNC_DUCKDB"})(nt||(nt={}));var il=class{log(e){}},sl=class{log(e){console.log(e)}};function Iy(t){switch(t){case 0:return"NONE";case 1:return"DEBUG";case 2:return"INFO";case 3:return"WARNING";case 4:return"ERROR";default:return"?"}}function wy(t){switch(t){case 0:return"NONE";case 1:return"OK";case 2:return"ERROR";case 3:return"START";case 4:return"RUN";case 5:return"CAPTURE";default:return"?"}}function vy(t){switch(t){case 1:return"CONNECT";case 2:return"DISCONNECT";case 3:return"OPEN";case 4:return"QUERY";default:return"?"}}function Sy(t){switch(t){case 0:return"NONE";case 1:return"WEB WORKER";case 2:return"NODE WORKER";case 3:return"DUCKDB BINDINGS";case 4:return"DUCKDB";default:return"?"}}var Ma;(function(e){e[e.SUCCESS=0]="SUCCESS"})(Ma||(Ma={}));var dt=Va(Fa());var iy=Va(Fa()),Ju=class extends iy.AsyncByteQueue{flush(){let e=super.toUint8Array(!0);return this._values.length=0,e}};var Da=class{constructor(e,r){this._bindings=e,this._conn=r}get bindings(){return this._bindings}async close(){return this._bindings.disconnect(this._conn)}useUnsafe(e){return e(this._bindings,this._conn)}async query(e){this._bindings.logger.log({timestamp:new Date,level:rt.INFO,origin:nt.ASYNC_DUCKDB,topic:ft.QUERY,event:Ce.RUN,value:e});let r=await this._bindings.runQuery(this._conn,e),n=dt.RecordBatchReader.from(r);return console.assert(n.isSync()),console.assert(n.isFile()),dt.Table.from(n)}async send(e){this._bindings.logger.log({timestamp:new Date,level:rt.INFO,origin:nt.ASYNC_DUCKDB,topic:ft.QUERY,event:Ce.RUN,value:e});let r=await this._bindings.sendQuery(this._conn,e),n=new Ra(this._bindings,this._conn,r),s=await dt.RecordBatchReader.from(n);return console.assert(s.isAsync()),console.assert(s.isStream()),s}async prepare(e){let r=await this._bindings.createPrepared(this._conn,e);return new Ku(this._bindings,this._conn,r)}async insertArrowVectors(e,r){await this.insertArrowTable(dt.Table.new(e),r)}async insertArrowTable(e,r){e.schema.fields.length==0&&console.warn("The schema is empty! If you used arrow.Table.from, consider constructing schema and batches manually"),await this.insertArrowBatches(e.schema,e.chunks,r)}async insertArrowBatches(e,r,n){let s=new Ju,a=new dt.RecordBatchStreamWriter().reset(s,e),o=!0;for(let c of r)o||await this._bindings.insertArrowFromIPCStream(this._conn,s.flush(),n),o=!1,a.write(c);a.finish(),await this._bindings.insertArrowFromIPCStream(this._conn,s.flush(),n)}async insertArrowFromIPCStream(e,r){await this._bindings.insertArrowFromIPCStream(this._conn,e,r)}async insertCSVFromPath(e,r){await this._bindings.insertCSVFromPath(this._conn,e,r)}async insertJSONFromPath(e,r){await this._bindings.insertJSONFromPath(this._conn,e,r)}},Ra=class{constructor(e,r,n){this.db=e;this.conn=r;this.header=n;this._first=!0,this._depleted=!1,this._inFlight=null}async next(){if(this._first)return this._first=!1,{done:!1,value:this.header};if(this._depleted)return{done:!0,value:null};let e;return this._inFlight!=null?(e=await this._inFlight,this._inFlight=null):e=await this.db.fetchQueryResults(this.conn),this._depleted=e.length==0,this._depleted||(this._inFlight=this.db.fetchQueryResults(this.conn)),{done:this._depleted,value:e}}[Symbol.asyncIterator](){return this}},Ku=class{constructor(e,r,n){this.bindings=e,this.connectionId=r,this.statementId=n}async close(){await this.bindings.closePrepared(this.connectionId,this.statementId)}async query(...e){let r=await this.bindings.runPrepared(this.connectionId,this.statementId,e),n=dt.RecordBatchReader.from(r);return console.assert(n.isSync()),console.assert(n.isFile()),dt.Table.from(n)}async send(...e){let r=await this.bindings.sendPrepared(this.connectionId,this.statementId,e),n=new Ra(this.bindings,this.connectionId,r),s=await dt.RecordBatchReader.from(n);return console.assert(s.isAsync()),console.assert(s.isStream()),s}};var _;(function(A){A.CLOSE_PREPARED="CLOSE_PREPARED",A.COLLECT_FILE_STATISTICS="COLLECT_FILE_STATISTICS",A.CONNECT="CONNECT",A.COPY_FILE_TO_BUFFER="COPY_FILE_TO_BUFFER",A.COPY_FILE_TO_PATH="COPY_FILE_TO_PATH",A.CREATE_PREPARED="CREATE_PREPARED",A.DISCONNECT="DISCONNECT",A.DROP_FILE="DROP_FILE",A.DROP_FILES="DROP_FILES",A.EXPORT_FILE_STATISTICS="EXPORT_FILE_STATISTICS",A.FETCH_QUERY_RESULTS="FETCH_QUERY_RESULTS",A.FLUSH_FILES="FLUSH_FILES",A.GET_FEATURE_FLAGS="GET_FEATURE_FLAGS",A.GET_VERSION="GET_VERSION",A.GLOB_FILE_INFOS="GLOB_FILE_INFOS",A.INSERT_ARROW_FROM_IPC_STREAM="INSERT_ARROW_FROM_IPC_STREAM",A.INSERT_CSV_FROM_PATH="IMPORT_CSV_FROM_PATH",A.INSERT_JSON_FROM_PATH="IMPORT_JSON_FROM_PATH",A.INSTANTIATE="INSTANTIATE",A.OPEN="OPEN",A.PING="PING",A.REGISTER_FILE_BUFFER="REGISTER_FILE_BUFFER",A.REGISTER_FILE_HANDLE="REGISTER_FILE_HANDLE",A.REGISTER_FILE_URL="REGISTER_FILE_URL",A.RESET="RESET",A.RUN_PREPARED="RUN_PREPARED",A.RUN_QUERY="RUN_QUERY",A.SEND_PREPARED="SEND_PREPARED",A.SEND_QUERY="SEND_QUERY",A.TOKENIZE="TOKENIZE"})(_||(_={}));var W;(function(z){z.CONNECTION_INFO="CONNECTION_INFO",z.ERROR="ERROR",z.FEATURE_FLAGS="FEATURE_FLAGS",z.FILE_BUFFER="FILE_BUFFER",z.FILE_INFOS="FILE_INFOS",z.FILE_SIZE="FILE_SIZE",z.FILE_STATISTICS="FILE_STATISTICS",z.LOG="LOG",z.OK="OK",z.PREPARED_STATEMENT_ID="PREPARED_STATEMENT_ID",z.QUERY_PLAN="QUERY_PLAN",z.QUERY_RESULT="QUERY_RESULT",z.QUERY_RESULT_CHUNK="QUERY_RESULT_CHUNK",z.QUERY_START="QUERY_START",z.REGISTERED_FILE="REGISTERED_FILE",z.SCRIPT_TOKENS="SCRIPT_TOKENS",z.SUCCESS="SUCCESS",z.VERSION_STRING="VERSION_STRING"})(W||(W={}));var J=class{constructor(e,r){this.promiseResolver=()=>{};this.promiseRejecter=()=>{};this.type=e,this.data=r,this.promise=new Promise((n,s)=>{this.promiseResolver=n,this.promiseRejecter=s})}};var Y=Va(Fa());function Ai(t,e){switch(e.typeId){case Y.Type.Binary:return{name:t,type:"binary"};case Y.Type.Bool:return{name:t,type:"bool"};case Y.Type.Date:return{name:t,type:"date"};case Y.Type.DateDay:return{name:t,type:"date32[d]"};case Y.Type.DateMillisecond:return{name:t,type:"date64[ms]"};case Y.Type.Decimal:{let r=e;return{name:t,type:"decimal",precision:r.precision,scale:r.scale}}case Y.Type.Float:return{name:t,type:"float"};case Y.Type.Float16:return{name:t,type:"float16"};case Y.Type.Float32:return{name:t,type:"float32"};case Y.Type.Float64:return{name:t,type:"float64"};case Y.Type.Int:return{name:t,type:"int32"};case Y.Type.Int16:return{name:t,type:"int16"};case Y.Type.Int32:return{name:t,type:"int32"};case Y.Type.Int64:return{name:t,type:"int64"};case Y.Type.Uint16:return{name:t,type:"uint16"};case Y.Type.Uint32:return{name:t,type:"uint32"};case Y.Type.Uint64:return{name:t,type:"uint64"};case Y.Type.Uint8:return{name:t,type:"uint8"};case Y.Type.IntervalDayTime:return{name:t,type:"interval[dt]"};case Y.Type.IntervalYearMonth:return{name:t,type:"interval[m]"};case Y.Type.List:{let r=e;return{name:t,type:"list",children:[Ai(r.valueField.name,r.valueField.type)]}}case Y.Type.FixedSizeBinary:return{name:t,type:"fixedsizebinary",byteWidth:e.byteWidth};case Y.Type.Null:return{name:t,type:"null"};case Y.Type.Utf8:return{name:t,type:"utf8"};case Y.Type.Struct:return{name:t,type:"struct",children:e.children.map(n=>Ai(n.name,n.type))};case Y.Type.Time:return{name:t,type:"time[s]"};case Y.Type.TimeMicrosecond:return{name:t,type:"time[us]"};case Y.Type.TimeMillisecond:return{name:t,type:"time[ms]"};case Y.Type.TimeNanosecond:return{name:t,type:"time[ns]"};case Y.Type.TimeSecond:return{name:t,type:"time[s]"};case Y.Type.Timestamp:return{name:t,type:"timestamp",timezone:e.timezone||void 0};case Y.Type.TimestampSecond:return{name:t,type:"timestamp[s]",timezone:e.timezone||void 0};case Y.Type.TimestampMicrosecond:return{name:t,type:"timestamp[us]",timezone:e.timezone||void 0};case Y.Type.TimestampNanosecond:return{name:t,type:"timestamp[ns]",timezone:e.timezone||void 0};case Y.Type.TimestampMillisecond:return{name:t,type:"timestamp[ms]",timezone:e.timezone||void 0}}throw new Error(`unsupported arrow type: ${e.toString()}`)}var bw=new TextEncoder,sy=class{constructor(e,r=null){this._worker=null;this._workerShutdownPromise=null;this._workerShutdownResolver=()=>{};this._nextMessageId=0;this._pendingRequests=new Map;this._logger=e,this._onMessageHandler=this.onMessage.bind(this),this._onErrorHandler=this.onError.bind(this),this._onCloseHandler=this.onClose.bind(this),r!=null&&this.attach(r)}get logger(){return this._logger}attach(e){this._worker=e,this._worker.addEventListener("message",this._onMessageHandler),this._worker.addEventListener("error",this._onErrorHandler),this._worker.addEventListener("close",this._onCloseHandler),this._workerShutdownPromise=new Promise((r,n)=>{this._workerShutdownResolver=r})}detach(){!this._worker||(this._worker.removeEventListener("message",this._onMessageHandler),this._worker.removeEventListener("error",this._onErrorHandler),this._worker.removeEventListener("close",this._onCloseHandler),this._worker=null,this._workerShutdownResolver(null),this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async terminate(){!this._worker||(this._worker.terminate(),this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async postTask(e,r=[]){if(!this._worker){console.error("cannot send a message since the worker is not set!");return}let n=this._nextMessageId++;return this._pendingRequests.set(n,e),this._worker.postMessage({messageId:n,type:e.type,data:e.data}),await e.promise}onMessage(e){let r=e.data;r.type==W.LOG&&this._logger.log(r.data);let n=this._pendingRequests.get(r.requestId);if(!n){console.warn(`unassociated response: [${r.requestId}, ${r.type.toString()}]`);return}if(this._pendingRequests.delete(r.requestId),r.type==W.ERROR){let s=new Error(r.data.message);s.name=r.data.name,s.stack=r.data.stack,n.promiseRejecter(s);return}switch(n.type){case _.CLOSE_PREPARED:case _.COLLECT_FILE_STATISTICS:case _.COPY_FILE_TO_PATH:case _.DISCONNECT:case _.DROP_FILES:case _.FLUSH_FILES:case _.INSERT_ARROW_FROM_IPC_STREAM:case _.INSERT_CSV_FROM_PATH:case _.INSERT_JSON_FROM_PATH:case _.INSTANTIATE:case _.OPEN:case _.PING:case _.REGISTER_FILE_BUFFER:case _.REGISTER_FILE_HANDLE:case _.REGISTER_FILE_URL:case _.RESET:if(r.type==W.OK){n.promiseResolver(r.data);return}break;case _.GLOB_FILE_INFOS:if(r.type==W.FILE_INFOS){n.promiseResolver(r.data);return}break;case _.GET_VERSION:if(r.type==W.VERSION_STRING){n.promiseResolver(r.data);return}break;case _.GET_FEATURE_FLAGS:if(r.type==W.FEATURE_FLAGS){n.promiseResolver(r.data);return}break;case _.TOKENIZE:if(r.type==W.SCRIPT_TOKENS){n.promiseResolver(r.data);return}break;case _.DROP_FILE:if(r.type==W.SUCCESS){n.promiseResolver(r.data);return}break;case _.COPY_FILE_TO_BUFFER:if(r.type==W.FILE_BUFFER){n.promiseResolver(r.data);return}break;case _.EXPORT_FILE_STATISTICS:if(r.type==W.FILE_STATISTICS){n.promiseResolver(r.data);return}break;case _.CONNECT:if(r.type==W.CONNECTION_INFO){n.promiseResolver(r.data);return}break;case _.RUN_PREPARED:case _.RUN_QUERY:if(r.type==W.QUERY_RESULT){n.promiseResolver(r.data);return}break;case _.SEND_PREPARED:case _.SEND_QUERY:if(r.type==W.QUERY_START){n.promiseResolver(r.data);return}break;case _.FETCH_QUERY_RESULTS:if(r.type==W.QUERY_RESULT_CHUNK){n.promiseResolver(r.data);return}break;case _.CREATE_PREPARED:if(r.type==W.PREPARED_STATEMENT_ID){n.promiseResolver(r.data);return}break}n.promiseRejecter(new Error(`unexpected response type: ${r.type.toString()}`))}onError(e){console.error(e),console.error(`error in duckdb worker: ${e.message}`),this._pendingRequests.clear()}onClose(){if(this._workerShutdownResolver(null),this._pendingRequests.size!=0){console.warn(`worker terminated with ${this._pendingRequests.size} pending requests`);return}this._pendingRequests.clear()}async reset(){let e=new J(_.RESET,null);return await this.postTask(e)}async ping(){let e=new J(_.PING,null);await this.postTask(e)}async dropFile(e){let r=new J(_.DROP_FILE,e);return await this.postTask(r)}async dropFiles(){let e=new J(_.DROP_FILES,null);return await this.postTask(e)}async flushFiles(){let e=new J(_.FLUSH_FILES,null);return await this.postTask(e)}async instantiate(e,r=null){let n=new J(_.INSTANTIATE,[e,r]);return await this.postTask(n)}async getVersion(){let e=new J(_.GET_VERSION,null);return await this.postTask(e)}async getFeatureFlags(){let e=new J(_.GET_FEATURE_FLAGS,null);return await this.postTask(e)}async open(e){let r=new J(_.OPEN,e);await this.postTask(r)}async tokenize(e){let r=new J(_.TOKENIZE,e);return await this.postTask(r)}async connectInternal(){let e=new J(_.CONNECT,null);return await this.postTask(e)}async connect(){let e=await this.connectInternal();return new Da(this,e)}async disconnect(e){let r=new J(_.DISCONNECT,e);await this.postTask(r)}async runQuery(e,r){let n=new J(_.RUN_QUERY,[e,r]);return await this.postTask(n)}async sendQuery(e,r){let n=new J(_.SEND_QUERY,[e,r]);return await this.postTask(n)}async fetchQueryResults(e){let r=new J(_.FETCH_QUERY_RESULTS,e);return await this.postTask(r)}async createPrepared(e,r){let n=new J(_.CREATE_PREPARED,[e,r]);return await this.postTask(n)}async closePrepared(e,r){let n=new J(_.CLOSE_PREPARED,[e,r]);await this.postTask(n)}async runPrepared(e,r,n){let s=new J(_.RUN_PREPARED,[e,r,n]);return await this.postTask(s)}async sendPrepared(e,r,n){let s=new J(_.SEND_PREPARED,[e,r,n]);return await this.postTask(s)}async globFiles(e){let r=new J(_.GLOB_FILE_INFOS,e);return await this.postTask(r)}async registerFileText(e,r){let n=bw.encode(r);await this.registerFileBuffer(e,n)}async registerFileURL(e,r){r===void 0&&(r=e);let n=new J(_.REGISTER_FILE_URL,[e,r]);await this.postTask(n)}async registerEmptyFileBuffer(e){let r=new J(_.REGISTER_FILE_BUFFER,[e,new Uint8Array]);await this.postTask(r)}async registerFileBuffer(e,r){let n=new J(_.REGISTER_FILE_BUFFER,[e,r]);await this.postTask(n,[r.buffer])}async registerFileHandle(e,r){let n=new J(_.REGISTER_FILE_HANDLE,[e,r]);await this.postTask(n,[])}async collectFileStatistics(e,r){let n=new J(_.COLLECT_FILE_STATISTICS,[e,r]);await this.postTask(n,[])}async exportFileStatistics(e){let r=new J(_.EXPORT_FILE_STATISTICS,e);return await this.postTask(r,[])}async copyFileToBuffer(e){let r=new J(_.COPY_FILE_TO_BUFFER,e);return await this.postTask(r)}async copyFileToPath(e,r){let n=new J(_.COPY_FILE_TO_PATH,[e,r]);await this.postTask(n)}async insertArrowFromIPCStream(e,r,n){let s=new J(_.INSERT_ARROW_FROM_IPC_STREAM,[e,r,n]);await this.postTask(s,[r.buffer])}async insertCSVFromPath(e,r,n){if(n.columns!==void 0){let a=[];for(let o in n.columns){let c=n.columns[o];a.push(Ai(o,c))}n.columnsFlat=a,delete n.columns}let s=new J(_.INSERT_CSV_FROM_PATH,[e,r,n]);await this.postTask(s)}async insertJSONFromPath(e,r,n){if(n.columns!==void 0){let a=[];for(let o in n.columns){let c=n.columns[o];a.push(Ai(o,c))}n.columnsFlat=a,delete n.columns}let s=new J(_.INSERT_JSON_FROM_PATH,[e,r,n]);await this.postTask(s)}};var ay=class{constructor(){this._bindings=null;this._nextMessageId=0}log(e){this.postMessage({messageId:this._nextMessageId++,requestId:0,type:W.LOG,data:e},[])}sendOK(e){this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:W.OK,data:null},[])}failWith(e,r){let n={name:r.name,message:r.message,stack:r.stack||void 0};this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:W.ERROR,data:n},[])}async onMessage(e){switch(e.type){case _.PING:this.sendOK(e);return;case _.INSTANTIATE:this._bindings!=null&&this.failWith(e,new Error("duckdb already initialized"));try{this._bindings=await this.instantiate(e.data[0],e.data[1]),this.sendOK(e)}catch(r){this._bindings=null,this.failWith(e,r)}return;default:break}if(!this._bindings)return this.failWith(e,new Error("duckdb is not initialized"));try{switch(e.type){case _.GET_VERSION:this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:W.VERSION_STRING,data:this._bindings.getVersion()},[]);break;case _.GET_FEATURE_FLAGS:this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:W.FEATURE_FLAGS,data:this._bindings.getFeatureFlags()},[]);break;case _.RESET:this._bindings.reset(),this.sendOK(e);break;case _.OPEN:this._bindings.open(e.data),this.sendOK(e);break;case _.DROP_FILE:this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:W.SUCCESS,data:this._bindings.dropFile(e.data)},[]);break;case _.DROP_FILES:this._bindings.dropFiles(),this.sendOK(e);break;case _.FLUSH_FILES:this._bindings.flushFiles(),this.sendOK(e);break;case _.CONNECT:{let r=this._bindings.connect();this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:W.CONNECTION_INFO,data:r.useUnsafe((n,s)=>s)},[]);break}case _.DISCONNECT:this._bindings.disconnect(e.data),this.sendOK(e);break;case _.CREATE_PREPARED:{let r=this._bindings.createPrepared(e.data[0],e.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:W.PREPARED_STATEMENT_ID,data:r},[]);break}case _.CLOSE_PREPARED:{this._bindings.closePrepared(e.data[0],e.data[1]),this.sendOK(e);break}case _.RUN_PREPARED:{let r=this._bindings.runPrepared(e.data[0],e.data[1],e.data[2]);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:W.QUERY_RESULT,data:r},[r.buffer]);break}case _.RUN_QUERY:{let r=this._bindings.runQuery(e.data[0],e.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:W.QUERY_RESULT,data:r},[r.buffer]);break}case _.SEND_PREPARED:{let r=this._bindings.sendPrepared(e.data[0],e.data[1],e.data[2]);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:W.QUERY_START,data:r},[r.buffer]);break}case _.SEND_QUERY:{let r=this._bindings.sendQuery(e.data[0],e.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:W.QUERY_START,data:r},[r.buffer]);break}case _.FETCH_QUERY_RESULTS:{let r=this._bindings.fetchQueryResults(e.data);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:W.QUERY_RESULT_CHUNK,data:r},[r.buffer]);break}case _.GLOB_FILE_INFOS:{let r=this._bindings.globFiles(e.data);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:W.FILE_INFOS,data:r},[]);break}case _.REGISTER_FILE_URL:this._bindings.registerFileURL(e.data[0],e.data[1]),this.sendOK(e);break;case _.REGISTER_FILE_BUFFER:this._bindings.registerFileBuffer(e.data[0],e.data[1]),this.sendOK(e);break;case _.REGISTER_FILE_HANDLE:this._bindings.registerFileHandle(e.data[0],e.data[1]),this.sendOK(e);break;case _.COPY_FILE_TO_PATH:this._bindings.copyFileToPath(e.data[0],e.data[1]),this.sendOK(e);break;case _.COPY_FILE_TO_BUFFER:{let r=this._bindings.copyFileToBuffer(e.data);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:W.FILE_BUFFER,data:r},[]);break}case _.COLLECT_FILE_STATISTICS:this._bindings.collectFileStatistics(e.data[0],e.data[1]),this.sendOK(e);break;case _.EXPORT_FILE_STATISTICS:{this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:W.FILE_STATISTICS,data:this._bindings.exportFileStatistics(e.data)},[]);break}case _.INSERT_ARROW_FROM_IPC_STREAM:{this._bindings.insertArrowFromIPCStream(e.data[0],e.data[1],e.data[2]),this.sendOK(e);break}case _.INSERT_CSV_FROM_PATH:{this._bindings.insertCSVFromPath(e.data[0],e.data[1],e.data[2]),this.sendOK(e);break}case _.INSERT_JSON_FROM_PATH:{this._bindings.insertJSONFromPath(e.data[0],e.data[1],e.data[2]),this.sendOK(e);break}case _.TOKENIZE:{let r=this._bindings.tokenize(e.data);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:W.SCRIPT_TOKENS,data:r},[]);break}}}catch(r){return this.failWith(e,r)}}};var oy=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,3,1,0,1,10,14,1,12,0,65,0,65,0,65,0,252,10,0,0,11])),cy=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,6,64,25,11,11]));var uy=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]));var ly=()=>(async t=>{try{return typeof MessageChannel!="undefined"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(t)}catch{return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]));var mw="@duckdb/duckdb-wasm",gw="0.1.12-dev54.0",_w="DuckDB powered by WebAssembly",Tw="MPL-2.0",Bw={type:"git",url:"https://github.com/duckdb/duckdb-wasm.git"},Iw={"@apache-arrow/esnext-esm":"^6.0.0","wasm-feature-detect":"^1.2.11"},ww={"@types/emscripten":"^1.39.4","@types/jasmine":"^3.10.2","@typescript-eslint/eslint-plugin":"^5.3.0","@typescript-eslint/parser":"^5.3.0",esbuild:"^0.13.12",eslint:"^8.2.0","eslint-plugin-jasmine":"^4.1.2","eslint-plugin-react":"^7.26.1",jasmine:"^3.10.0","jasmine-core":"^3.10.1","jasmine-spec-reporter":"^7.0.0",karma:"^6.3.8","karma-chrome-launcher":"^3.1.0","karma-coverage":"^2.0.3","karma-firefox-launcher":"^2.1.2","karma-jasmine":"^4.0.1","karma-jasmine-html-reporter":"^1.7.0","karma-sourcemap-loader":"^0.3.8","karma-spec-reporter":"^0.0.32","fast-glob":"^3.2.7","make-dir":"^3.1.0",nyc:"^15.1.0",prettier:"^2.4.1",puppeteer:"^11.0.0",rimraf:"^3.0.2",typedoc:"^0.22.8",typescript:"^4.4.4","web-worker":"^1.2.0"},vw={fsevents:"*"},Sw={"build:debug":"node bundle.mjs debug && tsc --emitDeclarationOnly","build:release":"node bundle.mjs release && tsc --emitDeclarationOnly",docs:"typedoc",report:"node ./coverage.mjs","test:node":"node --enable-source-maps --experimental-wasm-eh ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.js","test:node:debug":"node --inspect-brk --enable-source-maps --experimental-wasm-eh ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.js","test:node:coverage":"nyc -r json --report-dir ./coverage/node node --experimental-wasm-eh ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.js","test:firefox":"karma start ./karma/tests-firefox.cjs","test:chrome":"karma start ./karma/tests-chrome.cjs","test:chrome:eh":"karma start ./karma/tests-chrome-eh.cjs","test:chrome:coverage":"karma start ./karma/tests-chrome-coverage.cjs","test:browser":"karma start ./karma/tests-all.cjs","test:browser:debug":"karma start ./karma/tests-debug.cjs",test:"npm run test:chrome && npm run test:node","test:coverage":"npm run test:chrome:coverage && npm run test:node:coverage && npm run report",lint:"eslint src test"},Ow=["dist","!dist/types/test"],Aw="./dist/duckdb-node-async.js",Fw="./dist/duckdb-node-async.d.ts",Dw="./dist/duckdb-esm.js",Rw={"./dist/duckdb-node-async.js":"./dist/duckdb-browser-async.js","fast-glob":!1,"temp-write":!1,worker_threads:!1,perf_hooks:!1,fs:!1,os:!1,path:!1,buffer:!1,crypto:!1},Ea={name:mw,version:gw,description:_w,license:Tw,repository:Bw,dependencies:Iw,devDependencies:ww,optionalDependencies:vw,scripts:Sw,files:Ow,main:Aw,types:Fw,module:Dw,browser:Rw};var dy=Ea.name,fy=Ea.version,Qu=Ea.version.split("."),dO=Qu[0],fO=Qu[1],hO=Qu[2];function Ua(t){let e=`importScripts("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))}function Ew(){let t=`https://cdn.jsdelivr.net/npm/${dy}@${fy}/dist/`;return{asyncDefault:{mainModule:`${t}duckdb.wasm`,mainWorker:Ua(`${t}duckdb-browser-async.worker.js`)},asyncNext:{mainModule:`${t}duckdb-next.wasm`,mainWorker:Ua(`${t}duckdb-browser-async-next.worker.js`)},asyncNextCOI:{mainModule:`${t}duckdb-next-coi.wasm`,mainWorker:Ua(`${t}duckdb-browser-async-next-coi.worker.js`),pthreadWorker:Ua(`${t}duckdb-browser-async-next-coi.pthread.worker.js`)}}}var Zu=null,Xu=null,el=null,tl=null,rl=null;function Uw(){return typeof process!="undefined"&&process.release.name==="node"}async function hy(){return Zu==null&&(Zu=typeof BigInt64Array!="undefined"),Xu==null&&(Xu=await cy()),el==null&&(el=await ly()),tl==null&&(tl=await uy()),rl==null&&(rl=await oy()),{bigInt64Array:Zu,crossOriginIsolated:Uw()||globalThis.crossOriginIsolated||!1,wasmExceptions:Xu,wasmSIMD:tl,wasmThreads:el,wasmBulkMemory:rl}}async function Vw(t){let e=await hy();if(e.wasmExceptions&&e.wasmSIMD){if(e.wasmThreads&&e.crossOriginIsolated&&t.asyncNextCOI)return{mainModule:t.asyncNextCOI.mainModule,mainWorker:t.asyncNextCOI.mainWorker,pthreadWorker:t.asyncNextCOI.pthreadWorker};if(t.asyncNext)return{mainModule:t.asyncNext.mainModule,mainWorker:t.asyncNext.mainWorker,pthreadWorker:null}}return{mainModule:t.asyncDefault.mainModule,mainWorker:t.asyncDefault.mainWorker,pthreadWorker:null}}return Mw;})();
//# sourceMappingURL=duckdb-browser-async.js.map
