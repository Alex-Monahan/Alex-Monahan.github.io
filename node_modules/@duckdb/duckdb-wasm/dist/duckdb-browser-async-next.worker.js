var duckdb=(()=>{var eg=Object.create;var Os=Object.defineProperty;var tg=Object.getOwnPropertyDescriptor;var rg=Object.getOwnPropertyNames;var ng=Object.getPrototypeOf,ig=Object.prototype.hasOwnProperty;var Dd=r=>Os(r,"__esModule",{value:!0});var w=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),sg=(r,e)=>{Dd(r);for(var t in e)Os(r,t,{get:e[t],enumerable:!0})},og=(r,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of rg(e))!ig.call(r,n)&&n!=="default"&&Os(r,n,{get:()=>e[n],enumerable:!(t=tg(e,n))||t.enumerable});return r},As=r=>og(Dd(Os(r!=null?eg(ng(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r);var wn=w(Fd=>{var b={};b.Offset;b.Table;b.SIZEOF_SHORT=2;b.SIZEOF_INT=4;b.FILE_IDENTIFIER_LENGTH=4;b.Encoding={UTF8_BYTES:1,UTF16_STRING:2};b.int32=new Int32Array(2);b.float32=new Float32Array(b.int32.buffer);b.float64=new Float64Array(b.int32.buffer);b.isLittleEndian=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;b.Long=function(r,e){this.low=r|0,this.high=e|0};b.Long.create=function(r,e){return r==0&&e==0?b.Long.ZERO:new b.Long(r,e)};b.Long.prototype.toFloat64=function(){return(this.low>>>0)+this.high*4294967296};b.Long.prototype.equals=function(r){return this.low==r.low&&this.high==r.high};b.Long.ZERO=new b.Long(0,0);b.Builder=function(r){if(r)var e=r;else var e=1024;this.bb=b.ByteBuffer.allocate(e),this.space=e,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1};b.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1};b.Builder.prototype.forceDefaults=function(r){this.force_defaults=r};b.Builder.prototype.dataBuffer=function(){return this.bb};b.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())};b.Builder.prototype.prep=function(r,e){r>this.minalign&&(this.minalign=r);for(var t=~(this.bb.capacity()-this.space+e)+1&r-1;this.space<t+r+e;){var n=this.bb.capacity();this.bb=b.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-n}this.pad(t)};b.Builder.prototype.pad=function(r){for(var e=0;e<r;e++)this.bb.writeInt8(--this.space,0)};b.Builder.prototype.writeInt8=function(r){this.bb.writeInt8(this.space-=1,r)};b.Builder.prototype.writeInt16=function(r){this.bb.writeInt16(this.space-=2,r)};b.Builder.prototype.writeInt32=function(r){this.bb.writeInt32(this.space-=4,r)};b.Builder.prototype.writeInt64=function(r){this.bb.writeInt64(this.space-=8,r)};b.Builder.prototype.writeFloat32=function(r){this.bb.writeFloat32(this.space-=4,r)};b.Builder.prototype.writeFloat64=function(r){this.bb.writeFloat64(this.space-=8,r)};b.Builder.prototype.addInt8=function(r){this.prep(1,0),this.writeInt8(r)};b.Builder.prototype.addInt16=function(r){this.prep(2,0),this.writeInt16(r)};b.Builder.prototype.addInt32=function(r){this.prep(4,0),this.writeInt32(r)};b.Builder.prototype.addInt64=function(r){this.prep(8,0),this.writeInt64(r)};b.Builder.prototype.addFloat32=function(r){this.prep(4,0),this.writeFloat32(r)};b.Builder.prototype.addFloat64=function(r){this.prep(8,0),this.writeFloat64(r)};b.Builder.prototype.addFieldInt8=function(r,e,t){(this.force_defaults||e!=t)&&(this.addInt8(e),this.slot(r))};b.Builder.prototype.addFieldInt16=function(r,e,t){(this.force_defaults||e!=t)&&(this.addInt16(e),this.slot(r))};b.Builder.prototype.addFieldInt32=function(r,e,t){(this.force_defaults||e!=t)&&(this.addInt32(e),this.slot(r))};b.Builder.prototype.addFieldInt64=function(r,e,t){(this.force_defaults||!e.equals(t))&&(this.addInt64(e),this.slot(r))};b.Builder.prototype.addFieldFloat32=function(r,e,t){(this.force_defaults||e!=t)&&(this.addFloat32(e),this.slot(r))};b.Builder.prototype.addFieldFloat64=function(r,e,t){(this.force_defaults||e!=t)&&(this.addFloat64(e),this.slot(r))};b.Builder.prototype.addFieldOffset=function(r,e,t){(this.force_defaults||e!=t)&&(this.addOffset(e),this.slot(r))};b.Builder.prototype.addFieldStruct=function(r,e,t){e!=t&&(this.nested(e),this.slot(r))};b.Builder.prototype.nested=function(r){if(r!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")};b.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")};b.Builder.prototype.slot=function(r){this.vtable[r]=this.offset()};b.Builder.prototype.offset=function(){return this.bb.capacity()-this.space};b.Builder.growByteBuffer=function(r){var e=r.capacity();if(e&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var t=e<<1,n=b.ByteBuffer.allocate(t);return n.setPosition(t-e),n.bytes().set(r.bytes(),t-e),n};b.Builder.prototype.addOffset=function(r){this.prep(b.SIZEOF_INT,0),this.writeInt32(this.offset()-r+b.SIZEOF_INT)};b.Builder.prototype.startObject=function(r){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=r;for(var e=0;e<r;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()};b.Builder.prototype.endObject=function(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var r=this.offset(),e=this.vtable_in_use-1;e>=0&&this.vtable[e]==0;e--);for(var t=e+1;e>=0;e--)this.addInt16(this.vtable[e]!=0?r-this.vtable[e]:0);var n=2;this.addInt16(r-this.object_start);var i=(t+n)*b.SIZEOF_SHORT;this.addInt16(i);var o=0,a=this.space;e:for(e=0;e<this.vtables.length;e++){var u=this.bb.capacity()-this.vtables[e];if(i==this.bb.readInt16(u)){for(var f=b.SIZEOF_SHORT;f<i;f+=b.SIZEOF_SHORT)if(this.bb.readInt16(a+f)!=this.bb.readInt16(u+f))continue e;o=this.vtables[e];break}}return o?(this.space=this.bb.capacity()-r,this.bb.writeInt32(this.space,o-r)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-r,this.offset()-r)),this.isNested=!1,r};b.Builder.prototype.finish=function(r,e){if(e){var t=e;if(this.prep(this.minalign,b.SIZEOF_INT+b.FILE_IDENTIFIER_LENGTH),t.length!=b.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+b.FILE_IDENTIFIER_LENGTH);for(var n=b.FILE_IDENTIFIER_LENGTH-1;n>=0;n--)this.writeInt8(t.charCodeAt(n))}this.prep(this.minalign,b.SIZEOF_INT),this.addOffset(r),this.bb.setPosition(this.space)};b.Builder.prototype.requiredField=function(r,e){var t=this.bb.capacity()-r,n=t-this.bb.readInt32(t),i=this.bb.readInt16(n+e)!=0;if(!i)throw new Error("FlatBuffers: field "+e+" must be set")};b.Builder.prototype.startVector=function(r,e,t){this.notNested(),this.vector_num_elems=e,this.prep(b.SIZEOF_INT,r*e),this.prep(t,r*e)};b.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset()};b.Builder.prototype.createString=function(r){if(r instanceof Uint8Array)var e=r;else for(var e=[],t=0;t<r.length;){var n,i=r.charCodeAt(t++);if(i<55296||i>=56320)n=i;else{var o=r.charCodeAt(t++);n=(i<<10)+o+(65536-(55296<<10)-56320)}n<128?e.push(n):(n<2048?e.push(n>>6&31|192):(n<65536?e.push(n>>12&15|224):e.push(n>>18&7|240,n>>12&63|128),e.push(n>>6&63|128)),e.push(n&63|128))}this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(var t=0,a=this.space,u=this.bb.bytes();t<e.length;t++)u[a++]=e[t];return this.endVector()};b.Builder.prototype.createLong=function(r,e){return b.Long.create(r,e)};b.ByteBuffer=function(r){this.bytes_=r,this.position_=0};b.ByteBuffer.allocate=function(r){return new b.ByteBuffer(new Uint8Array(r))};b.ByteBuffer.prototype.clear=function(){this.position_=0};b.ByteBuffer.prototype.bytes=function(){return this.bytes_};b.ByteBuffer.prototype.position=function(){return this.position_};b.ByteBuffer.prototype.setPosition=function(r){this.position_=r};b.ByteBuffer.prototype.capacity=function(){return this.bytes_.length};b.ByteBuffer.prototype.readInt8=function(r){return this.readUint8(r)<<24>>24};b.ByteBuffer.prototype.readUint8=function(r){return this.bytes_[r]};b.ByteBuffer.prototype.readInt16=function(r){return this.readUint16(r)<<16>>16};b.ByteBuffer.prototype.readUint16=function(r){return this.bytes_[r]|this.bytes_[r+1]<<8};b.ByteBuffer.prototype.readInt32=function(r){return this.bytes_[r]|this.bytes_[r+1]<<8|this.bytes_[r+2]<<16|this.bytes_[r+3]<<24};b.ByteBuffer.prototype.readUint32=function(r){return this.readInt32(r)>>>0};b.ByteBuffer.prototype.readInt64=function(r){return new b.Long(this.readInt32(r),this.readInt32(r+4))};b.ByteBuffer.prototype.readUint64=function(r){return new b.Long(this.readUint32(r),this.readUint32(r+4))};b.ByteBuffer.prototype.readFloat32=function(r){return b.int32[0]=this.readInt32(r),b.float32[0]};b.ByteBuffer.prototype.readFloat64=function(r){return b.int32[b.isLittleEndian?0:1]=this.readInt32(r),b.int32[b.isLittleEndian?1:0]=this.readInt32(r+4),b.float64[0]};b.ByteBuffer.prototype.writeInt8=function(r,e){this.bytes_[r]=e};b.ByteBuffer.prototype.writeUint8=function(r,e){this.bytes_[r]=e};b.ByteBuffer.prototype.writeInt16=function(r,e){this.bytes_[r]=e,this.bytes_[r+1]=e>>8};b.ByteBuffer.prototype.writeUint16=function(r,e){this.bytes_[r]=e,this.bytes_[r+1]=e>>8};b.ByteBuffer.prototype.writeInt32=function(r,e){this.bytes_[r]=e,this.bytes_[r+1]=e>>8,this.bytes_[r+2]=e>>16,this.bytes_[r+3]=e>>24};b.ByteBuffer.prototype.writeUint32=function(r,e){this.bytes_[r]=e,this.bytes_[r+1]=e>>8,this.bytes_[r+2]=e>>16,this.bytes_[r+3]=e>>24};b.ByteBuffer.prototype.writeInt64=function(r,e){this.writeInt32(r,e.low),this.writeInt32(r+4,e.high)};b.ByteBuffer.prototype.writeUint64=function(r,e){this.writeUint32(r,e.low),this.writeUint32(r+4,e.high)};b.ByteBuffer.prototype.writeFloat32=function(r,e){b.float32[0]=e,this.writeInt32(r,b.int32[0])};b.ByteBuffer.prototype.writeFloat64=function(r,e){b.float64[0]=e,this.writeInt32(r,b.int32[b.isLittleEndian?0:1]),this.writeInt32(r+4,b.int32[b.isLittleEndian?1:0])};b.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+b.SIZEOF_INT+b.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var r="",e=0;e<b.FILE_IDENTIFIER_LENGTH;e++)r+=String.fromCharCode(this.readInt8(this.position_+b.SIZEOF_INT+e));return r};b.ByteBuffer.prototype.__offset=function(r,e){var t=r-this.readInt32(r);return e<this.readInt16(t)?this.readInt16(t+e):0};b.ByteBuffer.prototype.__union=function(r,e){return r.bb_pos=e+this.readInt32(e),r.bb=this,r};b.ByteBuffer.prototype.__string=function(r,e){r+=this.readInt32(r);var t=this.readInt32(r),n="",i=0;if(r+=b.SIZEOF_INT,e===b.Encoding.UTF8_BYTES)return this.bytes_.subarray(r,r+t);for(;i<t;){var o,a=this.readUint8(r+i++);if(a<192)o=a;else{var u=this.readUint8(r+i++);if(a<224)o=(a&31)<<6|u&63;else{var f=this.readUint8(r+i++);if(a<240)o=(a&15)<<12|(u&63)<<6|f&63;else{var s=this.readUint8(r+i++);o=(a&7)<<18|(u&63)<<12|(f&63)<<6|s&63}}}o<65536?n+=String.fromCharCode(o):(o-=65536,n+=String.fromCharCode((o>>10)+55296,(o&(1<<10)-1)+56320))}return n};b.ByteBuffer.prototype.__indirect=function(r){return r+this.readInt32(r)};b.ByteBuffer.prototype.__vector=function(r){return r+this.readInt32(r)+b.SIZEOF_INT};b.ByteBuffer.prototype.__vector_len=function(r){return this.readInt32(r+this.readInt32(r))};b.ByteBuffer.prototype.__has_identifier=function(r){if(r.length!=b.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+b.FILE_IDENTIFIER_LENGTH);for(var e=0;e<b.FILE_IDENTIFIER_LENGTH;e++)if(r.charCodeAt(e)!=this.readInt8(this.position_+b.SIZEOF_INT+e))return!1;return!0};b.ByteBuffer.prototype.createLong=function(r,e){return b.Long.create(r,e)};Fd.flatbuffers=b});var Rd=w(qa=>{"use strict";function sr(r,e,t){return e<=r&&r<=t}function Ds(r){if(r===void 0)return{};if(r===Object(r))return r;throw TypeError("Could not convert argument to dictionary")}function ag(r){for(var e=String(r),t=e.length,n=0,i=[];n<t;){var o=e.charCodeAt(n);if(o<55296||o>57343)i.push(o);else if(56320<=o&&o<=57343)i.push(65533);else if(55296<=o&&o<=56319)if(n===t-1)i.push(65533);else{var a=r.charCodeAt(n+1);if(56320<=a&&a<=57343){var u=o&1023,f=a&1023;i.push(65536+(u<<10)+f),n+=1}else i.push(65533)}n+=1}return i}function ug(r){for(var e="",t=0;t<r.length;++t){var n=r[t];n<=65535?e+=String.fromCharCode(n):(n-=65536,e+=String.fromCharCode((n>>10)+55296,(n&1023)+56320))}return e}var Fs=-1;function Ca(r){this.tokens=[].slice.call(r)}Ca.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():Fs},prepend:function(r){if(Array.isArray(r))for(var e=r;e.length;)this.tokens.unshift(e.pop());else this.tokens.unshift(r)},push:function(r){if(Array.isArray(r))for(var e=r;e.length;)this.tokens.push(e.shift());else this.tokens.push(r)}};var Tn=-1;function ja(r,e){if(r)throw TypeError("Decoder error");return e||65533}var Rs="utf-8";function Es(r,e){if(!(this instanceof Es))return new Es(r,e);if(r=r!==void 0?String(r).toLowerCase():Rs,r!==Rs)throw new Error("Encoding not supported. Only utf-8 is supported");e=Ds(e),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=Boolean(e.fatal),this._ignoreBOM=Boolean(e.ignoreBOM),Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}Es.prototype={decode:function(e,t){var n;typeof e=="object"&&e instanceof ArrayBuffer?n=new Uint8Array(e):typeof e=="object"&&"buffer"in e&&e.buffer instanceof ArrayBuffer?n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):n=new Uint8Array(0),t=Ds(t),this._streaming||(this._decoder=new cg({fatal:this._fatal}),this._BOMseen=!1),this._streaming=Boolean(t.stream);for(var i=new Ca(n),o=[],a;!i.endOfStream()&&(a=this._decoder.handler(i,i.read()),a!==Tn);)a!==null&&(Array.isArray(a)?o.push.apply(o,a):o.push(a));if(!this._streaming){do{if(a=this._decoder.handler(i,i.read()),a===Tn)break;a!==null&&(Array.isArray(a)?o.push.apply(o,a):o.push(a))}while(!i.endOfStream());this._decoder=null}return o.length&&["utf-8"].indexOf(this.encoding)!==-1&&!this._ignoreBOM&&!this._BOMseen&&(o[0]===65279?(this._BOMseen=!0,o.shift()):this._BOMseen=!0),ug(o)}};function Us(r,e){if(!(this instanceof Us))return new Us(r,e);if(r=r!==void 0?String(r).toLowerCase():Rs,r!==Rs)throw new Error("Encoding not supported. Only utf-8 is supported");e=Ds(e),this._streaming=!1,this._encoder=null,this._options={fatal:Boolean(e.fatal)},Object.defineProperty(this,"encoding",{value:"utf-8"})}Us.prototype={encode:function(e,t){e=e?String(e):"",t=Ds(t),this._streaming||(this._encoder=new lg(this._options)),this._streaming=Boolean(t.stream);for(var n=[],i=new Ca(ag(e)),o;!i.endOfStream()&&(o=this._encoder.handler(i,i.read()),o!==Tn);)Array.isArray(o)?n.push.apply(n,o):n.push(o);if(!this._streaming){for(;o=this._encoder.handler(i,i.read()),o!==Tn;)Array.isArray(o)?n.push.apply(n,o):n.push(o);this._encoder=null}return new Uint8Array(n)}};function cg(r){var e=r.fatal,t=0,n=0,i=0,o=128,a=191;this.handler=function(u,f){if(f===Fs&&i!==0)return i=0,ja(e);if(f===Fs)return Tn;if(i===0){if(sr(f,0,127))return f;if(sr(f,194,223))i=1,t=f-192;else if(sr(f,224,239))f===224&&(o=160),f===237&&(a=159),i=2,t=f-224;else if(sr(f,240,244))f===240&&(o=144),f===244&&(a=143),i=3,t=f-240;else return ja(e);return t=t<<6*i,null}if(!sr(f,o,a))return t=i=n=0,o=128,a=191,u.prepend(f),ja(e);if(o=128,a=191,n+=1,t+=f-128<<6*(i-n),n!==i)return null;var s=t;return t=i=n=0,s}}function lg(r){var e=r.fatal;this.handler=function(t,n){if(n===Fs)return Tn;if(sr(n,0,127))return n;var i,o;sr(n,128,2047)?(i=1,o=192):sr(n,2048,65535)?(i=2,o=224):sr(n,65536,1114111)&&(i=3,o=240);for(var a=[(n>>6*i)+o];i>0;){var u=n>>6*(i-1);a.push(128|u&63),i-=1}return a}}qa.TextEncoder=Us;qa.TextDecoder=Es});var Zr=w(Bn=>{"use strict";Object.defineProperty(Bn,"__esModule",{value:!0});Bn.encodeUtf8=Bn.decodeUtf8=void 0;var Ed=Ae(),Ud=Rd(),Ms=typeof Buffer=="function"?Buffer:null,Md=typeof TextDecoder=="function"&&typeof TextEncoder=="function";Bn.decodeUtf8=(r=>{if(Md||!Ms){let e=new r("utf-8");return t=>e.decode(t)}return e=>{let{buffer:t,byteOffset:n,length:i}=Ed.toUint8Array(e);return Ms.from(t,n,i).toString()}})(typeof TextDecoder!="undefined"?TextDecoder:Ud.TextDecoder);Bn.encodeUtf8=(r=>{if(Md||!Ms){let e=new r;return t=>e.encode(t)}return(e="")=>Ed.toUint8Array(Ms.from(e,"utf8"))})(typeof TextEncoder!="undefined"?TextEncoder:Ud.TextEncoder)});var vn=w(tt=>{"use strict";Object.defineProperty(tt,"__esModule",{value:!0});tt.AsyncQueue=tt.ReadableInterop=tt.ArrowJSON=tt.ITERATOR_DONE=void 0;var Pd=Oi();tt.ITERATOR_DONE=Object.freeze({done:!0,value:void 0});var Vd=class{constructor(e){this._json=e}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}};tt.ArrowJSON=Vd;var Wa=class{tee(){return this._getDOMStream().tee()}pipe(e,t){return this._getNodeStream().pipe(e,t)}pipeTo(e,t){return this._getDOMStream().pipeTo(e,t)}pipeThrough(e,t){return this._getDOMStream().pipeThrough(e,t)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}};tt.ReadableInterop=Wa;var Nd=class extends Wa{constructor(){super();this._values=[],this.resolvers=[],this._closedPromise=new Promise(e=>this._closedPromiseResolve=e)}get closed(){return this._closedPromise}async cancel(e){await this.return(e)}write(e){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(e):this.resolvers.shift().resolve({done:!1,value:e}))}abort(e){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:e}:this.resolvers.shift().reject({done:!0,value:e}))}close(){if(this._closedPromiseResolve){let{resolvers:e}=this;for(;e.length>0;)e.shift().resolve(tt.ITERATOR_DONE);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(e){return Pd.default.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,e)}toNodeStream(e){return Pd.default.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,e)}async throw(e){return await this.abort(e),tt.ITERATOR_DONE}async return(e){return await this.close(),tt.ITERATOR_DONE}async read(e){return(await this.next(e,"read")).value}async peek(e){return(await this.next(e,"peek")).value}next(...e){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((t,n)=>{this.resolvers.push({resolve:t,reject:n})}):Promise.resolve(tt.ITERATOR_DONE)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error(`${this} is closed`)}};tt.AsyncQueue=Nd});var He=w(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.isReadableNodeStream=F.isWritableNodeStream=F.isReadableDOMStream=F.isWritableDOMStream=F.isFetchResponse=F.isFSReadStream=F.isFileHandle=F.isUnderlyingSink=F.isIteratorResult=F.isArrayLike=F.isArrowJSON=F.isAsyncIterable=F.isIterable=F.isObservable=F.isPromise=F.isObject=F.BigUint64ArrayAvailable=F.BigUint64Array=F.BigInt64ArrayAvailable=F.BigInt64Array=F.BigIntAvailable=F.BigInt=void 0;var Ps=vn(),[dg,fg]=(()=>{let r=()=>{throw new Error("BigInt is not available in this environment")};function e(){throw r()}return e.asIntN=()=>{throw r()},e.asUintN=()=>{throw r()},typeof BigInt!="undefined"?[BigInt,!0]:[e,!1]})();F.BigInt=dg;F.BigIntAvailable=fg;var[hg,pg]=(()=>{let r=()=>{throw new Error("BigInt64Array is not available in this environment")};class e{static get BYTES_PER_ELEMENT(){return 8}static of(){throw r()}static from(){throw r()}constructor(){throw r()}}return typeof BigInt64Array!="undefined"?[BigInt64Array,!0]:[e,!1]})();F.BigInt64Array=hg;F.BigInt64ArrayAvailable=pg;var[yg,bg]=(()=>{let r=()=>{throw new Error("BigUint64Array is not available in this environment")};class e{static get BYTES_PER_ELEMENT(){return 8}static of(){throw r()}static from(){throw r()}constructor(){throw r()}}return typeof BigUint64Array!="undefined"?[BigUint64Array,!0]:[e,!1]})();F.BigUint64Array=yg;F.BigUint64ArrayAvailable=bg;var za=r=>typeof r=="number",kd=r=>typeof r=="boolean",qe=r=>typeof r=="function";F.isObject=r=>r!=null&&Object(r)===r;F.isPromise=r=>F.isObject(r)&&qe(r.then);F.isObservable=r=>F.isObject(r)&&qe(r.subscribe);F.isIterable=r=>F.isObject(r)&&qe(r[Symbol.iterator]);F.isAsyncIterable=r=>F.isObject(r)&&qe(r[Symbol.asyncIterator]);F.isArrowJSON=r=>F.isObject(r)&&F.isObject(r.schema);F.isArrayLike=r=>F.isObject(r)&&za(r.length);F.isIteratorResult=r=>F.isObject(r)&&"done"in r&&"value"in r;F.isUnderlyingSink=r=>F.isObject(r)&&qe(r.abort)&&qe(r.close)&&qe(r.start)&&qe(r.write);F.isFileHandle=r=>F.isObject(r)&&qe(r.stat)&&za(r.fd);F.isFSReadStream=r=>F.isReadableNodeStream(r)&&za(r.bytesRead);F.isFetchResponse=r=>F.isObject(r)&&F.isReadableDOMStream(r.body);F.isWritableDOMStream=r=>F.isObject(r)&&qe(r.abort)&&qe(r.getWriter)&&!(r instanceof Ps.ReadableInterop);F.isReadableDOMStream=r=>F.isObject(r)&&qe(r.cancel)&&qe(r.getReader)&&!(r instanceof Ps.ReadableInterop);F.isWritableNodeStream=r=>F.isObject(r)&&qe(r.end)&&qe(r.write)&&kd(r.writable)&&!(r instanceof Ps.ReadableInterop);F.isReadableNodeStream=r=>F.isObject(r)&&qe(r.read)&&qe(r.pipe)&&kd(r.readable)&&!(r instanceof Ps.ReadableInterop)});var Ae=w(O=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0});O.compareArrayLike=O.rebaseValueOffsets=O.toUint8ClampedArrayAsyncIterator=O.toFloat64ArrayAsyncIterator=O.toFloat32ArrayAsyncIterator=O.toUint32ArrayAsyncIterator=O.toUint16ArrayAsyncIterator=O.toUint8ArrayAsyncIterator=O.toInt32ArrayAsyncIterator=O.toInt16ArrayAsyncIterator=O.toInt8ArrayAsyncIterator=O.toArrayBufferViewAsyncIterator=O.toUint8ClampedArrayIterator=O.toFloat64ArrayIterator=O.toFloat32ArrayIterator=O.toUint32ArrayIterator=O.toUint16ArrayIterator=O.toUint8ArrayIterator=O.toInt32ArrayIterator=O.toInt16ArrayIterator=O.toInt8ArrayIterator=O.toArrayBufferViewIterator=O.toUint8ClampedArray=O.toFloat64Array=O.toFloat32Array=O.toBigUint64Array=O.toUint32Array=O.toUint16Array=O.toUint8Array=O.toBigInt64Array=O.toInt32Array=O.toInt16Array=O.toInt8Array=O.toArrayBufferView=O.joinUint8Arrays=O.memcpy=void 0;var mg=wn(),_g=Zr(),gg=mg.flatbuffers.ByteBuffer,Xr=He(),Ya=typeof SharedArrayBuffer!="undefined"?SharedArrayBuffer:ArrayBuffer;function wg(r){let e=r[0]?[r[0]]:[],t,n,i,o;for(let a,u,f=0,s=0,c=r.length;++f<c;){if(a=e[s],u=r[f],!a||!u||a.buffer!==u.buffer||u.byteOffset<a.byteOffset){u&&(e[++s]=u);continue}if({byteOffset:t,byteLength:i}=a,{byteOffset:n,byteLength:o}=u,t+i<n||n+o<t){u&&(e[++s]=u);continue}e[s]=new Uint8Array(a.buffer,t,n-t+o)}return e}function Ha(r,e,t=0,n=e.byteLength){let i=r.byteLength,o=new Uint8Array(r.buffer,r.byteOffset,i),a=new Uint8Array(e.buffer,e.byteOffset,Math.min(n,i));return o.set(a,t),r}O.memcpy=Ha;function Tg(r,e){let t=wg(r),n=t.reduce((c,_)=>c+_.byteLength,0),i,o,a,u=0,f=-1,s=Math.min(e||1/0,n);for(let c=t.length;++f<c;){if(i=t[f],o=i.subarray(0,Math.min(i.length,s-u)),s<=u+o.length){o.length<i.length?t[f]=i.subarray(o.length):o.length===i.length&&f++,a?Ha(a,o,u):a=o;break}Ha(a||(a=new Uint8Array(s)),o,u),u+=o.length}return[a||new Uint8Array(0),t.slice(f),n-(a?a.byteLength:0)]}O.joinUint8Arrays=Tg;function Je(r,e){let t=Xr.isIteratorResult(e)?e.value:e;return t instanceof r?r===Uint8Array?new r(t.buffer,t.byteOffset,t.byteLength):t:t?(typeof t=="string"&&(t=_g.encodeUtf8(t)),t instanceof ArrayBuffer?new r(t):t instanceof Ya?new r(t):t instanceof gg?Je(r,t.bytes()):ArrayBuffer.isView(t)?t.byteLength<=0?new r(0):new r(t.buffer,t.byteOffset,t.byteLength/r.BYTES_PER_ELEMENT):r.from(t)):new r(0)}O.toArrayBufferView=Je;O.toInt8Array=r=>Je(Int8Array,r);O.toInt16Array=r=>Je(Int16Array,r);O.toInt32Array=r=>Je(Int32Array,r);O.toBigInt64Array=r=>Je(Xr.BigInt64Array,r);O.toUint8Array=r=>Je(Uint8Array,r);O.toUint16Array=r=>Je(Uint16Array,r);O.toUint32Array=r=>Je(Uint32Array,r);O.toBigUint64Array=r=>Je(Xr.BigUint64Array,r);O.toFloat32Array=r=>Je(Float32Array,r);O.toFloat64Array=r=>Je(Float64Array,r);O.toUint8ClampedArray=r=>Je(Uint8ClampedArray,r);var Ga=r=>(r.next(),r);function*kt(r,e){let t=function*(i){yield i},n=typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof Ya?t(e):Xr.isIterable(e)?e:t(e);return yield*Ga(function*(i){let o=null;do o=i.next(yield Je(r,o));while(!o.done)}(n[Symbol.iterator]())),new r}O.toArrayBufferViewIterator=kt;O.toInt8ArrayIterator=r=>kt(Int8Array,r);O.toInt16ArrayIterator=r=>kt(Int16Array,r);O.toInt32ArrayIterator=r=>kt(Int32Array,r);O.toUint8ArrayIterator=r=>kt(Uint8Array,r);O.toUint16ArrayIterator=r=>kt(Uint16Array,r);O.toUint32ArrayIterator=r=>kt(Uint32Array,r);O.toFloat32ArrayIterator=r=>kt(Float32Array,r);O.toFloat64ArrayIterator=r=>kt(Float64Array,r);O.toUint8ClampedArrayIterator=r=>kt(Uint8ClampedArray,r);async function*It(r,e){if(Xr.isPromise(e))return yield*It(r,await e);let t=async function*(o){yield await o},n=async function*(o){yield*Ga(function*(a){let u=null;do u=a.next(yield u&&u.value);while(!u.done)}(o[Symbol.iterator]()))},i=typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof Ya?t(e):Xr.isIterable(e)?n(e):Xr.isAsyncIterable(e)?e:t(e);return yield*Ga(async function*(o){let a=null;do a=await o.next(yield Je(r,a));while(!a.done)}(i[Symbol.asyncIterator]())),new r}O.toArrayBufferViewAsyncIterator=It;O.toInt8ArrayAsyncIterator=r=>It(Int8Array,r);O.toInt16ArrayAsyncIterator=r=>It(Int16Array,r);O.toInt32ArrayAsyncIterator=r=>It(Int32Array,r);O.toUint8ArrayAsyncIterator=r=>It(Uint8Array,r);O.toUint16ArrayAsyncIterator=r=>It(Uint16Array,r);O.toUint32ArrayAsyncIterator=r=>It(Uint32Array,r);O.toFloat32ArrayAsyncIterator=r=>It(Float32Array,r);O.toFloat64ArrayAsyncIterator=r=>It(Float64Array,r);O.toUint8ClampedArrayAsyncIterator=r=>It(Uint8ClampedArray,r);function Bg(r,e,t){if(r!==0){t=t.slice(0,e+1);for(let n=-1;++n<=e;)t[n]+=r}return t}O.rebaseValueOffsets=Bg;function vg(r,e){let t=0,n=r.length;if(n!==e.length)return!1;if(n>0)do if(r[t]!==e[t])return!1;while(++t<n);return!0}O.compareArrayLike=vg});var Oi=w(Ja=>{"use strict";Object.defineProperty(Ja,"__esModule",{value:!0});var Ke=Ae();Ja.default={fromIterable(r){return Vs(Ig(r))},fromAsyncIterable(r){return Vs(Sg(r))},fromDOMStream(r){return Vs(Og(r))},fromNodeStream(r){return Vs(Ag(r))},toDOMStream(r,e){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(r,e){throw new Error('"toNodeStream" not available in this environment')}};var Vs=r=>(r.next(),r);function*Ig(r){let e,t=!1,n=[],i,o,a,u=0;function f(){return o==="peek"?Ke.joinUint8Arrays(n,a)[0]:([i,n,u]=Ke.joinUint8Arrays(n,a),i)}({cmd:o,size:a}=yield null);let s=Ke.toUint8ArrayIterator(r)[Symbol.iterator]();try{do if({done:e,value:i}=isNaN(a-u)?s.next(void 0):s.next(a-u),!e&&i.byteLength>0&&(n.push(i),u+=i.byteLength),e||a<=u)do({cmd:o,size:a}=yield f());while(a<u);while(!e)}catch(c){(t=!0)&&typeof s.throw=="function"&&s.throw(c)}finally{t===!1&&typeof s.return=="function"&&s.return(null)}return null}async function*Sg(r){let e,t=!1,n=[],i,o,a,u=0;function f(){return o==="peek"?Ke.joinUint8Arrays(n,a)[0]:([i,n,u]=Ke.joinUint8Arrays(n,a),i)}({cmd:o,size:a}=yield null);let s=Ke.toUint8ArrayAsyncIterator(r)[Symbol.asyncIterator]();try{do if({done:e,value:i}=isNaN(a-u)?await s.next(void 0):await s.next(a-u),!e&&i.byteLength>0&&(n.push(i),u+=i.byteLength),e||a<=u)do({cmd:o,size:a}=yield f());while(a<u);while(!e)}catch(c){(t=!0)&&typeof s.throw=="function"&&await s.throw(c)}finally{t===!1&&typeof s.return=="function"&&await s.return(new Uint8Array(0))}return null}async function*Og(r){let e=!1,t=!1,n=[],i,o,a,u=0;function f(){return o==="peek"?Ke.joinUint8Arrays(n,a)[0]:([i,n,u]=Ke.joinUint8Arrays(n,a),i)}({cmd:o,size:a}=yield null);let s=new Ld(r);try{do if({done:e,value:i}=isNaN(a-u)?await s.read(void 0):await s.read(a-u),!e&&i.byteLength>0&&(n.push(Ke.toUint8Array(i)),u+=i.byteLength),e||a<=u)do({cmd:o,size:a}=yield f());while(a<u);while(!e)}catch(c){(t=!0)&&await s.cancel(c)}finally{t===!1?await s.cancel():r.locked&&s.releaseLock()}return null}var Ld=class{constructor(e){this.source=e,this.byobReader=null,this.defaultReader=null;try{this.supportsBYOB=!!(this.reader=this.getBYOBReader())}catch{this.supportsBYOB=!(this.reader=this.getDefaultReader())}}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=this.byobReader=this.defaultReader=null}async cancel(e){let{reader:t,source:n}=this;t&&await t.cancel(e).catch(()=>{}),n&&n.locked&&this.releaseLock()}async read(e){if(e===0)return{done:this.reader==null,value:new Uint8Array(0)};let t=!this.supportsBYOB||typeof e!="number"?await this.getDefaultReader().read():await this.readFromBYOBReader(e);return!t.done&&(t.value=Ke.toUint8Array(t)),t}getDefaultReader(){return this.byobReader&&this.releaseLock(),this.defaultReader||(this.defaultReader=this.source.getReader(),this.defaultReader.closed.catch(()=>{})),this.reader=this.defaultReader}getBYOBReader(){return this.defaultReader&&this.releaseLock(),this.byobReader||(this.byobReader=this.source.getReader({mode:"byob"}),this.byobReader.closed.catch(()=>{})),this.reader=this.byobReader}async readFromBYOBReader(e){return await xd(this.getBYOBReader(),new ArrayBuffer(e),0,e)}};async function xd(r,e,t,n){if(t>=n)return{done:!1,value:new Uint8Array(e,0,n)};let{done:i,value:o}=await r.read(new Uint8Array(e,t,n-t));return(t+=o.byteLength)<n&&!i?await xd(r,o.buffer,t,n):{done:i,value:new Uint8Array(o.buffer,0,t)}}var $a=(r,e)=>{let t=i=>n([e,i]),n;return[e,t,new Promise(i=>(n=i)&&r.once(e,t))]};async function*Ag(r){let e=[],t="error",n=!1,i=null,o,a,u=0,f=[],s;function c(){return o==="peek"?Ke.joinUint8Arrays(f,a)[0]:([s,f,u]=Ke.joinUint8Arrays(f,a),s)}if({cmd:o,size:a}=yield null,r.isTTY)return yield new Uint8Array(0),null;try{e[0]=$a(r,"end"),e[1]=$a(r,"error");do{if(e[2]=$a(r,"readable"),[t,i]=await Promise.race(e.map(U=>U[2])),t==="error")break;if((n=t==="end")||(isFinite(a-u)?(s=Ke.toUint8Array(r.read(a-u)),s.byteLength<a-u&&(s=Ke.toUint8Array(r.read(void 0)))):s=Ke.toUint8Array(r.read(void 0)),s.byteLength>0&&(f.push(s),u+=s.byteLength)),n||a<=u)do({cmd:o,size:a}=yield c());while(a<u)}while(!n)}finally{await _(e,t==="error"?i:null)}return null;function _(U,J){return s=f=null,new Promise(async(et,Ut)=>{for(let[vt,yn]of U)r.off(vt,yn);try{let vt=r.destroy;vt&&vt.call(r,J),J=void 0}catch(vt){J=vt||J}finally{J!=null?Ut(J):et()}})}}});var ve=w(In=>{"use strict";Object.defineProperty(In,"__esModule",{value:!0});In.Vector=In.AbstractVector=void 0;var Ns=class{};In.AbstractVector=Ns;In.Vector=Ns;Ns.prototype.data=null});var Sn=w(A=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});A.org=void 0;var ie;(function(r){var e;(function(t){var n;(function(i){var o;(function(a){let u;(function(f){f[f.V1=0]="V1",f[f.V2=1]="V2",f[f.V3=2]="V3",f[f.V4=3]="V4"})(u=a.MetadataVersion||(a.MetadataVersion={}))})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){let u;(function(f){f[f.Sparse=0]="Sparse",f[f.Dense=1]="Dense"})(u=a.UnionMode||(a.UnionMode={}))})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){let u;(function(f){f[f.HALF=0]="HALF",f[f.SINGLE=1]="SINGLE",f[f.DOUBLE=2]="DOUBLE"})(u=a.Precision||(a.Precision={}))})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){let u;(function(f){f[f.DAY=0]="DAY",f[f.MILLISECOND=1]="MILLISECOND"})(u=a.DateUnit||(a.DateUnit={}))})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){let u;(function(f){f[f.SECOND=0]="SECOND",f[f.MILLISECOND=1]="MILLISECOND",f[f.MICROSECOND=2]="MICROSECOND",f[f.NANOSECOND=3]="NANOSECOND"})(u=a.TimeUnit||(a.TimeUnit={}))})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){let u;(function(f){f[f.YEAR_MONTH=0]="YEAR_MONTH",f[f.DAY_TIME=1]="DAY_TIME"})(u=a.IntervalUnit||(a.IntervalUnit={}))})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){let u;(function(f){f[f.NONE=0]="NONE",f[f.Null=1]="Null",f[f.Int=2]="Int",f[f.FloatingPoint=3]="FloatingPoint",f[f.Binary=4]="Binary",f[f.Utf8=5]="Utf8",f[f.Bool=6]="Bool",f[f.Decimal=7]="Decimal",f[f.Date=8]="Date",f[f.Time=9]="Time",f[f.Timestamp=10]="Timestamp",f[f.Interval=11]="Interval",f[f.List=12]="List",f[f.Struct_=13]="Struct_",f[f.Union=14]="Union",f[f.FixedSizeBinary=15]="FixedSizeBinary",f[f.FixedSizeList=16]="FixedSizeList",f[f.Map=17]="Map",f[f.Duration=18]="Duration",f[f.LargeBinary=19]="LargeBinary",f[f.LargeUtf8=20]="LargeUtf8",f[f.LargeList=21]="LargeList"})(u=a.Type||(a.Type={}))})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){let u;(function(f){f[f.Little=0]="Little",f[f.Big=1]="Big"})(u=a.Endianness||(a.Endianness={}))})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsNull(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}static startNull(s){s.startObject(0)}static endNull(s){return s.endObject()}static createNull(s){return u.startNull(s),u.endNull(s)}}a.Null=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsStruct_(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}static startStruct_(s){s.startObject(0)}static endStruct_(s){return s.endObject()}static createStruct_(s){return u.startStruct_(s),u.endStruct_(s)}}a.Struct_=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsList(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}static startList(s){s.startObject(0)}static endList(s){return s.endObject()}static createList(s){return u.startList(s),u.endList(s)}}a.List=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsLargeList(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}static startLargeList(s){s.startObject(0)}static endLargeList(s){return s.endObject()}static createLargeList(s){return u.startLargeList(s),u.endLargeList(s)}}a.LargeList=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsFixedSizeList(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}listSize(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt32(this.bb_pos+s):0}static startFixedSizeList(s){s.startObject(1)}static addListSize(s,c){s.addFieldInt32(0,c,0)}static endFixedSizeList(s){return s.endObject()}static createFixedSizeList(s,c){return u.startFixedSizeList(s),u.addListSize(s,c),u.endFixedSizeList(s)}}a.FixedSizeList=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsMap(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}keysSorted(){let s=this.bb.__offset(this.bb_pos,4);return s?!!this.bb.readInt8(this.bb_pos+s):!1}static startMap(s){s.startObject(1)}static addKeysSorted(s,c){s.addFieldInt8(0,+c,0)}static endMap(s){return s.endObject()}static createMap(s,c){return u.startMap(s),u.addKeysSorted(s,c),u.endMap(s)}}a.Map=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsUnion(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}mode(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt16(this.bb_pos+s):r.apache.arrow.flatbuf.UnionMode.Sparse}typeIds(s){let c=this.bb.__offset(this.bb_pos,6);return c?this.bb.readInt32(this.bb.__vector(this.bb_pos+c)+s*4):0}typeIdsLength(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.__vector_len(this.bb_pos+s):0}typeIdsArray(){let s=this.bb.__offset(this.bb_pos,6);return s?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+s),this.bb.__vector_len(this.bb_pos+s)):null}static startUnion(s){s.startObject(2)}static addMode(s,c){s.addFieldInt16(0,c,r.apache.arrow.flatbuf.UnionMode.Sparse)}static addTypeIds(s,c){s.addFieldOffset(1,c,0)}static createTypeIdsVector(s,c){s.startVector(4,c.length,4);for(let _=c.length-1;_>=0;_--)s.addInt32(c[_]);return s.endVector()}static startTypeIdsVector(s,c){s.startVector(4,c,4)}static endUnion(s){return s.endObject()}static createUnion(s,c,_){return u.startUnion(s),u.addMode(s,c),u.addTypeIds(s,_),u.endUnion(s)}}a.Union=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsInt(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}bitWidth(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt32(this.bb_pos+s):0}isSigned(){let s=this.bb.__offset(this.bb_pos,6);return s?!!this.bb.readInt8(this.bb_pos+s):!1}static startInt(s){s.startObject(2)}static addBitWidth(s,c){s.addFieldInt32(0,c,0)}static addIsSigned(s,c){s.addFieldInt8(1,+c,0)}static endInt(s){return s.endObject()}static createInt(s,c,_){return u.startInt(s),u.addBitWidth(s,c),u.addIsSigned(s,_),u.endInt(s)}}a.Int=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsFloatingPoint(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}precision(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt16(this.bb_pos+s):r.apache.arrow.flatbuf.Precision.HALF}static startFloatingPoint(s){s.startObject(1)}static addPrecision(s,c){s.addFieldInt16(0,c,r.apache.arrow.flatbuf.Precision.HALF)}static endFloatingPoint(s){return s.endObject()}static createFloatingPoint(s,c){return u.startFloatingPoint(s),u.addPrecision(s,c),u.endFloatingPoint(s)}}a.FloatingPoint=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsUtf8(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}static startUtf8(s){s.startObject(0)}static endUtf8(s){return s.endObject()}static createUtf8(s){return u.startUtf8(s),u.endUtf8(s)}}a.Utf8=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsBinary(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}static startBinary(s){s.startObject(0)}static endBinary(s){return s.endObject()}static createBinary(s){return u.startBinary(s),u.endBinary(s)}}a.Binary=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsLargeUtf8(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}static startLargeUtf8(s){s.startObject(0)}static endLargeUtf8(s){return s.endObject()}static createLargeUtf8(s){return u.startLargeUtf8(s),u.endLargeUtf8(s)}}a.LargeUtf8=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsLargeBinary(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}static startLargeBinary(s){s.startObject(0)}static endLargeBinary(s){return s.endObject()}static createLargeBinary(s){return u.startLargeBinary(s),u.endLargeBinary(s)}}a.LargeBinary=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsFixedSizeBinary(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}byteWidth(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt32(this.bb_pos+s):0}static startFixedSizeBinary(s){s.startObject(1)}static addByteWidth(s,c){s.addFieldInt32(0,c,0)}static endFixedSizeBinary(s){return s.endObject()}static createFixedSizeBinary(s,c){return u.startFixedSizeBinary(s),u.addByteWidth(s,c),u.endFixedSizeBinary(s)}}a.FixedSizeBinary=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsBool(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}static startBool(s){s.startObject(0)}static endBool(s){return s.endObject()}static createBool(s){return u.startBool(s),u.endBool(s)}}a.Bool=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsDecimal(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}precision(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt32(this.bb_pos+s):0}scale(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.readInt32(this.bb_pos+s):0}static startDecimal(s){s.startObject(2)}static addPrecision(s,c){s.addFieldInt32(0,c,0)}static addScale(s,c){s.addFieldInt32(1,c,0)}static endDecimal(s){return s.endObject()}static createDecimal(s,c,_){return u.startDecimal(s),u.addPrecision(s,c),u.addScale(s,_),u.endDecimal(s)}}a.Decimal=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsDate(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}unit(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt16(this.bb_pos+s):r.apache.arrow.flatbuf.DateUnit.MILLISECOND}static startDate(s){s.startObject(1)}static addUnit(s,c){s.addFieldInt16(0,c,r.apache.arrow.flatbuf.DateUnit.MILLISECOND)}static endDate(s){return s.endObject()}static createDate(s,c){return u.startDate(s),u.addUnit(s,c),u.endDate(s)}}a.Date=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsTime(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}unit(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt16(this.bb_pos+s):r.apache.arrow.flatbuf.TimeUnit.MILLISECOND}bitWidth(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.readInt32(this.bb_pos+s):32}static startTime(s){s.startObject(2)}static addUnit(s,c){s.addFieldInt16(0,c,r.apache.arrow.flatbuf.TimeUnit.MILLISECOND)}static addBitWidth(s,c){s.addFieldInt32(1,c,32)}static endTime(s){return s.endObject()}static createTime(s,c,_){return u.startTime(s),u.addUnit(s,c),u.addBitWidth(s,_),u.endTime(s)}}a.Time=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsTimestamp(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}unit(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt16(this.bb_pos+s):r.apache.arrow.flatbuf.TimeUnit.SECOND}timezone(s){let c=this.bb.__offset(this.bb_pos,6);return c?this.bb.__string(this.bb_pos+c,s):null}static startTimestamp(s){s.startObject(2)}static addUnit(s,c){s.addFieldInt16(0,c,r.apache.arrow.flatbuf.TimeUnit.SECOND)}static addTimezone(s,c){s.addFieldOffset(1,c,0)}static endTimestamp(s){return s.endObject()}static createTimestamp(s,c,_){return u.startTimestamp(s),u.addUnit(s,c),u.addTimezone(s,_),u.endTimestamp(s)}}a.Timestamp=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsInterval(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}unit(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt16(this.bb_pos+s):r.apache.arrow.flatbuf.IntervalUnit.YEAR_MONTH}static startInterval(s){s.startObject(1)}static addUnit(s,c){s.addFieldInt16(0,c,r.apache.arrow.flatbuf.IntervalUnit.YEAR_MONTH)}static endInterval(s){return s.endObject()}static createInterval(s,c){return u.startInterval(s),u.addUnit(s,c),u.endInterval(s)}}a.Interval=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsDuration(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}unit(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt16(this.bb_pos+s):r.apache.arrow.flatbuf.TimeUnit.MILLISECOND}static startDuration(s){s.startObject(1)}static addUnit(s,c){s.addFieldInt16(0,c,r.apache.arrow.flatbuf.TimeUnit.MILLISECOND)}static endDuration(s){return s.endObject()}static createDuration(s,c){return u.startDuration(s),u.addUnit(s,c),u.endDuration(s)}}a.Duration=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsKeyValue(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}key(s){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,s):null}value(s){let c=this.bb.__offset(this.bb_pos,6);return c?this.bb.__string(this.bb_pos+c,s):null}static startKeyValue(s){s.startObject(2)}static addKey(s,c){s.addFieldOffset(0,c,0)}static addValue(s,c){s.addFieldOffset(1,c,0)}static endKeyValue(s){return s.endObject()}static createKeyValue(s,c,_){return u.startKeyValue(s),u.addKey(s,c),u.addValue(s,_),u.endKeyValue(s)}}a.KeyValue=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsDictionaryEncoding(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}id(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt64(this.bb_pos+s):this.bb.createLong(0,0)}indexType(s){let c=this.bb.__offset(this.bb_pos,6);return c?(s||new r.apache.arrow.flatbuf.Int).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}isOrdered(){let s=this.bb.__offset(this.bb_pos,8);return s?!!this.bb.readInt8(this.bb_pos+s):!1}static startDictionaryEncoding(s){s.startObject(3)}static addId(s,c){s.addFieldInt64(0,c,s.createLong(0,0))}static addIndexType(s,c){s.addFieldOffset(1,c,0)}static addIsOrdered(s,c){s.addFieldInt8(2,+c,0)}static endDictionaryEncoding(s){return s.endObject()}static createDictionaryEncoding(s,c,_,U){return u.startDictionaryEncoding(s),u.addId(s,c),u.addIndexType(s,_),u.addIsOrdered(s,U),u.endDictionaryEncoding(s)}}a.DictionaryEncoding=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsField(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}name(s){let c=this.bb.__offset(this.bb_pos,4);return c?this.bb.__string(this.bb_pos+c,s):null}nullable(){let s=this.bb.__offset(this.bb_pos,6);return s?!!this.bb.readInt8(this.bb_pos+s):!1}typeType(){let s=this.bb.__offset(this.bb_pos,8);return s?this.bb.readUint8(this.bb_pos+s):r.apache.arrow.flatbuf.Type.NONE}type(s){let c=this.bb.__offset(this.bb_pos,10);return c?this.bb.__union(s,this.bb_pos+c):null}dictionary(s){let c=this.bb.__offset(this.bb_pos,12);return c?(s||new r.apache.arrow.flatbuf.DictionaryEncoding).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}children(s,c){let _=this.bb.__offset(this.bb_pos,14);return _?(c||new r.apache.arrow.flatbuf.Field).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+_)+s*4),this.bb):null}childrenLength(){let s=this.bb.__offset(this.bb_pos,14);return s?this.bb.__vector_len(this.bb_pos+s):0}customMetadata(s,c){let _=this.bb.__offset(this.bb_pos,16);return _?(c||new r.apache.arrow.flatbuf.KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+_)+s*4),this.bb):null}customMetadataLength(){let s=this.bb.__offset(this.bb_pos,16);return s?this.bb.__vector_len(this.bb_pos+s):0}static startField(s){s.startObject(7)}static addName(s,c){s.addFieldOffset(0,c,0)}static addNullable(s,c){s.addFieldInt8(1,+c,0)}static addTypeType(s,c){s.addFieldInt8(2,c,r.apache.arrow.flatbuf.Type.NONE)}static addType(s,c){s.addFieldOffset(3,c,0)}static addDictionary(s,c){s.addFieldOffset(4,c,0)}static addChildren(s,c){s.addFieldOffset(5,c,0)}static createChildrenVector(s,c){s.startVector(4,c.length,4);for(let _=c.length-1;_>=0;_--)s.addOffset(c[_]);return s.endVector()}static startChildrenVector(s,c){s.startVector(4,c,4)}static addCustomMetadata(s,c){s.addFieldOffset(6,c,0)}static createCustomMetadataVector(s,c){s.startVector(4,c.length,4);for(let _=c.length-1;_>=0;_--)s.addOffset(c[_]);return s.endVector()}static startCustomMetadataVector(s,c){s.startVector(4,c,4)}static endField(s){return s.endObject()}static createField(s,c,_,U,J,et,Ut,vt){return u.startField(s),u.addName(s,c),u.addNullable(s,_),u.addTypeType(s,U),u.addType(s,J),u.addDictionary(s,et),u.addChildren(s,Ut),u.addCustomMetadata(s,vt),u.endField(s)}}a.Field=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static createBuffer(s,c,_){return s.prep(8,16),s.writeInt64(_),s.writeInt64(c),s.offset()}}a.Buffer=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsSchema(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}endianness(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt16(this.bb_pos+s):r.apache.arrow.flatbuf.Endianness.Little}fields(s,c){let _=this.bb.__offset(this.bb_pos,6);return _?(c||new r.apache.arrow.flatbuf.Field).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+_)+s*4),this.bb):null}fieldsLength(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.__vector_len(this.bb_pos+s):0}customMetadata(s,c){let _=this.bb.__offset(this.bb_pos,8);return _?(c||new r.apache.arrow.flatbuf.KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+_)+s*4),this.bb):null}customMetadataLength(){let s=this.bb.__offset(this.bb_pos,8);return s?this.bb.__vector_len(this.bb_pos+s):0}static startSchema(s){s.startObject(3)}static addEndianness(s,c){s.addFieldInt16(0,c,r.apache.arrow.flatbuf.Endianness.Little)}static addFields(s,c){s.addFieldOffset(1,c,0)}static createFieldsVector(s,c){s.startVector(4,c.length,4);for(let _=c.length-1;_>=0;_--)s.addOffset(c[_]);return s.endVector()}static startFieldsVector(s,c){s.startVector(4,c,4)}static addCustomMetadata(s,c){s.addFieldOffset(2,c,0)}static createCustomMetadataVector(s,c){s.startVector(4,c.length,4);for(let _=c.length-1;_>=0;_--)s.addOffset(c[_]);return s.endVector()}static startCustomMetadataVector(s,c){s.startVector(4,c,4)}static endSchema(s){return s.endObject()}static finishSchemaBuffer(s,c){s.finish(c)}static createSchema(s,c,_,U){return u.startSchema(s),u.addEndianness(s,c),u.addFields(s,_),u.addCustomMetadata(s,U),u.endSchema(s)}}a.Schema=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(ie=A.org||(A.org={}))});var Ka=w(Qe=>{"use strict";Object.defineProperty(Qe,"__esModule",{value:!0});Qe.org=void 0;var Ai=Sn(),On;(function(r){var e;(function(t){var n;(function(i){var o;(function(a){a.Schema=Ai.org.apache.arrow.flatbuf.Schema})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(On=Qe.org||(Qe.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){let u;(function(f){f[f.NONE=0]="NONE",f[f.Schema=1]="Schema",f[f.DictionaryBatch=2]="DictionaryBatch",f[f.RecordBatch=3]="RecordBatch",f[f.Tensor=4]="Tensor",f[f.SparseTensor=5]="SparseTensor"})(u=a.MessageHeader||(a.MessageHeader={}))})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(On=Qe.org||(Qe.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static createFieldNode(s,c,_){return s.prep(8,16),s.writeInt64(_),s.writeInt64(c),s.offset()}}a.FieldNode=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(On=Qe.org||(Qe.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsRecordBatch(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}length(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt64(this.bb_pos+s):this.bb.createLong(0,0)}nodes(s,c){let _=this.bb.__offset(this.bb_pos,6);return _?(c||new r.apache.arrow.flatbuf.FieldNode).__init(this.bb.__vector(this.bb_pos+_)+s*16,this.bb):null}nodesLength(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.__vector_len(this.bb_pos+s):0}buffers(s,c){let _=this.bb.__offset(this.bb_pos,8);return _?(c||new Ai.org.apache.arrow.flatbuf.Buffer).__init(this.bb.__vector(this.bb_pos+_)+s*16,this.bb):null}buffersLength(){let s=this.bb.__offset(this.bb_pos,8);return s?this.bb.__vector_len(this.bb_pos+s):0}static startRecordBatch(s){s.startObject(3)}static addLength(s,c){s.addFieldInt64(0,c,s.createLong(0,0))}static addNodes(s,c){s.addFieldOffset(1,c,0)}static startNodesVector(s,c){s.startVector(16,c,8)}static addBuffers(s,c){s.addFieldOffset(2,c,0)}static startBuffersVector(s,c){s.startVector(16,c,8)}static endRecordBatch(s){return s.endObject()}static createRecordBatch(s,c,_,U){return u.startRecordBatch(s),u.addLength(s,c),u.addNodes(s,_),u.addBuffers(s,U),u.endRecordBatch(s)}}a.RecordBatch=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(On=Qe.org||(Qe.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsDictionaryBatch(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}id(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt64(this.bb_pos+s):this.bb.createLong(0,0)}data(s){let c=this.bb.__offset(this.bb_pos,6);return c?(s||new r.apache.arrow.flatbuf.RecordBatch).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}isDelta(){let s=this.bb.__offset(this.bb_pos,8);return s?!!this.bb.readInt8(this.bb_pos+s):!1}static startDictionaryBatch(s){s.startObject(3)}static addId(s,c){s.addFieldInt64(0,c,s.createLong(0,0))}static addData(s,c){s.addFieldOffset(1,c,0)}static addIsDelta(s,c){s.addFieldInt8(2,+c,0)}static endDictionaryBatch(s){return s.endObject()}static createDictionaryBatch(s,c,_,U){return u.startDictionaryBatch(s),u.addId(s,c),u.addData(s,_),u.addIsDelta(s,U),u.endDictionaryBatch(s)}}a.DictionaryBatch=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(On=Qe.org||(Qe.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsMessage(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}version(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt16(this.bb_pos+s):Ai.org.apache.arrow.flatbuf.MetadataVersion.V1}headerType(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.readUint8(this.bb_pos+s):r.apache.arrow.flatbuf.MessageHeader.NONE}header(s){let c=this.bb.__offset(this.bb_pos,8);return c?this.bb.__union(s,this.bb_pos+c):null}bodyLength(){let s=this.bb.__offset(this.bb_pos,10);return s?this.bb.readInt64(this.bb_pos+s):this.bb.createLong(0,0)}customMetadata(s,c){let _=this.bb.__offset(this.bb_pos,12);return _?(c||new Ai.org.apache.arrow.flatbuf.KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+_)+s*4),this.bb):null}customMetadataLength(){let s=this.bb.__offset(this.bb_pos,12);return s?this.bb.__vector_len(this.bb_pos+s):0}static startMessage(s){s.startObject(5)}static addVersion(s,c){s.addFieldInt16(0,c,Ai.org.apache.arrow.flatbuf.MetadataVersion.V1)}static addHeaderType(s,c){s.addFieldInt8(1,c,r.apache.arrow.flatbuf.MessageHeader.NONE)}static addHeader(s,c){s.addFieldOffset(2,c,0)}static addBodyLength(s,c){s.addFieldInt64(3,c,s.createLong(0,0))}static addCustomMetadata(s,c){s.addFieldOffset(4,c,0)}static createCustomMetadataVector(s,c){s.startVector(4,c.length,4);for(let _=c.length-1;_>=0;_--)s.addOffset(c[_]);return s.endVector()}static startCustomMetadataVector(s,c){s.startVector(4,c,4)}static endMessage(s){return s.endObject()}static finishMessageBuffer(s,c){s.finish(c)}static createMessage(s,c,_,U,J,et){return u.startMessage(s),u.addVersion(s,c),u.addHeaderType(s,_),u.addHeader(s,U),u.addBodyLength(s,J),u.addCustomMetadata(s,et),u.endMessage(s)}}a.Message=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(On=Qe.org||(Qe.org={}))});var de=w(pe=>{"use strict";Object.defineProperty(pe,"__esModule",{value:!0});pe.BufferType=pe.Type=pe.MetadataVersion=pe.MessageHeader=pe.IntervalUnit=pe.UnionMode=pe.Precision=pe.TimeUnit=pe.DateUnit=pe.ArrowType=void 0;var en=Sn(),Dg=Ka();pe.ArrowType=en.org.apache.arrow.flatbuf.Type;pe.DateUnit=en.org.apache.arrow.flatbuf.DateUnit;pe.TimeUnit=en.org.apache.arrow.flatbuf.TimeUnit;pe.Precision=en.org.apache.arrow.flatbuf.Precision;pe.UnionMode=en.org.apache.arrow.flatbuf.UnionMode;pe.IntervalUnit=en.org.apache.arrow.flatbuf.IntervalUnit;pe.MessageHeader=Dg.org.apache.arrow.flatbuf.MessageHeader;pe.MetadataVersion=en.org.apache.arrow.flatbuf.MetadataVersion;var Fg;(function(r){r[r.NONE=0]="NONE",r[r.Null=1]="Null",r[r.Int=2]="Int",r[r.Float=3]="Float",r[r.Binary=4]="Binary",r[r.Utf8=5]="Utf8",r[r.Bool=6]="Bool",r[r.Decimal=7]="Decimal",r[r.Date=8]="Date",r[r.Time=9]="Time",r[r.Timestamp=10]="Timestamp",r[r.Interval=11]="Interval",r[r.List=12]="List",r[r.Struct=13]="Struct",r[r.Union=14]="Union",r[r.FixedSizeBinary=15]="FixedSizeBinary",r[r.FixedSizeList=16]="FixedSizeList",r[r.Map=17]="Map",r[r.Dictionary=-1]="Dictionary",r[r.Int8=-2]="Int8",r[r.Int16=-3]="Int16",r[r.Int32=-4]="Int32",r[r.Int64=-5]="Int64",r[r.Uint8=-6]="Uint8",r[r.Uint16=-7]="Uint16",r[r.Uint32=-8]="Uint32",r[r.Uint64=-9]="Uint64",r[r.Float16=-10]="Float16",r[r.Float32=-11]="Float32",r[r.Float64=-12]="Float64",r[r.DateDay=-13]="DateDay",r[r.DateMillisecond=-14]="DateMillisecond",r[r.TimestampSecond=-15]="TimestampSecond",r[r.TimestampMillisecond=-16]="TimestampMillisecond",r[r.TimestampMicrosecond=-17]="TimestampMicrosecond",r[r.TimestampNanosecond=-18]="TimestampNanosecond",r[r.TimeSecond=-19]="TimeSecond",r[r.TimeMillisecond=-20]="TimeMillisecond",r[r.TimeMicrosecond=-21]="TimeMicrosecond",r[r.TimeNanosecond=-22]="TimeNanosecond",r[r.DenseUnion=-23]="DenseUnion",r[r.SparseUnion=-24]="SparseUnion",r[r.IntervalDayTime=-25]="IntervalDayTime",r[r.IntervalYearMonth=-26]="IntervalYearMonth"})(Fg=pe.Type||(pe.Type={}));var Rg;(function(r){r[r.OFFSET=0]="OFFSET",r[r.DATA=1]="DATA",r[r.VALIDITY=2]="VALIDITY",r[r.TYPE=3]="TYPE"})(Rg=pe.BufferType||(pe.BufferType={}))});var Lt=w(De=>{"use strict";Object.defineProperty(De,"__esModule",{value:!0});De.popcnt_uint32=De.popcnt_array=De.popcnt_bit_range=De.iterateBits=De.packBools=De.truncateBitmap=De.setBool=De.getBit=De.getBool=void 0;function Cd(r,e,t,n){return(t&1<<n)!=0}De.getBool=Cd;function jd(r,e,t,n){return(t&1<<n)>>n}De.getBit=jd;function Eg(r,e,t){return t?!!(r[e>>3]|=1<<e%8)||!0:!(r[e>>3]&=~(1<<e%8))&&!1}De.setBool=Eg;function Ug(r,e,t){let n=t.byteLength+7&~7;if(r>0||t.byteLength<n){let i=new Uint8Array(n);return i.set(r%8==0?t.subarray(r>>3):qd(Qa(t,r,e,null,Cd)).subarray(0,n)),i}return t}De.truncateBitmap=Ug;function qd(r){let e=[],t=0,n=0,i=0;for(let a of r)a&&(i|=1<<n),++n==8&&(e[t++]=i,i=n=0);(t===0||n>0)&&(e[t++]=i);let o=new Uint8Array(e.length+7&~7);return o.set(e),o}De.packBools=qd;function*Qa(r,e,t,n,i){let o=e%8,a=e>>3,u=0,f=t;for(;f>0;o=0){let s=r[a++];do yield i(n,u++,s,o);while(--f>0&&++o<8)}}De.iterateBits=Qa;function Za(r,e,t){if(t-e<=0)return 0;if(t-e<8){let o=0;for(let a of Qa(r,e,t-e,r,jd))o+=a;return o}let n=t>>3<<3,i=e+(e%8==0?0:8-e%8);return Za(r,e,i)+Za(r,n,t)+Wd(r,i>>3,n-i>>3)}De.popcnt_bit_range=Za;function Wd(r,e,t){let n=0,i=e|0,o=new DataView(r.buffer,r.byteOffset,r.byteLength),a=t===void 0?r.byteLength:i+t;for(;a-i>=4;)n+=ks(o.getUint32(i)),i+=4;for(;a-i>=2;)n+=ks(o.getUint16(i)),i+=2;for(;a-i>=1;)n+=ks(o.getUint8(i)),i+=1;return n}De.popcnt_array=Wd;function ks(r){let e=r|0;return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),(e+(e>>>4)&252645135)*16843009>>>24}De.popcnt_uint32=ks});var We=w(Ls=>{"use strict";Object.defineProperty(Ls,"__esModule",{value:!0});Ls.Visitor=void 0;var Mg=St(),Pg=ve(),g=de(),Vg=oe(),ce=class{visitMany(e,...t){return e.map((n,i)=>this.visit(n,...t.map(o=>o[i])))}visit(...e){return this.getVisitFn(e[0],!1).apply(this,e)}getVisitFn(e,t=!0){return Ng(this,e,t)}visitNull(e,...t){return null}visitBool(e,...t){return null}visitInt(e,...t){return null}visitFloat(e,...t){return null}visitUtf8(e,...t){return null}visitBinary(e,...t){return null}visitFixedSizeBinary(e,...t){return null}visitDate(e,...t){return null}visitTimestamp(e,...t){return null}visitTime(e,...t){return null}visitDecimal(e,...t){return null}visitList(e,...t){return null}visitStruct(e,...t){return null}visitUnion(e,...t){return null}visitDictionary(e,...t){return null}visitInterval(e,...t){return null}visitFixedSizeList(e,...t){return null}visitMap(e,...t){return null}};Ls.Visitor=ce;function Ng(r,e,t=!0){let n=null,i=g.Type.NONE;switch(e instanceof Mg.Data||e instanceof Pg.Vector?i=Xa(e.type):e instanceof Vg.DataType?i=Xa(e):typeof(i=e)!="number"&&(i=g.Type[e]),i){case g.Type.Null:n=r.visitNull;break;case g.Type.Bool:n=r.visitBool;break;case g.Type.Int:n=r.visitInt;break;case g.Type.Int8:n=r.visitInt8||r.visitInt;break;case g.Type.Int16:n=r.visitInt16||r.visitInt;break;case g.Type.Int32:n=r.visitInt32||r.visitInt;break;case g.Type.Int64:n=r.visitInt64||r.visitInt;break;case g.Type.Uint8:n=r.visitUint8||r.visitInt;break;case g.Type.Uint16:n=r.visitUint16||r.visitInt;break;case g.Type.Uint32:n=r.visitUint32||r.visitInt;break;case g.Type.Uint64:n=r.visitUint64||r.visitInt;break;case g.Type.Float:n=r.visitFloat;break;case g.Type.Float16:n=r.visitFloat16||r.visitFloat;break;case g.Type.Float32:n=r.visitFloat32||r.visitFloat;break;case g.Type.Float64:n=r.visitFloat64||r.visitFloat;break;case g.Type.Utf8:n=r.visitUtf8;break;case g.Type.Binary:n=r.visitBinary;break;case g.Type.FixedSizeBinary:n=r.visitFixedSizeBinary;break;case g.Type.Date:n=r.visitDate;break;case g.Type.DateDay:n=r.visitDateDay||r.visitDate;break;case g.Type.DateMillisecond:n=r.visitDateMillisecond||r.visitDate;break;case g.Type.Timestamp:n=r.visitTimestamp;break;case g.Type.TimestampSecond:n=r.visitTimestampSecond||r.visitTimestamp;break;case g.Type.TimestampMillisecond:n=r.visitTimestampMillisecond||r.visitTimestamp;break;case g.Type.TimestampMicrosecond:n=r.visitTimestampMicrosecond||r.visitTimestamp;break;case g.Type.TimestampNanosecond:n=r.visitTimestampNanosecond||r.visitTimestamp;break;case g.Type.Time:n=r.visitTime;break;case g.Type.TimeSecond:n=r.visitTimeSecond||r.visitTime;break;case g.Type.TimeMillisecond:n=r.visitTimeMillisecond||r.visitTime;break;case g.Type.TimeMicrosecond:n=r.visitTimeMicrosecond||r.visitTime;break;case g.Type.TimeNanosecond:n=r.visitTimeNanosecond||r.visitTime;break;case g.Type.Decimal:n=r.visitDecimal;break;case g.Type.List:n=r.visitList;break;case g.Type.Struct:n=r.visitStruct;break;case g.Type.Union:n=r.visitUnion;break;case g.Type.DenseUnion:n=r.visitDenseUnion||r.visitUnion;break;case g.Type.SparseUnion:n=r.visitSparseUnion||r.visitUnion;break;case g.Type.Dictionary:n=r.visitDictionary;break;case g.Type.Interval:n=r.visitInterval;break;case g.Type.IntervalDayTime:n=r.visitIntervalDayTime||r.visitInterval;break;case g.Type.IntervalYearMonth:n=r.visitIntervalYearMonth||r.visitInterval;break;case g.Type.FixedSizeList:n=r.visitFixedSizeList;break;case g.Type.Map:n=r.visitMap;break}if(typeof n=="function")return n;if(!t)return()=>null;throw new Error(`Unrecognized type '${g.Type[i]}'`)}function Xa(r){switch(r.typeId){case g.Type.Null:return g.Type.Null;case g.Type.Int:let{bitWidth:e,isSigned:t}=r;switch(e){case 8:return t?g.Type.Int8:g.Type.Uint8;case 16:return t?g.Type.Int16:g.Type.Uint16;case 32:return t?g.Type.Int32:g.Type.Uint32;case 64:return t?g.Type.Int64:g.Type.Uint64}return g.Type.Int;case g.Type.Float:switch(r.precision){case g.Precision.HALF:return g.Type.Float16;case g.Precision.SINGLE:return g.Type.Float32;case g.Precision.DOUBLE:return g.Type.Float64}return g.Type.Float;case g.Type.Binary:return g.Type.Binary;case g.Type.Utf8:return g.Type.Utf8;case g.Type.Bool:return g.Type.Bool;case g.Type.Decimal:return g.Type.Decimal;case g.Type.Time:switch(r.unit){case g.TimeUnit.SECOND:return g.Type.TimeSecond;case g.TimeUnit.MILLISECOND:return g.Type.TimeMillisecond;case g.TimeUnit.MICROSECOND:return g.Type.TimeMicrosecond;case g.TimeUnit.NANOSECOND:return g.Type.TimeNanosecond}return g.Type.Time;case g.Type.Timestamp:switch(r.unit){case g.TimeUnit.SECOND:return g.Type.TimestampSecond;case g.TimeUnit.MILLISECOND:return g.Type.TimestampMillisecond;case g.TimeUnit.MICROSECOND:return g.Type.TimestampMicrosecond;case g.TimeUnit.NANOSECOND:return g.Type.TimestampNanosecond}return g.Type.Timestamp;case g.Type.Date:switch(r.unit){case g.DateUnit.DAY:return g.Type.DateDay;case g.DateUnit.MILLISECOND:return g.Type.DateMillisecond}return g.Type.Date;case g.Type.Interval:switch(r.unit){case g.IntervalUnit.DAY_TIME:return g.Type.IntervalDayTime;case g.IntervalUnit.YEAR_MONTH:return g.Type.IntervalYearMonth}return g.Type.Interval;case g.Type.Map:return g.Type.Map;case g.Type.List:return g.Type.List;case g.Type.Struct:return g.Type.Struct;case g.Type.Union:switch(r.mode){case g.UnionMode.Dense:return g.Type.DenseUnion;case g.UnionMode.Sparse:return g.Type.SparseUnion}return g.Type.Union;case g.Type.FixedSizeBinary:return g.Type.FixedSizeBinary;case g.Type.FixedSizeList:return g.Type.FixedSizeList;case g.Type.Dictionary:return g.Type.Dictionary}throw new Error(`Unrecognized type '${g.Type[r.typeId]}'`)}ce.prototype.visitInt8=null;ce.prototype.visitInt16=null;ce.prototype.visitInt32=null;ce.prototype.visitInt64=null;ce.prototype.visitUint8=null;ce.prototype.visitUint16=null;ce.prototype.visitUint32=null;ce.prototype.visitUint64=null;ce.prototype.visitFloat16=null;ce.prototype.visitFloat32=null;ce.prototype.visitFloat64=null;ce.prototype.visitDateDay=null;ce.prototype.visitDateMillisecond=null;ce.prototype.visitTimestampSecond=null;ce.prototype.visitTimestampMillisecond=null;ce.prototype.visitTimestampMicrosecond=null;ce.prototype.visitTimestampNanosecond=null;ce.prototype.visitTimeSecond=null;ce.prototype.visitTimeMillisecond=null;ce.prototype.visitTimeMicrosecond=null;ce.prototype.visitTimeNanosecond=null;ce.prototype.visitDenseUnion=null;ce.prototype.visitSparseUnion=null;ce.prototype.visitIntervalDayTime=null;ce.prototype.visitIntervalYearMonth=null});var nu=w(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});Ge.instance=Ge.TypeComparator=void 0;var kg=We(),P=class extends kg.Visitor{compareSchemas(e,t){return e===t||t instanceof e.constructor&&Ge.instance.compareFields(e.fields,t.fields)}compareFields(e,t){return e===t||Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((n,i)=>Ge.instance.compareField(n,t[i]))}compareField(e,t){return e===t||t instanceof e.constructor&&e.name===t.name&&e.nullable===t.nullable&&Ge.instance.visit(e.type,t.type)}};Ge.TypeComparator=P;function rt(r,e){return e instanceof r.constructor}function Di(r,e){return r===e||rt(r,e)}function or(r,e){return r===e||rt(r,e)&&r.bitWidth===e.bitWidth&&r.isSigned===e.isSigned}function xs(r,e){return r===e||rt(r,e)&&r.precision===e.precision}function Lg(r,e){return r===e||rt(r,e)&&r.byteWidth===e.byteWidth}function eu(r,e){return r===e||rt(r,e)&&r.unit===e.unit}function Fi(r,e){return r===e||rt(r,e)&&r.unit===e.unit&&r.timezone===e.timezone}function Ri(r,e){return r===e||rt(r,e)&&r.unit===e.unit&&r.bitWidth===e.bitWidth}function xg(r,e){return r===e||rt(r,e)&&r.children.length===e.children.length&&Ge.instance.compareFields(r.children,e.children)}function Cg(r,e){return r===e||rt(r,e)&&r.children.length===e.children.length&&Ge.instance.compareFields(r.children,e.children)}function tu(r,e){return r===e||rt(r,e)&&r.mode===e.mode&&r.typeIds.every((t,n)=>t===e.typeIds[n])&&Ge.instance.compareFields(r.children,e.children)}function jg(r,e){return r===e||rt(r,e)&&r.id===e.id&&r.isOrdered===e.isOrdered&&Ge.instance.visit(r.indices,e.indices)&&Ge.instance.visit(r.dictionary,e.dictionary)}function ru(r,e){return r===e||rt(r,e)&&r.unit===e.unit}function qg(r,e){return r===e||rt(r,e)&&r.listSize===e.listSize&&r.children.length===e.children.length&&Ge.instance.compareFields(r.children,e.children)}function Wg(r,e){return r===e||rt(r,e)&&r.keysSorted===e.keysSorted&&r.children.length===e.children.length&&Ge.instance.compareFields(r.children,e.children)}P.prototype.visitNull=Di;P.prototype.visitBool=Di;P.prototype.visitInt=or;P.prototype.visitInt8=or;P.prototype.visitInt16=or;P.prototype.visitInt32=or;P.prototype.visitInt64=or;P.prototype.visitUint8=or;P.prototype.visitUint16=or;P.prototype.visitUint32=or;P.prototype.visitUint64=or;P.prototype.visitFloat=xs;P.prototype.visitFloat16=xs;P.prototype.visitFloat32=xs;P.prototype.visitFloat64=xs;P.prototype.visitUtf8=Di;P.prototype.visitBinary=Di;P.prototype.visitFixedSizeBinary=Lg;P.prototype.visitDate=eu;P.prototype.visitDateDay=eu;P.prototype.visitDateMillisecond=eu;P.prototype.visitTimestamp=Fi;P.prototype.visitTimestampSecond=Fi;P.prototype.visitTimestampMillisecond=Fi;P.prototype.visitTimestampMicrosecond=Fi;P.prototype.visitTimestampNanosecond=Fi;P.prototype.visitTime=Ri;P.prototype.visitTimeSecond=Ri;P.prototype.visitTimeMillisecond=Ri;P.prototype.visitTimeMicrosecond=Ri;P.prototype.visitTimeNanosecond=Ri;P.prototype.visitDecimal=Di;P.prototype.visitList=xg;P.prototype.visitStruct=Cg;P.prototype.visitUnion=tu;P.prototype.visitDenseUnion=tu;P.prototype.visitSparseUnion=tu;P.prototype.visitDictionary=jg;P.prototype.visitInterval=ru;P.prototype.visitIntervalDayTime=ru;P.prototype.visitIntervalYearMonth=ru;P.prototype.visitFixedSizeList=qg;P.prototype.visitMap=Wg;Ge.instance=new P});var oe=w(B=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0});B.strideForType=B.Dictionary=B.Map_=B.FixedSizeList=B.FixedSizeBinary=B.SparseUnion=B.DenseUnion=B.Union=B.Struct=B.List=B.IntervalYearMonth=B.IntervalDayTime=B.Interval=B.TimestampNanosecond=B.TimestampMicrosecond=B.TimestampMillisecond=B.TimestampSecond=B.Timestamp=B.TimeNanosecond=B.TimeMicrosecond=B.TimeMillisecond=B.TimeSecond=B.Time=B.DateMillisecond=B.DateDay=B.Date_=B.Decimal=B.Bool=B.Utf8=B.Binary=B.Float64=B.Float32=B.Float16=B.Float=B.Uint64=B.Uint32=B.Uint16=B.Uint8=B.Int64=B.Int32=B.Int16=B.Int8=B.Int=B.Null=B.DataType=void 0;var zg=nu(),D=de(),ge=class{static isNull(e){return e&&e.typeId===D.Type.Null}static isInt(e){return e&&e.typeId===D.Type.Int}static isFloat(e){return e&&e.typeId===D.Type.Float}static isBinary(e){return e&&e.typeId===D.Type.Binary}static isUtf8(e){return e&&e.typeId===D.Type.Utf8}static isBool(e){return e&&e.typeId===D.Type.Bool}static isDecimal(e){return e&&e.typeId===D.Type.Decimal}static isDate(e){return e&&e.typeId===D.Type.Date}static isTime(e){return e&&e.typeId===D.Type.Time}static isTimestamp(e){return e&&e.typeId===D.Type.Timestamp}static isInterval(e){return e&&e.typeId===D.Type.Interval}static isList(e){return e&&e.typeId===D.Type.List}static isStruct(e){return e&&e.typeId===D.Type.Struct}static isUnion(e){return e&&e.typeId===D.Type.Union}static isFixedSizeBinary(e){return e&&e.typeId===D.Type.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===D.Type.FixedSizeList}static isMap(e){return e&&e.typeId===D.Type.Map}static isDictionary(e){return e&&e.typeId===D.Type.Dictionary}get typeId(){return D.Type.NONE}compareTo(e){return zg.instance.visit(this,e)}};B.DataType=ge;ge[Symbol.toStringTag]=(r=>(r.children=null,r.ArrayType=Array,r[Symbol.toStringTag]="DataType"))(ge.prototype);var Cs=class extends ge{toString(){return"Null"}get typeId(){return D.Type.Null}};B.Null=Cs;Cs[Symbol.toStringTag]=(r=>r[Symbol.toStringTag]="Null")(Cs.prototype);var ct=class extends ge{constructor(e,t){super();this.isSigned=e,this.bitWidth=t}get typeId(){return D.Type.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?Int32Array:Uint32Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}};B.Int=ct;ct[Symbol.toStringTag]=(r=>(r.isSigned=null,r.bitWidth=null,r[Symbol.toStringTag]="Int"))(ct.prototype);var iu=class extends ct{constructor(){super(!0,8)}};B.Int8=iu;var su=class extends ct{constructor(){super(!0,16)}};B.Int16=su;var ou=class extends ct{constructor(){super(!0,32)}};B.Int32=ou;var au=class extends ct{constructor(){super(!0,64)}};B.Int64=au;var uu=class extends ct{constructor(){super(!1,8)}};B.Uint8=uu;var cu=class extends ct{constructor(){super(!1,16)}};B.Uint16=cu;var lu=class extends ct{constructor(){super(!1,32)}};B.Uint32=lu;var du=class extends ct{constructor(){super(!1,64)}};B.Uint64=du;Object.defineProperty(iu.prototype,"ArrayType",{value:Int8Array});Object.defineProperty(su.prototype,"ArrayType",{value:Int16Array});Object.defineProperty(ou.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(au.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(uu.prototype,"ArrayType",{value:Uint8Array});Object.defineProperty(cu.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(lu.prototype,"ArrayType",{value:Uint32Array});Object.defineProperty(du.prototype,"ArrayType",{value:Uint32Array});var tn=class extends ge{constructor(e){super();this.precision=e}get typeId(){return D.Type.Float}get ArrayType(){switch(this.precision){case D.Precision.HALF:return Uint16Array;case D.Precision.SINGLE:return Float32Array;case D.Precision.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}};B.Float=tn;tn[Symbol.toStringTag]=(r=>(r.precision=null,r[Symbol.toStringTag]="Float"))(tn.prototype);var fu=class extends tn{constructor(){super(D.Precision.HALF)}};B.Float16=fu;var hu=class extends tn{constructor(){super(D.Precision.SINGLE)}};B.Float32=hu;var pu=class extends tn{constructor(){super(D.Precision.DOUBLE)}};B.Float64=pu;Object.defineProperty(fu.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(hu.prototype,"ArrayType",{value:Float32Array});Object.defineProperty(pu.prototype,"ArrayType",{value:Float64Array});var js=class extends ge{constructor(){super()}get typeId(){return D.Type.Binary}toString(){return"Binary"}};B.Binary=js;js[Symbol.toStringTag]=(r=>(r.ArrayType=Uint8Array,r[Symbol.toStringTag]="Binary"))(js.prototype);var qs=class extends ge{constructor(){super()}get typeId(){return D.Type.Utf8}toString(){return"Utf8"}};B.Utf8=qs;qs[Symbol.toStringTag]=(r=>(r.ArrayType=Uint8Array,r[Symbol.toStringTag]="Utf8"))(qs.prototype);var Ws=class extends ge{constructor(){super()}get typeId(){return D.Type.Bool}toString(){return"Bool"}};B.Bool=Ws;Ws[Symbol.toStringTag]=(r=>(r.ArrayType=Uint8Array,r[Symbol.toStringTag]="Bool"))(Ws.prototype);var zs=class extends ge{constructor(e,t){super();this.scale=e,this.precision=t}get typeId(){return D.Type.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}};B.Decimal=zs;zs[Symbol.toStringTag]=(r=>(r.scale=null,r.precision=null,r.ArrayType=Uint32Array,r[Symbol.toStringTag]="Decimal"))(zs.prototype);var An=class extends ge{constructor(e){super();this.unit=e}get typeId(){return D.Type.Date}toString(){return`Date${(this.unit+1)*32}<${D.DateUnit[this.unit]}>`}};B.Date_=An;An[Symbol.toStringTag]=(r=>(r.unit=null,r.ArrayType=Int32Array,r[Symbol.toStringTag]="Date"))(An.prototype);var zd=class extends An{constructor(){super(D.DateUnit.DAY)}};B.DateDay=zd;var Yd=class extends An{constructor(){super(D.DateUnit.MILLISECOND)}};B.DateMillisecond=Yd;var _r=class extends ge{constructor(e,t){super();this.unit=e,this.bitWidth=t}get typeId(){return D.Type.Time}toString(){return`Time${this.bitWidth}<${D.TimeUnit[this.unit]}>`}};B.Time=_r;_r[Symbol.toStringTag]=(r=>(r.unit=null,r.bitWidth=null,r.ArrayType=Int32Array,r[Symbol.toStringTag]="Time"))(_r.prototype);var Hd=class extends _r{constructor(){super(D.TimeUnit.SECOND,32)}};B.TimeSecond=Hd;var Gd=class extends _r{constructor(){super(D.TimeUnit.MILLISECOND,32)}};B.TimeMillisecond=Gd;var $d=class extends _r{constructor(){super(D.TimeUnit.MICROSECOND,64)}};B.TimeMicrosecond=$d;var Jd=class extends _r{constructor(){super(D.TimeUnit.NANOSECOND,64)}};B.TimeNanosecond=Jd;var gr=class extends ge{constructor(e,t){super();this.unit=e,this.timezone=t}get typeId(){return D.Type.Timestamp}toString(){return`Timestamp<${D.TimeUnit[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}};B.Timestamp=gr;gr[Symbol.toStringTag]=(r=>(r.unit=null,r.timezone=null,r.ArrayType=Int32Array,r[Symbol.toStringTag]="Timestamp"))(gr.prototype);var Kd=class extends gr{constructor(e){super(D.TimeUnit.SECOND,e)}};B.TimestampSecond=Kd;var Qd=class extends gr{constructor(e){super(D.TimeUnit.MILLISECOND,e)}};B.TimestampMillisecond=Qd;var Zd=class extends gr{constructor(e){super(D.TimeUnit.MICROSECOND,e)}};B.TimestampMicrosecond=Zd;var Xd=class extends gr{constructor(e){super(D.TimeUnit.NANOSECOND,e)}};B.TimestampNanosecond=Xd;var Dn=class extends ge{constructor(e){super();this.unit=e}get typeId(){return D.Type.Interval}toString(){return`Interval<${D.IntervalUnit[this.unit]}>`}};B.Interval=Dn;Dn[Symbol.toStringTag]=(r=>(r.unit=null,r.ArrayType=Int32Array,r[Symbol.toStringTag]="Interval"))(Dn.prototype);var ef=class extends Dn{constructor(){super(D.IntervalUnit.DAY_TIME)}};B.IntervalDayTime=ef;var tf=class extends Dn{constructor(){super(D.IntervalUnit.YEAR_MONTH)}};B.IntervalYearMonth=tf;var Ys=class extends ge{constructor(e){super();this.children=[e]}get typeId(){return D.Type.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}};B.List=Ys;Ys[Symbol.toStringTag]=(r=>(r.children=null,r[Symbol.toStringTag]="List"))(Ys.prototype);var Hs=class extends ge{constructor(e){super();this.children=e}get typeId(){return D.Type.Struct}toString(){return`Struct<{${this.children.map(e=>`${e.name}:${e.type}`).join(", ")}}>`}};B.Struct=Hs;Hs[Symbol.toStringTag]=(r=>(r.children=null,r[Symbol.toStringTag]="Struct"))(Hs.prototype);var Fn=class extends ge{constructor(e,t,n){super();this.mode=e,this.children=n,this.typeIds=t=Int32Array.from(t),this.typeIdToChildIndex=t.reduce((i,o,a)=>(i[o]=a)&&i||i,Object.create(null))}get typeId(){return D.Type.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(e=>`${e.type}`).join(" | ")}>`}};B.Union=Fn;Fn[Symbol.toStringTag]=(r=>(r.mode=null,r.typeIds=null,r.children=null,r.typeIdToChildIndex=null,r.ArrayType=Int8Array,r[Symbol.toStringTag]="Union"))(Fn.prototype);var rf=class extends Fn{constructor(e,t){super(D.UnionMode.Dense,e,t)}};B.DenseUnion=rf;var nf=class extends Fn{constructor(e,t){super(D.UnionMode.Sparse,e,t)}};B.SparseUnion=nf;var Gs=class extends ge{constructor(e){super();this.byteWidth=e}get typeId(){return D.Type.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}};B.FixedSizeBinary=Gs;Gs[Symbol.toStringTag]=(r=>(r.byteWidth=null,r.ArrayType=Uint8Array,r[Symbol.toStringTag]="FixedSizeBinary"))(Gs.prototype);var $s=class extends ge{constructor(e,t){super();this.listSize=e,this.children=[t]}get typeId(){return D.Type.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}};B.FixedSizeList=$s;$s[Symbol.toStringTag]=(r=>(r.children=null,r.listSize=null,r[Symbol.toStringTag]="FixedSizeList"))($s.prototype);var Js=class extends ge{constructor(e,t=!1){super();this.children=[e],this.keysSorted=t}get typeId(){return D.Type.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}toString(){return`Map<{${this.children[0].type.children.map(e=>`${e.name}:${e.type}`).join(", ")}}>`}};B.Map_=Js;Js[Symbol.toStringTag]=(r=>(r.children=null,r.keysSorted=null,r[Symbol.toStringTag]="Map_"))(Js.prototype);var Yg=(r=>()=>++r)(-1),Ks=class extends ge{constructor(e,t,n,i){super();this.indices=t,this.dictionary=e,this.isOrdered=i||!1,this.id=n==null?Yg():typeof n=="number"?n:n.low}get typeId(){return D.Type.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}};B.Dictionary=Ks;Ks[Symbol.toStringTag]=(r=>(r.id=null,r.indices=null,r.isOrdered=null,r.dictionary=null,r[Symbol.toStringTag]="Dictionary"))(Ks.prototype);function Hg(r){let e=r;switch(r.typeId){case D.Type.Decimal:return 4;case D.Type.Timestamp:return 2;case D.Type.Date:return 1+e.unit;case D.Type.Interval:return 1+e.unit;case D.Type.Int:return 1+ +(e.bitWidth>32);case D.Type.Time:return 1+ +(e.bitWidth>32);case D.Type.FixedSizeList:return e.listSize;case D.Type.FixedSizeBinary:return e.byteWidth;default:return 1}}B.strideForType=Hg});var St=w(rn=>{"use strict";Object.defineProperty(rn,"__esModule",{value:!0});rn.Data=rn.kUnknownNullCount=void 0;var Gg=Lt(),$g=Lt(),R=de(),Jg=oe(),te=Ae();rn.kUnknownNullCount=-1;var j=class{constructor(e,t,n,i,o,a,u){this.type=e,this.dictionary=u,this.offset=Math.floor(Math.max(t||0,0)),this.length=Math.floor(Math.max(n||0,0)),this._nullCount=Math.floor(Math.max(i||0,-1)),this.childData=(a||[]).map(s=>s instanceof j?s:s.data);let f;o instanceof j?(this.stride=o.stride,this.values=o.values,this.typeIds=o.typeIds,this.nullBitmap=o.nullBitmap,this.valueOffsets=o.valueOffsets):(this.stride=Jg.strideForType(e),o&&((f=o[0])&&(this.valueOffsets=f),(f=o[1])&&(this.values=f),(f=o[2])&&(this.nullBitmap=f),(f=o[3])&&(this.typeIds=f)))}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let e=0,{valueOffsets:t,values:n,nullBitmap:i,typeIds:o}=this;return t&&(e+=t.byteLength),n&&(e+=n.byteLength),i&&(e+=i.byteLength),o&&(e+=o.byteLength),this.childData.reduce((a,u)=>a+u.byteLength,e)}get nullCount(){let e=this._nullCount,t;return e<=rn.kUnknownNullCount&&(t=this.nullBitmap)&&(this._nullCount=e=this.length-$g.popcnt_bit_range(t,this.offset,this.offset+this.length)),e}clone(e,t=this.offset,n=this.length,i=this._nullCount,o=this,a=this.childData){return new j(e,t,n,i,o,a,this.dictionary)}slice(e,t){let{stride:n,typeId:i,childData:o}=this,a=+(this._nullCount===0)-1,u=i===16?n:1,f=this._sliceBuffers(e,t,n,i);return this.clone(this.type,this.offset+e,t,a,f,!o.length||this.valueOffsets?o:this._sliceChildren(o,u*e,u*t))}_changeLengthAndBackfillNullBitmap(e){if(this.typeId===R.Type.Null)return this.clone(this.type,0,e,0);let{length:t,nullCount:n}=this,i=new Uint8Array((e+63&~63)>>3).fill(255,0,t>>3);i[t>>3]=(1<<t-(t&~7))-1,n>0&&i.set(Gg.truncateBitmap(this.offset,t,this.nullBitmap),0);let o=this.buffers;return o[R.BufferType.VALIDITY]=i,this.clone(this.type,0,e,n+(e-t),o)}_sliceBuffers(e,t,n,i){let o,{buffers:a}=this;return(o=a[R.BufferType.TYPE])&&(a[R.BufferType.TYPE]=o.subarray(e,e+t)),(o=a[R.BufferType.OFFSET])&&(a[R.BufferType.OFFSET]=o.subarray(e,e+t+1))||(o=a[R.BufferType.DATA])&&(a[R.BufferType.DATA]=i===6?o:o.subarray(n*e,n*(e+t))),a}_sliceChildren(e,t,n){return e.map(i=>i.slice(t,n))}static new(e,t,n,i,o,a,u){switch(o instanceof j?o=o.buffers:o||(o=[]),e.typeId){case R.Type.Null:return j.Null(e,t,n);case R.Type.Int:return j.Int(e,t,n,i||0,o[R.BufferType.VALIDITY],o[R.BufferType.DATA]||[]);case R.Type.Dictionary:return j.Dictionary(e,t,n,i||0,o[R.BufferType.VALIDITY],o[R.BufferType.DATA]||[],u);case R.Type.Float:return j.Float(e,t,n,i||0,o[R.BufferType.VALIDITY],o[R.BufferType.DATA]||[]);case R.Type.Bool:return j.Bool(e,t,n,i||0,o[R.BufferType.VALIDITY],o[R.BufferType.DATA]||[]);case R.Type.Decimal:return j.Decimal(e,t,n,i||0,o[R.BufferType.VALIDITY],o[R.BufferType.DATA]||[]);case R.Type.Date:return j.Date(e,t,n,i||0,o[R.BufferType.VALIDITY],o[R.BufferType.DATA]||[]);case R.Type.Time:return j.Time(e,t,n,i||0,o[R.BufferType.VALIDITY],o[R.BufferType.DATA]||[]);case R.Type.Timestamp:return j.Timestamp(e,t,n,i||0,o[R.BufferType.VALIDITY],o[R.BufferType.DATA]||[]);case R.Type.Interval:return j.Interval(e,t,n,i||0,o[R.BufferType.VALIDITY],o[R.BufferType.DATA]||[]);case R.Type.FixedSizeBinary:return j.FixedSizeBinary(e,t,n,i||0,o[R.BufferType.VALIDITY],o[R.BufferType.DATA]||[]);case R.Type.Binary:return j.Binary(e,t,n,i||0,o[R.BufferType.VALIDITY],o[R.BufferType.OFFSET]||[],o[R.BufferType.DATA]||[]);case R.Type.Utf8:return j.Utf8(e,t,n,i||0,o[R.BufferType.VALIDITY],o[R.BufferType.OFFSET]||[],o[R.BufferType.DATA]||[]);case R.Type.List:return j.List(e,t,n,i||0,o[R.BufferType.VALIDITY],o[R.BufferType.OFFSET]||[],(a||[])[0]);case R.Type.FixedSizeList:return j.FixedSizeList(e,t,n,i||0,o[R.BufferType.VALIDITY],(a||[])[0]);case R.Type.Struct:return j.Struct(e,t,n,i||0,o[R.BufferType.VALIDITY],a||[]);case R.Type.Map:return j.Map(e,t,n,i||0,o[R.BufferType.VALIDITY],o[R.BufferType.OFFSET]||[],(a||[])[0]);case R.Type.Union:return j.Union(e,t,n,i||0,o[R.BufferType.VALIDITY],o[R.BufferType.TYPE]||[],o[R.BufferType.OFFSET]||a,a)}throw new Error(`Unrecognized typeId ${e.typeId}`)}static Null(e,t,n){return new j(e,t,n,0)}static Int(e,t,n,i,o,a){return new j(e,t,n,i,[void 0,te.toArrayBufferView(e.ArrayType,a),te.toUint8Array(o)])}static Dictionary(e,t,n,i,o,a,u){return new j(e,t,n,i,[void 0,te.toArrayBufferView(e.indices.ArrayType,a),te.toUint8Array(o)],[],u)}static Float(e,t,n,i,o,a){return new j(e,t,n,i,[void 0,te.toArrayBufferView(e.ArrayType,a),te.toUint8Array(o)])}static Bool(e,t,n,i,o,a){return new j(e,t,n,i,[void 0,te.toArrayBufferView(e.ArrayType,a),te.toUint8Array(o)])}static Decimal(e,t,n,i,o,a){return new j(e,t,n,i,[void 0,te.toArrayBufferView(e.ArrayType,a),te.toUint8Array(o)])}static Date(e,t,n,i,o,a){return new j(e,t,n,i,[void 0,te.toArrayBufferView(e.ArrayType,a),te.toUint8Array(o)])}static Time(e,t,n,i,o,a){return new j(e,t,n,i,[void 0,te.toArrayBufferView(e.ArrayType,a),te.toUint8Array(o)])}static Timestamp(e,t,n,i,o,a){return new j(e,t,n,i,[void 0,te.toArrayBufferView(e.ArrayType,a),te.toUint8Array(o)])}static Interval(e,t,n,i,o,a){return new j(e,t,n,i,[void 0,te.toArrayBufferView(e.ArrayType,a),te.toUint8Array(o)])}static FixedSizeBinary(e,t,n,i,o,a){return new j(e,t,n,i,[void 0,te.toArrayBufferView(e.ArrayType,a),te.toUint8Array(o)])}static Binary(e,t,n,i,o,a,u){return new j(e,t,n,i,[te.toInt32Array(a),te.toUint8Array(u),te.toUint8Array(o)])}static Utf8(e,t,n,i,o,a,u){return new j(e,t,n,i,[te.toInt32Array(a),te.toUint8Array(u),te.toUint8Array(o)])}static List(e,t,n,i,o,a,u){return new j(e,t,n,i,[te.toInt32Array(a),void 0,te.toUint8Array(o)],u?[u]:[])}static FixedSizeList(e,t,n,i,o,a){return new j(e,t,n,i,[void 0,void 0,te.toUint8Array(o)],a?[a]:[])}static Struct(e,t,n,i,o,a){return new j(e,t,n,i,[void 0,void 0,te.toUint8Array(o)],a)}static Map(e,t,n,i,o,a,u){return new j(e,t,n,i,[te.toInt32Array(a),void 0,te.toUint8Array(o)],u?[u]:[])}static Union(e,t,n,i,o,a,u,f){let s=[void 0,void 0,te.toUint8Array(o),te.toArrayBufferView(e.ArrayType,a)];return e.mode===R.UnionMode.Sparse?new j(e,t,n,i,s,u):(s[R.BufferType.OFFSET]=te.toInt32Array(u),new j(e,t,n,i,s,f))}};rn.Data=j;j.prototype.childData=Object.freeze([])});var yu=w(Qs=>{"use strict";Object.defineProperty(Qs,"__esModule",{value:!0});Qs.valueToString=void 0;var Kg=void 0;function Qg(r){if(r===null)return"null";if(r===Kg)return"undefined";switch(typeof r){case"number":return`${r}`;case"bigint":return`${r}`;case"string":return`"${r}"`}return typeof r[Symbol.toPrimitive]=="function"?r[Symbol.toPrimitive]("string"):ArrayBuffer.isView(r)?`[${r}]`:JSON.stringify(r)}Qs.valueToString=Qg});var sf=w(Zs=>{"use strict";Object.defineProperty(Zs,"__esModule",{value:!0});Zs.createIsValidFunction=void 0;var bu=yu(),Zg=He();function Xg(r){if(!r||r.length<=0)return function(i){return!0};let e="",t=r.filter(n=>n===n);return t.length>0&&(e=`
    switch (x) {${t.map(n=>`
        case ${ew(n)}:`).join("")}
            return false;
    }`),r.length!==t.length&&(e=`if (x !== x) return false;
${e}`),new Function("x",`${e}
return true;`)}Zs.createIsValidFunction=Xg;function ew(r){return typeof r!="bigint"?bu.valueToString(r):Zg.BigIntAvailable?`${bu.valueToString(r)}n`:`"${bu.valueToString(r)}"`}});var wr=w(lt=>{"use strict";Object.defineProperty(lt,"__esModule",{value:!0});lt.WideBufferBuilder=lt.OffsetsBufferBuilder=lt.BitmapBufferBuilder=lt.DataBufferBuilder=lt.BufferBuilder=void 0;var of=Ae(),mu=He(),_u=(r,e)=>(r*e+63&~63||64)/e,tw=(r,e=0)=>r.length>=e?r.subarray(0,e):of.memcpy(new r.constructor(e),r,0),Ei=class{constructor(e,t=1){this.buffer=e,this.stride=t,this.BYTES_PER_ELEMENT=e.BYTES_PER_ELEMENT,this.ArrayType=e.constructor,this._resize(this.length=e.length/t|0)}get byteLength(){return this.length*this.stride*this.BYTES_PER_ELEMENT|0}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(e,t){return this}append(e){return this.set(this.length,e)}reserve(e){if(e>0){this.length+=e;let t=this.stride,n=this.length*t,i=this.buffer.length;n>=i&&this._resize(i===0?_u(n*1,this.BYTES_PER_ELEMENT):_u(n*2,this.BYTES_PER_ELEMENT))}return this}flush(e=this.length){e=_u(e*this.stride,this.BYTES_PER_ELEMENT);let t=tw(this.buffer,e);return this.clear(),t}clear(){return this.length=0,this._resize(0),this}_resize(e){return this.buffer=of.memcpy(new this.ArrayType(e),this.buffer)}};lt.BufferBuilder=Ei;Ei.prototype.offset=0;var Xs=class extends Ei{last(){return this.get(this.length-1)}get(e){return this.buffer[e]}set(e,t){return this.reserve(e-this.length+1),this.buffer[e*this.stride]=t,this}};lt.DataBufferBuilder=Xs;var af=class extends Xs{constructor(e=new Uint8Array(0)){super(e,1/8);this.numValid=0}get numInvalid(){return this.length-this.numValid}get(e){return this.buffer[e>>3]>>e%8&1}set(e,t){let{buffer:n}=this.reserve(e-this.length+1),i=e>>3,o=e%8,a=n[i]>>o&1;return t?a===0&&(n[i]|=1<<o,++this.numValid):a===1&&(n[i]&=~(1<<o),--this.numValid),this}clear(){return this.numValid=0,super.clear()}};lt.BitmapBufferBuilder=af;var uf=class extends Xs{constructor(e=new Int32Array(1)){super(e,1)}append(e){return this.set(this.length-1,e)}set(e,t){let n=this.length-1,i=this.reserve(e-n+1).buffer;return n<e++&&i.fill(i[n],n,e),i[e]=i[e-1]+t,this}flush(e=this.length-1){return e>this.length&&this.set(e-1,0),super.flush(e+1)}};lt.OffsetsBufferBuilder=uf;var cf=class extends Ei{get ArrayType64(){return this._ArrayType64||(this._ArrayType64=this.buffer instanceof Int32Array?mu.BigInt64Array:mu.BigUint64Array)}set(e,t){switch(this.reserve(e-this.length+1),typeof t){case"bigint":this.buffer64[e]=t;break;case"number":this.buffer[e*this.stride]=t;break;default:this.buffer.set(t,e*this.stride)}return this}_resize(e){let t=super._resize(e),n=t.byteLength/(this.BYTES_PER_ELEMENT*this.stride);return mu.BigIntAvailable&&(this.buffer64=new this.ArrayType64(t.buffer,t.byteOffset,n)),t}};lt.WideBufferBuilder=cf});var we=w(Tr=>{"use strict";Object.defineProperty(Tr,"__esModule",{value:!0});Tr.VariableWidthBuilder=Tr.FixedWidthBuilder=Tr.Builder=void 0;var rw=ve(),Rn=de(),nw=St(),iw=sf(),gu=wr(),sw=oe(),dt=class{constructor({type:e,nullValues:t}){this.length=0,this.finished=!1,this.type=e,this.children=[],this.nullValues=t,this.stride=sw.strideForType(e),this._nulls=new gu.BitmapBufferBuilder,t&&t.length>0&&(this._isValid=iw.createIsValidFunction(t))}static new(e){}static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e){throw new Error('"throughDOM" not available in this environment')}static throughIterable(e){return ow(e)}static throughAsyncIterable(e){return aw(e)}toVector(){return rw.Vector.new(this.flush())}get ArrayType(){return this.type.ArrayType}get nullCount(){return this._nulls.numInvalid}get numChildren(){return this.children.length}get byteLength(){let e=0;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),this._typeIds&&(e+=this._typeIds.byteLength),this.children.reduce((t,n)=>t+n.byteLength,e)}get reservedLength(){return this._nulls.reservedLength}get reservedByteLength(){let e=0;return this._offsets&&(e+=this._offsets.reservedByteLength),this._values&&(e+=this._values.reservedByteLength),this._nulls&&(e+=this._nulls.reservedByteLength),this._typeIds&&(e+=this._typeIds.reservedByteLength),this.children.reduce((t,n)=>t+n.reservedByteLength,e)}get valueOffsets(){return this._offsets?this._offsets.buffer:null}get values(){return this._values?this._values.buffer:null}get nullBitmap(){return this._nulls?this._nulls.buffer:null}get typeIds(){return this._typeIds?this._typeIds.buffer:null}append(e){return this.set(this.length,e)}isValid(e){return this._isValid(e)}set(e,t){return this.setValid(e,this.isValid(t))&&this.setValue(e,t),this}setValue(e,t){this._setValue(this,e,t)}setValid(e,t){return this.length=this._nulls.set(e,+t).length,t}addChild(e,t=`${this.numChildren}`){throw new Error(`Cannot append children to non-nested type "${this.type}"`)}getChildAt(e){return this.children[e]||null}flush(){let e=[],t=this._values,n=this._offsets,i=this._typeIds,{length:o,nullCount:a}=this;i?(e[Rn.BufferType.TYPE]=i.flush(o),n&&(e[Rn.BufferType.OFFSET]=n.flush(o))):n?(t&&(e[Rn.BufferType.DATA]=t.flush(n.last())),e[Rn.BufferType.OFFSET]=n.flush(o)):t&&(e[Rn.BufferType.DATA]=t.flush(o)),a>0&&(e[Rn.BufferType.VALIDITY]=this._nulls.flush(o));let u=nw.Data.new(this.type,0,o,a,e,this.children.map(f=>f.flush()));return this.clear(),u}finish(){return this.finished=!0,this.children.forEach(e=>e.finish()),this}clear(){return this.length=0,this._offsets&&this._offsets.clear(),this._values&&this._values.clear(),this._nulls&&this._nulls.clear(),this._typeIds&&this._typeIds.clear(),this.children.forEach(e=>e.clear()),this}};Tr.Builder=dt;dt.prototype.length=1;dt.prototype.stride=1;dt.prototype.children=null;dt.prototype.finished=!1;dt.prototype.nullValues=null;dt.prototype._isValid=()=>!0;var lf=class extends dt{constructor(e){super(e);this._values=new gu.DataBufferBuilder(new this.ArrayType(0),this.stride)}setValue(e,t){let n=this._values;return n.reserve(e-n.length+1),super.setValue(e,t)}};Tr.FixedWidthBuilder=lf;var df=class extends dt{constructor(e){super(e);this._pendingLength=0,this._offsets=new gu.OffsetsBufferBuilder}setValue(e,t){let n=this._pending||(this._pending=new Map),i=n.get(e);i&&(this._pendingLength-=i.length),this._pendingLength+=t.length,n.set(e,t)}setValid(e,t){return super.setValid(e,t)?!0:((this._pending||(this._pending=new Map)).set(e,void 0),!1)}clear(){return this._pendingLength=0,this._pending=void 0,super.clear()}flush(){return this._flush(),super.flush()}finish(){return this._flush(),super.finish()}_flush(){let e=this._pending,t=this._pendingLength;return this._pendingLength=0,this._pending=void 0,e&&e.size>0&&this._flushPending(e,t),this}};Tr.VariableWidthBuilder=df;function ow(r){let{["queueingStrategy"]:e="count"}=r,{["highWaterMark"]:t=e!=="bytes"?1e3:2**14}=r,n=e!=="bytes"?"length":"byteLength";return function*(i){let o=0,a=dt.new(r);for(let u of i)a.append(u)[n]>=t&&++o&&(yield a.toVector());(a.finish().length>0||o===0)&&(yield a.toVector())}}function aw(r){let{["queueingStrategy"]:e="count"}=r,{["highWaterMark"]:t=e!=="bytes"?1e3:2**14}=r,n=e!=="bytes"?"length":"byteLength";return async function*(i){let o=0,a=dt.new(r);for await(let u of i)a.append(u)[n]>=t&&++o&&(yield a.toVector());(a.finish().length>0||o===0)&&(yield a.toVector())}}});var wu=w(eo=>{"use strict";Object.defineProperty(eo,"__esModule",{value:!0});eo.BoolBuilder=void 0;var uw=wr(),cw=we(),ff=class extends cw.Builder{constructor(e){super(e);this._values=new uw.BitmapBufferBuilder}setValue(e,t){this._values.set(e,+t)}};eo.BoolBuilder=ff});var Tu=w(to=>{"use strict";Object.defineProperty(to,"__esModule",{value:!0});to.NullBuilder=void 0;var lw=we(),hf=class extends lw.Builder{setValue(e,t){}setValid(e,t){return this.length=Math.max(e+1,this.length),t}};to.NullBuilder=hf});var Bu=w(Br=>{"use strict";Object.defineProperty(Br,"__esModule",{value:!0});Br.DateMillisecondBuilder=Br.DateDayBuilder=Br.DateBuilder=void 0;var dw=we(),ro=class extends dw.FixedWidthBuilder{};Br.DateBuilder=ro;var pf=class extends ro{};Br.DateDayBuilder=pf;var yf=class extends ro{};Br.DateMillisecondBuilder=yf});var vu=w(no=>{"use strict";Object.defineProperty(no,"__esModule",{value:!0});no.DecimalBuilder=void 0;var fw=we(),bf=class extends fw.FixedWidthBuilder{};no.DecimalBuilder=bf});var Su=w(io=>{"use strict";Object.defineProperty(io,"__esModule",{value:!0});io.DictionaryBuilder=void 0;var hw=oe(),Iu=we(),mf=class extends Iu.Builder{constructor({type:e,nullValues:t,dictionaryHashFunction:n}){super({type:new hw.Dictionary(e.dictionary,e.indices,e.id,e.isOrdered)});this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=Iu.Builder.new({type:this.type.indices,nullValues:t}),this.dictionary=Iu.Builder.new({type:this.type.dictionary,nullValues:null}),typeof n=="function"&&(this.valueToKey=n)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(e){return this.indices.isValid(e)}setValid(e,t){let n=this.indices;return t=n.setValid(e,t),this.length=n.length,t}setValue(e,t){let n=this._keysToIndices,i=this.valueToKey(t),o=n[i];return o===void 0&&(n[i]=o=this._dictionaryOffset+this.dictionary.append(t).length-1),this.indices.setValue(e,o)}flush(){let e=this.type,t=this._dictionary,n=this.dictionary.toVector(),i=this.indices.flush().clone(e);return i.dictionary=t?t.concat(n):n,this.finished||(this._dictionaryOffset+=n.length),this._dictionary=i.dictionary,this.clear(),i}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey(e){return typeof e=="string"?e:`${e}`}};io.DictionaryBuilder=mf});var Ou=w(so=>{"use strict";Object.defineProperty(so,"__esModule",{value:!0});so.FixedSizeBinaryBuilder=void 0;var pw=we(),_f=class extends pw.FixedWidthBuilder{};so.FixedSizeBinaryBuilder=_f});var Ui=w(Un=>{"use strict";Object.defineProperty(Un,"__esModule",{value:!0});Un.float64ToUint16=Un.uint16ToFloat64=void 0;var gf=new Float64Array(1),En=new Uint32Array(gf.buffer);function yw(r){let e=(r&31744)>>10,t=(r&1023)/1024,n=(-1)**((r&32768)>>15);switch(e){case 31:return n*(t?NaN:1/0);case 0:return n*(t?6103515625e-14*t:0)}return n*2**(e-15)*(1+t)}Un.uint16ToFloat64=yw;function bw(r){if(r!==r)return 32256;gf[0]=r;let e=(En[1]&2147483648)>>16&65535,t=En[1]&2146435072,n=0;return t>=1089470464?En[0]>0?t=31744:(t=(t&2080374784)>>16,n=(En[1]&1048575)>>10):t<=1056964608?(n=1048576+(En[1]&1048575),n=1048576+(n<<(t>>20)-998)>>21,t=0):(t=t-1056964608>>10,n=(En[1]&1048575)+512>>10),e|t|n&65535}Un.float64ToUint16=bw});var Au=w(xt=>{"use strict";Object.defineProperty(xt,"__esModule",{value:!0});xt.Float64Builder=xt.Float32Builder=xt.Float16Builder=xt.FloatBuilder=void 0;var mw=Ui(),_w=we(),Mi=class extends _w.FixedWidthBuilder{};xt.FloatBuilder=Mi;var wf=class extends Mi{setValue(e,t){this._values.set(e,mw.float64ToUint16(t))}};xt.Float16Builder=wf;var Tf=class extends Mi{setValue(e,t){this._values.set(e,t)}};xt.Float32Builder=Tf;var Bf=class extends Mi{setValue(e,t){this._values.set(e,t)}};xt.Float64Builder=Bf});var Ni=w(Pe=>{"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Pe.BN=Pe.bignumToBigInt=Pe.bignumToString=Pe.isArrowBigNumSymbol=void 0;var gw=Ae(),Pi=He();Pe.isArrowBigNumSymbol=Symbol.for("isArrowBigNum");function Ot(r,...e){return e.length===0?Object.setPrototypeOf(gw.toArrayBufferView(this.TypedArray,r),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(r,...e),this.constructor.prototype)}Ot.prototype[Pe.isArrowBigNumSymbol]=!0;Ot.prototype.toJSON=function(){return`"${Pe.bignumToString(this)}"`};Ot.prototype.valueOf=function(){return vf(this)};Ot.prototype.toString=function(){return Pe.bignumToString(this)};Ot.prototype[Symbol.toPrimitive]=function(r="default"){switch(r){case"number":return vf(this);case"string":return Pe.bignumToString(this);case"default":return Pe.bignumToBigInt(this)}return Pe.bignumToString(this)};function Mn(...r){return Ot.apply(this,r)}function Pn(...r){return Ot.apply(this,r)}function Vi(...r){return Ot.apply(this,r)}Object.setPrototypeOf(Mn.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(Pn.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(Vi.prototype,Object.create(Uint32Array.prototype));Object.assign(Mn.prototype,Ot.prototype,{constructor:Mn,signed:!0,TypedArray:Int32Array,BigIntArray:Pi.BigInt64Array});Object.assign(Pn.prototype,Ot.prototype,{constructor:Pn,signed:!1,TypedArray:Uint32Array,BigIntArray:Pi.BigUint64Array});Object.assign(Vi.prototype,Ot.prototype,{constructor:Vi,signed:!0,TypedArray:Uint32Array,BigIntArray:Pi.BigUint64Array});function vf(r){let{buffer:e,byteOffset:t,length:n,signed:i}=r,o=new Int32Array(e,t,n),a=0,u=0,f=o.length,s,c;for(;u<f;)c=o[u++],s=o[u++],i||(s=s>>>0),a+=(c>>>0)+s*u**32;return a}Pi.BigIntAvailable?(Pe.bignumToBigInt=r=>r.byteLength===8?new r.BigIntArray(r.buffer,r.byteOffset,1)[0]:Du(r),Pe.bignumToString=r=>r.byteLength===8?`${new r.BigIntArray(r.buffer,r.byteOffset,1)[0]}`:Du(r)):(Pe.bignumToString=Du,Pe.bignumToBigInt=Pe.bignumToString);function Du(r){let e="",t=new Uint32Array(2),n=new Uint16Array(r.buffer,r.byteOffset,r.byteLength/2),i=new Uint32Array((n=new Uint16Array(n).reverse()).buffer),o=-1,a=n.length-1;do{for(t[0]=n[o=0];o<a;)n[o++]=t[1]=t[0]/10,t[0]=(t[0]-t[1]*10<<16)+n[o];n[o]=t[1]=t[0]/10,t[0]=t[0]-t[1]*10,e=`${t[0]}${e}`}while(i[0]||i[1]||i[2]||i[3]);return e||"0"}var oo=class{static new(e,t){switch(t){case!0:return new Mn(e);case!1:return new Pn(e)}switch(e.constructor){case Int8Array:case Int16Array:case Int32Array:case Pi.BigInt64Array:return new Mn(e)}return e.byteLength===16?new Vi(e):new Pn(e)}static signed(e){return new Mn(e)}static unsigned(e){return new Pn(e)}static decimal(e){return new Vi(e)}constructor(e,t){return oo.new(e,t)}};Pe.BN=oo});var Fu=w(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});Fe.Uint64Builder=Fe.Uint32Builder=Fe.Uint16Builder=Fe.Uint8Builder=Fe.Int64Builder=Fe.Int32Builder=Fe.Int16Builder=Fe.Int8Builder=Fe.IntBuilder=void 0;var ww=Ni(),If=wr(),Tw=He(),Bw=we(),Ct=class extends Bw.FixedWidthBuilder{setValue(e,t){this._values.set(e,t)}};Fe.IntBuilder=Ct;var Sf=class extends Ct{};Fe.Int8Builder=Sf;var Of=class extends Ct{};Fe.Int16Builder=Of;var Af=class extends Ct{};Fe.Int32Builder=Af;var Df=class extends Ct{constructor(e){e.nullValues&&(e.nullValues=e.nullValues.map(ao));super(e);this._values=new If.WideBufferBuilder(new Int32Array(0),2)}get values64(){return this._values.buffer64}isValid(e){return super.isValid(ao(e))}};Fe.Int64Builder=Df;var Ff=class extends Ct{};Fe.Uint8Builder=Ff;var Rf=class extends Ct{};Fe.Uint16Builder=Rf;var Ef=class extends Ct{};Fe.Uint32Builder=Ef;var Uf=class extends Ct{constructor(e){e.nullValues&&(e.nullValues=e.nullValues.map(ao));super(e);this._values=new If.WideBufferBuilder(new Uint32Array(0),2)}get values64(){return this._values.buffer64}isValid(e){return super.isValid(ao(e))}};Fe.Uint64Builder=Uf;var ao=(r=>e=>(ArrayBuffer.isView(e)&&(r.buffer=e.buffer,r.byteOffset=e.byteOffset,r.byteLength=e.byteLength,e=ww.bignumToBigInt(r),r.buffer=null),e))({BigIntArray:Tw.BigInt64Array})});var Ru=w(ft=>{"use strict";Object.defineProperty(ft,"__esModule",{value:!0});ft.TimeNanosecondBuilder=ft.TimeMicrosecondBuilder=ft.TimeMillisecondBuilder=ft.TimeSecondBuilder=ft.TimeBuilder=void 0;var vw=we(),Vn=class extends vw.FixedWidthBuilder{};ft.TimeBuilder=Vn;var Mf=class extends Vn{};ft.TimeSecondBuilder=Mf;var Pf=class extends Vn{};ft.TimeMillisecondBuilder=Pf;var Vf=class extends Vn{};ft.TimeMicrosecondBuilder=Vf;var Nf=class extends Vn{};ft.TimeNanosecondBuilder=Nf});var Eu=w(ht=>{"use strict";Object.defineProperty(ht,"__esModule",{value:!0});ht.TimestampNanosecondBuilder=ht.TimestampMicrosecondBuilder=ht.TimestampMillisecondBuilder=ht.TimestampSecondBuilder=ht.TimestampBuilder=void 0;var Iw=we(),Nn=class extends Iw.FixedWidthBuilder{};ht.TimestampBuilder=Nn;var kf=class extends Nn{};ht.TimestampSecondBuilder=kf;var Lf=class extends Nn{};ht.TimestampMillisecondBuilder=Lf;var xf=class extends Nn{};ht.TimestampMicrosecondBuilder=xf;var Cf=class extends Nn{};ht.TimestampNanosecondBuilder=Cf});var Uu=w(vr=>{"use strict";Object.defineProperty(vr,"__esModule",{value:!0});vr.IntervalYearMonthBuilder=vr.IntervalDayTimeBuilder=vr.IntervalBuilder=void 0;var Sw=we(),uo=class extends Sw.FixedWidthBuilder{};vr.IntervalBuilder=uo;var jf=class extends uo{};vr.IntervalDayTimeBuilder=jf;var qf=class extends uo{};vr.IntervalYearMonthBuilder=qf});var lo=w(co=>{"use strict";Object.defineProperty(co,"__esModule",{value:!0});co.BinaryBuilder=void 0;var Ow=Ae(),Aw=wr(),Dw=we(),Wf=class extends Dw.VariableWidthBuilder{constructor(e){super(e);this._values=new Aw.BufferBuilder(new Uint8Array(0))}get byteLength(){let e=this._pendingLength+this.length*4;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),e}setValue(e,t){return super.setValue(e,Ow.toUint8Array(t))}_flushPending(e,t){let n=this._offsets,i=this._values.reserve(t).buffer,o=0,a=0,u=0,f;for([o,f]of e)f===void 0?n.set(o,0):(a=f.length,i.set(f,u),n.set(o,a),u+=a)}};co.BinaryBuilder=Wf});var ho=w(fo=>{"use strict";Object.defineProperty(fo,"__esModule",{value:!0});fo.Utf8Builder=void 0;var Fw=Zr(),Rw=lo(),Ew=wr(),Uw=we(),Mu=class extends Uw.VariableWidthBuilder{constructor(e){super(e);this._values=new Ew.BufferBuilder(new Uint8Array(0))}get byteLength(){let e=this._pendingLength+this.length*4;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),e}setValue(e,t){return super.setValue(e,Fw.encodeUtf8(t))}_flushPending(e,t){}};fo.Utf8Builder=Mu;Mu.prototype._flushPending=Rw.BinaryBuilder.prototype._flushPending});var Pu=w(po=>{"use strict";Object.defineProperty(po,"__esModule",{value:!0});po.Run=void 0;var Mw=ve(),zf=class{get length(){return this._values.length}get(e){return this._values[e]}clear(){return this._values=null,this}bind(e){return e instanceof Mw.Vector?e:(this._values=e,this)}};po.Run=zf});var ki=w(Ln=>{"use strict";Object.defineProperty(Ln,"__esModule",{value:!0});Ln.StructRow=Ln.MapRow=void 0;var Yf=yu(),ze=Symbol.for("parent"),kn=Symbol.for("rowIndex"),it=Symbol.for("keyToIdx"),st=Symbol.for("idxToVal"),Vu=Symbol.for("nodejs.util.inspect.custom"),jt=class{constructor(e,t){this[ze]=e,this.size=t}entries(){return this[Symbol.iterator]()}has(e){return this.get(e)!==void 0}get(e){let t;if(e!=null){let n=this[it]||(this[it]=new Map),i=n.get(e);if(i!==void 0){let o=this[st]||(this[st]=new Array(this.size));(t=o[i])!==void 0||(o[i]=t=this.getValue(i))}else if((i=this.getIndex(e))>-1){n.set(e,i);let o=this[st]||(this[st]=new Array(this.size));(t=o[i])!==void 0||(o[i]=t=this.getValue(i))}}return t}set(e,t){if(e!=null){let n=this[it]||(this[it]=new Map),i=n.get(e);if(i===void 0&&n.set(e,i=this.getIndex(e)),i>-1){let o=this[st]||(this[st]=new Array(this.size));o[i]=this.setValue(i,t)}}return this}clear(){throw new Error(`Clearing ${this[Symbol.toStringTag]} not supported.`)}delete(e){throw new Error(`Deleting ${this[Symbol.toStringTag]} values not supported.`)}*[Symbol.iterator](){let e=this.keys(),t=this.values(),n=this[it]||(this[it]=new Map),i=this[st]||(this[st]=new Array(this.size));for(let o,a,u=0,f,s;!((f=e.next()).done||(s=t.next()).done);++u)o=f.value,a=s.value,i[u]=a,n.has(o)||n.set(o,u),yield[o,a]}forEach(e,t){let n=this.keys(),i=this.values(),o=t===void 0?e:(f,s,c)=>e.call(t,f,s,c),a=this[it]||(this[it]=new Map),u=this[st]||(this[st]=new Array(this.size));for(let f,s,c=0,_,U;!((_=n.next()).done||(U=i.next()).done);++c)f=_.value,s=U.value,u[c]=s,a.has(f)||a.set(f,c),o(s,f,this)}toArray(){return[...this.values()]}toJSON(){let e={};return this.forEach((t,n)=>e[n]=t),e}inspect(){return this.toString()}[Vu](){return this.toString()}toString(){let e=[];return this.forEach((t,n)=>{n=Yf.valueToString(n),t=Yf.valueToString(t),e.push(`${n}: ${t}`)}),`{ ${e.join(", ")} }`}};jt[Symbol.toStringTag]=(r=>(Object.defineProperties(r,{size:{writable:!0,enumerable:!1,configurable:!1,value:0},[ze]:{writable:!0,enumerable:!1,configurable:!1,value:null},[kn]:{writable:!0,enumerable:!1,configurable:!1,value:-1}}),r[Symbol.toStringTag]="Row"))(jt.prototype);var Hf=class extends jt{constructor(e){super(e,e.length);return Pw(this)}keys(){return this[ze].getChildAt(0)[Symbol.iterator]()}values(){return this[ze].getChildAt(1)[Symbol.iterator]()}getKey(e){return this[ze].getChildAt(0).get(e)}getIndex(e){return this[ze].getChildAt(0).indexOf(e)}getValue(e){return this[ze].getChildAt(1).get(e)}setValue(e,t){this[ze].getChildAt(1).set(e,t)}};Ln.MapRow=Hf;var Gf=class extends jt{constructor(e){super(e,e.type.children.length);return $f(this)}*keys(){for(let e of this[ze].type.children)yield e.name}*values(){for(let e of this[ze].type.children)yield this[e.name]}getKey(e){return this[ze].type.children[e].name}getIndex(e){return this[ze].type.children.findIndex(t=>t.name===e)}getValue(e){return this[ze].getChildAt(e).get(this[kn])}setValue(e,t){return this[ze].getChildAt(e).set(this[kn],t)}};Ln.StructRow=Gf;Object.setPrototypeOf(jt.prototype,Map.prototype);var $f=(()=>{let r={enumerable:!0,configurable:!1,get:null,set:null};return e=>{let t=-1,n=e[it]||(e[it]=new Map),i=a=>function(){return this.get(a)},o=a=>function(u){return this.set(a,u)};for(let a of e.keys())n.set(a,++t),r.get=i(a),r.set=o(a),e.hasOwnProperty(a)||(r.enumerable=!0,Object.defineProperty(e,a,r)),e.hasOwnProperty(t)||(r.enumerable=!1,Object.defineProperty(e,t,r));return r.get=r.set=null,e}})(),Pw=(()=>{if(typeof Proxy=="undefined")return $f;let r=jt.prototype.has,e=jt.prototype.get,t=jt.prototype.set,n=jt.prototype.getKey,i={isExtensible(){return!1},deleteProperty(){return!1},preventExtensions(){return!0},ownKeys(o){return[...o.keys()].map(a=>`${a}`)},has(o,a){switch(a){case"getKey":case"getIndex":case"getValue":case"setValue":case"toArray":case"toJSON":case"inspect":case"constructor":case"isPrototypeOf":case"propertyIsEnumerable":case"toString":case"toLocaleString":case"valueOf":case"size":case"has":case"get":case"set":case"clear":case"delete":case"keys":case"values":case"entries":case"forEach":case"__proto__":case"__defineGetter__":case"__defineSetter__":case"hasOwnProperty":case"__lookupGetter__":case"__lookupSetter__":case Symbol.iterator:case Symbol.toStringTag:case ze:case kn:case st:case it:case Vu:return!0}return typeof a=="number"&&!o.has(a)&&(a=o.getKey(a)),o.has(a)},get(o,a,u){switch(a){case"getKey":case"getIndex":case"getValue":case"setValue":case"toArray":case"toJSON":case"inspect":case"constructor":case"isPrototypeOf":case"propertyIsEnumerable":case"toString":case"toLocaleString":case"valueOf":case"size":case"has":case"get":case"set":case"clear":case"delete":case"keys":case"values":case"entries":case"forEach":case"__proto__":case"__defineGetter__":case"__defineSetter__":case"hasOwnProperty":case"__lookupGetter__":case"__lookupSetter__":case Symbol.iterator:case Symbol.toStringTag:case ze:case kn:case st:case it:case Vu:return Reflect.get(o,a,u)}return typeof a=="number"&&!r.call(u,a)&&(a=n.call(u,a)),e.call(u,a)},set(o,a,u,f){switch(a){case ze:case kn:case st:case it:return Reflect.set(o,a,u,f);case"getKey":case"getIndex":case"getValue":case"setValue":case"toArray":case"toJSON":case"inspect":case"constructor":case"isPrototypeOf":case"propertyIsEnumerable":case"toString":case"toLocaleString":case"valueOf":case"size":case"has":case"get":case"set":case"clear":case"delete":case"keys":case"values":case"entries":case"forEach":case"__proto__":case"__defineGetter__":case"__defineSetter__":case"hasOwnProperty":case"__lookupGetter__":case"__lookupSetter__":case Symbol.iterator:case Symbol.toStringTag:return!1}return typeof a=="number"&&!r.call(f,a)&&(a=n.call(f,a)),r.call(f,a)?!!t.call(f,a,u):!1}};return o=>new Proxy(o,i)})()});var xi=w(Ir=>{"use strict";Object.defineProperty(Ir,"__esModule",{value:!0});Ir.createElementComparator=Ir.clampRange=Ir.clampIndex=void 0;var Jf=ve(),Kf=ki(),Vw=Ae(),Qf=He();function Nw(r,e,t){let n=r.length,i=e>-1?e:n+e%n;return t?t(r,i):i}Ir.clampIndex=Nw;var Zf;function kw(r,e,t,n){let{length:i=0}=r,o=typeof e!="number"?0:e,a=typeof t!="number"?i:t;return o<0&&(o=(o%i+i)%i),a<0&&(a=(a%i+i)%i),a<o&&(Zf=o,o=a,a=Zf),a>i&&(a=i),n?n(r,o,a):[o,a]}Ir.clampRange=kw;var Lw=Qf.BigIntAvailable?Qf.BigInt(0):0,Xf=r=>r!==r;function Li(r){let e=typeof r;if(e!=="object"||r===null)return Xf(r)?Xf:e!=="bigint"?t=>t===r:t=>Lw+t===r;if(r instanceof Date){let t=r.valueOf();return n=>n instanceof Date?n.valueOf()===t:!1}return ArrayBuffer.isView(r)?t=>t?Vw.compareArrayLike(r,t):!1:r instanceof Map?Cw(r):Array.isArray(r)?xw(r):r instanceof Jf.Vector?jw(r):qw(r)}Ir.createElementComparator=Li;function xw(r){let e=[];for(let t=-1,n=r.length;++t<n;)e[t]=Li(r[t]);return yo(e)}function Cw(r){let e=-1,t=[];return r.forEach(n=>t[++e]=Li(n)),yo(t)}function jw(r){let e=[];for(let t=-1,n=r.length;++t<n;)e[t]=Li(r.get(t));return yo(e)}function qw(r){let e=Object.keys(r);if(e.length===0)return()=>!1;let t=[];for(let n=-1,i=e.length;++n<i;)t[n]=Li(r[e[n]]);return yo(t,e)}function yo(r,e){return t=>{if(!t||typeof t!="object")return!1;switch(t.constructor){case Array:return Ww(r,t);case Map:case Kf.MapRow:case Kf.StructRow:return eh(r,t,t.keys());case Object:case void 0:return eh(r,t,e||Object.keys(t))}return t instanceof Jf.Vector?zw(r,t):!1}}function Ww(r,e){let t=r.length;if(e.length!==t)return!1;for(let n=-1;++n<t;)if(!r[n](e[n]))return!1;return!0}function zw(r,e){let t=r.length;if(e.length!==t)return!1;for(let n=-1;++n<t;)if(!r[n](e.get(n)))return!1;return!0}function eh(r,e,t){let n=t[Symbol.iterator](),i=e instanceof Map?e.keys():Object.keys(e)[Symbol.iterator](),o=e instanceof Map?e.values():Object.values(e)[Symbol.iterator](),a=0,u=r.length,f=o.next(),s=n.next(),c=i.next();for(;a<u&&!s.done&&!c.done&&!f.done&&!(s.value!==c.value||!r[a](f.value));++a,s=n.next(),c=i.next(),f=o.next());return a===u&&s.done&&c.done&&f.done?!0:(n.return&&n.return(),i.return&&i.return(),o.return&&o.return(),!1)}});var Sr=w(bo=>{"use strict";Object.defineProperty(bo,"__esModule",{value:!0});bo.Chunked=void 0;var Yw=xi(),th=oe(),Hw=Or(),rh=ve(),ar=class extends rh.AbstractVector{constructor(e,t=[],n=Gw(t)){super();this._nullCount=-1,this._type=e,this._chunks=t,this._chunkOffsets=n,this._length=n[n.length-1],this._numChildren=(this._type.children||[]).length}static flatten(...e){return Hw.selectChunkArgs(rh.Vector,e)}static concat(...e){let t=ar.flatten(...e);return new ar(t[0].type,t)}get type(){return this._type}get length(){return this._length}get chunks(){return this._chunks}get typeId(){return this._type.typeId}get VectorName(){return`Chunked<${this._type}>`}get data(){return this._chunks[0]?this._chunks[0].data:null}get ArrayType(){return this._type.ArrayType}get numChildren(){return this._numChildren}get stride(){return this._chunks[0]?this._chunks[0].stride:1}get byteLength(){return this._chunks.reduce((e,t)=>e+t.byteLength,0)}get nullCount(){let e=this._nullCount;return e<0&&(this._nullCount=e=this._chunks.reduce((t,{nullCount:n})=>t+n,0)),e}get indices(){if(th.DataType.isDictionary(this._type)){if(!this._indices){let e=this._chunks;this._indices=e.length===1?e[0].indices:ar.concat(...e.map(t=>t.indices))}return this._indices}return null}get dictionary(){return th.DataType.isDictionary(this._type)?this._chunks[this._chunks.length-1].data.dictionary:null}*[Symbol.iterator](){for(let e of this._chunks)yield*e}clone(e=this._chunks){return new ar(this._type,e)}concat(...e){return this.clone(ar.flatten(this,...e))}slice(e,t){return Yw.clampRange(this,e,t,this._sliceInternal)}getChildAt(e){if(e<0||e>=this._numChildren)return null;let t=this._children||(this._children=[]),n,i,o;return(n=t[e])?n:(i=(this._type.children||[])[e])&&(o=this._chunks.map(a=>a.getChildAt(e)).filter(a=>a!=null),o.length>0)?t[e]=new ar(i.type,o):null}search(e,t){let n=e,i=this._chunkOffsets,o=i.length-1;if(n<0||n>=i[o])return null;if(o<=1)return t?t(this,0,n):[0,n];let a=0,u=0,f=0;do{if(a+1===o)return t?t(this,a,n-u):[a,n-u];f=a+(o-a)/2|0,n>=i[f]?a=f:o=f}while(n<i[o]&&n>=(u=i[a]));return null}isValid(e){return!!this.search(e,this.isValidInternal)}get(e){return this.search(e,this.getInternal)}set(e,t){this.search(e,({chunks:n},i,o)=>n[i].set(o,t))}indexOf(e,t){return t&&typeof t=="number"?this.search(t,(n,i,o)=>this.indexOfInternal(n,i,o,e)):this.indexOfInternal(this,0,Math.max(0,t||0),e)}toArray(){let{chunks:e}=this,t=e.length,n=this._type.ArrayType;if(t<=0)return new n(0);if(t<=1)return e[0].toArray();let i=0,o=new Array(t);for(let f=-1;++f<t;)i+=(o[f]=e[f].toArray()).length;n!==o[0].constructor&&(n=o[0].constructor);let a=new n(i),u=n===Array?Jw:$w;for(let f=-1,s=0;++f<t;)s=u(o[f],a,s);return a}getInternal({_chunks:e},t,n){return e[t].get(n)}isValidInternal({_chunks:e},t,n){return e[t].isValid(n)}indexOfInternal({_chunks:e},t,n,i){let o=t-1,a=e.length,u=n,f=0,s=-1;for(;++o<a;){if(~(s=e[o].indexOf(i,u)))return f+s;u=0,f+=e[o].length}return-1}_sliceInternal(e,t,n){let i=[],{chunks:o,_chunkOffsets:a}=e;for(let u=-1,f=o.length;++u<f;){let s=o[u],c=s.length,_=a[u];if(_>=n)break;if(t>=_+c)continue;if(_>=t&&_+c<=n){i.push(s);continue}let U=Math.max(0,t-_),J=Math.min(n-_,c);i.push(s.slice(U,J))}return e.clone(i)}};bo.Chunked=ar;function Gw(r){let e=new Uint32Array((r||[]).length+1),t=e[0]=0,n=e.length;for(let i=0;++i<n;)e[i]=t+=r[i-1].length;return e}var $w=(r,e,t)=>(e.set(r,t),t+r.length),Jw=(r,e,t)=>{let n=t;for(let i=-1,o=r.length;++i<o;)e[n++]=r[i];return n}});var xn=w(mo=>{"use strict";Object.defineProperty(mo,"__esModule",{value:!0});mo.Column=void 0;var nh=Le(),ih=ve(),Nu=Sr(),nn=class extends Nu.Chunked{constructor(e,t=[],n){t=Nu.Chunked.flatten(...t);super(e.type,t,n);if(this._field=e,t.length===1&&!(this instanceof ku))return new ku(e,t[0],this._chunkOffsets)}static new(...e){let[t,n,...i]=e;typeof t!="string"&&!(t instanceof nh.Field)&&(n=t,t="");let o=Nu.Chunked.flatten(Array.isArray(n)?[...n,...i]:n instanceof ih.Vector?[n,...i]:[ih.Vector.new(n,...i)]);if(typeof t=="string"){let a=o[0].data.type;t=new nh.Field(t,a,!0)}else!t.nullable&&o.some(({nullCount:a})=>a>0)&&(t=t.clone({nullable:!0}));return new nn(t,o)}get field(){return this._field}get name(){return this._field.name}get nullable(){return this._field.nullable}get metadata(){return this._field.metadata}clone(e=this._chunks){return new nn(this._field,e)}getChildAt(e){if(e<0||e>=this.numChildren)return null;let t=this._children||(this._children=[]),n,i,o;return(n=t[e])?n:(i=(this.type.children||[])[e])&&(o=this._chunks.map(a=>a.getChildAt(e)).filter(a=>a!=null),o.length>0)?t[e]=new nn(i,o):null}};mo.Column=nn;var ku=class extends nn{constructor(e,t,n){super(e,[t],n);this._chunk=t}search(e,t){return t?t(this,0,e):[0,e]}isValid(e){return this._chunk.isValid(e)}get(e){return this._chunk.get(e)}set(e,t){this._chunk.set(e,t)}indexOf(e,t){return this._chunk.indexOf(e,t)}}});var Or=w(nt=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0});nt.selectColumnChildrenArgs=nt.selectVectorChildrenArgs=nt.selectChunkArgs=nt.selectFieldArgs=nt.selectColumnArgs=nt.selectArgs=void 0;var sh=St(),oh=Le(),Ar=xn(),Ci=ve(),ah=oe(),Kw=Sr(),Dr=Array.isArray;nt.selectArgs=(r,e)=>_o(r,e,[],0);nt.selectColumnArgs=r=>{let[e,t]=xu(r,[[],[]]);return t.map((n,i)=>n instanceof Ar.Column?Ar.Column.new(n.field.clone(e[i]),n):n instanceof Ci.Vector?Ar.Column.new(e[i],n):Ar.Column.new(e[i],[]))};nt.selectFieldArgs=r=>xu(r,[[],[]]);nt.selectChunkArgs=(r,e)=>Lu(r,e,[],0);nt.selectVectorChildrenArgs=(r,e)=>uh(r,e,[],0);nt.selectColumnChildrenArgs=(r,e)=>ch(r,e,[],0);function _o(r,e,t,n){let i,o=n,a=-1,u=e.length;for(;++a<u;)Dr(i=e[a])?o=_o(r,i,t,o).length:i instanceof r&&(t[o++]=i);return t}function Lu(r,e,t,n){let i,o=n,a=-1,u=e.length;for(;++a<u;)Dr(i=e[a])?o=Lu(r,i,t,o).length:i instanceof Kw.Chunked?o=Lu(r,i.chunks,t,o).length:i instanceof r&&(t[o++]=i);return t}function uh(r,e,t,n){let i,o=n,a=-1,u=e.length;for(;++a<u;)Dr(i=e[a])?o=uh(r,i,t,o).length:i instanceof r?o=_o(Ci.Vector,i.schema.fields.map((f,s)=>i.getChildAt(s)),t,o).length:i instanceof Ci.Vector&&(t[o++]=i);return t}function ch(r,e,t,n){let i,o=n,a=-1,u=e.length;for(;++a<u;)Dr(i=e[a])?o=ch(r,i,t,o).length:i instanceof r?o=_o(Ar.Column,i.schema.fields.map((f,s)=>Ar.Column.new(f,i.getChildAt(s))),t,o).length:i instanceof Ar.Column&&(t[o++]=i);return t}var Qw=(r,[e,t],n)=>(r[0][n]=e,r[1][n]=t,r);function xu(r,e){let t,n;switch(n=r.length){case 0:return e;case 1:if(t=e[0],!r[0])return e;if(Dr(r[0]))return xu(r[0],e);r[0]instanceof sh.Data||r[0]instanceof Ci.Vector||r[0]instanceof ah.DataType||([t,r]=Object.entries(r[0]).reduce(Qw,e));break;default:Dr(t=r[n-1])?r=Dr(r[0])?r[0]:r.slice(0,n-1):(r=Dr(r[0])?r[0]:r,t=[])}let i=-1,o=-1,a=-1,u=r.length,f,s,[c,_]=e;for(;++a<u;)s=r[a],s instanceof Ar.Column&&(_[++o]=s)?c[++i]=s.field.clone(t[a],s.type,!0):({[a]:f=a}=t,s instanceof ah.DataType&&(_[++o]=s)?c[++i]=oh.Field.new(f,s,!0):s&&s.type&&(_[++o]=s)&&(s instanceof sh.Data&&(_[o]=s=Ci.Vector.new(s)),c[++i]=oh.Field.new(f,s.type,!0)));return e}});var Le=w(Cn=>{"use strict";Object.defineProperty(Cn,"__esModule",{value:!0});Cn.Field=Cn.Schema=void 0;var Zw=oe(),Xw=Or(),eT=Or(),lh=nu(),ot=class{constructor(e=[],t,n){this.fields=e||[],this.metadata=t||new Map,n||(n=Cu(e)),this.dictionaries=n}static from(...e){return ot.new(e[0],e[1])}static new(...e){return new ot(eT.selectFieldArgs(e)[0])}get[Symbol.toStringTag](){return"Schema"}toString(){return`Schema<{ ${this.fields.map((e,t)=>`${t}: ${e}`).join(", ")} }>`}compareTo(e){return lh.instance.compareSchemas(this,e)}select(...e){let t=e.reduce((n,i)=>(n[i]=!0)&&n,Object.create(null));return new ot(this.fields.filter(n=>t[n.name]),this.metadata)}selectAt(...e){return new ot(e.map(t=>this.fields[t]).filter(Boolean),this.metadata)}assign(...e){let t=e[0]instanceof ot?e[0]:new ot(Xw.selectArgs(qt,e)),n=[...this.fields],i=go(go(new Map,this.metadata),t.metadata),o=t.fields.filter(u=>{let f=n.findIndex(s=>s.name===u.name);return~f?(n[f]=u.clone({metadata:go(go(new Map,n[f].metadata),u.metadata)}))&&!1:!0}),a=Cu(o,new Map);return new ot([...n,...o],i,new Map([...this.dictionaries,...a]))}};Cn.Schema=ot;var qt=class{constructor(e,t,n=!1,i){this.name=e,this.type=t,this.nullable=n,this.metadata=i||new Map}static new(...e){let[t,n,i,o]=e;return e[0]&&typeof e[0]=="object"&&({name:t}=e[0],n===void 0&&(n=e[0].type),i===void 0&&(i=e[0].nullable),o===void 0&&(o=e[0].metadata)),new qt(`${t}`,n,i,o)}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}compareTo(e){return lh.instance.compareField(this,e)}clone(...e){let[t,n,i,o]=e;return!e[0]||typeof e[0]!="object"?[t=this.name,n=this.type,i=this.nullable,o=this.metadata]=e:{name:t=this.name,type:n=this.type,nullable:i=this.nullable,metadata:o=this.metadata}=e[0],qt.new(t,n,i,o)}};Cn.Field=qt;function go(r,e){return new Map([...r||new Map,...e||new Map])}function Cu(r,e=new Map){for(let t=-1,n=r.length;++t<n;){let o=r[t].type;if(Zw.DataType.isDictionary(o)){if(!e.has(o.id))e.set(o.id,o.dictionary);else if(e.get(o.id)!==o.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}o.children&&o.children.length>0&&Cu(o.children,e)}return e}ot.prototype.fields=null;ot.prototype.metadata=null;ot.prototype.dictionaries=null;qt.prototype.type=null;qt.prototype.name=null;qt.prototype.nullable=null;qt.prototype.metadata=null});var ju=w(wo=>{"use strict";Object.defineProperty(wo,"__esModule",{value:!0});wo.ListBuilder=void 0;var tT=Pu(),rT=Le(),nT=oe(),iT=wr(),sT=we(),dh=class extends sT.VariableWidthBuilder{constructor(e){super(e);this._run=new tT.Run,this._offsets=new iT.OffsetsBufferBuilder}addChild(e,t="0"){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=e,this.type=new nT.List(new rT.Field(t,e.type,!0)),this.numChildren-1}clear(){return this._run.clear(),super.clear()}_flushPending(e){let t=this._run,n=this._offsets,i=this._setValue,o=0,a;for([o,a]of e)a===void 0?n.set(o,0):(n.set(o,a.length),i(this,o,t.bind(a)))}};wo.ListBuilder=dh});var qu=w(To=>{"use strict";Object.defineProperty(To,"__esModule",{value:!0});To.FixedSizeListBuilder=void 0;var oT=Pu(),aT=Le(),uT=we(),cT=oe(),fh=class extends uT.Builder{constructor(){super(...arguments);this._run=new oT.Run}setValue(e,t){super.setValue(e,this._run.bind(t))}addChild(e,t="0"){if(this.numChildren>0)throw new Error("FixedSizeListBuilder can only have one child.");let n=this.children.push(e);return this.type=new cT.FixedSizeList(this.type.listSize,new aT.Field(t,e.type,!0)),n}clear(){return this._run.clear(),super.clear()}};To.FixedSizeListBuilder=fh});var Wu=w(Bo=>{"use strict";Object.defineProperty(Bo,"__esModule",{value:!0});Bo.MapBuilder=void 0;var lT=Le(),dT=oe(),fT=we(),hh=class extends fT.VariableWidthBuilder{set(e,t){return super.set(e,t)}setValue(e,t){t=t instanceof Map?t:new Map(Object.entries(t));let n=this._pending||(this._pending=new Map),i=n.get(e);i&&(this._pendingLength-=i.size),this._pendingLength+=t.size,n.set(e,t)}addChild(e,t=`${this.numChildren}`){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=e,this.type=new dT.Map_(new lT.Field(t,e.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending(e){let t=this._offsets,n=this._setValue;e.forEach((i,o)=>{i===void 0?t.set(o,0):(t.set(o,i.size),n(this,o,i))})}};Bo.MapBuilder=hh});var zu=w(vo=>{"use strict";Object.defineProperty(vo,"__esModule",{value:!0});vo.StructBuilder=void 0;var hT=Le(),pT=we(),yT=oe(),ph=class extends pT.Builder{addChild(e,t=`${this.numChildren}`){let n=this.children.push(e);return this.type=new yT.Struct([...this.type.children,new hT.Field(t,e.type,!0)]),n}};vo.StructBuilder=ph});var Yu=w(Fr=>{"use strict";Object.defineProperty(Fr,"__esModule",{value:!0});Fr.DenseUnionBuilder=Fr.SparseUnionBuilder=Fr.UnionBuilder=void 0;var bT=Le(),yh=wr(),mT=we(),_T=oe(),Io=class extends mT.Builder{constructor(e){super(e);this._typeIds=new yh.DataBufferBuilder(new Int8Array(0),1),typeof e.valueToChildTypeId=="function"&&(this._valueToChildTypeId=e.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(e,t){return this.set(this.length,e,t)}set(e,t,n){return n===void 0&&(n=this._valueToChildTypeId(this,t,e)),this.setValid(e,this.isValid(t))&&this.setValue(e,t,n),this}setValue(e,t,n){this._typeIds.set(e,n),super.setValue(e,t)}addChild(e,t=`${this.children.length}`){let n=this.children.push(e),{type:{children:i,mode:o,typeIds:a}}=this,u=[...i,new bT.Field(t,e.type)];return this.type=new _T.Union(o,[...a,n],u),n}_valueToChildTypeId(e,t,n){throw new Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}};Fr.UnionBuilder=Io;var bh=class extends Io{};Fr.SparseUnionBuilder=bh;var mh=class extends Io{constructor(e){super(e);this._offsets=new yh.DataBufferBuilder(new Int32Array(0))}setValue(e,t,n){let i=this.type.typeIdToChildIndex[n];return this._offsets.set(e,this.getChildAt(i).length),super.setValue(e,t,n)}};Fr.DenseUnionBuilder=mh});var $u=w(jn=>{"use strict";Object.defineProperty(jn,"__esModule",{value:!0});jn.instance=jn.SetVisitor=void 0;var gT=ve(),wT=We(),TT=Zr(),BT=Ui(),vT=Ae(),pt=de(),q=class extends wT.Visitor{};jn.SetVisitor=q;var IT=(r,e,t)=>{r[e]=t/864e5|0},Hu=(r,e,t)=>{r[e]=t%4294967296|0,r[e+1]=t/4294967296|0},ST=(r,e,t)=>{r[e]=t*1e3%4294967296|0,r[e+1]=t*1e3/4294967296|0},OT=(r,e,t)=>{r[e]=t*1e6%4294967296|0,r[e+1]=t*1e6/4294967296|0},_h=(r,e,t,n)=>{let{[t]:i,[t+1]:o}=e;i!=null&&o!=null&&r.set(n.subarray(0,o-i),i)},AT=({offset:r,values:e},t,n)=>{let i=r+t;n?e[i>>3]|=1<<i%8:e[i>>3]&=~(1<<i%8)},gh=({values:r},e,t)=>{IT(r,e,t.valueOf())},wh=({values:r},e,t)=>{Hu(r,e*2,t.valueOf())},Wt=({stride:r,values:e},t,n)=>{e[r*t]=n},Th=({stride:r,values:e},t,n)=>{e[r*t]=BT.float64ToUint16(n)},Gu=(r,e,t)=>{switch(typeof t){case"bigint":r.values64[e]=t;break;case"number":r.values[e*r.stride]=t;break;default:let n=t,{stride:i,ArrayType:o}=r,a=vT.toArrayBufferView(o,n);r.values.set(a.subarray(0,i),i*e)}},DT=({stride:r,values:e},t,n)=>{e.set(n.subarray(0,r),r*t)},FT=({values:r,valueOffsets:e},t,n)=>_h(r,e,t,n),RT=({values:r,valueOffsets:e},t,n)=>{_h(r,e,t,TT.encodeUtf8(n))},ET=(r,e,t)=>{r.type.bitWidth<64?Wt(r,e,t):Gu(r,e,t)},UT=(r,e,t)=>{r.type.precision!==pt.Precision.HALF?Wt(r,e,t):Th(r,e,t)},MT=(r,e,t)=>{r.type.unit===pt.DateUnit.DAY?gh(r,e,t):wh(r,e,t)},Bh=({values:r},e,t)=>Hu(r,e*2,t/1e3),vh=({values:r},e,t)=>Hu(r,e*2,t),Ih=({values:r},e,t)=>ST(r,e*2,t),Sh=({values:r},e,t)=>OT(r,e*2,t),PT=(r,e,t)=>{switch(r.type.unit){case pt.TimeUnit.SECOND:return Bh(r,e,t);case pt.TimeUnit.MILLISECOND:return vh(r,e,t);case pt.TimeUnit.MICROSECOND:return Ih(r,e,t);case pt.TimeUnit.NANOSECOND:return Sh(r,e,t)}},Oh=({values:r,stride:e},t,n)=>{r[e*t]=n},Ah=({values:r,stride:e},t,n)=>{r[e*t]=n},Dh=({values:r},e,t)=>{r.set(t.subarray(0,2),2*e)},Fh=({values:r},e,t)=>{r.set(t.subarray(0,2),2*e)},VT=(r,e,t)=>{switch(r.type.unit){case pt.TimeUnit.SECOND:return Oh(r,e,t);case pt.TimeUnit.MILLISECOND:return Ah(r,e,t);case pt.TimeUnit.MICROSECOND:return Dh(r,e,t);case pt.TimeUnit.NANOSECOND:return Fh(r,e,t)}},NT=({values:r},e,t)=>{r.set(t.subarray(0,4),4*e)},kT=(r,e,t)=>{let n=r.getChildAt(0),i=r.valueOffsets;for(let o=-1,a=i[e],u=i[e+1];a<u;)n.set(a++,t.get(++o))},LT=(r,e,t)=>{let n=r.getChildAt(0),i=r.valueOffsets,o=t instanceof Map?[...t]:Object.entries(t);for(let a=-1,u=i[e],f=i[e+1];u<f;)n.set(u++,o[++a])},xT=(r,e)=>(t,n,i)=>t&&t.set(r,e[i]),CT=(r,e)=>(t,n,i)=>t&&t.set(r,e.get(i)),jT=(r,e)=>(t,n,i)=>t&&t.set(r,e.get(n.name)),qT=(r,e)=>(t,n,i)=>t&&t.set(r,e[n.name]),WT=(r,e,t)=>{let n=t instanceof Map?jT(e,t):t instanceof gT.Vector?CT(e,t):Array.isArray(t)?xT(e,t):qT(e,t);r.type.children.forEach((i,o)=>n(r.getChildAt(o),i,o))},zT=(r,e,t)=>{r.type.mode===pt.UnionMode.Dense?Rh(r,e,t):Eh(r,e,t)},Rh=(r,e,t)=>{let n=r.typeIdToChildIndex[r.typeIds[e]],i=r.getChildAt(n);i&&i.set(r.valueOffsets[e],t)},Eh=(r,e,t)=>{let n=r.typeIdToChildIndex[r.typeIds[e]],i=r.getChildAt(n);i&&i.set(e,t)},YT=(r,e,t)=>{let n=r.getKey(e);n!==null&&r.setValue(n,t)},HT=(r,e,t)=>{r.type.unit===pt.IntervalUnit.DAY_TIME?Uh(r,e,t):Mh(r,e,t)},Uh=({values:r},e,t)=>{r.set(t.subarray(0,2),2*e)},Mh=({values:r},e,t)=>{r[e]=t[0]*12+t[1]%12},GT=(r,e,t)=>{let n=r.getChildAt(0),{stride:i}=r;for(let o=-1,a=e*i;++o<i;)n.set(a+o,t.get(o))};q.prototype.visitBool=AT;q.prototype.visitInt=ET;q.prototype.visitInt8=Wt;q.prototype.visitInt16=Wt;q.prototype.visitInt32=Wt;q.prototype.visitInt64=Gu;q.prototype.visitUint8=Wt;q.prototype.visitUint16=Wt;q.prototype.visitUint32=Wt;q.prototype.visitUint64=Gu;q.prototype.visitFloat=UT;q.prototype.visitFloat16=Th;q.prototype.visitFloat32=Wt;q.prototype.visitFloat64=Wt;q.prototype.visitUtf8=RT;q.prototype.visitBinary=FT;q.prototype.visitFixedSizeBinary=DT;q.prototype.visitDate=MT;q.prototype.visitDateDay=gh;q.prototype.visitDateMillisecond=wh;q.prototype.visitTimestamp=PT;q.prototype.visitTimestampSecond=Bh;q.prototype.visitTimestampMillisecond=vh;q.prototype.visitTimestampMicrosecond=Ih;q.prototype.visitTimestampNanosecond=Sh;q.prototype.visitTime=VT;q.prototype.visitTimeSecond=Oh;q.prototype.visitTimeMillisecond=Ah;q.prototype.visitTimeMicrosecond=Dh;q.prototype.visitTimeNanosecond=Fh;q.prototype.visitDecimal=NT;q.prototype.visitList=kT;q.prototype.visitStruct=WT;q.prototype.visitUnion=zT;q.prototype.visitDenseUnion=Rh;q.prototype.visitSparseUnion=Eh;q.prototype.visitDictionary=YT;q.prototype.visitInterval=HT;q.prototype.visitIntervalDayTime=Uh;q.prototype.visitIntervalYearMonth=Mh;q.prototype.visitFixedSizeList=GT;q.prototype.visitMap=LT;jn.instance=new q});var Ph=w(qn=>{"use strict";Object.defineProperty(qn,"__esModule",{value:!0});qn.instance=qn.GetBuilderCtor=void 0;var $T=We(),JT=lo(),KT=wu(),Ju=Bu(),QT=vu(),ZT=Su(),XT=Ou(),eB=qu(),So=Au(),Ku=Uu(),ur=Fu(),tB=ju(),rB=Wu(),nB=Tu(),iB=zu(),ji=Eu(),qi=Ru(),Qu=Yu(),sB=ho(),Zu=class extends $T.Visitor{visitNull(){return nB.NullBuilder}visitBool(){return KT.BoolBuilder}visitInt(){return ur.IntBuilder}visitInt8(){return ur.Int8Builder}visitInt16(){return ur.Int16Builder}visitInt32(){return ur.Int32Builder}visitInt64(){return ur.Int64Builder}visitUint8(){return ur.Uint8Builder}visitUint16(){return ur.Uint16Builder}visitUint32(){return ur.Uint32Builder}visitUint64(){return ur.Uint64Builder}visitFloat(){return So.FloatBuilder}visitFloat16(){return So.Float16Builder}visitFloat32(){return So.Float32Builder}visitFloat64(){return So.Float64Builder}visitUtf8(){return sB.Utf8Builder}visitBinary(){return JT.BinaryBuilder}visitFixedSizeBinary(){return XT.FixedSizeBinaryBuilder}visitDate(){return Ju.DateBuilder}visitDateDay(){return Ju.DateDayBuilder}visitDateMillisecond(){return Ju.DateMillisecondBuilder}visitTimestamp(){return ji.TimestampBuilder}visitTimestampSecond(){return ji.TimestampSecondBuilder}visitTimestampMillisecond(){return ji.TimestampMillisecondBuilder}visitTimestampMicrosecond(){return ji.TimestampMicrosecondBuilder}visitTimestampNanosecond(){return ji.TimestampNanosecondBuilder}visitTime(){return qi.TimeBuilder}visitTimeSecond(){return qi.TimeSecondBuilder}visitTimeMillisecond(){return qi.TimeMillisecondBuilder}visitTimeMicrosecond(){return qi.TimeMicrosecondBuilder}visitTimeNanosecond(){return qi.TimeNanosecondBuilder}visitDecimal(){return QT.DecimalBuilder}visitList(){return tB.ListBuilder}visitStruct(){return iB.StructBuilder}visitUnion(){return Qu.UnionBuilder}visitDenseUnion(){return Qu.DenseUnionBuilder}visitSparseUnion(){return Qu.SparseUnionBuilder}visitDictionary(){return ZT.DictionaryBuilder}visitInterval(){return Ku.IntervalBuilder}visitIntervalDayTime(){return Ku.IntervalDayTimeBuilder}visitIntervalYearMonth(){return Ku.IntervalYearMonthBuilder}visitFixedSizeList(){return eB.FixedSizeListBuilder}visitMap(){return rB.MapBuilder}};qn.GetBuilderCtor=Zu;qn.instance=new Zu});var Ao=w(v=>{"use strict";Object.defineProperty(v,"__esModule",{value:!0});v.DenseUnionBuilder=v.SparseUnionBuilder=v.UnionBuilder=v.StructBuilder=v.MapBuilder=v.FixedSizeListBuilder=v.ListBuilder=v.BinaryBuilder=v.Utf8Builder=v.IntervalYearMonthBuilder=v.IntervalDayTimeBuilder=v.IntervalBuilder=v.TimestampNanosecondBuilder=v.TimestampMicrosecondBuilder=v.TimestampMillisecondBuilder=v.TimestampSecondBuilder=v.TimestampBuilder=v.TimeNanosecondBuilder=v.TimeMicrosecondBuilder=v.TimeMillisecondBuilder=v.TimeSecondBuilder=v.TimeBuilder=v.Uint64Builder=v.Uint32Builder=v.Uint16Builder=v.Uint8Builder=v.Int64Builder=v.Int32Builder=v.Int16Builder=v.Int8Builder=v.IntBuilder=v.Float64Builder=v.Float32Builder=v.Float16Builder=v.FloatBuilder=v.FixedSizeBinaryBuilder=v.DictionaryBuilder=v.DecimalBuilder=v.DateMillisecondBuilder=v.DateDayBuilder=v.DateBuilder=v.NullBuilder=v.BoolBuilder=v.Builder=void 0;var oB=we();Object.defineProperty(v,"Builder",{enumerable:!0,get:function(){return oB.Builder}});var aB=wu();Object.defineProperty(v,"BoolBuilder",{enumerable:!0,get:function(){return aB.BoolBuilder}});var uB=Tu();Object.defineProperty(v,"NullBuilder",{enumerable:!0,get:function(){return uB.NullBuilder}});var Xu=Bu();Object.defineProperty(v,"DateBuilder",{enumerable:!0,get:function(){return Xu.DateBuilder}});Object.defineProperty(v,"DateDayBuilder",{enumerable:!0,get:function(){return Xu.DateDayBuilder}});Object.defineProperty(v,"DateMillisecondBuilder",{enumerable:!0,get:function(){return Xu.DateMillisecondBuilder}});var cB=vu();Object.defineProperty(v,"DecimalBuilder",{enumerable:!0,get:function(){return cB.DecimalBuilder}});var lB=Su();Object.defineProperty(v,"DictionaryBuilder",{enumerable:!0,get:function(){return lB.DictionaryBuilder}});var dB=Ou();Object.defineProperty(v,"FixedSizeBinaryBuilder",{enumerable:!0,get:function(){return dB.FixedSizeBinaryBuilder}});var Oo=Au();Object.defineProperty(v,"FloatBuilder",{enumerable:!0,get:function(){return Oo.FloatBuilder}});Object.defineProperty(v,"Float16Builder",{enumerable:!0,get:function(){return Oo.Float16Builder}});Object.defineProperty(v,"Float32Builder",{enumerable:!0,get:function(){return Oo.Float32Builder}});Object.defineProperty(v,"Float64Builder",{enumerable:!0,get:function(){return Oo.Float64Builder}});var cr=Fu();Object.defineProperty(v,"IntBuilder",{enumerable:!0,get:function(){return cr.IntBuilder}});Object.defineProperty(v,"Int8Builder",{enumerable:!0,get:function(){return cr.Int8Builder}});Object.defineProperty(v,"Int16Builder",{enumerable:!0,get:function(){return cr.Int16Builder}});Object.defineProperty(v,"Int32Builder",{enumerable:!0,get:function(){return cr.Int32Builder}});Object.defineProperty(v,"Int64Builder",{enumerable:!0,get:function(){return cr.Int64Builder}});Object.defineProperty(v,"Uint8Builder",{enumerable:!0,get:function(){return cr.Uint8Builder}});Object.defineProperty(v,"Uint16Builder",{enumerable:!0,get:function(){return cr.Uint16Builder}});Object.defineProperty(v,"Uint32Builder",{enumerable:!0,get:function(){return cr.Uint32Builder}});Object.defineProperty(v,"Uint64Builder",{enumerable:!0,get:function(){return cr.Uint64Builder}});var Wi=Ru();Object.defineProperty(v,"TimeBuilder",{enumerable:!0,get:function(){return Wi.TimeBuilder}});Object.defineProperty(v,"TimeSecondBuilder",{enumerable:!0,get:function(){return Wi.TimeSecondBuilder}});Object.defineProperty(v,"TimeMillisecondBuilder",{enumerable:!0,get:function(){return Wi.TimeMillisecondBuilder}});Object.defineProperty(v,"TimeMicrosecondBuilder",{enumerable:!0,get:function(){return Wi.TimeMicrosecondBuilder}});Object.defineProperty(v,"TimeNanosecondBuilder",{enumerable:!0,get:function(){return Wi.TimeNanosecondBuilder}});var zi=Eu();Object.defineProperty(v,"TimestampBuilder",{enumerable:!0,get:function(){return zi.TimestampBuilder}});Object.defineProperty(v,"TimestampSecondBuilder",{enumerable:!0,get:function(){return zi.TimestampSecondBuilder}});Object.defineProperty(v,"TimestampMillisecondBuilder",{enumerable:!0,get:function(){return zi.TimestampMillisecondBuilder}});Object.defineProperty(v,"TimestampMicrosecondBuilder",{enumerable:!0,get:function(){return zi.TimestampMicrosecondBuilder}});Object.defineProperty(v,"TimestampNanosecondBuilder",{enumerable:!0,get:function(){return zi.TimestampNanosecondBuilder}});var ec=Uu();Object.defineProperty(v,"IntervalBuilder",{enumerable:!0,get:function(){return ec.IntervalBuilder}});Object.defineProperty(v,"IntervalDayTimeBuilder",{enumerable:!0,get:function(){return ec.IntervalDayTimeBuilder}});Object.defineProperty(v,"IntervalYearMonthBuilder",{enumerable:!0,get:function(){return ec.IntervalYearMonthBuilder}});var fB=ho();Object.defineProperty(v,"Utf8Builder",{enumerable:!0,get:function(){return fB.Utf8Builder}});var hB=lo();Object.defineProperty(v,"BinaryBuilder",{enumerable:!0,get:function(){return hB.BinaryBuilder}});var pB=ju();Object.defineProperty(v,"ListBuilder",{enumerable:!0,get:function(){return pB.ListBuilder}});var yB=qu();Object.defineProperty(v,"FixedSizeListBuilder",{enumerable:!0,get:function(){return yB.FixedSizeListBuilder}});var bB=Wu();Object.defineProperty(v,"MapBuilder",{enumerable:!0,get:function(){return bB.MapBuilder}});var mB=zu();Object.defineProperty(v,"StructBuilder",{enumerable:!0,get:function(){return mB.StructBuilder}});var tc=Yu();Object.defineProperty(v,"UnionBuilder",{enumerable:!0,get:function(){return tc.UnionBuilder}});Object.defineProperty(v,"SparseUnionBuilder",{enumerable:!0,get:function(){return tc.SparseUnionBuilder}});Object.defineProperty(v,"DenseUnionBuilder",{enumerable:!0,get:function(){return tc.DenseUnionBuilder}});var rc=de(),_B=ho(),gB=we(),Vh=$u(),Nh=Ph();gB.Builder.new=kh;function kh(r){let e=r.type,t=new(Nh.instance.getVisitFn(e)())(r);if(e.children&&e.children.length>0){let n=r.children||[],i={nullValues:r.nullValues},o=Array.isArray(n)?(a,u)=>n[u]||i:({name:a})=>n[a]||i;e.children.forEach((a,u)=>{let{type:f}=a,s=o(a,u);t.children.push(kh({...s,type:f}))})}return t}Object.keys(rc.Type).map(r=>rc.Type[r]).filter(r=>typeof r=="number"&&r!==rc.Type.NONE).forEach(r=>{let e=Nh.instance.visit(r);e.prototype._setValue=Vh.instance.getVisitFn(r)});_B.Utf8Builder.prototype._setValue=Vh.instance.visitBinary});var xh=w(sn=>{"use strict";Object.defineProperty(sn,"__esModule",{value:!0});sn.org=void 0;var nc=Sn(),Lh;(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}static getRootAsFooter(s,c){return(c||new u).__init(s.readInt32(s.position())+s.position(),s)}version(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt16(this.bb_pos+s):nc.org.apache.arrow.flatbuf.MetadataVersion.V1}schema(s){let c=this.bb.__offset(this.bb_pos,6);return c?(s||new nc.org.apache.arrow.flatbuf.Schema).__init(this.bb.__indirect(this.bb_pos+c),this.bb):null}dictionaries(s,c){let _=this.bb.__offset(this.bb_pos,8);return _?(c||new r.apache.arrow.flatbuf.Block).__init(this.bb.__vector(this.bb_pos+_)+s*24,this.bb):null}dictionariesLength(){let s=this.bb.__offset(this.bb_pos,8);return s?this.bb.__vector_len(this.bb_pos+s):0}recordBatches(s,c){let _=this.bb.__offset(this.bb_pos,10);return _?(c||new r.apache.arrow.flatbuf.Block).__init(this.bb.__vector(this.bb_pos+_)+s*24,this.bb):null}recordBatchesLength(){let s=this.bb.__offset(this.bb_pos,10);return s?this.bb.__vector_len(this.bb_pos+s):0}static startFooter(s){s.startObject(4)}static addVersion(s,c){s.addFieldInt16(0,c,nc.org.apache.arrow.flatbuf.MetadataVersion.V1)}static addSchema(s,c){s.addFieldOffset(1,c,0)}static addDictionaries(s,c){s.addFieldOffset(2,c,0)}static startDictionariesVector(s,c){s.startVector(24,c,8)}static addRecordBatches(s,c){s.addFieldOffset(3,c,0)}static startRecordBatchesVector(s,c){s.startVector(24,c,8)}static endFooter(s){return s.endObject()}static finishFooterBuffer(s,c){s.finish(c)}static createFooter(s,c,_,U,J){return u.startFooter(s),u.addVersion(s,c),u.addSchema(s,_),u.addDictionaries(s,U),u.addRecordBatches(s,J),u.endFooter(s)}}a.Footer=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(Lh=sn.org||(sn.org={}));(function(r){var e;(function(t){var n;(function(i){var o;(function(a){class u{constructor(){this.bb=null,this.bb_pos=0}__init(s,c){return this.bb_pos=s,this.bb=c,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static createBlock(s,c,_,U){return s.prep(8,24),s.writeInt64(U),s.pad(4),s.writeInt32(_),s.writeInt64(c),s.offset()}}a.Block=u})(o=i.flatbuf||(i.flatbuf={}))})(n=t.arrow||(t.arrow={}))})(e=r.apache||(r.apache={}))})(Lh=sn.org||(sn.org={}))});var oc=w(Wn=>{"use strict";Object.defineProperty(Wn,"__esModule",{value:!0});Wn.FileBlock=Wn.Footer=void 0;var Ch=xh(),ic=wn(),jh=ic.flatbuffers.Long,wB=ic.flatbuffers.Builder,TB=ic.flatbuffers.ByteBuffer,BB=Ch.org.apache.arrow.flatbuf.Block,zt=Ch.org.apache.arrow.flatbuf.Footer,qh=Le(),Wh=de(),vB=Ae(),sc=class{constructor(e,t=Wh.MetadataVersion.V4,n,i){this.schema=e,this.version=t,n&&(this._recordBatches=n),i&&(this._dictionaryBatches=i)}static decode(e){e=new TB(vB.toUint8Array(e));let t=zt.getRootAsFooter(e),n=qh.Schema.decode(t.schema());return new zh(n,t)}static encode(e){let t=new wB,n=qh.Schema.encode(t,e.schema);zt.startRecordBatchesVector(t,e.numRecordBatches),[...e.recordBatches()].slice().reverse().forEach(a=>Rr.encode(t,a));let i=t.endVector();zt.startDictionariesVector(t,e.numDictionaries),[...e.dictionaryBatches()].slice().reverse().forEach(a=>Rr.encode(t,a));let o=t.endVector();return zt.startFooter(t),zt.addSchema(t,n),zt.addVersion(t,Wh.MetadataVersion.V4),zt.addRecordBatches(t,i),zt.addDictionaries(t,o),zt.finishFooterBuffer(t,zt.endFooter(t)),t.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}*recordBatches(){for(let e,t=-1,n=this.numRecordBatches;++t<n;)(e=this.getRecordBatch(t))&&(yield e)}*dictionaryBatches(){for(let e,t=-1,n=this.numDictionaries;++t<n;)(e=this.getDictionaryBatch(t))&&(yield e)}getRecordBatch(e){return e>=0&&e<this.numRecordBatches&&this._recordBatches[e]||null}getDictionaryBatch(e){return e>=0&&e<this.numDictionaries&&this._dictionaryBatches[e]||null}};Wn.Footer=sc;var zh=class extends sc{constructor(e,t){super(e,t.version());this._footer=t}get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}getRecordBatch(e){if(e>=0&&e<this.numRecordBatches){let t=this._footer.recordBatches(e);if(t)return Rr.decode(t)}return null}getDictionaryBatch(e){if(e>=0&&e<this.numDictionaries){let t=this._footer.dictionaries(e);if(t)return Rr.decode(t)}return null}},Rr=class{constructor(e,t,n){this.metaDataLength=e,this.offset=typeof n=="number"?n:n.low,this.bodyLength=typeof t=="number"?t:t.low}static decode(e){return new Rr(e.metaDataLength(),e.bodyLength(),e.offset())}static encode(e,t){let{metaDataLength:n}=t,i=new jh(t.offset,0),o=new jh(t.bodyLength,0);return BB.createBlock(e,i,n,o)}};Wn.FileBlock=Rr});var Pr=w(Mr=>{"use strict";Object.defineProperty(Mr,"__esModule",{value:!0});Mr.AsyncByteStream=Mr.ByteStream=Mr.AsyncByteQueue=void 0;var Er=Oi(),Yh=Zr(),Yi=vn(),ac=Ae(),zn=He(),uc=class extends Yi.AsyncQueue{write(e){if((e=ac.toUint8Array(e)).byteLength>0)return super.write(e)}toString(e=!1){return e?Yh.decodeUtf8(this.toUint8Array(!0)):this.toUint8Array(!1).then(Yh.decodeUtf8)}toUint8Array(e=!1){return e?ac.joinUint8Arrays(this._values)[0]:(async()=>{let t=[],n=0;for await(let i of this)t.push(i),n+=i.byteLength;return ac.joinUint8Arrays(t,n)[0]})()}};Mr.AsyncByteQueue=uc;var Hh=class{constructor(e){e&&(this.source=new Gh(Er.default.fromIterable(e)))}[Symbol.iterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}};Mr.ByteStream=Hh;var Do=class{constructor(e){e instanceof Do?this.source=e.source:e instanceof uc?this.source=new Ur(Er.default.fromAsyncIterable(e)):zn.isReadableNodeStream(e)?this.source=new Ur(Er.default.fromNodeStream(e)):zn.isReadableDOMStream(e)?this.source=new Ur(Er.default.fromDOMStream(e)):zn.isFetchResponse(e)?this.source=new Ur(Er.default.fromDOMStream(e.body)):zn.isIterable(e)?this.source=new Ur(Er.default.fromIterable(e)):zn.isPromise(e)?this.source=new Ur(Er.default.fromAsyncIterable(e)):zn.isAsyncIterable(e)&&(this.source=new Ur(Er.default.fromAsyncIterable(e)))}[Symbol.asyncIterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}get closed(){return this.source.closed}cancel(e){return this.source.cancel(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}};Mr.AsyncByteStream=Do;var Gh=class{constructor(e){this.source=e}cancel(e){this.return(e)}peek(e){return this.next(e,"peek").value}read(e){return this.next(e,"read").value}next(e,t="read"){return this.source.next({cmd:t,size:e})}throw(e){return Object.create(this.source.throw&&this.source.throw(e)||Yi.ITERATOR_DONE)}return(e){return Object.create(this.source.return&&this.source.return(e)||Yi.ITERATOR_DONE)}},Ur=class{constructor(e){this.source=e,this._closedPromise=new Promise(t=>this._closedPromiseResolve=t)}async cancel(e){await this.return(e)}get closed(){return this._closedPromise}async read(e){return(await this.next(e,"read")).value}async peek(e){return(await this.next(e,"peek")).value}async next(e,t="read"){return await this.source.next({cmd:t,size:e})}async throw(e){let t=this.source.throw&&await this.source.throw(e)||Yi.ITERATOR_DONE;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(t)}async return(e){let t=this.source.return&&await this.source.return(e)||Yi.ITERATOR_DONE;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(t)}}});var cc=w(Yn=>{"use strict";Object.defineProperty(Yn,"__esModule",{value:!0});Yn.AsyncRandomAccessFile=Yn.RandomAccessFile=void 0;var $h=Pr(),IB=Ae(),Jh=class extends $h.ByteStream{constructor(e,t){super();this.position=0,this.buffer=IB.toUint8Array(e),this.size=typeof t=="undefined"?this.buffer.byteLength:t}readInt32(e){let{buffer:t,byteOffset:n}=this.readAt(e,4);return new DataView(t,n).getInt32(0,!0)}seek(e){return this.position=Math.min(e,this.size),e<this.size}read(e){let{buffer:t,size:n,position:i}=this;return t&&i<n?(typeof e!="number"&&(e=1/0),this.position=Math.min(n,i+Math.min(n-i,e)),t.subarray(i,this.position)):null}readAt(e,t){let n=this.buffer,i=Math.min(this.size,e+t);return n?n.subarray(e,i):new Uint8Array(t)}close(){this.buffer&&(this.buffer=null)}throw(e){return this.close(),{done:!0,value:e}}return(e){return this.close(),{done:!0,value:e}}};Yn.RandomAccessFile=Jh;var Kh=class extends $h.AsyncByteStream{constructor(e,t){super();this.position=0,this._handle=e,typeof t=="number"?this.size=t:this._pending=(async()=>{this.size=(await e.stat()).size,delete this._pending})()}async readInt32(e){let{buffer:t,byteOffset:n}=await this.readAt(e,4);return new DataView(t,n).getInt32(0,!0)}async seek(e){return this._pending&&await this._pending,this.position=Math.min(e,this.size),e<this.size}async read(e){this._pending&&await this._pending;let{_handle:t,size:n,position:i}=this;if(t&&i<n){typeof e!="number"&&(e=1/0);let o=i,a=0,u=0,f=Math.min(n,o+Math.min(n-o,e)),s=new Uint8Array(Math.max(0,(this.position=f)-o));for(;(o+=u)<f&&(a+=u)<s.byteLength;)({bytesRead:u}=await t.read(s,a,s.byteLength-a,o));return s}return null}async readAt(e,t){this._pending&&await this._pending;let{_handle:n,size:i}=this;if(n&&e+t<i){let o=Math.min(i,e+t),a=new Uint8Array(o-e);return(await n.read(a,0,t,e)).buffer}return new Uint8Array(t)}async close(){let e=this._handle;this._handle=null,e&&await e.close()}async throw(e){return await this.close(),{done:!0,value:e}}async return(e){return await this.close(),{done:!0,value:e}}};Yn.AsyncRandomAccessFile=Kh});var dc=w(Yt=>{"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});Yt.Int128=Yt.Int64=Yt.Uint64=Yt.BaseInt64=void 0;var SB=1<<16;function Hn(r){return r<0&&(r=4294967295+r+1),`0x${r.toString(16)}`}var Gn=8,lc=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8],Fo=class{constructor(e){this.buffer=e}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(e){let t=new Uint32Array([this.buffer[1]>>>16,this.buffer[1]&65535,this.buffer[0]>>>16,this.buffer[0]&65535]),n=new Uint32Array([e.buffer[1]>>>16,e.buffer[1]&65535,e.buffer[0]>>>16,e.buffer[0]&65535]),i=t[3]*n[3];this.buffer[0]=i&65535;let o=i>>>16;return i=t[2]*n[3],o+=i,i=t[3]*n[2]>>>0,o+=i,this.buffer[0]+=o<<16,this.buffer[1]=o>>>0<i?SB:0,this.buffer[1]+=o>>>16,this.buffer[1]+=t[1]*n[3]+t[2]*n[2]+t[3]*n[1],this.buffer[1]+=t[0]*n[3]+t[1]*n[2]+t[2]*n[1]+t[3]*n[0]<<16,this}_plus(e){let t=this.buffer[0]+e.buffer[0]>>>0;this.buffer[1]+=e.buffer[1],t<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=t}lessThan(e){return this.buffer[1]<e.buffer[1]||this.buffer[1]===e.buffer[1]&&this.buffer[0]<e.buffer[0]}equals(e){return this.buffer[1]===e.buffer[1]&&this.buffer[0]==e.buffer[0]}greaterThan(e){return e.lessThan(this)}hex(){return`${Hn(this.buffer[1])} ${Hn(this.buffer[0])}`}};Yt.BaseInt64=Fo;var ae=class extends Fo{times(e){return this._times(e),this}plus(e){return this._plus(e),this}static from(e,t=new Uint32Array(2)){return ae.fromString(typeof e=="string"?e:e.toString(),t)}static fromNumber(e,t=new Uint32Array(2)){return ae.fromString(e.toString(),t)}static fromString(e,t=new Uint32Array(2)){let n=e.length,i=new ae(t);for(let o=0;o<n;){let a=Gn<n-o?Gn:n-o,u=new ae(new Uint32Array([parseInt(e.substr(o,a),10),0])),f=new ae(new Uint32Array([lc[a],0]));i.times(f),i.plus(u),o+=a}return i}static convertArray(e){let t=new Uint32Array(e.length*2);for(let n=-1,i=e.length;++n<i;)ae.from(e[n],new Uint32Array(t.buffer,t.byteOffset+2*n*4,2));return t}static multiply(e,t){return new ae(new Uint32Array(e.buffer)).times(t)}static add(e,t){return new ae(new Uint32Array(e.buffer)).plus(t)}};Yt.Uint64=ae;var at=class extends Fo{negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[0]==0&&++this.buffer[1],this}times(e){return this._times(e),this}plus(e){return this._plus(e),this}lessThan(e){let t=this.buffer[1]<<0,n=e.buffer[1]<<0;return t<n||t===n&&this.buffer[0]<e.buffer[0]}static from(e,t=new Uint32Array(2)){return at.fromString(typeof e=="string"?e:e.toString(),t)}static fromNumber(e,t=new Uint32Array(2)){return at.fromString(e.toString(),t)}static fromString(e,t=new Uint32Array(2)){let n=e.startsWith("-"),i=e.length,o=new at(t);for(let a=n?1:0;a<i;){let u=Gn<i-a?Gn:i-a,f=new at(new Uint32Array([parseInt(e.substr(a,u),10),0])),s=new at(new Uint32Array([lc[u],0]));o.times(s),o.plus(f),a+=u}return n?o.negate():o}static convertArray(e){let t=new Uint32Array(e.length*2);for(let n=-1,i=e.length;++n<i;)at.from(e[n],new Uint32Array(t.buffer,t.byteOffset+2*n*4,2));return t}static multiply(e,t){return new at(new Uint32Array(e.buffer)).times(t)}static add(e,t){return new at(new Uint32Array(e.buffer)).plus(t)}};Yt.Int64=at;var At=class{constructor(e){this.buffer=e}high(){return new at(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new at(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],this.buffer[0]==0&&++this.buffer[1],this.buffer[1]==0&&++this.buffer[2],this.buffer[2]==0&&++this.buffer[3],this}times(e){let t=new ae(new Uint32Array([this.buffer[3],0])),n=new ae(new Uint32Array([this.buffer[2],0])),i=new ae(new Uint32Array([this.buffer[1],0])),o=new ae(new Uint32Array([this.buffer[0],0])),a=new ae(new Uint32Array([e.buffer[3],0])),u=new ae(new Uint32Array([e.buffer[2],0])),f=new ae(new Uint32Array([e.buffer[1],0])),s=new ae(new Uint32Array([e.buffer[0],0])),c=ae.multiply(o,s);this.buffer[0]=c.low();let _=new ae(new Uint32Array([c.high(),0]));return c=ae.multiply(i,s),_.plus(c),c=ae.multiply(o,f),_.plus(c),this.buffer[1]=_.low(),this.buffer[3]=_.lessThan(c)?1:0,this.buffer[2]=_.high(),new ae(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(ae.multiply(n,s)).plus(ae.multiply(i,f)).plus(ae.multiply(o,u)),this.buffer[3]+=ae.multiply(t,s).plus(ae.multiply(n,f)).plus(ae.multiply(i,u)).plus(ae.multiply(o,a)).low(),this}plus(e){let t=new Uint32Array(4);return t[3]=this.buffer[3]+e.buffer[3]>>>0,t[2]=this.buffer[2]+e.buffer[2]>>>0,t[1]=this.buffer[1]+e.buffer[1]>>>0,t[0]=this.buffer[0]+e.buffer[0]>>>0,t[0]<this.buffer[0]>>>0&&++t[1],t[1]<this.buffer[1]>>>0&&++t[2],t[2]<this.buffer[2]>>>0&&++t[3],this.buffer[3]=t[3],this.buffer[2]=t[2],this.buffer[1]=t[1],this.buffer[0]=t[0],this}hex(){return`${Hn(this.buffer[3])} ${Hn(this.buffer[2])} ${Hn(this.buffer[1])} ${Hn(this.buffer[0])}`}static multiply(e,t){return new At(new Uint32Array(e.buffer)).times(t)}static add(e,t){return new At(new Uint32Array(e.buffer)).plus(t)}static from(e,t=new Uint32Array(4)){return At.fromString(typeof e=="string"?e:e.toString(),t)}static fromNumber(e,t=new Uint32Array(4)){return At.fromString(e.toString(),t)}static fromString(e,t=new Uint32Array(4)){let n=e.startsWith("-"),i=e.length,o=new At(t);for(let a=n?1:0;a<i;){let u=Gn<i-a?Gn:i-a,f=new At(new Uint32Array([parseInt(e.substr(a,u),10),0,0,0])),s=new At(new Uint32Array([lc[u],0,0,0]));o.times(s),o.plus(f),a+=u}return n?o.negate():o}static convertArray(e){let t=new Uint32Array(e.length*4);for(let n=-1,i=e.length;++n<i;)At.from(e[n],new Uint32Array(t.buffer,t.byteOffset+4*4*n,4));return t}};Yt.Int128=At});var ep=w($n=>{"use strict";Object.defineProperty($n,"__esModule",{value:!0});$n.JSONVectorLoader=$n.VectorLoader=void 0;var Ve=St(),OB=Le(),lr=oe(),AB=We(),Qh=Lt(),DB=Zr(),Ro=dc(),Zh=de(),Ht=Ae(),fc=class extends AB.Visitor{constructor(e,t,n,i){super();this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=e,this.nodes=t,this.buffers=n,this.dictionaries=i}visit(e){return super.visit(e instanceof OB.Field?e.type:e)}visitNull(e,{length:t}=this.nextFieldNode()){return Ve.Data.Null(e,0,t)}visitBool(e,{length:t,nullCount:n}=this.nextFieldNode()){return Ve.Data.Bool(e,0,t,n,this.readNullBitmap(e,n),this.readData(e))}visitInt(e,{length:t,nullCount:n}=this.nextFieldNode()){return Ve.Data.Int(e,0,t,n,this.readNullBitmap(e,n),this.readData(e))}visitFloat(e,{length:t,nullCount:n}=this.nextFieldNode()){return Ve.Data.Float(e,0,t,n,this.readNullBitmap(e,n),this.readData(e))}visitUtf8(e,{length:t,nullCount:n}=this.nextFieldNode()){return Ve.Data.Utf8(e,0,t,n,this.readNullBitmap(e,n),this.readOffsets(e),this.readData(e))}visitBinary(e,{length:t,nullCount:n}=this.nextFieldNode()){return Ve.Data.Binary(e,0,t,n,this.readNullBitmap(e,n),this.readOffsets(e),this.readData(e))}visitFixedSizeBinary(e,{length:t,nullCount:n}=this.nextFieldNode()){return Ve.Data.FixedSizeBinary(e,0,t,n,this.readNullBitmap(e,n),this.readData(e))}visitDate(e,{length:t,nullCount:n}=this.nextFieldNode()){return Ve.Data.Date(e,0,t,n,this.readNullBitmap(e,n),this.readData(e))}visitTimestamp(e,{length:t,nullCount:n}=this.nextFieldNode()){return Ve.Data.Timestamp(e,0,t,n,this.readNullBitmap(e,n),this.readData(e))}visitTime(e,{length:t,nullCount:n}=this.nextFieldNode()){return Ve.Data.Time(e,0,t,n,this.readNullBitmap(e,n),this.readData(e))}visitDecimal(e,{length:t,nullCount:n}=this.nextFieldNode()){return Ve.Data.Decimal(e,0,t,n,this.readNullBitmap(e,n),this.readData(e))}visitList(e,{length:t,nullCount:n}=this.nextFieldNode()){return Ve.Data.List(e,0,t,n,this.readNullBitmap(e,n),this.readOffsets(e),this.visit(e.children[0]))}visitStruct(e,{length:t,nullCount:n}=this.nextFieldNode()){return Ve.Data.Struct(e,0,t,n,this.readNullBitmap(e,n),this.visitMany(e.children))}visitUnion(e){return e.mode===Zh.UnionMode.Sparse?this.visitSparseUnion(e):this.visitDenseUnion(e)}visitDenseUnion(e,{length:t,nullCount:n}=this.nextFieldNode()){return Ve.Data.Union(e,0,t,n,this.readNullBitmap(e,n),this.readTypeIds(e),this.readOffsets(e),this.visitMany(e.children))}visitSparseUnion(e,{length:t,nullCount:n}=this.nextFieldNode()){return Ve.Data.Union(e,0,t,n,this.readNullBitmap(e,n),this.readTypeIds(e),this.visitMany(e.children))}visitDictionary(e,{length:t,nullCount:n}=this.nextFieldNode()){return Ve.Data.Dictionary(e,0,t,n,this.readNullBitmap(e,n),this.readData(e.indices),this.readDictionary(e))}visitInterval(e,{length:t,nullCount:n}=this.nextFieldNode()){return Ve.Data.Interval(e,0,t,n,this.readNullBitmap(e,n),this.readData(e))}visitFixedSizeList(e,{length:t,nullCount:n}=this.nextFieldNode()){return Ve.Data.FixedSizeList(e,0,t,n,this.readNullBitmap(e,n),this.visit(e.children[0]))}visitMap(e,{length:t,nullCount:n}=this.nextFieldNode()){return Ve.Data.Map(e,0,t,n,this.readNullBitmap(e,n),this.readOffsets(e),this.visit(e.children[0]))}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(e,t,n=this.nextBufferRange()){return t>0&&this.readData(e,n)||new Uint8Array(0)}readOffsets(e,t){return this.readData(e,t)}readTypeIds(e,t){return this.readData(e,t)}readData(e,{length:t,offset:n}=this.nextBufferRange()){return this.bytes.subarray(n,n+t)}readDictionary(e){return this.dictionaries.get(e.id)}};$n.VectorLoader=fc;var Xh=class extends fc{constructor(e,t,n,i){super(new Uint8Array(0),t,n,i);this.sources=e}readNullBitmap(e,t,{offset:n}=this.nextBufferRange()){return t<=0?new Uint8Array(0):Qh.packBools(this.sources[n])}readOffsets(e,{offset:t}=this.nextBufferRange()){return Ht.toArrayBufferView(Uint8Array,Ht.toArrayBufferView(Int32Array,this.sources[t]))}readTypeIds(e,{offset:t}=this.nextBufferRange()){return Ht.toArrayBufferView(Uint8Array,Ht.toArrayBufferView(e.ArrayType,this.sources[t]))}readData(e,{offset:t}=this.nextBufferRange()){let{sources:n}=this;return lr.DataType.isTimestamp(e)||(lr.DataType.isInt(e)||lr.DataType.isTime(e))&&e.bitWidth===64||lr.DataType.isDate(e)&&e.unit===Zh.DateUnit.MILLISECOND?Ht.toArrayBufferView(Uint8Array,Ro.Int64.convertArray(n[t])):lr.DataType.isDecimal(e)?Ht.toArrayBufferView(Uint8Array,Ro.Int128.convertArray(n[t])):lr.DataType.isBinary(e)||lr.DataType.isFixedSizeBinary(e)?FB(n[t]):lr.DataType.isBool(e)?Qh.packBools(n[t]):lr.DataType.isUtf8(e)?DB.encodeUtf8(n[t].join("")):Ht.toArrayBufferView(Uint8Array,Ht.toArrayBufferView(e.ArrayType,n[t].map(i=>+i)))}};$n.JSONVectorLoader=Xh;function FB(r){let e=r.join(""),t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2)t[n>>1]=parseInt(e.substr(n,2),16);return t}});var ap=w(Kn=>{"use strict";Object.defineProperty(Kn,"__esModule",{value:!0});Kn.instance=Kn.TypeAssembler=void 0;var RB=wn(),EB=RB.flatbuffers.Long,xe=Sn(),UB=We(),tp=xe.org.apache.arrow.flatbuf.Null,Eo=xe.org.apache.arrow.flatbuf.Int,hc=xe.org.apache.arrow.flatbuf.FloatingPoint,rp=xe.org.apache.arrow.flatbuf.Binary,np=xe.org.apache.arrow.flatbuf.Bool,ip=xe.org.apache.arrow.flatbuf.Utf8,Uo=xe.org.apache.arrow.flatbuf.Decimal,pc=xe.org.apache.arrow.flatbuf.Date,Mo=xe.org.apache.arrow.flatbuf.Time,Po=xe.org.apache.arrow.flatbuf.Timestamp,yc=xe.org.apache.arrow.flatbuf.Interval,sp=xe.org.apache.arrow.flatbuf.List,op=xe.org.apache.arrow.flatbuf.Struct_,Jn=xe.org.apache.arrow.flatbuf.Union,Hi=xe.org.apache.arrow.flatbuf.DictionaryEncoding,bc=xe.org.apache.arrow.flatbuf.FixedSizeBinary,mc=xe.org.apache.arrow.flatbuf.FixedSizeList,_c=xe.org.apache.arrow.flatbuf.Map,gc=class extends UB.Visitor{visit(e,t){return e==null||t==null?void 0:super.visit(e,t)}visitNull(e,t){return tp.startNull(t),tp.endNull(t)}visitInt(e,t){return Eo.startInt(t),Eo.addBitWidth(t,e.bitWidth),Eo.addIsSigned(t,e.isSigned),Eo.endInt(t)}visitFloat(e,t){return hc.startFloatingPoint(t),hc.addPrecision(t,e.precision),hc.endFloatingPoint(t)}visitBinary(e,t){return rp.startBinary(t),rp.endBinary(t)}visitBool(e,t){return np.startBool(t),np.endBool(t)}visitUtf8(e,t){return ip.startUtf8(t),ip.endUtf8(t)}visitDecimal(e,t){return Uo.startDecimal(t),Uo.addScale(t,e.scale),Uo.addPrecision(t,e.precision),Uo.endDecimal(t)}visitDate(e,t){return pc.startDate(t),pc.addUnit(t,e.unit),pc.endDate(t)}visitTime(e,t){return Mo.startTime(t),Mo.addUnit(t,e.unit),Mo.addBitWidth(t,e.bitWidth),Mo.endTime(t)}visitTimestamp(e,t){let n=e.timezone&&t.createString(e.timezone)||void 0;return Po.startTimestamp(t),Po.addUnit(t,e.unit),n!==void 0&&Po.addTimezone(t,n),Po.endTimestamp(t)}visitInterval(e,t){return yc.startInterval(t),yc.addUnit(t,e.unit),yc.endInterval(t)}visitList(e,t){return sp.startList(t),sp.endList(t)}visitStruct(e,t){return op.startStruct_(t),op.endStruct_(t)}visitUnion(e,t){Jn.startTypeIdsVector(t,e.typeIds.length);let n=Jn.createTypeIdsVector(t,e.typeIds);return Jn.startUnion(t),Jn.addMode(t,e.mode),Jn.addTypeIds(t,n),Jn.endUnion(t)}visitDictionary(e,t){let n=this.visit(e.indices,t);return Hi.startDictionaryEncoding(t),Hi.addId(t,new EB(e.id,0)),Hi.addIsOrdered(t,e.isOrdered),n!==void 0&&Hi.addIndexType(t,n),Hi.endDictionaryEncoding(t)}visitFixedSizeBinary(e,t){return bc.startFixedSizeBinary(t),bc.addByteWidth(t,e.byteWidth),bc.endFixedSizeBinary(t)}visitFixedSizeList(e,t){return mc.startFixedSizeList(t),mc.addListSize(t,e.listSize),mc.endFixedSizeList(t)}visitMap(e,t){return _c.startMap(t),_c.addKeysSorted(t,e.keysSorted),_c.endMap(t)}};Kn.TypeAssembler=gc;Kn.instance=new gc});var pp=w(Gt=>{"use strict";Object.defineProperty(Gt,"__esModule",{value:!0});Gt.fieldFromJSON=Gt.dictionaryBatchFromJSON=Gt.recordBatchFromJSON=Gt.schemaFromJSON=void 0;var Qn=Le(),ye=oe(),on=an(),Zn=de();function MB(r,e=new Map){return new Qn.Schema(VB(r,e),Vo(r.customMetadata),e)}Gt.schemaFromJSON=MB;function up(r){return new on.RecordBatch(r.count,lp(r.columns),dp(r.columns))}Gt.recordBatchFromJSON=up;function PB(r){return new on.DictionaryBatch(up(r.data),r.id,r.isDelta)}Gt.dictionaryBatchFromJSON=PB;function VB(r,e){return(r.fields||[]).filter(Boolean).map(t=>Qn.Field.fromJSON(t,e))}function cp(r,e){return(r.children||[]).filter(Boolean).map(t=>Qn.Field.fromJSON(t,e))}function lp(r){return(r||[]).reduce((e,t)=>[...e,new on.FieldNode(t.count,NB(t.VALIDITY)),...lp(t.children)],[])}function dp(r,e=[]){for(let t=-1,n=(r||[]).length;++t<n;){let i=r[t];i.VALIDITY&&e.push(new on.BufferRegion(e.length,i.VALIDITY.length)),i.TYPE&&e.push(new on.BufferRegion(e.length,i.TYPE.length)),i.OFFSET&&e.push(new on.BufferRegion(e.length,i.OFFSET.length)),i.DATA&&e.push(new on.BufferRegion(e.length,i.DATA.length)),e=dp(i.children,e)}return e}function NB(r){return(r||[]).reduce((e,t)=>e+ +(t===0),0)}function kB(r,e){let t,n,i,o,a,u;return!e||!(o=r.dictionary)?(a=hp(r,cp(r,e)),i=new Qn.Field(r.name,a,r.nullable,Vo(r.customMetadata))):e.has(t=o.id)?(n=(n=o.indexType)?fp(n):new ye.Int32,u=new ye.Dictionary(e.get(t),n,t,o.isOrdered),i=new Qn.Field(r.name,u,r.nullable,Vo(r.customMetadata))):(n=(n=o.indexType)?fp(n):new ye.Int32,e.set(t,a=hp(r,cp(r,e))),u=new ye.Dictionary(a,n,t,o.isOrdered),i=new Qn.Field(r.name,u,r.nullable,Vo(r.customMetadata))),i||null}Gt.fieldFromJSON=kB;function Vo(r){return new Map(Object.entries(r||{}))}function fp(r){return new ye.Int(r.isSigned,r.bitWidth)}function hp(r,e){let t=r.type.name;switch(t){case"NONE":return new ye.Null;case"null":return new ye.Null;case"binary":return new ye.Binary;case"utf8":return new ye.Utf8;case"bool":return new ye.Bool;case"list":return new ye.List((e||[])[0]);case"struct":return new ye.Struct(e||[]);case"struct_":return new ye.Struct(e||[])}switch(t){case"int":{let n=r.type;return new ye.Int(n.isSigned,n.bitWidth)}case"floatingpoint":{let n=r.type;return new ye.Float(Zn.Precision[n.precision])}case"decimal":{let n=r.type;return new ye.Decimal(n.scale,n.precision)}case"date":{let n=r.type;return new ye.Date_(Zn.DateUnit[n.unit])}case"time":{let n=r.type;return new ye.Time(Zn.TimeUnit[n.unit],n.bitWidth)}case"timestamp":{let n=r.type;return new ye.Timestamp(Zn.TimeUnit[n.unit],n.timezone)}case"interval":{let n=r.type;return new ye.Interval(Zn.IntervalUnit[n.unit])}case"union":{let n=r.type;return new ye.Union(Zn.UnionMode[n.mode],n.typeIds||[],e||[])}case"fixedsizebinary":{let n=r.type;return new ye.FixedSizeBinary(n.byteWidth)}case"fixedsizelist":{let n=r.type;return new ye.FixedSizeList(n.listSize,(e||[])[0])}case"map":{let n=r.type;return new ye.Map_((e||[])[0],n.keysSorted)}}throw new Error(`Unrecognized type: "${t}"`)}});var an=w(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});bt.FieldNode=bt.BufferRegion=bt.DictionaryBatch=bt.RecordBatch=bt.Message=void 0;var wc=wn(),Ye=Sn(),No=Ka(),Ce=Le(),LB=Ae(),Te=de(),Tc=ap(),ko=pp(),un=wc.flatbuffers.Long,xB=wc.flatbuffers.Builder,CB=wc.flatbuffers.ByteBuffer,Ne=Ye.org.apache.arrow.flatbuf.Type,Dt=Ye.org.apache.arrow.flatbuf.Field,dr=Ye.org.apache.arrow.flatbuf.Schema,jB=Ye.org.apache.arrow.flatbuf.Buffer,Vr=No.org.apache.arrow.flatbuf.Message,Nr=Ye.org.apache.arrow.flatbuf.KeyValue,qB=No.org.apache.arrow.flatbuf.FieldNode,yp=Ye.org.apache.arrow.flatbuf.Endianness,kr=No.org.apache.arrow.flatbuf.RecordBatch,Xn=No.org.apache.arrow.flatbuf.DictionaryBatch,be=oe(),Lr=class{constructor(e,t,n,i){this._version=t,this._headerType=n,this.body=new Uint8Array(0),i&&(this._createHeader=()=>i),this._bodyLength=typeof e=="number"?e:e.low}static fromJSON(e,t){let n=new Lr(0,Te.MetadataVersion.V4,t);return n._createHeader=WB(e,t),n}static decode(e){e=new CB(LB.toUint8Array(e));let t=Vr.getRootAsMessage(e),n=t.bodyLength(),i=t.version(),o=t.headerType(),a=new Lr(n,i,o);return a._createHeader=zB(t,o),a}static encode(e){let t=new xB,n=-1;return e.isSchema()?n=Ce.Schema.encode(t,e.header()):e.isRecordBatch()?n=yt.encode(t,e.header()):e.isDictionaryBatch()&&(n=$t.encode(t,e.header())),Vr.startMessage(t),Vr.addVersion(t,Te.MetadataVersion.V4),Vr.addHeader(t,n),Vr.addHeaderType(t,e.headerType),Vr.addBodyLength(t,new un(e.bodyLength,0)),Vr.finishMessageBuffer(t,Vr.endMessage(t)),t.asUint8Array()}static from(e,t=0){if(e instanceof Ce.Schema)return new Lr(0,Te.MetadataVersion.V4,Te.MessageHeader.Schema,e);if(e instanceof yt)return new Lr(t,Te.MetadataVersion.V4,Te.MessageHeader.RecordBatch,e);if(e instanceof $t)return new Lr(t,Te.MetadataVersion.V4,Te.MessageHeader.DictionaryBatch,e);throw new Error(`Unrecognized Message header: ${e}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===Te.MessageHeader.Schema}isRecordBatch(){return this.headerType===Te.MessageHeader.RecordBatch}isDictionaryBatch(){return this.headerType===Te.MessageHeader.DictionaryBatch}};bt.Message=Lr;var yt=class{constructor(e,t,n){this._nodes=t,this._buffers=n,this._length=typeof e=="number"?e:e.low}get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}};bt.RecordBatch=yt;var $t=class{constructor(e,t,n=!1){this._data=e,this._isDelta=n,this._id=typeof t=="number"?t:t.low}get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}};bt.DictionaryBatch=$t;var cn=class{constructor(e,t){this.offset=typeof e=="number"?e:e.low,this.length=typeof t=="number"?t:t.low}};bt.BufferRegion=cn;var ln=class{constructor(e,t){this.length=typeof e=="number"?e:e.low,this.nullCount=typeof t=="number"?t:t.low}};bt.FieldNode=ln;function WB(r,e){return()=>{switch(e){case Te.MessageHeader.Schema:return Ce.Schema.fromJSON(r);case Te.MessageHeader.RecordBatch:return yt.fromJSON(r);case Te.MessageHeader.DictionaryBatch:return $t.fromJSON(r)}throw new Error(`Unrecognized Message type: { name: ${Te.MessageHeader[e]}, type: ${e} }`)}}function zB(r,e){return()=>{switch(e){case Te.MessageHeader.Schema:return Ce.Schema.decode(r.header(new dr));case Te.MessageHeader.RecordBatch:return yt.decode(r.header(new kr),r.version());case Te.MessageHeader.DictionaryBatch:return $t.decode(r.header(new Xn),r.version())}throw new Error(`Unrecognized Message type: { name: ${Te.MessageHeader[e]}, type: ${e} }`)}}Ce.Field.encode=tv;Ce.Field.decode=XB;Ce.Field.fromJSON=ko.fieldFromJSON;Ce.Schema.encode=ev;Ce.Schema.decode=YB;Ce.Schema.fromJSON=ko.schemaFromJSON;yt.encode=rv;yt.decode=HB;yt.fromJSON=ko.recordBatchFromJSON;$t.encode=nv;$t.decode=GB;$t.fromJSON=ko.dictionaryBatchFromJSON;ln.encode=iv;ln.decode=JB;cn.encode=sv;cn.decode=$B;function YB(r,e=new Map){let t=ZB(r,e);return new Ce.Schema(t,Lo(r),e)}function HB(r,e=Te.MetadataVersion.V4){return new yt(r.length(),KB(r),QB(r,e))}function GB(r,e=Te.MetadataVersion.V4){return new $t(yt.decode(r.data(),e),r.id(),r.isDelta())}function $B(r){return new cn(r.offset(),r.length())}function JB(r){return new ln(r.length(),r.nullCount())}function KB(r){let e=[];for(let t,n=-1,i=-1,o=r.nodesLength();++n<o;)(t=r.nodes(n))&&(e[++i]=ln.decode(t));return e}function QB(r,e){let t=[];for(let n,i=-1,o=-1,a=r.buffersLength();++i<a;)(n=r.buffers(i))&&(e<Te.MetadataVersion.V4&&(n.bb_pos+=8*(i+1)),t[++o]=cn.decode(n));return t}function ZB(r,e){let t=[];for(let n,i=-1,o=-1,a=r.fieldsLength();++i<a;)(n=r.fields(i))&&(t[++o]=Ce.Field.decode(n,e));return t}function bp(r,e){let t=[];for(let n,i=-1,o=-1,a=r.childrenLength();++i<a;)(n=r.children(i))&&(t[++o]=Ce.Field.decode(n,e));return t}function XB(r,e){let t,n,i,o,a,u;return!e||!(u=r.dictionary())?(i=_p(r,bp(r,e)),n=new Ce.Field(r.name(),i,r.nullable(),Lo(r))):e.has(t=u.id().low)?(o=(o=u.indexType())?mp(o):new be.Int32,a=new be.Dictionary(e.get(t),o,t,u.isOrdered()),n=new Ce.Field(r.name(),a,r.nullable(),Lo(r))):(o=(o=u.indexType())?mp(o):new be.Int32,e.set(t,i=_p(r,bp(r,e))),a=new be.Dictionary(i,o,t,u.isOrdered()),n=new Ce.Field(r.name(),a,r.nullable(),Lo(r))),n||null}function Lo(r){let e=new Map;if(r)for(let t,n,i=-1,o=r.customMetadataLength()|0;++i<o;)(t=r.customMetadata(i))&&(n=t.key())!=null&&e.set(n,t.value());return e}function mp(r){return new be.Int(r.isSigned(),r.bitWidth())}function _p(r,e){let t=r.typeType();switch(t){case Ne.NONE:return new be.Null;case Ne.Null:return new be.Null;case Ne.Binary:return new be.Binary;case Ne.Utf8:return new be.Utf8;case Ne.Bool:return new be.Bool;case Ne.List:return new be.List((e||[])[0]);case Ne.Struct_:return new be.Struct(e||[])}switch(t){case Ne.Int:{let n=r.type(new Ye.org.apache.arrow.flatbuf.Int);return new be.Int(n.isSigned(),n.bitWidth())}case Ne.FloatingPoint:{let n=r.type(new Ye.org.apache.arrow.flatbuf.FloatingPoint);return new be.Float(n.precision())}case Ne.Decimal:{let n=r.type(new Ye.org.apache.arrow.flatbuf.Decimal);return new be.Decimal(n.scale(),n.precision())}case Ne.Date:{let n=r.type(new Ye.org.apache.arrow.flatbuf.Date);return new be.Date_(n.unit())}case Ne.Time:{let n=r.type(new Ye.org.apache.arrow.flatbuf.Time);return new be.Time(n.unit(),n.bitWidth())}case Ne.Timestamp:{let n=r.type(new Ye.org.apache.arrow.flatbuf.Timestamp);return new be.Timestamp(n.unit(),n.timezone())}case Ne.Interval:{let n=r.type(new Ye.org.apache.arrow.flatbuf.Interval);return new be.Interval(n.unit())}case Ne.Union:{let n=r.type(new Ye.org.apache.arrow.flatbuf.Union);return new be.Union(n.mode(),n.typeIdsArray()||[],e||[])}case Ne.FixedSizeBinary:{let n=r.type(new Ye.org.apache.arrow.flatbuf.FixedSizeBinary);return new be.FixedSizeBinary(n.byteWidth())}case Ne.FixedSizeList:{let n=r.type(new Ye.org.apache.arrow.flatbuf.FixedSizeList);return new be.FixedSizeList(n.listSize(),(e||[])[0])}case Ne.Map:{let n=r.type(new Ye.org.apache.arrow.flatbuf.Map);return new be.Map_((e||[])[0],n.keysSorted())}}throw new Error(`Unrecognized type: "${Ne[t]}" (${t})`)}function ev(r,e){let t=e.fields.map(o=>Ce.Field.encode(r,o));dr.startFieldsVector(r,t.length);let n=dr.createFieldsVector(r,t),i=e.metadata&&e.metadata.size>0?dr.createCustomMetadataVector(r,[...e.metadata].map(([o,a])=>{let u=r.createString(`${o}`),f=r.createString(`${a}`);return Nr.startKeyValue(r),Nr.addKey(r,u),Nr.addValue(r,f),Nr.endKeyValue(r)})):-1;return dr.startSchema(r),dr.addFields(r,n),dr.addEndianness(r,ov?yp.Little:yp.Big),i!==-1&&dr.addCustomMetadata(r,i),dr.endSchema(r)}function tv(r,e){let t=-1,n=-1,i=-1,o=e.type,a=e.typeId;be.DataType.isDictionary(o)?(a=o.dictionary.typeId,i=Tc.instance.visit(o,r),n=Tc.instance.visit(o.dictionary,r)):n=Tc.instance.visit(o,r);let u=(o.children||[]).map(c=>Ce.Field.encode(r,c)),f=Dt.createChildrenVector(r,u),s=e.metadata&&e.metadata.size>0?Dt.createCustomMetadataVector(r,[...e.metadata].map(([c,_])=>{let U=r.createString(`${c}`),J=r.createString(`${_}`);return Nr.startKeyValue(r),Nr.addKey(r,U),Nr.addValue(r,J),Nr.endKeyValue(r)})):-1;return e.name&&(t=r.createString(e.name)),Dt.startField(r),Dt.addType(r,n),Dt.addTypeType(r,a),Dt.addChildren(r,f),Dt.addNullable(r,!!e.nullable),t!==-1&&Dt.addName(r,t),i!==-1&&Dt.addDictionary(r,i),s!==-1&&Dt.addCustomMetadata(r,s),Dt.endField(r)}function rv(r,e){let t=e.nodes||[],n=e.buffers||[];kr.startNodesVector(r,t.length),t.slice().reverse().forEach(a=>ln.encode(r,a));let i=r.endVector();kr.startBuffersVector(r,n.length),n.slice().reverse().forEach(a=>cn.encode(r,a));let o=r.endVector();return kr.startRecordBatch(r),kr.addLength(r,new un(e.length,0)),kr.addNodes(r,i),kr.addBuffers(r,o),kr.endRecordBatch(r)}function nv(r,e){let t=yt.encode(r,e.data);return Xn.startDictionaryBatch(r),Xn.addId(r,new un(e.id,0)),Xn.addIsDelta(r,e.isDelta),Xn.addData(r,t),Xn.endDictionaryBatch(r)}function iv(r,e){return qB.createFieldNode(r,new un(e.length,0),new un(e.nullCount,0))}function sv(r,e){return jB.createBuffer(r,new un(e.offset,0),new un(e.length,0))}var ov=function(){let r=new ArrayBuffer(2);return new DataView(r).setInt16(0,256,!0),new Int16Array(r)[0]===256}()});var Co=w(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});re.magicX2AndPadding=re.magicAndPadding=re.magicLength=re.checkForMagicArrowString=re.MAGIC=re.MAGIC_STR=re.PADDING=re.JSONMessageReader=re.AsyncMessageReader=re.MessageReader=void 0;var xr=de(),av=wn(),gp=av.flatbuffers.ByteBuffer,Gi=an(),uv=He(),cv=cc(),wp=Ae(),xo=Pr(),Ft=vn(),Bc=r=>`Expected ${xr.MessageHeader[r]} Message in stream, but was null or length 0.`,vc=r=>`Header pointer of flatbuffer-encoded ${xr.MessageHeader[r]} Message is null or length 0.`,Tp=(r,e)=>`Expected to read ${r} metadata bytes, but only read ${e}.`,Bp=(r,e)=>`Expected to read ${r} bytes for message body, but only read ${e}.`,Ic=class{constructor(e){this.source=e instanceof xo.ByteStream?e:new xo.ByteStream(e)}[Symbol.iterator](){return this}next(){let e;return(e=this.readMetadataLength()).done||e.value===-1&&(e=this.readMetadataLength()).done||(e=this.readMetadata(e.value)).done?Ft.ITERATOR_DONE:e}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}readMessage(e){let t;if((t=this.next()).done)return null;if(e!=null&&t.value.headerType!==e)throw new Error(Bc(e));return t.value}readMessageBody(e){if(e<=0)return new Uint8Array(0);let t=wp.toUint8Array(this.source.read(e));if(t.byteLength<e)throw new Error(Bp(e,t.byteLength));return t.byteOffset%8==0&&t.byteOffset+t.byteLength<=t.buffer.byteLength?t:t.slice()}readSchema(e=!1){let t=xr.MessageHeader.Schema,n=this.readMessage(t),i=n&&n.header();if(e&&!i)throw new Error(vc(t));return i}readMetadataLength(){let e=this.source.read(re.PADDING),t=e&&new gp(e),n=t&&t.readInt32(0)||0;return{done:n===0,value:n}}readMetadata(e){let t=this.source.read(e);if(!t)return Ft.ITERATOR_DONE;if(t.byteLength<e)throw new Error(Tp(e,t.byteLength));return{done:!1,value:Gi.Message.decode(t)}}};re.MessageReader=Ic;var vp=class{constructor(e,t){this.source=e instanceof xo.AsyncByteStream?e:uv.isFileHandle(e)?new cv.AsyncRandomAccessFile(e,t):new xo.AsyncByteStream(e)}[Symbol.asyncIterator](){return this}async next(){let e;return(e=await this.readMetadataLength()).done||e.value===-1&&(e=await this.readMetadataLength()).done||(e=await this.readMetadata(e.value)).done?Ft.ITERATOR_DONE:e}async throw(e){return await this.source.throw(e)}async return(e){return await this.source.return(e)}async readMessage(e){let t;if((t=await this.next()).done)return null;if(e!=null&&t.value.headerType!==e)throw new Error(Bc(e));return t.value}async readMessageBody(e){if(e<=0)return new Uint8Array(0);let t=wp.toUint8Array(await this.source.read(e));if(t.byteLength<e)throw new Error(Bp(e,t.byteLength));return t.byteOffset%8==0&&t.byteOffset+t.byteLength<=t.buffer.byteLength?t:t.slice()}async readSchema(e=!1){let t=xr.MessageHeader.Schema,n=await this.readMessage(t),i=n&&n.header();if(e&&!i)throw new Error(vc(t));return i}async readMetadataLength(){let e=await this.source.read(re.PADDING),t=e&&new gp(e),n=t&&t.readInt32(0)||0;return{done:n===0,value:n}}async readMetadata(e){let t=await this.source.read(e);if(!t)return Ft.ITERATOR_DONE;if(t.byteLength<e)throw new Error(Tp(e,t.byteLength));return{done:!1,value:Gi.Message.decode(t)}}};re.AsyncMessageReader=vp;var Ip=class extends Ic{constructor(e){super(new Uint8Array(0));this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=e instanceof Ft.ArrowJSON?e:new Ft.ArrowJSON(e)}next(){let{_json:e}=this;if(!this._schema){this._schema=!0;let t=Gi.Message.fromJSON(e.schema,xr.MessageHeader.Schema);return{done:!1,value:t}}if(this._dictionaryIndex<e.dictionaries.length){let t=e.dictionaries[this._dictionaryIndex++];this._body=t.data.columns;let n=Gi.Message.fromJSON(t,xr.MessageHeader.DictionaryBatch);return{done:!1,value:n}}if(this._batchIndex<e.batches.length){let t=e.batches[this._batchIndex++];this._body=t.columns;let n=Gi.Message.fromJSON(t,xr.MessageHeader.RecordBatch);return{done:!1,value:n}}return this._body=[],Ft.ITERATOR_DONE}readMessageBody(e){return t(this._body);function t(n){return(n||[]).reduce((i,o)=>[...i,...o.VALIDITY&&[o.VALIDITY]||[],...o.TYPE&&[o.TYPE]||[],...o.OFFSET&&[o.OFFSET]||[],...o.DATA&&[o.DATA]||[],...t(o.children)],[])}}readMessage(e){let t;if((t=this.next()).done)return null;if(e!=null&&t.value.headerType!==e)throw new Error(Bc(e));return t.value}readSchema(){let e=xr.MessageHeader.Schema,t=this.readMessage(e),n=t&&t.header();if(!t||!n)throw new Error(vc(e));return n}};re.JSONMessageReader=Ip;re.PADDING=4;re.MAGIC_STR="ARROW1";re.MAGIC=new Uint8Array(re.MAGIC_STR.length);for(let r=0;r<re.MAGIC_STR.length;r+=1|0)re.MAGIC[r]=re.MAGIC_STR.charCodeAt(r);function lv(r,e=0){for(let t=-1,n=re.MAGIC.length;++t<n;)if(re.MAGIC[t]!==r[e+t])return!1;return!0}re.checkForMagicArrowString=lv;re.magicLength=re.MAGIC.length;re.magicAndPadding=re.magicLength+re.PADDING;re.magicX2AndPadding=re.magicLength*2+re.PADDING});var Fp=w(jo=>{"use strict";Object.defineProperty(jo,"__esModule",{value:!0});jo.VectorAssembler=void 0;var dv=We(),Sp=de(),fv=fr(),Sc=Ae(),Oc=Lt(),hv=Or(),Op=an(),Ap=oe(),Re=class extends dv.Visitor{constructor(){super();this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}static assemble(...e){let t=new Re,n=hv.selectVectorChildrenArgs(fv.RecordBatch,e),[i=t]=t.visitMany(n);return i}visit(e){if(!Ap.DataType.isDictionary(e.type)){let{data:t,length:n,nullCount:i}=e;if(n>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");Ap.DataType.isNull(e.type)||Rt.call(this,i<=0?new Uint8Array(0):Oc.truncateBitmap(t.offset,n,t.nullBitmap)),this.nodes.push(new Op.FieldNode(n,i))}return super.visit(e)}visitNull(e){return this}visitDictionary(e){return this.visit(e.indices)}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}};jo.VectorAssembler=Re;function Rt(r){let e=r.byteLength+7&~7;return this.buffers.push(r),this.bufferRegions.push(new Op.BufferRegion(this._byteLength,e)),this._byteLength+=e,this}function pv(r){let{type:e,length:t,typeIds:n,valueOffsets:i}=r;if(Rt.call(this,n),e.mode===Sp.UnionMode.Sparse)return Dc.call(this,r);if(e.mode===Sp.UnionMode.Dense){if(r.offset<=0)return Rt.call(this,i),Dc.call(this,r);{let o=n.reduce((c,_)=>Math.max(c,_),n[0]),a=new Int32Array(o+1),u=new Int32Array(o+1).fill(-1),f=new Int32Array(t),s=Sc.rebaseValueOffsets(-i[0],t,i);for(let c,_,U=-1;++U<t;)(_=u[c=n[U]])===-1&&(_=u[c]=s[c]),f[U]=s[U]-_,++a[c];Rt.call(this,f);for(let c,_=-1,U=e.children.length;++_<U;)if(c=r.getChildAt(_)){let J=e.typeIds[_],et=Math.min(t,a[J]);this.visit(c.slice(u[J],et))}}}return this}function yv(r){let e;return r.nullCount>=r.length?Rt.call(this,new Uint8Array(0)):(e=r.values)instanceof Uint8Array?Rt.call(this,Oc.truncateBitmap(r.offset,r.length,e)):Rt.call(this,Oc.packBools(r))}function Cr(r){return Rt.call(this,r.values.subarray(0,r.length*r.stride))}function Dp(r){let{length:e,values:t,valueOffsets:n}=r,i=n[0],o=n[e],a=Math.min(o-i,t.byteLength-i);return Rt.call(this,Sc.rebaseValueOffsets(-n[0],e,n)),Rt.call(this,t.subarray(i,i+a)),this}function Ac(r){let{length:e,valueOffsets:t}=r;return t&&Rt.call(this,Sc.rebaseValueOffsets(t[0],e,t)),this.visit(r.getChildAt(0))}function Dc(r){return this.visitMany(r.type.children.map((e,t)=>r.getChildAt(t)).filter(Boolean))[0]}Re.prototype.visitBool=yv;Re.prototype.visitInt=Cr;Re.prototype.visitFloat=Cr;Re.prototype.visitUtf8=Dp;Re.prototype.visitBinary=Dp;Re.prototype.visitFixedSizeBinary=Cr;Re.prototype.visitDate=Cr;Re.prototype.visitTimestamp=Cr;Re.prototype.visitTime=Cr;Re.prototype.visitDecimal=Cr;Re.prototype.visitList=Ac;Re.prototype.visitStruct=Dc;Re.prototype.visitUnion=pv;Re.prototype.visitInterval=Cr;Re.prototype.visitFixedSizeList=Ac;Re.prototype.visitMap=Ac});var Ep=w(qo=>{"use strict";Object.defineProperty(qo,"__esModule",{value:!0});qo.JSONTypeAssembler=void 0;var bv=We(),_e=de(),Rp=class extends bv.Visitor{visit(e){return e==null?void 0:super.visit(e)}visitNull({typeId:e}){return{name:_e.ArrowType[e].toLowerCase()}}visitInt({typeId:e,bitWidth:t,isSigned:n}){return{name:_e.ArrowType[e].toLowerCase(),bitWidth:t,isSigned:n}}visitFloat({typeId:e,precision:t}){return{name:_e.ArrowType[e].toLowerCase(),precision:_e.Precision[t]}}visitBinary({typeId:e}){return{name:_e.ArrowType[e].toLowerCase()}}visitBool({typeId:e}){return{name:_e.ArrowType[e].toLowerCase()}}visitUtf8({typeId:e}){return{name:_e.ArrowType[e].toLowerCase()}}visitDecimal({typeId:e,scale:t,precision:n}){return{name:_e.ArrowType[e].toLowerCase(),scale:t,precision:n}}visitDate({typeId:e,unit:t}){return{name:_e.ArrowType[e].toLowerCase(),unit:_e.DateUnit[t]}}visitTime({typeId:e,unit:t,bitWidth:n}){return{name:_e.ArrowType[e].toLowerCase(),unit:_e.TimeUnit[t],bitWidth:n}}visitTimestamp({typeId:e,timezone:t,unit:n}){return{name:_e.ArrowType[e].toLowerCase(),unit:_e.TimeUnit[n],timezone:t}}visitInterval({typeId:e,unit:t}){return{name:_e.ArrowType[e].toLowerCase(),unit:_e.IntervalUnit[t]}}visitList({typeId:e}){return{name:_e.ArrowType[e].toLowerCase()}}visitStruct({typeId:e}){return{name:_e.ArrowType[e].toLowerCase()}}visitUnion({typeId:e,mode:t,typeIds:n}){return{name:_e.ArrowType[e].toLowerCase(),mode:_e.UnionMode[t],typeIds:[...n]}}visitDictionary(e){return this.visit(e.dictionary)}visitFixedSizeBinary({typeId:e,byteWidth:t}){return{name:_e.ArrowType[e].toLowerCase(),byteWidth:t}}visitFixedSizeList({typeId:e,listSize:t}){return{name:_e.ArrowType[e].toLowerCase(),listSize:t}}visitMap({typeId:e,keysSorted:t}){return{name:_e.ArrowType[e].toLowerCase(),keysSorted:t}}};qo.JSONTypeAssembler=Rp});var Pp=w(Yo=>{"use strict";Object.defineProperty(Yo,"__esModule",{value:!0});Yo.JSONVectorAssembler=void 0;var mv=Ni(),$i=xn(),_v=ve(),gv=We(),wv=de(),Tv=fr(),Fc=de(),Wo=Lt(),Bv=Or(),Up=oe(),zo=class extends gv.Visitor{static assemble(...e){return new zo().visitMany(Bv.selectColumnChildrenArgs(Tv.RecordBatch,e))}visit(e){let{data:t,name:n,length:i}=e,{offset:o,nullCount:a,nullBitmap:u}=t,f=Up.DataType.isDictionary(e.type)?e.type.indices:e.type,s=Object.assign([],t.buffers,{[wv.BufferType.VALIDITY]:void 0});return{name:n,count:i,VALIDITY:Up.DataType.isNull(f)?void 0:a<=0?Array.from({length:i},()=>1):[...Wo.iterateBits(u,o,i,null,Wo.getBit)],...super.visit(_v.Vector.new(t.clone(f,o,i,0,s)))}}visitNull(){return{}}visitBool({values:e,offset:t,length:n}){return{DATA:[...Wo.iterateBits(e,t,n,null,Wo.getBool)]}}visitInt(e){return{DATA:e.type.bitWidth<64?[...e.values]:[...Ji(e.values,2)]}}visitFloat(e){return{DATA:[...e.values]}}visitUtf8(e){return{DATA:[...e],OFFSET:[...e.valueOffsets]}}visitBinary(e){return{DATA:[...Mp(e)],OFFSET:[...e.valueOffsets]}}visitFixedSizeBinary(e){return{DATA:[...Mp(e)]}}visitDate(e){return{DATA:e.type.unit===Fc.DateUnit.DAY?[...e.values]:[...Ji(e.values,2)]}}visitTimestamp(e){return{DATA:[...Ji(e.values,2)]}}visitTime(e){return{DATA:e.type.unit<Fc.TimeUnit.MICROSECOND?[...e.values]:[...Ji(e.values,2)]}}visitDecimal(e){return{DATA:[...Ji(e.values,4)]}}visitList(e){return{OFFSET:[...e.valueOffsets],children:e.type.children.map((t,n)=>this.visit(new $i.Column(t,[e.getChildAt(n)])))}}visitStruct(e){return{children:e.type.children.map((t,n)=>this.visit(new $i.Column(t,[e.getChildAt(n)])))}}visitUnion(e){return{TYPE:[...e.typeIds],OFFSET:e.type.mode===Fc.UnionMode.Dense?[...e.valueOffsets]:void 0,children:e.type.children.map((t,n)=>this.visit(new $i.Column(t,[e.getChildAt(n)])))}}visitInterval(e){return{DATA:[...e.values]}}visitFixedSizeList(e){return{children:e.type.children.map((t,n)=>this.visit(new $i.Column(t,[e.getChildAt(n)])))}}visitMap(e){return{OFFSET:[...e.valueOffsets],children:e.type.children.map((t,n)=>this.visit(new $i.Column(t,[e.getChildAt(n)])))}}};Yo.JSONVectorAssembler=zo;function*Mp(r){for(let e of r)yield e.reduce((t,n)=>`${t}${("0"+(n&255).toString(16)).slice(-2)}`,"").toUpperCase()}function*Ji(r,e){for(let t=-1,n=r.length/e;++t<n;)yield`${mv.BN.new(r.subarray((t+0)*e,(t+1)*e),!1)}`}});var Ko=w(Kt=>{"use strict";Object.defineProperty(Kt,"__esModule",{value:!0});Kt.RecordBatchJSONWriter=Kt.RecordBatchFileWriter=Kt.RecordBatchStreamWriter=Kt.RecordBatchWriter=void 0;var Rc=Qi(),vv=Co(),Iv=xn(),Sv=oe(),Ov=Le(),Ho=an(),Ec=an(),ei=oc(),Uc=de(),Mc=Pr(),Vp=Fp(),Av=Ep(),Np=Pp(),Dv=Ae(),Pc=fr(),Fv=vn(),Jt=He(),Ki=class extends Fv.ReadableInterop{constructor(e){super();this._position=0,this._started=!1,this._sink=new Mc.AsyncByteQueue,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,Jt.isObject(e)||(e={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy=typeof e.autoDestroy=="boolean"?e.autoDestroy:!0,this._writeLegacyIpcFormat=typeof e.writeLegacyIpcFormat=="boolean"?e.writeLegacyIpcFormat:!1}static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e,t){throw new Error('"throughDOM" not available in this environment')}toString(e=!1){return this._sink.toString(e)}toUint8Array(e=!1){return this._sink.toUint8Array(e)}writeAll(e){return Jt.isPromise(e)?e.then(t=>this.writeAll(t)):Jt.isAsyncIterable(e)?Nc(this,e):Vc(this,e)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(e){return this._sink.toDOMStream(e)}toNodeStream(e){return this._sink.toNodeStream(e)}close(){return this.reset()._sink.close()}abort(e){return this.reset()._sink.abort(e)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(e=this._sink,t=null){return e===this._sink||e instanceof Mc.AsyncByteQueue?this._sink=e:(this._sink=new Mc.AsyncByteQueue,e&&Jt.isWritableDOMStream(e)?this.toDOMStream({type:"bytes"}).pipeTo(e):e&&Jt.isWritableNodeStream(e)&&this.toNodeStream({objectMode:!1}).pipe(e)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,(!t||!t.compareTo(this._schema))&&(t===null?(this._position=0,this._schema=null):(this._started=!0,this._schema=t,this._writeSchema(t))),this}write(e){let t=null;if(this._sink){if(e==null)return this.finish()&&void 0;if(e instanceof Rc.Table&&!(t=e.schema))return this.finish()&&void 0;if(e instanceof Pc.RecordBatch&&!(t=e.schema))return this.finish()&&void 0}else throw new Error("RecordBatchWriter is closed");if(t&&!t.compareTo(this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,t)}e instanceof Pc.RecordBatch?e instanceof Pc._InternalEmptyPlaceholderRecordBatch||this._writeRecordBatch(e):e instanceof Rc.Table?this.writeAll(e.chunks):Jt.isIterable(e)&&this.writeAll(e)}_writeMessage(e,t=8){let n=t-1,i=Ho.Message.encode(e),o=i.byteLength,a=this._writeLegacyIpcFormat?4:8,u=o+a+n&~n,f=u-o-a;return e.headerType===Uc.MessageHeader.RecordBatch?this._recordBatchBlocks.push(new ei.FileBlock(u,e.bodyLength,this._position)):e.headerType===Uc.MessageHeader.DictionaryBatch&&this._dictionaryBlocks.push(new ei.FileBlock(u,e.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(u-a)),o>0&&this._write(i),this._writePadding(f)}_write(e){if(this._started){let t=Dv.toUint8Array(e);t&&t.byteLength>0&&(this._sink.write(t),this._position+=t.byteLength)}return this}_writeSchema(e){return this._writeMessage(Ho.Message.from(e))}_writeFooter(e){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(vv.MAGIC)}_writePadding(e){return e>0?this._write(new Uint8Array(e)):this}_writeRecordBatch(e){let{byteLength:t,nodes:n,bufferRegions:i,buffers:o}=Vp.VectorAssembler.assemble(e),a=new Ec.RecordBatch(e.length,n,i),u=Ho.Message.from(a,t);return this._writeDictionaries(e)._writeMessage(u)._writeBodyBuffers(o)}_writeDictionaryBatch(e,t,n=!1){this._dictionaryDeltaOffsets.set(t,e.length+(this._dictionaryDeltaOffsets.get(t)||0));let{byteLength:i,nodes:o,bufferRegions:a,buffers:u}=Vp.VectorAssembler.assemble(e),f=new Ec.RecordBatch(e.length,o,a),s=new Ec.DictionaryBatch(f,t,n),c=Ho.Message.from(s,i);return this._writeMessage(c)._writeBodyBuffers(u)}_writeBodyBuffers(e){let t,n,i;for(let o=-1,a=e.length;++o<a;)(t=e[o])&&(n=t.byteLength)>0&&(this._write(t),(i=(n+7&~7)-n)>0&&this._writePadding(i));return this}_writeDictionaries(e){for(let[t,n]of e.dictionaries){let i=this._dictionaryDeltaOffsets.get(t)||0;if(i===0||(n=n.slice(i)).length>0){let o="chunks"in n?n.chunks:[n];for(let a of o)this._writeDictionaryBatch(a,t,i>0),i+=a.length}}return this}};Kt.RecordBatchWriter=Ki;var Go=class extends Ki{static writeAll(e,t){let n=new Go(t);return Jt.isPromise(e)?e.then(i=>n.writeAll(i)):Jt.isAsyncIterable(e)?Nc(n,e):Vc(n,e)}};Kt.RecordBatchStreamWriter=Go;var $o=class extends Ki{static writeAll(e){let t=new $o;return Jt.isPromise(e)?e.then(n=>t.writeAll(n)):Jt.isAsyncIterable(e)?Nc(t,e):Vc(t,e)}constructor(){super();this._autoDestroy=!0}_writeSchema(e){return this._writeMagic()._writePadding(2)}_writeFooter(e){let t=ei.Footer.encode(new ei.Footer(e,Uc.MetadataVersion.V4,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(e)._write(t)._write(Int32Array.of(t.byteLength))._writeMagic()}};Kt.RecordBatchFileWriter=$o;var Jo=class extends Ki{constructor(){super();this._autoDestroy=!0,this._recordBatches=[],this._dictionaries=[]}static writeAll(e){return new Jo().writeAll(e)}_writeMessage(){return this}_writeFooter(e){return this}_writeSchema(e){return this._write(`{
  "schema": ${JSON.stringify({fields:e.fields.map(kp)},null,2)}`)}_writeDictionaries(e){return e.dictionaries.size>0&&this._dictionaries.push(e),this}_writeDictionaryBatch(e,t,n=!1){return this._dictionaryDeltaOffsets.set(t,e.length+(this._dictionaryDeltaOffsets.get(t)||0)),this._write(this._dictionaryBlocks.length===0?"    ":`,
    `),this._write(`${Rv(e,t,n)}`),this._dictionaryBlocks.push(new ei.FileBlock(0,0,0)),this}_writeRecordBatch(e){return this._writeDictionaries(e),this._recordBatches.push(e),this}close(){if(this._dictionaries.length>0){this._write(`,
  "dictionaries": [
`);for(let e of this._dictionaries)super._writeDictionaries(e);this._write(`
  ]`)}if(this._recordBatches.length>0){for(let e=-1,t=this._recordBatches.length;++e<t;)this._write(e===0?`,
  "batches": [
    `:`,
    `),this._write(`${Ev(this._recordBatches[e])}`),this._recordBatchBlocks.push(new ei.FileBlock(0,0,0));this._write(`
  ]`)}return this._schema&&this._write(`
}`),this._dictionaries=[],this._recordBatches=[],super.close()}};Kt.RecordBatchJSONWriter=Jo;function Vc(r,e){let t=e;e instanceof Rc.Table&&(t=e.chunks,r.reset(void 0,e.schema));for(let n of t)r.write(n);return r.finish()}async function Nc(r,e){for await(let t of e)r.write(t);return r.finish()}function kp({name:r,type:e,nullable:t}){let n=new Av.JSONTypeAssembler;return{name:r,nullable:t,type:n.visit(e),children:(e.children||[]).map(kp),dictionary:Sv.DataType.isDictionary(e)?{id:e.id,isOrdered:e.isOrdered,indexType:n.visit(e.indices)}:void 0}}function Rv(r,e,t=!1){let n=new Ov.Field(`${e}`,r.type,r.nullCount>0),i=Np.JSONVectorAssembler.assemble(new Iv.Column(n,[r]));return JSON.stringify({id:e,isDelta:t,data:{count:r.length,columns:i}},null,2)}function Ev(r){return JSON.stringify({count:r.length,columns:Np.JSONVectorAssembler.assemble(r)},null,2)}});var xc=w(jr=>{"use strict";Object.defineProperty(jr,"__esModule",{value:!0});jr.distributeVectorsIntoRecordBatches=jr.distributeColumnsIntoRecordBatches=jr.ensureSameLengthData=void 0;var Lp=St(),kc=Le(),Uv=Sr(),Mv=fr(),Lc=new Uint8Array(0),xp=r=>[Lc,Lc,new Uint8Array(r),Lc];function Pv(r,e,t=e.reduce((n,i)=>Math.max(n,i.length),0)){let n,i,o=-1,a=e.length,u=[...r.fields],f=[],s=(t+63&~63)>>3;for(;++o<a;)(n=e[o])&&n.length===t?f[o]=n:((i=u[o]).nullable||(u[o]=u[o].clone({nullable:!0})),f[o]=n?n._changeLengthAndBackfillNullBitmap(t):Lp.Data.new(i.type,0,t,t,xp(s)));return[new kc.Schema(u),t,f]}jr.ensureSameLengthData=Pv;function Vv(r){return Cp(new kc.Schema(r.map(({field:e})=>e)),r)}jr.distributeColumnsIntoRecordBatches=Vv;function Cp(r,e){return Nv(r,e.map(t=>t instanceof Uv.Chunked?t.chunks.map(n=>n.data):[t.data]))}jr.distributeVectorsIntoRecordBatches=Cp;function Nv(r,e){let t=[...r.fields],n=[],i={numBatches:e.reduce((_,U)=>Math.max(_,U.length),0)},o=0,a=0,u=-1,f=e.length,s,c=[];for(;i.numBatches-- >0;){for(a=Number.POSITIVE_INFINITY,u=-1;++u<f;)c[u]=s=e[u].shift(),a=Math.min(a,s?s.length:a);isFinite(a)&&(c=kv(t,a,c,e,i),a>0&&(n[o++]=[a,c.slice()]))}return[r=new kc.Schema(t,r.metadata),n.map(_=>new Mv.RecordBatch(r,..._))]}function kv(r,e,t,n,i){let o,a,u=0,f=-1,s=n.length,c=(e+63&~63)>>3;for(;++f<s;)(o=t[f])&&(u=o.length)>=e?u===e?t[f]=o:(t[f]=o.slice(0,e),o=o.slice(e,u-e),i.numBatches=Math.max(i.numBatches,n[f].unshift(o))):((a=r[f]).nullable||(r[f]=a.clone({nullable:!0})),t[f]=o?o._changeLengthAndBackfillNullBitmap(e):Lp.Data.new(a.type,0,e,e,xp(c)));return t}});var Ie=w(Qo=>{"use strict";Object.defineProperty(Qo,"__esModule",{value:!0});Qo.BaseVector=void 0;var Lv=de(),xv=Sr(),Cv=xi(),Cc=ve(),jc=class extends Cc.AbstractVector{constructor(e,t){super();this._children=t,this.numChildren=e.childData.length,this._bindDataAccessors(this.data=e)}get type(){return this.data.type}get typeId(){return this.data.typeId}get length(){return this.data.length}get offset(){return this.data.offset}get stride(){return this.data.stride}get nullCount(){return this.data.nullCount}get byteLength(){return this.data.byteLength}get VectorName(){return`${Lv.Type[this.typeId]}Vector`}get ArrayType(){return this.type.ArrayType}get values(){return this.data.values}get typeIds(){return this.data.typeIds}get nullBitmap(){return this.data.nullBitmap}get valueOffsets(){return this.data.valueOffsets}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}clone(e,t=this._children){return Cc.Vector.new(e,t)}concat(...e){return xv.Chunked.concat(this,...e)}slice(e,t){return Cv.clampRange(this,e,t,this._sliceInternal)}isValid(e){if(this.nullCount>0){let t=this.offset+e;return(this.nullBitmap[t>>3]&1<<t%8)!==0}return!0}getChildAt(e){return e<0||e>=this.numChildren?null:(this._children||(this._children=[]))[e]||(this._children[e]=Cc.Vector.new(this.data.childData[e]))}toJSON(){return[...this]}_sliceInternal(e,t,n){return e.clone(e.data.slice(t,n-t),null)}_bindDataAccessors(e){}};Qo.BaseVector=jc;jc.prototype[Symbol.isConcatSpreadable]=!0});var qc=w(Zo=>{"use strict";Object.defineProperty(Zo,"__esModule",{value:!0});Zo.BinaryVector=void 0;var jv=ve(),qv=Ie(),Wv=oe(),jp=class extends qv.BaseVector{asUtf8(){return jv.Vector.new(this.data.clone(new Wv.Utf8))}};Zo.BinaryVector=jp});var Wc=w(Xo=>{"use strict";Object.defineProperty(Xo,"__esModule",{value:!0});Xo.BoolVector=void 0;var zv=oe(),Yv=Ie(),Hv=Qt(),qp=class extends Yv.BaseVector{static from(e){return Hv.vectorFromValuesWithType(()=>new zv.Bool,e)}};Xo.BoolVector=qp});var Yc=w(qr=>{"use strict";Object.defineProperty(qr,"__esModule",{value:!0});qr.DateMillisecondVector=qr.DateDayVector=qr.DateVector=void 0;var Gv=de(),$v=Ie(),Wp=Qt(),zc=oe(),ea=class extends $v.BaseVector{static from(...e){return e.length===2?Wp.vectorFromValuesWithType(()=>e[1]===Gv.DateUnit.DAY?new zc.DateDay:new zc.DateMillisecond,e[0]):Wp.vectorFromValuesWithType(()=>new zc.DateMillisecond,e[0])}};qr.DateVector=ea;var zp=class extends ea{};qr.DateDayVector=zp;var Yp=class extends ea{};qr.DateMillisecondVector=Yp});var Hc=w(ta=>{"use strict";Object.defineProperty(ta,"__esModule",{value:!0});ta.DecimalVector=void 0;var Jv=Ie(),Hp=class extends Jv.BaseVector{};ta.DecimalVector=Hp});var na=w(ra=>{"use strict";Object.defineProperty(ra,"__esModule",{value:!0});ra.DictionaryVector=void 0;var Kv=St(),Gp=ve(),Qv=Ie(),Zv=Qt(),Xv=oe(),Gc=class extends Qv.BaseVector{constructor(e){super(e);this.indices=Gp.Vector.new(e.clone(this.type.indices))}static from(...e){if(e.length===3){let[t,n,i]=e,o=new Xv.Dictionary(t.type,n,null,null);return Gp.Vector.new(Kv.Data.Dictionary(o,0,i.length,0,null,i,t))}return Zv.vectorFromValuesWithType(()=>e[0].type,e[0])}get dictionary(){return this.data.dictionary}reverseLookup(e){return this.dictionary.indexOf(e)}getKey(e){return this.indices.get(e)}getValue(e){return this.dictionary.get(e)}setKey(e,t){return this.indices.set(e,t)}setValue(e,t){return this.dictionary.set(e,t)}};ra.DictionaryVector=Gc;Gc.prototype.indices=null});var $c=w(ia=>{"use strict";Object.defineProperty(ia,"__esModule",{value:!0});ia.FixedSizeBinaryVector=void 0;var eI=Ie(),$p=class extends eI.BaseVector{};ia.FixedSizeBinaryVector=$p});var Jc=w(sa=>{"use strict";Object.defineProperty(sa,"__esModule",{value:!0});sa.FixedSizeListVector=void 0;var tI=Ie(),Jp=class extends tI.BaseVector{};sa.FixedSizeListVector=Jp});var Xc=w(Zt=>{"use strict";Object.defineProperty(Zt,"__esModule",{value:!0});Zt.Float64Vector=Zt.Float32Vector=Zt.Float16Vector=Zt.FloatVector=void 0;var rI=St(),nI=ve(),iI=Ie(),sI=Qt(),dn=oe(),Zi=class extends iI.BaseVector{static from(e){let t=uI(this);if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)){let n=aI(e.constructor)||t;if(t===null&&(t=n),t&&t===n){let i=new t,o=e.byteLength/i.ArrayType.BYTES_PER_ELEMENT;if(!oI(t,e.constructor))return nI.Vector.new(rI.Data.Float(i,0,o,0,null,e))}}if(t)return sI.vectorFromValuesWithType(()=>new t,e);throw e instanceof DataView||e instanceof ArrayBuffer?new TypeError(`Cannot infer float type from instance of ${e.constructor.name}`):new TypeError("Unrecognized FloatVector input")}};Zt.FloatVector=Zi;var Kc=class extends Zi{toFloat32Array(){return new Float32Array(this)}toFloat64Array(){return new Float64Array(this)}};Zt.Float16Vector=Kc;var Qc=class extends Zi{};Zt.Float32Vector=Qc;var Zc=class extends Zi{};Zt.Float64Vector=Zc;var oI=(r,e)=>r===dn.Float16&&e!==Uint16Array,aI=r=>{switch(r){case Uint16Array:return dn.Float16;case Float32Array:return dn.Float32;case Float64Array:return dn.Float64;default:return null}},uI=r=>{switch(r){case Kc:return dn.Float16;case Qc:return dn.Float32;case Zc:return dn.Float64;default:return null}}});var el=w(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});Wr.IntervalYearMonthVector=Wr.IntervalDayTimeVector=Wr.IntervalVector=void 0;var cI=Ie(),oa=class extends cI.BaseVector{};Wr.IntervalVector=oa;var Kp=class extends oa{};Wr.IntervalDayTimeVector=Kp;var Qp=class extends oa{};Wr.IntervalYearMonthVector=Qp});var aa=w(Ee=>{"use strict";Object.defineProperty(Ee,"__esModule",{value:!0});Ee.Uint64Vector=Ee.Uint32Vector=Ee.Uint16Vector=Ee.Uint8Vector=Ee.Int64Vector=Ee.Int32Vector=Ee.Int16Vector=Ee.Int8Vector=Ee.IntVector=void 0;var lI=St(),dI=ve(),fI=Ie(),hI=Qt(),Zp=He(),Xp=Ae(),Be=oe(),Xt=class extends fI.BaseVector{static from(...e){let[t,n=!1]=e,i=bI(this,n);if(t instanceof ArrayBuffer||ArrayBuffer.isView(t)){let o=yI(t.constructor,n)||i;if(i===null&&(i=o),i&&i===o){let a=new i,u=t.byteLength/a.ArrayType.BYTES_PER_ELEMENT;return pI(i,t.constructor)&&(u*=.5),dI.Vector.new(lI.Data.Int(a,0,u,0,null,t))}}if(i)return hI.vectorFromValuesWithType(()=>new i,t);throw t instanceof DataView||t instanceof ArrayBuffer?new TypeError(`Cannot infer integer type from instance of ${t.constructor.name}`):new TypeError("Unrecognized IntVector input")}};Ee.IntVector=Xt;var tl=class extends Xt{};Ee.Int8Vector=tl;var rl=class extends Xt{};Ee.Int16Vector=rl;var nl=class extends Xt{};Ee.Int32Vector=nl;var il=class extends Xt{toBigInt64Array(){return Xp.toBigInt64Array(this.values)}get values64(){return this._values64||(this._values64=this.toBigInt64Array())}};Ee.Int64Vector=il;var sl=class extends Xt{};Ee.Uint8Vector=sl;var ol=class extends Xt{};Ee.Uint16Vector=ol;var al=class extends Xt{};Ee.Uint32Vector=al;var ul=class extends Xt{toBigUint64Array(){return Xp.toBigUint64Array(this.values)}get values64(){return this._values64||(this._values64=this.toBigUint64Array())}};Ee.Uint64Vector=ul;var pI=(r,e)=>(r===Be.Int64||r===Be.Uint64)&&(e===Int32Array||e===Uint32Array),yI=(r,e)=>{switch(r){case Int8Array:return Be.Int8;case Int16Array:return Be.Int16;case Int32Array:return e?Be.Int64:Be.Int32;case Zp.BigInt64Array:return Be.Int64;case Uint8Array:return Be.Uint8;case Uint16Array:return Be.Uint16;case Uint32Array:return e?Be.Uint64:Be.Uint32;case Zp.BigUint64Array:return Be.Uint64;default:return null}},bI=(r,e)=>{switch(r){case tl:return Be.Int8;case rl:return Be.Int16;case nl:return e?Be.Int64:Be.Int32;case il:return Be.Int64;case sl:return Be.Uint8;case ol:return Be.Uint16;case al:return e?Be.Uint64:Be.Uint32;case ul:return Be.Uint64;default:return null}}});var cl=w(ua=>{"use strict";Object.defineProperty(ua,"__esModule",{value:!0});ua.ListVector=void 0;var mI=Ie(),ey=class extends mI.BaseVector{};ua.ListVector=ey});var ll=w(ca=>{"use strict";Object.defineProperty(ca,"__esModule",{value:!0});ca.MapVector=void 0;var _I=ki(),gI=ve(),wI=Ie(),TI=oe(),ty=class extends wI.BaseVector{asList(){let e=this.type.children[0];return gI.Vector.new(this.data.clone(new TI.List(e)))}bind(e){let t=this.getChildAt(0),{[e]:n,[e+1]:i}=this.valueOffsets;return new _I.MapRow(t.slice(n,i))}};ca.MapVector=ty});var dl=w(la=>{"use strict";Object.defineProperty(la,"__esModule",{value:!0});la.NullVector=void 0;var BI=Ie(),ry=class extends BI.BaseVector{};la.NullVector=ry});var fl=w(da=>{"use strict";Object.defineProperty(da,"__esModule",{value:!0});da.StructVector=void 0;var vI=ki(),II=Ie(),SI=Symbol.for("rowIndex"),ny=class extends II.BaseVector{bind(e){let t=this._row||(this._row=new vI.StructRow(this)),n=Object.create(t);return n[SI]=e,n}};da.StructVector=ny});var hl=w(mt=>{"use strict";Object.defineProperty(mt,"__esModule",{value:!0});mt.TimestampNanosecondVector=mt.TimestampMicrosecondVector=mt.TimestampMillisecondVector=mt.TimestampSecondVector=mt.TimestampVector=void 0;var OI=Ie(),ti=class extends OI.BaseVector{};mt.TimestampVector=ti;var iy=class extends ti{};mt.TimestampSecondVector=iy;var sy=class extends ti{};mt.TimestampMillisecondVector=sy;var oy=class extends ti{};mt.TimestampMicrosecondVector=oy;var ay=class extends ti{};mt.TimestampNanosecondVector=ay});var pl=w(_t=>{"use strict";Object.defineProperty(_t,"__esModule",{value:!0});_t.TimeNanosecondVector=_t.TimeMicrosecondVector=_t.TimeMillisecondVector=_t.TimeSecondVector=_t.TimeVector=void 0;var AI=Ie(),ri=class extends AI.BaseVector{};_t.TimeVector=ri;var uy=class extends ri{};_t.TimeSecondVector=uy;var cy=class extends ri{};_t.TimeMillisecondVector=cy;var ly=class extends ri{};_t.TimeMicrosecondVector=ly;var dy=class extends ri{};_t.TimeNanosecondVector=dy});var yl=w(zr=>{"use strict";Object.defineProperty(zr,"__esModule",{value:!0});zr.SparseUnionVector=zr.DenseUnionVector=zr.UnionVector=void 0;var DI=Ie(),fa=class extends DI.BaseVector{get typeIdToChildIndex(){return this.data.type.typeIdToChildIndex}};zr.UnionVector=fa;var fy=class extends fa{get valueOffsets(){return this.data.valueOffsets}};zr.DenseUnionVector=fy;var hy=class extends fa{};zr.SparseUnionVector=hy});var bl=w(ha=>{"use strict";Object.defineProperty(ha,"__esModule",{value:!0});ha.Utf8Vector=void 0;var FI=ve(),RI=Ie(),py=oe(),EI=Qt(),yy=class extends RI.BaseVector{static from(e){return EI.vectorFromValuesWithType(()=>new py.Utf8,e)}asBinary(){return FI.Vector.new(this.data.clone(new py.Binary))}};ha.Utf8Vector=yy});var by=w(Yr=>{"use strict";Object.defineProperty(Yr,"__esModule",{value:!0});Yr.partial2=Yr.partial1=Yr.partial0=void 0;function UI(r){return function(){return r(this)}}Yr.partial0=UI;function MI(r){return function(e){return r(this,e)}}Yr.partial1=MI;function PI(r){return function(e,t){return r(this,e,t)}}Yr.partial2=PI});var gl=w(ni=>{"use strict";Object.defineProperty(ni,"__esModule",{value:!0});ni.instance=ni.GetVisitor=void 0;var pa=Ni(),VI=We(),NI=Zr(),kI=Ui(),gt=de(),V=class extends VI.Visitor{};ni.GetVisitor=V;var LI=(r,e)=>864e5*r[e],ml=(r,e)=>4294967296*r[e+1]+(r[e]>>>0),xI=(r,e)=>4294967296*(r[e+1]/1e3)+(r[e]>>>0)/1e3,CI=(r,e)=>4294967296*(r[e+1]/1e6)+(r[e]>>>0)/1e6,my=r=>new Date(r),jI=(r,e)=>my(LI(r,e)),qI=(r,e)=>my(ml(r,e)),WI=(r,e)=>null,_y=(r,e,t)=>{let{[t]:n,[t+1]:i}=e;return n!=null&&i!=null?r.subarray(n,i):null},zI=({offset:r,values:e},t)=>{let n=r+t;return(e[n>>3]&1<<n%8)!=0},gy=({values:r},e)=>jI(r,e),wy=({values:r},e)=>qI(r,e*2),er=({stride:r,values:e},t)=>e[r*t],Ty=({stride:r,values:e},t)=>kI.uint16ToFloat64(e[r*t]),_l=({stride:r,values:e,type:t},n)=>pa.BN.new(e.subarray(r*n,r*(n+1)),t.isSigned),YI=({stride:r,values:e},t)=>e.subarray(r*t,r*(t+1)),HI=({values:r,valueOffsets:e},t)=>_y(r,e,t),GI=({values:r,valueOffsets:e},t)=>{let n=_y(r,e,t);return n!==null?NI.decodeUtf8(n):null},$I=(r,e)=>r.type.bitWidth<64?er(r,e):_l(r,e),JI=(r,e)=>r.type.precision!==gt.Precision.HALF?er(r,e):Ty(r,e),KI=(r,e)=>r.type.unit===gt.DateUnit.DAY?gy(r,e):wy(r,e),By=({values:r},e)=>1e3*ml(r,e*2),vy=({values:r},e)=>ml(r,e*2),Iy=({values:r},e)=>xI(r,e*2),Sy=({values:r},e)=>CI(r,e*2),QI=(r,e)=>{switch(r.type.unit){case gt.TimeUnit.SECOND:return By(r,e);case gt.TimeUnit.MILLISECOND:return vy(r,e);case gt.TimeUnit.MICROSECOND:return Iy(r,e);case gt.TimeUnit.NANOSECOND:return Sy(r,e)}},Oy=({values:r,stride:e},t)=>r[e*t],Ay=({values:r,stride:e},t)=>r[e*t],Dy=({values:r},e)=>pa.BN.signed(r.subarray(2*e,2*(e+1))),Fy=({values:r},e)=>pa.BN.signed(r.subarray(2*e,2*(e+1))),ZI=(r,e)=>{switch(r.type.unit){case gt.TimeUnit.SECOND:return Oy(r,e);case gt.TimeUnit.MILLISECOND:return Ay(r,e);case gt.TimeUnit.MICROSECOND:return Dy(r,e);case gt.TimeUnit.NANOSECOND:return Fy(r,e)}},XI=({values:r},e)=>pa.BN.decimal(r.subarray(4*e,4*(e+1))),eS=(r,e)=>{let t=r.getChildAt(0),{valueOffsets:n,stride:i}=r;return t.slice(n[e*i],n[e*i+1])},tS=(r,e)=>r.bind(e),rS=(r,e)=>r.bind(e),nS=(r,e)=>r.type.mode===gt.UnionMode.Dense?Ry(r,e):Ey(r,e),Ry=(r,e)=>{let t=r.typeIdToChildIndex[r.typeIds[e]],n=r.getChildAt(t);return n?n.get(r.valueOffsets[e]):null},Ey=(r,e)=>{let t=r.typeIdToChildIndex[r.typeIds[e]],n=r.getChildAt(t);return n?n.get(e):null},iS=(r,e)=>r.getValue(r.getKey(e)),sS=(r,e)=>r.type.unit===gt.IntervalUnit.DAY_TIME?Uy(r,e):My(r,e),Uy=({values:r},e)=>r.subarray(2*e,2*(e+1)),My=({values:r},e)=>{let t=r[e],n=new Int32Array(2);return n[0]=t/12|0,n[1]=t%12|0,n},oS=(r,e)=>{let t=r.getChildAt(0),{stride:n}=r;return t.slice(e*n,(e+1)*n)};V.prototype.visitNull=WI;V.prototype.visitBool=zI;V.prototype.visitInt=$I;V.prototype.visitInt8=er;V.prototype.visitInt16=er;V.prototype.visitInt32=er;V.prototype.visitInt64=_l;V.prototype.visitUint8=er;V.prototype.visitUint16=er;V.prototype.visitUint32=er;V.prototype.visitUint64=_l;V.prototype.visitFloat=JI;V.prototype.visitFloat16=Ty;V.prototype.visitFloat32=er;V.prototype.visitFloat64=er;V.prototype.visitUtf8=GI;V.prototype.visitBinary=HI;V.prototype.visitFixedSizeBinary=YI;V.prototype.visitDate=KI;V.prototype.visitDateDay=gy;V.prototype.visitDateMillisecond=wy;V.prototype.visitTimestamp=QI;V.prototype.visitTimestampSecond=By;V.prototype.visitTimestampMillisecond=vy;V.prototype.visitTimestampMicrosecond=Iy;V.prototype.visitTimestampNanosecond=Sy;V.prototype.visitTime=ZI;V.prototype.visitTimeSecond=Oy;V.prototype.visitTimeMillisecond=Ay;V.prototype.visitTimeMicrosecond=Dy;V.prototype.visitTimeNanosecond=Fy;V.prototype.visitDecimal=XI;V.prototype.visitList=eS;V.prototype.visitStruct=rS;V.prototype.visitUnion=nS;V.prototype.visitDenseUnion=Ry;V.prototype.visitSparseUnion=Ey;V.prototype.visitDictionary=iS;V.prototype.visitInterval=sS;V.prototype.visitIntervalDayTime=Uy;V.prototype.visitIntervalYearMonth=My;V.prototype.visitFixedSizeList=oS;V.prototype.visitMap=tS;ni.instance=new V});var ky=w(ii=>{"use strict";Object.defineProperty(ii,"__esModule",{value:!0});ii.instance=ii.IndexOfVisitor=void 0;var aS=We(),Py=Lt(),Vy=xi(),N=class extends aS.Visitor{};ii.IndexOfVisitor=N;function uS(r,e){return e===null&&r.length>0?0:-1}function cS(r,e){let{nullBitmap:t}=r.data;if(!t||r.nullCount<=0)return-1;let n=0;for(let i of Py.iterateBits(t,r.data.offset+(e||0),r.length,t,Py.getBool)){if(!i)return n;++n}return-1}function Q(r,e,t){if(e===void 0)return-1;if(e===null)return cS(r,t);let n=Vy.createElementComparator(e);for(let i=(t||0)-1,o=r.length;++i<o;)if(n(r.get(i)))return i;return-1}function Ny(r,e,t){let n=Vy.createElementComparator(e);for(let i=(t||0)-1,o=r.length;++i<o;)if(n(r.get(i)))return i;return-1}N.prototype.visitNull=uS;N.prototype.visitBool=Q;N.prototype.visitInt=Q;N.prototype.visitInt8=Q;N.prototype.visitInt16=Q;N.prototype.visitInt32=Q;N.prototype.visitInt64=Q;N.prototype.visitUint8=Q;N.prototype.visitUint16=Q;N.prototype.visitUint32=Q;N.prototype.visitUint64=Q;N.prototype.visitFloat=Q;N.prototype.visitFloat16=Q;N.prototype.visitFloat32=Q;N.prototype.visitFloat64=Q;N.prototype.visitUtf8=Q;N.prototype.visitBinary=Q;N.prototype.visitFixedSizeBinary=Q;N.prototype.visitDate=Q;N.prototype.visitDateDay=Q;N.prototype.visitDateMillisecond=Q;N.prototype.visitTimestamp=Q;N.prototype.visitTimestampSecond=Q;N.prototype.visitTimestampMillisecond=Q;N.prototype.visitTimestampMicrosecond=Q;N.prototype.visitTimestampNanosecond=Q;N.prototype.visitTime=Q;N.prototype.visitTimeSecond=Q;N.prototype.visitTimeMillisecond=Q;N.prototype.visitTimeMicrosecond=Q;N.prototype.visitTimeNanosecond=Q;N.prototype.visitDecimal=Q;N.prototype.visitList=Q;N.prototype.visitStruct=Q;N.prototype.visitUnion=Q;N.prototype.visitDenseUnion=Ny;N.prototype.visitSparseUnion=Ny;N.prototype.visitDictionary=Q;N.prototype.visitInterval=Q;N.prototype.visitIntervalDayTime=Q;N.prototype.visitIntervalYearMonth=Q;N.prototype.visitFixedSizeList=Q;N.prototype.visitMap=Q;ii.instance=new N});var wl=w(si=>{"use strict";Object.defineProperty(si,"__esModule",{value:!0});si.instance=si.IteratorVisitor=void 0;var ya=de(),lS=We(),dS=Lt(),Ly=gl(),k=class extends lS.Visitor{};si.IteratorVisitor=k;function fS(r){let e=Ly.instance.getVisitFn(r);return dS.iterateBits(r.data.nullBitmap,r.data.offset,r.length,r,(t,n,i,o)=>(i&1<<o)!=0?e(t,n):null)}function G(r){if(r.nullCount>0)return fS(r);let{type:e,typeId:t,length:n}=r;return r.stride===1&&(t===ya.Type.Timestamp||t===ya.Type.Int&&e.bitWidth!==64||t===ya.Type.Time&&e.bitWidth!==64||t===ya.Type.Float&&e.precision>0)?r.data.values.subarray(0,n)[Symbol.iterator]():function*(i){for(let o=-1;++o<n;)yield i(r,o)}(Ly.instance.getVisitFn(r))}k.prototype.visitNull=G;k.prototype.visitBool=G;k.prototype.visitInt=G;k.prototype.visitInt8=G;k.prototype.visitInt16=G;k.prototype.visitInt32=G;k.prototype.visitInt64=G;k.prototype.visitUint8=G;k.prototype.visitUint16=G;k.prototype.visitUint32=G;k.prototype.visitUint64=G;k.prototype.visitFloat=G;k.prototype.visitFloat16=G;k.prototype.visitFloat32=G;k.prototype.visitFloat64=G;k.prototype.visitUtf8=G;k.prototype.visitBinary=G;k.prototype.visitFixedSizeBinary=G;k.prototype.visitDate=G;k.prototype.visitDateDay=G;k.prototype.visitDateMillisecond=G;k.prototype.visitTimestamp=G;k.prototype.visitTimestampSecond=G;k.prototype.visitTimestampMillisecond=G;k.prototype.visitTimestampMicrosecond=G;k.prototype.visitTimestampNanosecond=G;k.prototype.visitTime=G;k.prototype.visitTimeSecond=G;k.prototype.visitTimeMillisecond=G;k.prototype.visitTimeMicrosecond=G;k.prototype.visitTimeNanosecond=G;k.prototype.visitDecimal=G;k.prototype.visitList=G;k.prototype.visitStruct=G;k.prototype.visitUnion=G;k.prototype.visitDenseUnion=G;k.prototype.visitSparseUnion=G;k.prototype.visitDictionary=G;k.prototype.visitInterval=G;k.prototype.visitIntervalDayTime=G;k.prototype.visitIntervalYearMonth=G;k.prototype.visitFixedSizeList=G;k.prototype.visitMap=G;si.instance=new k});var xy=w(oi=>{"use strict";Object.defineProperty(oi,"__esModule",{value:!0});oi.instance=oi.ToArrayVisitor=void 0;var Xi=de(),hS=We(),pS=wl(),L=class extends hS.Visitor{};oi.ToArrayVisitor=L;function $(r){let{type:e,length:t,stride:n}=r;switch(e.typeId){case Xi.Type.Int:case Xi.Type.Float:case Xi.Type.Decimal:case Xi.Type.Time:case Xi.Type.Timestamp:return r.data.values.subarray(0,t*n)}return[...pS.instance.visit(r)]}L.prototype.visitNull=$;L.prototype.visitBool=$;L.prototype.visitInt=$;L.prototype.visitInt8=$;L.prototype.visitInt16=$;L.prototype.visitInt32=$;L.prototype.visitInt64=$;L.prototype.visitUint8=$;L.prototype.visitUint16=$;L.prototype.visitUint32=$;L.prototype.visitUint64=$;L.prototype.visitFloat=$;L.prototype.visitFloat16=$;L.prototype.visitFloat32=$;L.prototype.visitFloat64=$;L.prototype.visitUtf8=$;L.prototype.visitBinary=$;L.prototype.visitFixedSizeBinary=$;L.prototype.visitDate=$;L.prototype.visitDateDay=$;L.prototype.visitDateMillisecond=$;L.prototype.visitTimestamp=$;L.prototype.visitTimestampSecond=$;L.prototype.visitTimestampMillisecond=$;L.prototype.visitTimestampMicrosecond=$;L.prototype.visitTimestampNanosecond=$;L.prototype.visitTime=$;L.prototype.visitTimeSecond=$;L.prototype.visitTimeMillisecond=$;L.prototype.visitTimeMicrosecond=$;L.prototype.visitTimeNanosecond=$;L.prototype.visitDecimal=$;L.prototype.visitList=$;L.prototype.visitStruct=$;L.prototype.visitUnion=$;L.prototype.visitDenseUnion=$;L.prototype.visitSparseUnion=$;L.prototype.visitDictionary=$;L.prototype.visitInterval=$;L.prototype.visitIntervalDayTime=$;L.prototype.visitIntervalYearMonth=$;L.prototype.visitFixedSizeList=$;L.prototype.visitMap=$;oi.instance=new L});var Cy=w(ai=>{"use strict";Object.defineProperty(ai,"__esModule",{value:!0});ai.instance=ai.ByteWidthVisitor=void 0;var yS=We(),bS=de(),es=(r,e)=>r+e,Tl=r=>`Cannot compute the byte width of variable-width column ${r}`,Bl=class extends yS.Visitor{visitNull(e){return 0}visitInt(e){return e.bitWidth/8}visitFloat(e){return e.ArrayType.BYTES_PER_ELEMENT}visitBinary(e){throw new Error(Tl(e))}visitUtf8(e){throw new Error(Tl(e))}visitBool(e){return 1/8}visitDecimal(e){return 16}visitDate(e){return(e.unit+1)*4}visitTime(e){return e.bitWidth/8}visitTimestamp(e){return e.unit===bS.TimeUnit.SECOND?4:8}visitInterval(e){return(e.unit+1)*4}visitList(e){throw new Error(Tl(e))}visitStruct(e){return this.visitFields(e.children).reduce(es,0)}visitUnion(e){return this.visitFields(e.children).reduce(es,0)}visitFixedSizeBinary(e){return e.byteWidth}visitFixedSizeList(e){return e.listSize*this.visitFields(e.children).reduce(es,0)}visitMap(e){return this.visitFields(e.children).reduce(es,0)}visitDictionary(e){return this.visit(e.indices)}visitFields(e){return(e||[]).map(t=>this.visit(t.type))}visitSchema(e){return this.visitFields(e.fields).reduce(es,0)}};ai.ByteWidthVisitor=Bl;ai.instance=new Bl});var jy=w(ui=>{"use strict";Object.defineProperty(ui,"__esModule",{value:!0});ui.instance=ui.GetVectorConstructor=void 0;var mS=We(),_S=qc(),gS=Wc(),vl=Yc(),wS=Hc(),TS=na(),BS=$c(),vS=Jc(),ba=Xc(),Il=el(),hr=aa(),IS=cl(),SS=ll(),OS=dl(),AS=fl(),ts=hl(),rs=pl(),Sl=yl(),DS=bl(),Ol=class extends mS.Visitor{visitNull(){return OS.NullVector}visitBool(){return gS.BoolVector}visitInt(){return hr.IntVector}visitInt8(){return hr.Int8Vector}visitInt16(){return hr.Int16Vector}visitInt32(){return hr.Int32Vector}visitInt64(){return hr.Int64Vector}visitUint8(){return hr.Uint8Vector}visitUint16(){return hr.Uint16Vector}visitUint32(){return hr.Uint32Vector}visitUint64(){return hr.Uint64Vector}visitFloat(){return ba.FloatVector}visitFloat16(){return ba.Float16Vector}visitFloat32(){return ba.Float32Vector}visitFloat64(){return ba.Float64Vector}visitUtf8(){return DS.Utf8Vector}visitBinary(){return _S.BinaryVector}visitFixedSizeBinary(){return BS.FixedSizeBinaryVector}visitDate(){return vl.DateVector}visitDateDay(){return vl.DateDayVector}visitDateMillisecond(){return vl.DateMillisecondVector}visitTimestamp(){return ts.TimestampVector}visitTimestampSecond(){return ts.TimestampSecondVector}visitTimestampMillisecond(){return ts.TimestampMillisecondVector}visitTimestampMicrosecond(){return ts.TimestampMicrosecondVector}visitTimestampNanosecond(){return ts.TimestampNanosecondVector}visitTime(){return rs.TimeVector}visitTimeSecond(){return rs.TimeSecondVector}visitTimeMillisecond(){return rs.TimeMillisecondVector}visitTimeMicrosecond(){return rs.TimeMicrosecondVector}visitTimeNanosecond(){return rs.TimeNanosecondVector}visitDecimal(){return wS.DecimalVector}visitList(){return IS.ListVector}visitStruct(){return AS.StructVector}visitUnion(){return Sl.UnionVector}visitDenseUnion(){return Sl.DenseUnionVector}visitSparseUnion(){return Sl.SparseUnionVector}visitDictionary(){return TS.DictionaryVector}visitInterval(){return Il.IntervalVector}visitIntervalDayTime(){return Il.IntervalDayTimeVector}visitIntervalYearMonth(){return Il.IntervalYearMonthVector}visitFixedSizeList(){return vS.FixedSizeListVector}visitMap(){return SS.MapVector}};ui.GetVectorConstructor=Ol;ui.instance=new Ol});var Qt=w(T=>{"use strict";Object.defineProperty(T,"__esModule",{value:!0});T.vectorFromValuesWithType=T.StructRow=T.MapRow=T.Utf8Vector=T.SparseUnionVector=T.DenseUnionVector=T.UnionVector=T.TimeNanosecondVector=T.TimeMicrosecondVector=T.TimeMillisecondVector=T.TimeSecondVector=T.TimeVector=T.TimestampNanosecondVector=T.TimestampMicrosecondVector=T.TimestampMillisecondVector=T.TimestampSecondVector=T.TimestampVector=T.StructVector=T.NullVector=T.MapVector=T.ListVector=T.Uint64Vector=T.Uint32Vector=T.Uint16Vector=T.Uint8Vector=T.Int64Vector=T.Int32Vector=T.Int16Vector=T.Int8Vector=T.IntVector=T.IntervalYearMonthVector=T.IntervalDayTimeVector=T.IntervalVector=T.Float64Vector=T.Float32Vector=T.Float16Vector=T.FloatVector=T.FixedSizeListVector=T.FixedSizeBinaryVector=T.DictionaryVector=T.DecimalVector=T.DateMillisecondVector=T.DateDayVector=T.DateVector=T.Chunked=T.BoolVector=T.BinaryVector=T.BaseVector=T.Vector=void 0;var FS=ve();Object.defineProperty(T,"Vector",{enumerable:!0,get:function(){return FS.Vector}});var RS=Ie();Object.defineProperty(T,"BaseVector",{enumerable:!0,get:function(){return RS.BaseVector}});var ES=qc();Object.defineProperty(T,"BinaryVector",{enumerable:!0,get:function(){return ES.BinaryVector}});var US=Wc();Object.defineProperty(T,"BoolVector",{enumerable:!0,get:function(){return US.BoolVector}});var MS=Sr();Object.defineProperty(T,"Chunked",{enumerable:!0,get:function(){return MS.Chunked}});var Al=Yc();Object.defineProperty(T,"DateVector",{enumerable:!0,get:function(){return Al.DateVector}});Object.defineProperty(T,"DateDayVector",{enumerable:!0,get:function(){return Al.DateDayVector}});Object.defineProperty(T,"DateMillisecondVector",{enumerable:!0,get:function(){return Al.DateMillisecondVector}});var PS=Hc();Object.defineProperty(T,"DecimalVector",{enumerable:!0,get:function(){return PS.DecimalVector}});var VS=na();Object.defineProperty(T,"DictionaryVector",{enumerable:!0,get:function(){return VS.DictionaryVector}});var NS=$c();Object.defineProperty(T,"FixedSizeBinaryVector",{enumerable:!0,get:function(){return NS.FixedSizeBinaryVector}});var kS=Jc();Object.defineProperty(T,"FixedSizeListVector",{enumerable:!0,get:function(){return kS.FixedSizeListVector}});var ma=Xc();Object.defineProperty(T,"FloatVector",{enumerable:!0,get:function(){return ma.FloatVector}});Object.defineProperty(T,"Float16Vector",{enumerable:!0,get:function(){return ma.Float16Vector}});Object.defineProperty(T,"Float32Vector",{enumerable:!0,get:function(){return ma.Float32Vector}});Object.defineProperty(T,"Float64Vector",{enumerable:!0,get:function(){return ma.Float64Vector}});var Dl=el();Object.defineProperty(T,"IntervalVector",{enumerable:!0,get:function(){return Dl.IntervalVector}});Object.defineProperty(T,"IntervalDayTimeVector",{enumerable:!0,get:function(){return Dl.IntervalDayTimeVector}});Object.defineProperty(T,"IntervalYearMonthVector",{enumerable:!0,get:function(){return Dl.IntervalYearMonthVector}});var pr=aa();Object.defineProperty(T,"IntVector",{enumerable:!0,get:function(){return pr.IntVector}});Object.defineProperty(T,"Int8Vector",{enumerable:!0,get:function(){return pr.Int8Vector}});Object.defineProperty(T,"Int16Vector",{enumerable:!0,get:function(){return pr.Int16Vector}});Object.defineProperty(T,"Int32Vector",{enumerable:!0,get:function(){return pr.Int32Vector}});Object.defineProperty(T,"Int64Vector",{enumerable:!0,get:function(){return pr.Int64Vector}});Object.defineProperty(T,"Uint8Vector",{enumerable:!0,get:function(){return pr.Uint8Vector}});Object.defineProperty(T,"Uint16Vector",{enumerable:!0,get:function(){return pr.Uint16Vector}});Object.defineProperty(T,"Uint32Vector",{enumerable:!0,get:function(){return pr.Uint32Vector}});Object.defineProperty(T,"Uint64Vector",{enumerable:!0,get:function(){return pr.Uint64Vector}});var LS=cl();Object.defineProperty(T,"ListVector",{enumerable:!0,get:function(){return LS.ListVector}});var xS=ll();Object.defineProperty(T,"MapVector",{enumerable:!0,get:function(){return xS.MapVector}});var CS=dl();Object.defineProperty(T,"NullVector",{enumerable:!0,get:function(){return CS.NullVector}});var jS=fl();Object.defineProperty(T,"StructVector",{enumerable:!0,get:function(){return jS.StructVector}});var ns=hl();Object.defineProperty(T,"TimestampVector",{enumerable:!0,get:function(){return ns.TimestampVector}});Object.defineProperty(T,"TimestampSecondVector",{enumerable:!0,get:function(){return ns.TimestampSecondVector}});Object.defineProperty(T,"TimestampMillisecondVector",{enumerable:!0,get:function(){return ns.TimestampMillisecondVector}});Object.defineProperty(T,"TimestampMicrosecondVector",{enumerable:!0,get:function(){return ns.TimestampMicrosecondVector}});Object.defineProperty(T,"TimestampNanosecondVector",{enumerable:!0,get:function(){return ns.TimestampNanosecondVector}});var is=pl();Object.defineProperty(T,"TimeVector",{enumerable:!0,get:function(){return is.TimeVector}});Object.defineProperty(T,"TimeSecondVector",{enumerable:!0,get:function(){return is.TimeSecondVector}});Object.defineProperty(T,"TimeMillisecondVector",{enumerable:!0,get:function(){return is.TimeMillisecondVector}});Object.defineProperty(T,"TimeMicrosecondVector",{enumerable:!0,get:function(){return is.TimeMicrosecondVector}});Object.defineProperty(T,"TimeNanosecondVector",{enumerable:!0,get:function(){return is.TimeNanosecondVector}});var Fl=yl();Object.defineProperty(T,"UnionVector",{enumerable:!0,get:function(){return Fl.UnionVector}});Object.defineProperty(T,"DenseUnionVector",{enumerable:!0,get:function(){return Fl.DenseUnionVector}});Object.defineProperty(T,"SparseUnionVector",{enumerable:!0,get:function(){return Fl.SparseUnionVector}});var qS=bl();Object.defineProperty(T,"Utf8Vector",{enumerable:!0,get:function(){return qS.Utf8Vector}});var qy=ki();Object.defineProperty(T,"MapRow",{enumerable:!0,get:function(){return qy.MapRow}});Object.defineProperty(T,"StructRow",{enumerable:!0,get:function(){return qy.StructRow}});var ss=by(),Rl=de(),ci=ve(),Wy=Sr(),fn=Ie(),WS=Lt(),_a=He(),zy=we(),Yy=gl(),Hy=$u(),Gy=ky(),$y=xy(),Jy=wl(),Ky=Cy(),Qy=jy();ci.Vector.new=zS;ci.Vector.from=HS;function zS(r,...e){return new(Qy.instance.getVisitFn(r)())(r,...e)}function YS(r,e){if(_a.isIterable(e))return ci.Vector.from({nullValues:[null,void 0],type:r(),values:e});if(_a.isAsyncIterable(e))return ci.Vector.from({nullValues:[null,void 0],type:r(),values:e});let{values:t=[],type:n=r(),nullValues:i=[null,void 0]}={...e};return _a.isIterable(t)?ci.Vector.from({nullValues:i,...e,type:n}):ci.Vector.from({nullValues:i,...e,type:n})}T.vectorFromValuesWithType=YS;function HS(r){let{values:e=[],...t}={nullValues:[null,void 0],...r};if(_a.isIterable(e)){let n=[...zy.Builder.throughIterable(t)(e)];return n.length===1?n[0]:Wy.Chunked.concat(n)}return(async n=>{let i=zy.Builder.throughAsyncIterable(t);for await(let o of i(e))n.push(o);return n.length===1?n[0]:Wy.Chunked.concat(n)})([])}fn.BaseVector.prototype.get=function(e){return Yy.instance.visit(this,e)};fn.BaseVector.prototype.set=function(e,t){return Hy.instance.visit(this,e,t)};fn.BaseVector.prototype.indexOf=function(e,t){return Gy.instance.visit(this,e,t)};fn.BaseVector.prototype.toArray=function(){return $y.instance.visit(this)};fn.BaseVector.prototype.getByteWidth=function(){return Ky.instance.visit(this.type)};fn.BaseVector.prototype[Symbol.iterator]=function(){return Jy.instance.visit(this)};fn.BaseVector.prototype._bindDataAccessors=KS;Object.keys(Rl.Type).map(r=>Rl.Type[r]).filter(r=>typeof r=="number").filter(r=>r!==Rl.Type.NONE).forEach(r=>{let e=Qy.instance.visit(r);e.prototype.get=ss.partial1(Yy.instance.getVisitFn(r)),e.prototype.set=ss.partial2(Hy.instance.getVisitFn(r)),e.prototype.indexOf=ss.partial2(Gy.instance.getVisitFn(r)),e.prototype.toArray=ss.partial0($y.instance.getVisitFn(r)),e.prototype.getByteWidth=GS(Ky.instance.getVisitFn(r)),e.prototype[Symbol.iterator]=ss.partial0(Jy.instance.getVisitFn(r))});function GS(r){return function(){return r(this.type)}}function $S(r){return function(e){return this.isValid(e)?r.call(this,e):null}}function JS(r){return function(e,t){WS.setBool(this.nullBitmap,this.offset+e,t!=null)&&r.call(this,e,t)}}function KS(){let r=this.nullBitmap;r&&r.byteLength>0&&(this.get=$S(this.get),this.set=JS(this.set))}});var Qi=w(ga=>{"use strict";Object.defineProperty(ga,"__esModule",{value:!0});ga.Table=void 0;var QS=xn(),Zy=Le(),El=fr(),ZS=os(),Ul=oe(),Xy=Or(),Ml=He(),eb=Ko(),tb=xc(),Pl=Qt(),je=class extends Pl.Chunked{constructor(...e){let t=null;e[0]instanceof Zy.Schema&&(t=e.shift());let n=Xy.selectArgs(El.RecordBatch,e);if(!t&&!(t=n[0]&&n[0].schema))throw new TypeError("Table must be initialized with a Schema or at least one RecordBatch");n[0]||(n[0]=new El._InternalEmptyPlaceholderRecordBatch(t));super(new Ul.Struct(t.fields),n);this._schema=t,this._chunks=n}static empty(e=new Zy.Schema([])){return new je(e,[])}static from(e){if(!e)return je.empty();if(typeof e=="object"){let n=Ml.isIterable(e.values)?XS(e):Ml.isAsyncIterable(e.values)?eO(e):null;if(n!==null)return n}let t=ZS.RecordBatchReader.from(e);return Ml.isPromise(t)?(async()=>await je.from(await t))():t.isSync()&&(t=t.open())?t.schema?new je(t.schema,[...t]):je.empty():(async n=>{let i=await n,o=i.schema,a=[];if(o){for await(let u of i)a.push(u);return new je(o,a)}return je.empty()})(t.open())}static async fromAsync(e){return await je.from(e)}static fromStruct(e){return je.new(e.data.childData,e.type.children)}static new(...e){return new je(...tb.distributeColumnsIntoRecordBatches(Xy.selectColumnArgs(e)))}get schema(){return this._schema}get length(){return this._length}get chunks(){return this._chunks}get numCols(){return this._numChildren}clone(e=this._chunks){return new je(this._schema,e)}getColumn(e){return this.getColumnAt(this.getColumnIndex(e))}getColumnAt(e){return this.getChildAt(e)}getColumnIndex(e){return this._schema.fields.findIndex(t=>t.name===e)}getChildAt(e){if(e<0||e>=this.numChildren)return null;let t,n,i=this._schema.fields,o=this._children||(this._children=[]);if(n=o[e])return n;if(t=i[e]){let a=this._chunks.map(u=>u.getChildAt(e)).filter(u=>u!=null);if(a.length>0)return o[e]=new QS.Column(t,a)}return null}serialize(e="binary",t=!0){return(t?eb.RecordBatchStreamWriter:eb.RecordBatchFileWriter).writeAll(this).toUint8Array(!0)}count(){return this._length}select(...e){let t=this._schema.fields.reduce((n,i,o)=>n.set(i.name,o),new Map);return this.selectAt(...e.map(n=>t.get(n)).filter(n=>n>-1))}selectAt(...e){let t=this._schema.selectAt(...e);return new je(t,this._chunks.map(({length:n,data:{childData:i}})=>new El.RecordBatch(t,n,e.map(o=>i[o]).filter(Boolean))))}assign(e){let t=this._schema.fields,[n,i]=e.schema.fields.reduce((u,f,s)=>{let[c,_]=u,U=t.findIndex(J=>J.name===f.name);return~U?_[U]=s:c.push(s),u},[[],[]]),o=this._schema.assign(e.schema),a=[...t.map((u,f,s,c=i[f])=>c===void 0?this.getColumnAt(f):e.getColumnAt(c)),...n.map(u=>e.getColumnAt(u))].filter(Boolean);return new je(...tb.distributeVectorsIntoRecordBatches(o,a))}};ga.Table=je;function XS(r){let{type:e}=r;return e instanceof Ul.Struct?je.fromStruct(Pl.StructVector.from(r)):null}function eO(r){let{type:e}=r;return e instanceof Ul.Struct?Pl.StructVector.from(r).then(t=>je.fromStruct(t)):null}});var fr=w(li=>{"use strict";Object.defineProperty(li,"__esModule",{value:!0});li._InternalEmptyPlaceholderRecordBatch=li.RecordBatch=void 0;var Vl=St(),Nl=Qi(),tO=ve(),rO=We(),nO=Le(),iO=He(),sO=Sr(),oO=Or(),kl=oe(),aO=xc(),uO=Qt(),Hr=class extends uO.StructVector{constructor(...e){let t,n=e[0],i;if(e[1]instanceof Vl.Data)[,t,i]=e;else{let o=n.fields,[,a,u]=e;t=Vl.Data.Struct(new kl.Struct(o),0,a,0,null,u)}super(t,i);this._schema=n}static from(e){return iO.isIterable(e.values),Nl.Table.from(e)}static new(...e){let[t,n]=oO.selectFieldArgs(e),i=n.filter(o=>o instanceof tO.Vector);return new Hr(...aO.ensureSameLengthData(new nO.Schema(t),i.map(o=>o.data)))}clone(e,t=this._children){return new Hr(this._schema,e,t)}concat(...e){let t=this._schema,n=sO.Chunked.flatten(this,...e);return new Nl.Table(t,n.map(({data:i})=>new Hr(t,i)))}get schema(){return this._schema}get numCols(){return this._schema.fields.length}get dictionaries(){return this._dictionaries||(this._dictionaries=wa.collect(this))}select(...e){let t=this._schema.fields.reduce((n,i,o)=>n.set(i.name,o),new Map);return this.selectAt(...e.map(n=>t.get(n)).filter(n=>n>-1))}selectAt(...e){let t=this._schema.selectAt(...e),n=e.map(i=>this.data.childData[i]).filter(Boolean);return new Hr(t,this.length,n)}};li.RecordBatch=Hr;var rb=class extends Hr{constructor(e){super(e,0,e.fields.map(t=>Vl.Data.new(t.type,0,0,0)))}};li._InternalEmptyPlaceholderRecordBatch=rb;var wa=class extends rO.Visitor{constructor(){super(...arguments);this.dictionaries=new Map}static collect(e){return new wa().visit(e.data,new kl.Struct(e.schema.fields)).dictionaries}visit(e,t){return kl.DataType.isDictionary(t)?this.visitDictionary(e,t):(e.childData.forEach((n,i)=>this.visit(n,t.children[i].type)),this)}visitDictionary(e,t){let n=e.dictionary;return n&&n.length>0&&this.dictionaries.set(t.id,n),this}}});var os=w(Bt=>{"use strict";Object.defineProperty(Bt,"__esModule",{value:!0});Bt.AsyncRecordBatchFileReader=Bt.RecordBatchFileReader=Bt.AsyncRecordBatchStreamReader=Bt.RecordBatchStreamReader=Bt.RecordBatchReader=void 0;var nb=ve(),Ta=de(),ib=oc(),sb=Oi(),ob=Pr(),as=cc(),ab=ep(),Ll=fr(),hn=vn(),wt=Co(),Tt=He(),tr=class extends hn.ReadableInterop{constructor(e){super();this._impl=e}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(e){return this._impl.throw(e)}return(e){return this._impl.return(e)}cancel(){return this._impl.cancel()}reset(e){return this._impl.reset(e),this._DOMStream=void 0,this._nodeStream=void 0,this}open(e){let t=this._impl.open(e);return Tt.isPromise(t)?t.then(()=>this):this}readRecordBatch(e){return this._impl.isFile()?this._impl.readRecordBatch(e):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return sb.default.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return sb.default.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e,t){throw new Error('"throughDOM" not available in this environment')}static from(e){return e instanceof tr?e:Tt.isArrowJSON(e)?cO(e):Tt.isFileHandle(e)?fO(e):Tt.isPromise(e)?(async()=>await tr.from(await e))():Tt.isFetchResponse(e)||Tt.isReadableDOMStream(e)||Tt.isReadableNodeStream(e)||Tt.isAsyncIterable(e)?dO(new ob.AsyncByteStream(e)):lO(new ob.ByteStream(e))}static readAll(e){return e instanceof tr?e.isSync()?db(e):fb(e):Tt.isArrowJSON(e)||ArrayBuffer.isView(e)||Tt.isIterable(e)||Tt.isIteratorResult(e)?db(e):fb(e)}};Bt.RecordBatchReader=tr;var di=class extends tr{constructor(e){super(e);this._impl=e}[Symbol.iterator](){return this._impl[Symbol.iterator]()}async*[Symbol.asyncIterator](){yield*this[Symbol.iterator]()}};Bt.RecordBatchStreamReader=di;var fi=class extends tr{constructor(e){super(e);this._impl=e}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}};Bt.AsyncRecordBatchStreamReader=fi;var Ba=class extends di{constructor(e){super(e);this._impl=e}};Bt.RecordBatchFileReader=Ba;var xl=class extends fi{constructor(e){super(e);this._impl=e}};Bt.AsyncRecordBatchFileReader=xl;var Cl=class{constructor(e=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=e}get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(e){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=e,this.dictionaries=new Map,this}_loadRecordBatch(e,t){return new Ll.RecordBatch(this.schema,e.length,this._loadVectors(e,t,this.schema.fields))}_loadDictionaryBatch(e,t){let{id:n,isDelta:i,data:o}=e,{dictionaries:a,schema:u}=this,f=a.get(n);if(i||!f){let s=u.dictionaries.get(n);return f&&i?f.concat(nb.Vector.new(this._loadVectors(o,t,[s])[0])):nb.Vector.new(this._loadVectors(o,t,[s])[0])}return f}_loadVectors(e,t,n){return new ab.VectorLoader(t,e.nodes,e.buffers,this.dictionaries).visitMany(n)}},us=class extends Cl{constructor(e,t){super(t);this._reader=Tt.isArrowJSON(e)?new wt.JSONMessageReader(this._handle=e):new wt.MessageReader(this._handle=e)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(e){return this.closed||(this.autoDestroy=lb(this,e),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(e):hn.ITERATOR_DONE}return(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(e):hn.ITERATOR_DONE}next(){if(this.closed)return hn.ITERATOR_DONE;let e,{_reader:t}=this;for(;e=this._readNextMessageAndValidate();)if(e.isSchema())this.reset(e.header());else if(e.isRecordBatch()){this._recordBatchIndex++;let n=e.header(),i=t.readMessageBody(e.bodyLength),o=this._loadRecordBatch(n,i);return{done:!1,value:o}}else if(e.isDictionaryBatch()){this._dictionaryIndex++;let n=e.header(),i=t.readMessageBody(e.bodyLength),o=this._loadDictionaryBatch(n,i);this.dictionaries.set(n.id,o)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new Ll._InternalEmptyPlaceholderRecordBatch(this.schema)}):this.return()}_readNextMessageAndValidate(e){return this._reader.readMessage(e)}},cs=class extends Cl{constructor(e,t){super(t);this._reader=new wt.AsyncMessageReader(this._handle=e)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}async cancel(){!this.closed&&(this.closed=!0)&&(await this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}async open(e){return this.closed||(this.autoDestroy=lb(this,e),this.schema||(this.schema=await this._reader.readSchema())||await this.cancel()),this}async throw(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?await this.reset()._reader.throw(e):hn.ITERATOR_DONE}async return(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?await this.reset()._reader.return(e):hn.ITERATOR_DONE}async next(){if(this.closed)return hn.ITERATOR_DONE;let e,{_reader:t}=this;for(;e=await this._readNextMessageAndValidate();)if(e.isSchema())await this.reset(e.header());else if(e.isRecordBatch()){this._recordBatchIndex++;let n=e.header(),i=await t.readMessageBody(e.bodyLength),o=this._loadRecordBatch(n,i);return{done:!1,value:o}}else if(e.isDictionaryBatch()){this._dictionaryIndex++;let n=e.header(),i=await t.readMessageBody(e.bodyLength),o=this._loadDictionaryBatch(n,i);this.dictionaries.set(n.id,o)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new Ll._InternalEmptyPlaceholderRecordBatch(this.schema)}):await this.return()}async _readNextMessageAndValidate(e){return await this._reader.readMessage(e)}},jl=class extends us{constructor(e,t){super(e instanceof as.RandomAccessFile?e:new as.RandomAccessFile(e),t)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(e){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(let t of this._footer.dictionaryBatches())t&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(e)}readRecordBatch(e){if(this.closed)return null;this._footer||this.open();let t=this._footer&&this._footer.getRecordBatch(e);if(t&&this._handle.seek(t.offset)){let n=this._reader.readMessage(Ta.MessageHeader.RecordBatch);if(n&&n.isRecordBatch()){let i=n.header(),o=this._reader.readMessageBody(n.bodyLength);return this._loadRecordBatch(i,o)}}return null}_readDictionaryBatch(e){let t=this._footer&&this._footer.getDictionaryBatch(e);if(t&&this._handle.seek(t.offset)){let n=this._reader.readMessage(Ta.MessageHeader.DictionaryBatch);if(n&&n.isDictionaryBatch()){let i=n.header(),o=this._reader.readMessageBody(n.bodyLength),a=this._loadDictionaryBatch(i,o);this.dictionaries.set(i.id,a)}}}_readFooter(){let{_handle:e}=this,t=e.size-wt.magicAndPadding,n=e.readInt32(t),i=e.readAt(t-n,n);return ib.Footer.decode(i)}_readNextMessageAndValidate(e){if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){let t=this._footer&&this._footer.getRecordBatch(this._recordBatchIndex);if(t&&this._handle.seek(t.offset))return this._reader.readMessage(e)}return null}},ub=class extends cs{constructor(e,...t){let n=typeof t[0]!="number"?t.shift():void 0,i=t[0]instanceof Map?t.shift():void 0;super(e instanceof as.AsyncRandomAccessFile?e:new as.AsyncRandomAccessFile(e,n),i)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}async open(e){if(!this.closed&&!this._footer){this.schema=(this._footer=await this._readFooter()).schema;for(let t of this._footer.dictionaryBatches())t&&await this._readDictionaryBatch(this._dictionaryIndex++)}return await super.open(e)}async readRecordBatch(e){if(this.closed)return null;this._footer||await this.open();let t=this._footer&&this._footer.getRecordBatch(e);if(t&&await this._handle.seek(t.offset)){let n=await this._reader.readMessage(Ta.MessageHeader.RecordBatch);if(n&&n.isRecordBatch()){let i=n.header(),o=await this._reader.readMessageBody(n.bodyLength);return this._loadRecordBatch(i,o)}}return null}async _readDictionaryBatch(e){let t=this._footer&&this._footer.getDictionaryBatch(e);if(t&&await this._handle.seek(t.offset)){let n=await this._reader.readMessage(Ta.MessageHeader.DictionaryBatch);if(n&&n.isDictionaryBatch()){let i=n.header(),o=await this._reader.readMessageBody(n.bodyLength),a=this._loadDictionaryBatch(i,o);this.dictionaries.set(i.id,a)}}}async _readFooter(){let{_handle:e}=this;e._pending&&await e._pending;let t=e.size-wt.magicAndPadding,n=await e.readInt32(t),i=await e.readAt(t-n,n);return ib.Footer.decode(i)}async _readNextMessageAndValidate(e){if(this._footer||await this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){let t=this._footer.getRecordBatch(this._recordBatchIndex);if(t&&await this._handle.seek(t.offset))return await this._reader.readMessage(e)}return null}},cb=class extends us{constructor(e,t){super(e,t)}_loadVectors(e,t,n){return new ab.JSONVectorLoader(t,e.nodes,e.buffers,this.dictionaries).visitMany(n)}};function lb(r,e){return e&&typeof e.autoDestroy=="boolean"?e.autoDestroy:r.autoDestroy}function*db(r){let e=tr.from(r);try{if(!e.open({autoDestroy:!1}).closed)do yield e;while(!e.reset().open().closed)}finally{e.cancel()}}async function*fb(r){let e=await tr.from(r);try{if(!(await e.open({autoDestroy:!1})).closed)do yield e;while(!(await e.reset().open()).closed)}finally{await e.cancel()}}function cO(r){return new di(new cb(r))}function lO(r){let e=r.peek(wt.magicLength+7&~7);return e&&e.byteLength>=4?wt.checkForMagicArrowString(e)?new Ba(new jl(r.read())):new di(new us(r)):new di(new us(function*(){}()))}async function dO(r){let e=await r.peek(wt.magicLength+7&~7);return e&&e.byteLength>=4?wt.checkForMagicArrowString(e)?new Ba(new jl(await r.read())):new fi(new cs(r)):new fi(new cs(async function*(){}()))}async function fO(r){let{size:e}=await r.stat(),t=new as.AsyncRandomAccessFile(r,e);return e>=wt.magicX2AndPadding&&wt.checkForMagicArrowString(await t.readAt(0,wt.magicLength+7&~7))?new xl(new ub(t)):new fi(new cs(t))}});var yb=w(va=>{"use strict";Object.defineProperty(va,"__esModule",{value:!0});va.toDOMStream=void 0;var hb=Ae(),pb=He();function hO(r,e){if(pb.isAsyncIterable(r))return yO(r,e);if(pb.isIterable(r))return pO(r,e);throw new Error("toDOMStream() must be called with an Iterable or AsyncIterable")}va.toDOMStream=hO;function pO(r,e){let t=null,n=e&&e.type==="bytes"||!1,i=e&&e.highWaterMark||2**24;return new ReadableStream({...e,start(a){o(a,t||(t=r[Symbol.iterator]()))},pull(a){t?o(a,t):a.close()},cancel(){(t&&t.return&&t.return()||!0)&&(t=null)}},{highWaterMark:n?i:void 0,...e});function o(a,u){let f,s=null,c=a.desiredSize||null;for(;!(s=u.next(n?c:null)).done;)if(ArrayBuffer.isView(s.value)&&(f=hb.toUint8Array(s.value))&&(c!=null&&n&&(c=c-f.byteLength+1),s.value=f),a.enqueue(s.value),c!=null&&--c<=0)return;a.close()}}function yO(r,e){let t=null,n=e&&e.type==="bytes"||!1,i=e&&e.highWaterMark||2**24;return new ReadableStream({...e,async start(a){await o(a,t||(t=r[Symbol.asyncIterator]()))},async pull(a){t?await o(a,t):a.close()},async cancel(){(t&&t.return&&await t.return()||!0)&&(t=null)}},{highWaterMark:n?i:void 0,...e});async function o(a,u){let f,s=null,c=a.desiredSize||null;for(;!(s=await u.next(n?c:null)).done;)if(ArrayBuffer.isView(s.value)&&(f=hb.toUint8Array(s.value))&&(c!=null&&n&&(c=c-f.byteLength+1),s.value=f),a.enqueue(s.value),c!=null&&--c<=0)return;a.close()}}});var _b=w(hi=>{"use strict";Object.defineProperty(hi,"__esModule",{value:!0});hi.BuilderTransform=hi.builderThroughDOMStream=void 0;var bO=Ao();function mO(r){return new ql(r)}hi.builderThroughDOMStream=mO;var ql=class{constructor(e){this._numChunks=0,this._finished=!1,this._bufferedSize=0;let{["readableStrategy"]:t,["writableStrategy"]:n,["queueingStrategy"]:i="count",...o}=e;this._controller=null,this._builder=bO.Builder.new(o),this._getSize=i!=="bytes"?bb:mb;let{["highWaterMark"]:a=i==="bytes"?2**14:1e3}={...t},{["highWaterMark"]:u=i==="bytes"?2**14:1e3}={...n};this.readable=new ReadableStream({cancel:()=>{this._builder.clear()},pull:f=>{this._maybeFlush(this._builder,this._controller=f)},start:f=>{this._maybeFlush(this._builder,this._controller=f)}},{highWaterMark:a,size:i!=="bytes"?bb:mb}),this.writable=new WritableStream({abort:()=>{this._builder.clear()},write:()=>{this._maybeFlush(this._builder,this._controller)},close:()=>{this._maybeFlush(this._builder.finish(),this._controller)}},{highWaterMark:u,size:f=>this._writeValueAndReturnChunkSize(f)})}_writeValueAndReturnChunkSize(e){let t=this._bufferedSize;return this._bufferedSize=this._getSize(this._builder.append(e)),this._bufferedSize-t}_maybeFlush(e,t){t!==null&&(this._bufferedSize>=t.desiredSize&&++this._numChunks&&this._enqueue(t,e.toVector()),e.finished&&((e.length>0||this._numChunks===0)&&++this._numChunks&&this._enqueue(t,e.toVector()),!this._finished&&(this._finished=!0)&&this._enqueue(t,null)))}_enqueue(e,t){this._bufferedSize=0,this._controller=null,t===null?e.close():e.enqueue(t)}};hi.BuilderTransform=ql;var bb=r=>r.length,mb=r=>r.byteLength});var gb=w(Ia=>{"use strict";Object.defineProperty(Ia,"__esModule",{value:!0});Ia.recordBatchReaderThroughDOMStream=void 0;var _O=Pr(),gO=os();function wO(r,e){let t=new _O.AsyncByteQueue,n=null,i=new ReadableStream({async cancel(){await t.close()},async start(u){await a(u,n||(n=await o()))},async pull(u){n?await a(u,n):u.close()}});return{writable:new WritableStream(t,{highWaterMark:2**14,...r}),readable:i};async function o(){return await(await gO.RecordBatchReader.from(t)).open(e)}async function a(u,f){let s=u.desiredSize,c=null;for(;!(c=await f.next()).done;)if(u.enqueue(c.value),s!=null&&--s<=0)return;u.close()}}Ia.recordBatchReaderThroughDOMStream=wO});var wb=w(Sa=>{"use strict";Object.defineProperty(Sa,"__esModule",{value:!0});Sa.recordBatchWriterThroughDOMStream=void 0;var TO=Pr();function BO(r,e){let t=new this(r),n=new TO.AsyncByteStream(t),i=new ReadableStream({type:"bytes",async cancel(){await n.cancel()},async pull(a){await o(a)},async start(a){await o(a)}},{highWaterMark:2**14,...e});return{writable:new WritableStream(t,r),readable:i};async function o(a){let u=null,f=a.desiredSize;for(;u=await n.read(f||null);)if(a.enqueue(u),f!=null&&(f-=u.byteLength)<=0)return;a.close()}}Sa.recordBatchWriterThroughDOMStream=BO});var $l=w(X=>{"use strict";Object.defineProperty(X,"__esModule",{value:!0});X.custom=X.or=X.and=X.col=X.lit=X.CustomPredicate=X.Not=X.GTeq=X.LTeq=X.Equals=X.Or=X.And=X.CombinationPredicate=X.ComparisonPredicate=X.Predicate=X.Col=X.Literal=X.Value=void 0;var vO=na(),Gr=class{eq(e){return e instanceof Gr||(e=new yr(e)),new zl(this,e)}le(e){return e instanceof Gr||(e=new yr(e)),new Yl(this,e)}ge(e){return e instanceof Gr||(e=new yr(e)),new Hl(this,e)}lt(e){return new mi(this.ge(e))}gt(e){return new mi(this.le(e))}ne(e){return new mi(this.eq(e))}};X.Value=Gr;var yr=class extends Gr{constructor(e){super();this.v=e}};X.Literal=yr;var Wl=class extends Gr{constructor(e){super();this.name=e}bind(e){if(!this.colidx){this.colidx=-1;let n=e.schema.fields;for(let i=-1;++i<n.length;)if(n[i].name===this.name){this.colidx=i;break}if(this.colidx<0)throw new Error(`Failed to bind Col "${this.name}"`)}let t=this.vector=e.getChildAt(this.colidx);return n=>t.get(n)}};X.Col=Wl;var pi=class{and(...e){return new yi(this,...e)}or(...e){return new bi(this,...e)}not(){return new mi(this)}};X.Predicate=pi;var ls=class extends pi{constructor(e,t){super();this.left=e,this.right=t}bind(e){return this.left instanceof yr?this.right instanceof yr?this._bindLitLit(e,this.left,this.right):this._bindLitCol(e,this.left,this.right):this.right instanceof yr?this._bindColLit(e,this.left,this.right):this._bindColCol(e,this.left,this.right)}};X.ComparisonPredicate=ls;var ds=class extends pi{constructor(...e){super();this.children=e}};X.CombinationPredicate=ds;ds.prototype.children=Object.freeze([]);var yi=class extends ds{constructor(...e){e=e.reduce((t,n)=>t.concat(n instanceof yi?n.children:n),[]);super(...e)}bind(e){let t=this.children.map(n=>n.bind(e));return(n,i)=>t.every(o=>o(n,i))}};X.And=yi;var bi=class extends ds{constructor(...e){e=e.reduce((t,n)=>t.concat(n instanceof bi?n.children:n),[]);super(...e)}bind(e){let t=this.children.map(n=>n.bind(e));return(n,i)=>t.some(o=>o(n,i))}};X.Or=bi;var zl=class extends ls{_bindLitLit(e,t,n){let i=t.v==n.v;return()=>i}_bindColCol(e,t,n){let i=t.bind(e),o=n.bind(e);return(a,u)=>i(a,u)==o(a,u)}_bindColLit(e,t,n){let i=t.bind(e);if(t.vector instanceof vO.DictionaryVector){let o,a=t.vector;return a.dictionary!==this.lastDictionary?(o=a.reverseLookup(n.v),this.lastDictionary=a.dictionary,this.lastKey=o):o=this.lastKey,o===-1?()=>!1:u=>a.getKey(u)===o}else return(o,a)=>i(o,a)==n.v}_bindLitCol(e,t,n){return this._bindColLit(e,n,t)}};X.Equals=zl;var Yl=class extends ls{_bindLitLit(e,t,n){let i=t.v<=n.v;return()=>i}_bindColCol(e,t,n){let i=t.bind(e),o=n.bind(e);return(a,u)=>i(a,u)<=o(a,u)}_bindColLit(e,t,n){let i=t.bind(e);return(o,a)=>i(o,a)<=n.v}_bindLitCol(e,t,n){let i=n.bind(e);return(o,a)=>t.v<=i(o,a)}};X.LTeq=Yl;var Hl=class extends ls{_bindLitLit(e,t,n){let i=t.v>=n.v;return()=>i}_bindColCol(e,t,n){let i=t.bind(e),o=n.bind(e);return(a,u)=>i(a,u)>=o(a,u)}_bindColLit(e,t,n){let i=t.bind(e);return(o,a)=>i(o,a)>=n.v}_bindLitCol(e,t,n){let i=n.bind(e);return(o,a)=>t.v>=i(o,a)}};X.GTeq=Hl;var mi=class extends pi{constructor(e){super();this.child=e}bind(e){let t=this.child.bind(e);return(n,i)=>!t(n,i)}};X.Not=mi;var Gl=class extends pi{constructor(e,t){super();this.next=e,this.bind_=t}bind(e){return this.bind_(e),this.next}};X.CustomPredicate=Gl;function IO(r){return new yr(r)}X.lit=IO;function SO(r){return new Wl(r)}X.col=SO;function OO(...r){return new yi(...r)}X.and=OO;function AO(...r){return new bi(...r)}X.or=AO;function DO(r,e){return new Gl(r,e)}X.custom=DO});var Ib=w($r=>{"use strict";Object.defineProperty($r,"__esModule",{value:!0});$r.FilteredDataFrame=$r.CountByResult=$r.DataFrame=void 0;var _i=Qi(),Tb=aa(),Jl=Le(),Bb=$l(),FO=fr(),vb=oe();_i.Table.prototype.countBy=function(r){return new pn(this.chunks).countBy(r)};_i.Table.prototype.scan=function(r,e){return new pn(this.chunks).scan(r,e)};_i.Table.prototype.scanReverse=function(r,e){return new pn(this.chunks).scanReverse(r,e)};_i.Table.prototype.filter=function(r){return new pn(this.chunks).filter(r)};var pn=class extends _i.Table{filter(e){return new fs(this.chunks,e)}scan(e,t){let n=this.chunks,i=n.length;for(let o=-1;++o<i;){let a=n[o];t&&t(a);for(let u=-1,f=a.length;++u<f;)e(u,a)}}scanReverse(e,t){let n=this.chunks,i=n.length;for(let o=i;--o>=0;){let a=n[o];t&&t(a);for(let u=a.length;--u>=0;)e(u,a)}}countBy(e){let t=this.chunks,n=t.length,i=typeof e=="string"?new Bb.Col(e):e;i.bind(t[n-1]);let o=i.vector;if(!vb.DataType.isDictionary(o.type))throw new Error("countBy currently only supports dictionary-encoded columns");let a=Math.ceil(Math.log(o.length)/Math.log(256)),u=a==4?Uint32Array:a>=2?Uint16Array:Uint8Array,f=new u(o.dictionary.length);for(let s=-1;++s<n;){let c=t[s];i.bind(c);let _=i.vector.indices;for(let U=-1,J=c.length;++U<J;){let et=_.get(U);et!==null&&f[et]++}}return new Oa(o.dictionary,Tb.IntVector.from(f))}};$r.DataFrame=pn;var Oa=class extends _i.Table{constructor(e,t){let n=new Jl.Schema([new Jl.Field("values",e.type),new Jl.Field("counts",t.type)]);super(new FO.RecordBatch(n,t.length,[e,t]))}toJSON(){let e=this.getColumnAt(0),t=this.getColumnAt(1),n={};for(let i=-1;++i<this.length;)n[e.get(i)]=t.get(i);return n}};$r.CountByResult=Oa;var fs=class extends pn{constructor(e,t){super(e);this._predicate=t}scan(e,t){let n=this._chunks,i=n.length;for(let o=-1;++o<i;){let a=n[o],u=this._predicate.bind(a),f=!1;for(let s=-1,c=a.length;++s<c;)u(s,a)&&(t&&!f&&(t(a),f=!0),e(s,a))}}scanReverse(e,t){let n=this._chunks,i=n.length;for(let o=i;--o>=0;){let a=n[o],u=this._predicate.bind(a),f=!1;for(let s=a.length;--s>=0;)u(s,a)&&(t&&!f&&(t(a),f=!0),e(s,a))}}count(){let e=0,t=this._chunks,n=t.length;for(let i=-1;++i<n;){let o=t[i],a=this._predicate.bind(o);for(let u=-1,f=o.length;++u<f;)a(u,o)&&++e}return e}*[Symbol.iterator](){let e=this._chunks,t=e.length;for(let n=-1;++n<t;){let i=e[n],o=this._predicate.bind(i);for(let a=-1,u=i.length;++a<u;)o(a,i)&&(yield i.get(a))}}filter(e){return new fs(this._chunks,this._predicate.and(e))}countBy(e){let t=this._chunks,n=t.length,i=typeof e=="string"?new Bb.Col(e):e;i.bind(t[n-1]);let o=i.vector;if(!vb.DataType.isDictionary(o.type))throw new Error("countBy currently only supports dictionary-encoded columns");let a=Math.ceil(Math.log(o.length)/Math.log(256)),u=a==4?Uint32Array:a>=2?Uint16Array:Uint8Array,f=new u(o.dictionary.length);for(let s=-1;++s<n;){let c=t[s],_=this._predicate.bind(c);i.bind(c);let U=i.vector.indices;for(let J=-1,et=c.length;++J<et;){let Ut=U.get(J);Ut!==null&&_(J,c)&&f[Ut]++}}return new Oa(o.dictionary,Tb.IntVector.from(f))}};$r.FilteredDataFrame=fs});var Ob=w(l=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0});l.util=l.predicate=l.CountByResult=l.FilteredDataFrame=l.DataFrame=l.RecordBatch=l.Message=l.JSONMessageReader=l.AsyncMessageReader=l.MessageReader=l.RecordBatchJSONWriter=l.RecordBatchStreamWriter=l.RecordBatchFileWriter=l.RecordBatchWriter=l.AsyncRecordBatchStreamReader=l.AsyncRecordBatchFileReader=l.RecordBatchStreamReader=l.RecordBatchFileReader=l.RecordBatchReader=l.AsyncByteQueue=l.AsyncByteStream=l.ByteStream=l.Utf8Builder=l.SparseUnionBuilder=l.DenseUnionBuilder=l.UnionBuilder=l.TimeNanosecondBuilder=l.TimeMicrosecondBuilder=l.TimeMillisecondBuilder=l.TimeSecondBuilder=l.TimeBuilder=l.TimestampNanosecondBuilder=l.TimestampMicrosecondBuilder=l.TimestampMillisecondBuilder=l.TimestampSecondBuilder=l.TimestampBuilder=l.StructBuilder=l.NullBuilder=l.MapBuilder=l.ListBuilder=l.Uint64Builder=l.Uint32Builder=l.Uint16Builder=l.Uint8Builder=l.Int64Builder=l.Int32Builder=l.Int16Builder=l.Int8Builder=l.IntBuilder=l.IntervalYearMonthBuilder=l.IntervalDayTimeBuilder=l.IntervalBuilder=l.Float64Builder=l.Float32Builder=l.Float16Builder=l.FloatBuilder=l.FixedSizeListBuilder=l.FixedSizeBinaryBuilder=l.DictionaryBuilder=l.DecimalBuilder=l.DateMillisecondBuilder=l.DateDayBuilder=l.DateBuilder=l.BoolBuilder=l.BinaryBuilder=l.Builder=l.Utf8Vector=l.SparseUnionVector=l.DenseUnionVector=l.UnionVector=l.TimeNanosecondVector=l.TimeMicrosecondVector=l.TimeMillisecondVector=l.TimeSecondVector=l.TimeVector=l.TimestampNanosecondVector=l.TimestampMicrosecondVector=l.TimestampMillisecondVector=l.TimestampSecondVector=l.TimestampVector=l.StructVector=l.NullVector=l.MapVector=l.ListVector=l.Uint64Vector=l.Uint32Vector=l.Uint16Vector=l.Uint8Vector=l.Int64Vector=l.Int32Vector=l.Int16Vector=l.Int8Vector=l.IntVector=l.IntervalYearMonthVector=l.IntervalDayTimeVector=l.IntervalVector=l.Float64Vector=l.Float32Vector=l.Float16Vector=l.FloatVector=l.FixedSizeListVector=l.FixedSizeBinaryVector=l.DictionaryVector=l.DecimalVector=l.DateMillisecondVector=l.DateDayVector=l.DateVector=l.Chunked=l.BoolVector=l.BinaryVector=l.BaseVector=l.Vector=l.Field=l.Schema=l.Visitor=l.Column=l.Table=l.Map_=l.FixedSizeList=l.IntervalYearMonth=l.IntervalDayTime=l.Interval=l.Dictionary=l.SparseUnion=l.DenseUnion=l.Union=l.Struct=l.List=l.Decimal=l.TimeNanosecond=l.TimeMicrosecond=l.TimeMillisecond=l.TimeSecond=l.Time=l.TimestampNanosecond=l.TimestampMicrosecond=l.TimestampMillisecond=l.TimestampSecond=l.Timestamp=l.DateMillisecond=l.DateDay=l.Date_=l.FixedSizeBinary=l.Binary=l.Utf8=l.Float64=l.Float32=l.Float16=l.Float=l.Uint64=l.Uint32=l.Uint16=l.Uint8=l.Int64=l.Int32=l.Int16=l.Int8=l.Int=l.Bool=l.Null=l.DataType=l.Data=l.BufferType=l.UnionMode=l.Type=l.TimeUnit=l.Precision=l.MetadataVersion=l.MessageHeader=l.IntervalUnit=l.DateUnit=l.ArrowType=void 0;var rr=de();Object.defineProperty(l,"ArrowType",{enumerable:!0,get:function(){return rr.ArrowType}});Object.defineProperty(l,"DateUnit",{enumerable:!0,get:function(){return rr.DateUnit}});Object.defineProperty(l,"IntervalUnit",{enumerable:!0,get:function(){return rr.IntervalUnit}});Object.defineProperty(l,"MessageHeader",{enumerable:!0,get:function(){return rr.MessageHeader}});Object.defineProperty(l,"MetadataVersion",{enumerable:!0,get:function(){return rr.MetadataVersion}});Object.defineProperty(l,"Precision",{enumerable:!0,get:function(){return rr.Precision}});Object.defineProperty(l,"TimeUnit",{enumerable:!0,get:function(){return rr.TimeUnit}});Object.defineProperty(l,"Type",{enumerable:!0,get:function(){return rr.Type}});Object.defineProperty(l,"UnionMode",{enumerable:!0,get:function(){return rr.UnionMode}});Object.defineProperty(l,"BufferType",{enumerable:!0,get:function(){return rr.BufferType}});var RO=St();Object.defineProperty(l,"Data",{enumerable:!0,get:function(){return RO.Data}});var z=oe();Object.defineProperty(l,"DataType",{enumerable:!0,get:function(){return z.DataType}});Object.defineProperty(l,"Null",{enumerable:!0,get:function(){return z.Null}});Object.defineProperty(l,"Bool",{enumerable:!0,get:function(){return z.Bool}});Object.defineProperty(l,"Int",{enumerable:!0,get:function(){return z.Int}});Object.defineProperty(l,"Int8",{enumerable:!0,get:function(){return z.Int8}});Object.defineProperty(l,"Int16",{enumerable:!0,get:function(){return z.Int16}});Object.defineProperty(l,"Int32",{enumerable:!0,get:function(){return z.Int32}});Object.defineProperty(l,"Int64",{enumerable:!0,get:function(){return z.Int64}});Object.defineProperty(l,"Uint8",{enumerable:!0,get:function(){return z.Uint8}});Object.defineProperty(l,"Uint16",{enumerable:!0,get:function(){return z.Uint16}});Object.defineProperty(l,"Uint32",{enumerable:!0,get:function(){return z.Uint32}});Object.defineProperty(l,"Uint64",{enumerable:!0,get:function(){return z.Uint64}});Object.defineProperty(l,"Float",{enumerable:!0,get:function(){return z.Float}});Object.defineProperty(l,"Float16",{enumerable:!0,get:function(){return z.Float16}});Object.defineProperty(l,"Float32",{enumerable:!0,get:function(){return z.Float32}});Object.defineProperty(l,"Float64",{enumerable:!0,get:function(){return z.Float64}});Object.defineProperty(l,"Utf8",{enumerable:!0,get:function(){return z.Utf8}});Object.defineProperty(l,"Binary",{enumerable:!0,get:function(){return z.Binary}});Object.defineProperty(l,"FixedSizeBinary",{enumerable:!0,get:function(){return z.FixedSizeBinary}});Object.defineProperty(l,"Date_",{enumerable:!0,get:function(){return z.Date_}});Object.defineProperty(l,"DateDay",{enumerable:!0,get:function(){return z.DateDay}});Object.defineProperty(l,"DateMillisecond",{enumerable:!0,get:function(){return z.DateMillisecond}});Object.defineProperty(l,"Timestamp",{enumerable:!0,get:function(){return z.Timestamp}});Object.defineProperty(l,"TimestampSecond",{enumerable:!0,get:function(){return z.TimestampSecond}});Object.defineProperty(l,"TimestampMillisecond",{enumerable:!0,get:function(){return z.TimestampMillisecond}});Object.defineProperty(l,"TimestampMicrosecond",{enumerable:!0,get:function(){return z.TimestampMicrosecond}});Object.defineProperty(l,"TimestampNanosecond",{enumerable:!0,get:function(){return z.TimestampNanosecond}});Object.defineProperty(l,"Time",{enumerable:!0,get:function(){return z.Time}});Object.defineProperty(l,"TimeSecond",{enumerable:!0,get:function(){return z.TimeSecond}});Object.defineProperty(l,"TimeMillisecond",{enumerable:!0,get:function(){return z.TimeMillisecond}});Object.defineProperty(l,"TimeMicrosecond",{enumerable:!0,get:function(){return z.TimeMicrosecond}});Object.defineProperty(l,"TimeNanosecond",{enumerable:!0,get:function(){return z.TimeNanosecond}});Object.defineProperty(l,"Decimal",{enumerable:!0,get:function(){return z.Decimal}});Object.defineProperty(l,"List",{enumerable:!0,get:function(){return z.List}});Object.defineProperty(l,"Struct",{enumerable:!0,get:function(){return z.Struct}});Object.defineProperty(l,"Union",{enumerable:!0,get:function(){return z.Union}});Object.defineProperty(l,"DenseUnion",{enumerable:!0,get:function(){return z.DenseUnion}});Object.defineProperty(l,"SparseUnion",{enumerable:!0,get:function(){return z.SparseUnion}});Object.defineProperty(l,"Dictionary",{enumerable:!0,get:function(){return z.Dictionary}});Object.defineProperty(l,"Interval",{enumerable:!0,get:function(){return z.Interval}});Object.defineProperty(l,"IntervalDayTime",{enumerable:!0,get:function(){return z.IntervalDayTime}});Object.defineProperty(l,"IntervalYearMonth",{enumerable:!0,get:function(){return z.IntervalYearMonth}});Object.defineProperty(l,"FixedSizeList",{enumerable:!0,get:function(){return z.FixedSizeList}});Object.defineProperty(l,"Map_",{enumerable:!0,get:function(){return z.Map_}});var EO=Qi();Object.defineProperty(l,"Table",{enumerable:!0,get:function(){return EO.Table}});var UO=xn();Object.defineProperty(l,"Column",{enumerable:!0,get:function(){return UO.Column}});var MO=We();Object.defineProperty(l,"Visitor",{enumerable:!0,get:function(){return MO.Visitor}});var Sb=Le();Object.defineProperty(l,"Schema",{enumerable:!0,get:function(){return Sb.Schema}});Object.defineProperty(l,"Field",{enumerable:!0,get:function(){return Sb.Field}});var x=Qt();Object.defineProperty(l,"Vector",{enumerable:!0,get:function(){return x.Vector}});Object.defineProperty(l,"BaseVector",{enumerable:!0,get:function(){return x.BaseVector}});Object.defineProperty(l,"BinaryVector",{enumerable:!0,get:function(){return x.BinaryVector}});Object.defineProperty(l,"BoolVector",{enumerable:!0,get:function(){return x.BoolVector}});Object.defineProperty(l,"Chunked",{enumerable:!0,get:function(){return x.Chunked}});Object.defineProperty(l,"DateVector",{enumerable:!0,get:function(){return x.DateVector}});Object.defineProperty(l,"DateDayVector",{enumerable:!0,get:function(){return x.DateDayVector}});Object.defineProperty(l,"DateMillisecondVector",{enumerable:!0,get:function(){return x.DateMillisecondVector}});Object.defineProperty(l,"DecimalVector",{enumerable:!0,get:function(){return x.DecimalVector}});Object.defineProperty(l,"DictionaryVector",{enumerable:!0,get:function(){return x.DictionaryVector}});Object.defineProperty(l,"FixedSizeBinaryVector",{enumerable:!0,get:function(){return x.FixedSizeBinaryVector}});Object.defineProperty(l,"FixedSizeListVector",{enumerable:!0,get:function(){return x.FixedSizeListVector}});Object.defineProperty(l,"FloatVector",{enumerable:!0,get:function(){return x.FloatVector}});Object.defineProperty(l,"Float16Vector",{enumerable:!0,get:function(){return x.Float16Vector}});Object.defineProperty(l,"Float32Vector",{enumerable:!0,get:function(){return x.Float32Vector}});Object.defineProperty(l,"Float64Vector",{enumerable:!0,get:function(){return x.Float64Vector}});Object.defineProperty(l,"IntervalVector",{enumerable:!0,get:function(){return x.IntervalVector}});Object.defineProperty(l,"IntervalDayTimeVector",{enumerable:!0,get:function(){return x.IntervalDayTimeVector}});Object.defineProperty(l,"IntervalYearMonthVector",{enumerable:!0,get:function(){return x.IntervalYearMonthVector}});Object.defineProperty(l,"IntVector",{enumerable:!0,get:function(){return x.IntVector}});Object.defineProperty(l,"Int8Vector",{enumerable:!0,get:function(){return x.Int8Vector}});Object.defineProperty(l,"Int16Vector",{enumerable:!0,get:function(){return x.Int16Vector}});Object.defineProperty(l,"Int32Vector",{enumerable:!0,get:function(){return x.Int32Vector}});Object.defineProperty(l,"Int64Vector",{enumerable:!0,get:function(){return x.Int64Vector}});Object.defineProperty(l,"Uint8Vector",{enumerable:!0,get:function(){return x.Uint8Vector}});Object.defineProperty(l,"Uint16Vector",{enumerable:!0,get:function(){return x.Uint16Vector}});Object.defineProperty(l,"Uint32Vector",{enumerable:!0,get:function(){return x.Uint32Vector}});Object.defineProperty(l,"Uint64Vector",{enumerable:!0,get:function(){return x.Uint64Vector}});Object.defineProperty(l,"ListVector",{enumerable:!0,get:function(){return x.ListVector}});Object.defineProperty(l,"MapVector",{enumerable:!0,get:function(){return x.MapVector}});Object.defineProperty(l,"NullVector",{enumerable:!0,get:function(){return x.NullVector}});Object.defineProperty(l,"StructVector",{enumerable:!0,get:function(){return x.StructVector}});Object.defineProperty(l,"TimestampVector",{enumerable:!0,get:function(){return x.TimestampVector}});Object.defineProperty(l,"TimestampSecondVector",{enumerable:!0,get:function(){return x.TimestampSecondVector}});Object.defineProperty(l,"TimestampMillisecondVector",{enumerable:!0,get:function(){return x.TimestampMillisecondVector}});Object.defineProperty(l,"TimestampMicrosecondVector",{enumerable:!0,get:function(){return x.TimestampMicrosecondVector}});Object.defineProperty(l,"TimestampNanosecondVector",{enumerable:!0,get:function(){return x.TimestampNanosecondVector}});Object.defineProperty(l,"TimeVector",{enumerable:!0,get:function(){return x.TimeVector}});Object.defineProperty(l,"TimeSecondVector",{enumerable:!0,get:function(){return x.TimeSecondVector}});Object.defineProperty(l,"TimeMillisecondVector",{enumerable:!0,get:function(){return x.TimeMillisecondVector}});Object.defineProperty(l,"TimeMicrosecondVector",{enumerable:!0,get:function(){return x.TimeMicrosecondVector}});Object.defineProperty(l,"TimeNanosecondVector",{enumerable:!0,get:function(){return x.TimeNanosecondVector}});Object.defineProperty(l,"UnionVector",{enumerable:!0,get:function(){return x.UnionVector}});Object.defineProperty(l,"DenseUnionVector",{enumerable:!0,get:function(){return x.DenseUnionVector}});Object.defineProperty(l,"SparseUnionVector",{enumerable:!0,get:function(){return x.SparseUnionVector}});Object.defineProperty(l,"Utf8Vector",{enumerable:!0,get:function(){return x.Utf8Vector}});var Y=Ao();Object.defineProperty(l,"Builder",{enumerable:!0,get:function(){return Y.Builder}});Object.defineProperty(l,"BinaryBuilder",{enumerable:!0,get:function(){return Y.BinaryBuilder}});Object.defineProperty(l,"BoolBuilder",{enumerable:!0,get:function(){return Y.BoolBuilder}});Object.defineProperty(l,"DateBuilder",{enumerable:!0,get:function(){return Y.DateBuilder}});Object.defineProperty(l,"DateDayBuilder",{enumerable:!0,get:function(){return Y.DateDayBuilder}});Object.defineProperty(l,"DateMillisecondBuilder",{enumerable:!0,get:function(){return Y.DateMillisecondBuilder}});Object.defineProperty(l,"DecimalBuilder",{enumerable:!0,get:function(){return Y.DecimalBuilder}});Object.defineProperty(l,"DictionaryBuilder",{enumerable:!0,get:function(){return Y.DictionaryBuilder}});Object.defineProperty(l,"FixedSizeBinaryBuilder",{enumerable:!0,get:function(){return Y.FixedSizeBinaryBuilder}});Object.defineProperty(l,"FixedSizeListBuilder",{enumerable:!0,get:function(){return Y.FixedSizeListBuilder}});Object.defineProperty(l,"FloatBuilder",{enumerable:!0,get:function(){return Y.FloatBuilder}});Object.defineProperty(l,"Float16Builder",{enumerable:!0,get:function(){return Y.Float16Builder}});Object.defineProperty(l,"Float32Builder",{enumerable:!0,get:function(){return Y.Float32Builder}});Object.defineProperty(l,"Float64Builder",{enumerable:!0,get:function(){return Y.Float64Builder}});Object.defineProperty(l,"IntervalBuilder",{enumerable:!0,get:function(){return Y.IntervalBuilder}});Object.defineProperty(l,"IntervalDayTimeBuilder",{enumerable:!0,get:function(){return Y.IntervalDayTimeBuilder}});Object.defineProperty(l,"IntervalYearMonthBuilder",{enumerable:!0,get:function(){return Y.IntervalYearMonthBuilder}});Object.defineProperty(l,"IntBuilder",{enumerable:!0,get:function(){return Y.IntBuilder}});Object.defineProperty(l,"Int8Builder",{enumerable:!0,get:function(){return Y.Int8Builder}});Object.defineProperty(l,"Int16Builder",{enumerable:!0,get:function(){return Y.Int16Builder}});Object.defineProperty(l,"Int32Builder",{enumerable:!0,get:function(){return Y.Int32Builder}});Object.defineProperty(l,"Int64Builder",{enumerable:!0,get:function(){return Y.Int64Builder}});Object.defineProperty(l,"Uint8Builder",{enumerable:!0,get:function(){return Y.Uint8Builder}});Object.defineProperty(l,"Uint16Builder",{enumerable:!0,get:function(){return Y.Uint16Builder}});Object.defineProperty(l,"Uint32Builder",{enumerable:!0,get:function(){return Y.Uint32Builder}});Object.defineProperty(l,"Uint64Builder",{enumerable:!0,get:function(){return Y.Uint64Builder}});Object.defineProperty(l,"ListBuilder",{enumerable:!0,get:function(){return Y.ListBuilder}});Object.defineProperty(l,"MapBuilder",{enumerable:!0,get:function(){return Y.MapBuilder}});Object.defineProperty(l,"NullBuilder",{enumerable:!0,get:function(){return Y.NullBuilder}});Object.defineProperty(l,"StructBuilder",{enumerable:!0,get:function(){return Y.StructBuilder}});Object.defineProperty(l,"TimestampBuilder",{enumerable:!0,get:function(){return Y.TimestampBuilder}});Object.defineProperty(l,"TimestampSecondBuilder",{enumerable:!0,get:function(){return Y.TimestampSecondBuilder}});Object.defineProperty(l,"TimestampMillisecondBuilder",{enumerable:!0,get:function(){return Y.TimestampMillisecondBuilder}});Object.defineProperty(l,"TimestampMicrosecondBuilder",{enumerable:!0,get:function(){return Y.TimestampMicrosecondBuilder}});Object.defineProperty(l,"TimestampNanosecondBuilder",{enumerable:!0,get:function(){return Y.TimestampNanosecondBuilder}});Object.defineProperty(l,"TimeBuilder",{enumerable:!0,get:function(){return Y.TimeBuilder}});Object.defineProperty(l,"TimeSecondBuilder",{enumerable:!0,get:function(){return Y.TimeSecondBuilder}});Object.defineProperty(l,"TimeMillisecondBuilder",{enumerable:!0,get:function(){return Y.TimeMillisecondBuilder}});Object.defineProperty(l,"TimeMicrosecondBuilder",{enumerable:!0,get:function(){return Y.TimeMicrosecondBuilder}});Object.defineProperty(l,"TimeNanosecondBuilder",{enumerable:!0,get:function(){return Y.TimeNanosecondBuilder}});Object.defineProperty(l,"UnionBuilder",{enumerable:!0,get:function(){return Y.UnionBuilder}});Object.defineProperty(l,"DenseUnionBuilder",{enumerable:!0,get:function(){return Y.DenseUnionBuilder}});Object.defineProperty(l,"SparseUnionBuilder",{enumerable:!0,get:function(){return Y.SparseUnionBuilder}});Object.defineProperty(l,"Utf8Builder",{enumerable:!0,get:function(){return Y.Utf8Builder}});var Kl=Pr();Object.defineProperty(l,"ByteStream",{enumerable:!0,get:function(){return Kl.ByteStream}});Object.defineProperty(l,"AsyncByteStream",{enumerable:!0,get:function(){return Kl.AsyncByteStream}});Object.defineProperty(l,"AsyncByteQueue",{enumerable:!0,get:function(){return Kl.AsyncByteQueue}});var hs=os();Object.defineProperty(l,"RecordBatchReader",{enumerable:!0,get:function(){return hs.RecordBatchReader}});Object.defineProperty(l,"RecordBatchFileReader",{enumerable:!0,get:function(){return hs.RecordBatchFileReader}});Object.defineProperty(l,"RecordBatchStreamReader",{enumerable:!0,get:function(){return hs.RecordBatchStreamReader}});Object.defineProperty(l,"AsyncRecordBatchFileReader",{enumerable:!0,get:function(){return hs.AsyncRecordBatchFileReader}});Object.defineProperty(l,"AsyncRecordBatchStreamReader",{enumerable:!0,get:function(){return hs.AsyncRecordBatchStreamReader}});var Aa=Ko();Object.defineProperty(l,"RecordBatchWriter",{enumerable:!0,get:function(){return Aa.RecordBatchWriter}});Object.defineProperty(l,"RecordBatchFileWriter",{enumerable:!0,get:function(){return Aa.RecordBatchFileWriter}});Object.defineProperty(l,"RecordBatchStreamWriter",{enumerable:!0,get:function(){return Aa.RecordBatchStreamWriter}});Object.defineProperty(l,"RecordBatchJSONWriter",{enumerable:!0,get:function(){return Aa.RecordBatchJSONWriter}});var Ql=Co();Object.defineProperty(l,"MessageReader",{enumerable:!0,get:function(){return Ql.MessageReader}});Object.defineProperty(l,"AsyncMessageReader",{enumerable:!0,get:function(){return Ql.AsyncMessageReader}});Object.defineProperty(l,"JSONMessageReader",{enumerable:!0,get:function(){return Ql.JSONMessageReader}});var PO=an();Object.defineProperty(l,"Message",{enumerable:!0,get:function(){return PO.Message}});var VO=fr();Object.defineProperty(l,"RecordBatch",{enumerable:!0,get:function(){return VO.RecordBatch}});var Zl=Ib();Object.defineProperty(l,"DataFrame",{enumerable:!0,get:function(){return Zl.DataFrame}});Object.defineProperty(l,"FilteredDataFrame",{enumerable:!0,get:function(){return Zl.FilteredDataFrame}});Object.defineProperty(l,"CountByResult",{enumerable:!0,get:function(){return Zl.CountByResult}});var NO=Ni(),kO=dc(),LO=Lt(),xO=Ui(),CO=Ae(),jO=xi(),qO=$l();l.predicate=qO;l.util={...NO,...kO,...LO,...xO,...CO,...jO}});var ps=w(d=>{"use strict";Object.defineProperty(d,"__esModule",{value:!0});d.Utf8Builder=d.SparseUnionBuilder=d.DenseUnionBuilder=d.UnionBuilder=d.TimeNanosecondBuilder=d.TimeMicrosecondBuilder=d.TimeMillisecondBuilder=d.TimeSecondBuilder=d.TimeBuilder=d.TimestampNanosecondBuilder=d.TimestampMicrosecondBuilder=d.TimestampMillisecondBuilder=d.TimestampSecondBuilder=d.TimestampBuilder=d.StructBuilder=d.NullBuilder=d.MapBuilder=d.ListBuilder=d.Uint64Builder=d.Uint32Builder=d.Uint16Builder=d.Uint8Builder=d.Int64Builder=d.Int32Builder=d.Int16Builder=d.Int8Builder=d.IntBuilder=d.IntervalYearMonthBuilder=d.IntervalDayTimeBuilder=d.IntervalBuilder=d.Float64Builder=d.Float32Builder=d.Float16Builder=d.FloatBuilder=d.FixedSizeListBuilder=d.FixedSizeBinaryBuilder=d.DictionaryBuilder=d.DecimalBuilder=d.DateMillisecondBuilder=d.DateDayBuilder=d.DateBuilder=d.BoolBuilder=d.BinaryBuilder=d.Builder=d.util=d.predicate=d.CountByResult=d.FilteredDataFrame=d.DataFrame=d.RecordBatch=d.Message=d.JSONMessageReader=d.AsyncMessageReader=d.MessageReader=d.RecordBatchJSONWriter=d.RecordBatchStreamWriter=d.RecordBatchFileWriter=d.RecordBatchWriter=d.AsyncRecordBatchStreamReader=d.AsyncRecordBatchFileReader=d.RecordBatchStreamReader=d.RecordBatchFileReader=d.RecordBatchReader=d.AsyncByteQueue=d.AsyncByteStream=d.ByteStream=d.Utf8Vector=d.SparseUnionVector=d.DenseUnionVector=d.UnionVector=d.TimeNanosecondVector=d.TimeMicrosecondVector=d.TimeMillisecondVector=d.TimeSecondVector=d.TimeVector=d.TimestampNanosecondVector=d.TimestampMicrosecondVector=d.TimestampMillisecondVector=d.TimestampSecondVector=d.TimestampVector=d.StructVector=d.NullVector=d.MapVector=d.ListVector=d.Uint64Vector=d.Uint32Vector=d.Uint16Vector=d.Uint8Vector=d.Int64Vector=d.Int32Vector=d.Int16Vector=d.Int8Vector=d.IntVector=d.IntervalYearMonthVector=d.IntervalDayTimeVector=d.IntervalVector=d.Float64Vector=d.Float32Vector=d.Float16Vector=d.FloatVector=d.FixedSizeListVector=d.FixedSizeBinaryVector=d.DictionaryVector=d.DecimalVector=d.DateMillisecondVector=d.DateDayVector=d.DateVector=d.Chunked=d.BoolVector=d.BinaryVector=d.BaseVector=d.Vector=d.Visitor=d.Field=d.Schema=d.Column=d.Table=d.Map_=d.FixedSizeList=d.IntervalYearMonth=d.IntervalDayTime=d.Interval=d.Dictionary=d.SparseUnion=d.DenseUnion=d.Union=d.Struct=d.List=d.Decimal=d.TimeNanosecond=d.TimeMicrosecond=d.TimeMillisecond=d.TimeSecond=d.Time=d.TimestampNanosecond=d.TimestampMicrosecond=d.TimestampMillisecond=d.TimestampSecond=d.Timestamp=d.DateMillisecond=d.DateDay=d.Date_=d.FixedSizeBinary=d.Binary=d.Utf8=d.Float64=d.Float32=d.Float16=d.Float=d.Uint64=d.Uint32=d.Uint16=d.Uint8=d.Int64=d.Int32=d.Int16=d.Int8=d.Int=d.Bool=d.Null=d.DataType=d.Data=d.BufferType=d.UnionMode=d.Type=d.TimeUnit=d.Precision=d.MetadataVersion=d.MessageHeader=d.IntervalUnit=d.DateUnit=d.ArrowType=void 0;var WO=Oi(),zO=Ao(),YO=os(),HO=Ko(),GO=yb(),$O=_b(),JO=gb(),KO=wb();WO.default.toDOMStream=GO.toDOMStream;zO.Builder.throughDOM=$O.builderThroughDOMStream;YO.RecordBatchReader.throughDOM=JO.recordBatchReaderThroughDOMStream;HO.RecordBatchWriter.throughDOM=KO.recordBatchWriterThroughDOMStream;var y=Ob();Object.defineProperty(d,"ArrowType",{enumerable:!0,get:function(){return y.ArrowType}});Object.defineProperty(d,"DateUnit",{enumerable:!0,get:function(){return y.DateUnit}});Object.defineProperty(d,"IntervalUnit",{enumerable:!0,get:function(){return y.IntervalUnit}});Object.defineProperty(d,"MessageHeader",{enumerable:!0,get:function(){return y.MessageHeader}});Object.defineProperty(d,"MetadataVersion",{enumerable:!0,get:function(){return y.MetadataVersion}});Object.defineProperty(d,"Precision",{enumerable:!0,get:function(){return y.Precision}});Object.defineProperty(d,"TimeUnit",{enumerable:!0,get:function(){return y.TimeUnit}});Object.defineProperty(d,"Type",{enumerable:!0,get:function(){return y.Type}});Object.defineProperty(d,"UnionMode",{enumerable:!0,get:function(){return y.UnionMode}});Object.defineProperty(d,"BufferType",{enumerable:!0,get:function(){return y.BufferType}});Object.defineProperty(d,"Data",{enumerable:!0,get:function(){return y.Data}});Object.defineProperty(d,"DataType",{enumerable:!0,get:function(){return y.DataType}});Object.defineProperty(d,"Null",{enumerable:!0,get:function(){return y.Null}});Object.defineProperty(d,"Bool",{enumerable:!0,get:function(){return y.Bool}});Object.defineProperty(d,"Int",{enumerable:!0,get:function(){return y.Int}});Object.defineProperty(d,"Int8",{enumerable:!0,get:function(){return y.Int8}});Object.defineProperty(d,"Int16",{enumerable:!0,get:function(){return y.Int16}});Object.defineProperty(d,"Int32",{enumerable:!0,get:function(){return y.Int32}});Object.defineProperty(d,"Int64",{enumerable:!0,get:function(){return y.Int64}});Object.defineProperty(d,"Uint8",{enumerable:!0,get:function(){return y.Uint8}});Object.defineProperty(d,"Uint16",{enumerable:!0,get:function(){return y.Uint16}});Object.defineProperty(d,"Uint32",{enumerable:!0,get:function(){return y.Uint32}});Object.defineProperty(d,"Uint64",{enumerable:!0,get:function(){return y.Uint64}});Object.defineProperty(d,"Float",{enumerable:!0,get:function(){return y.Float}});Object.defineProperty(d,"Float16",{enumerable:!0,get:function(){return y.Float16}});Object.defineProperty(d,"Float32",{enumerable:!0,get:function(){return y.Float32}});Object.defineProperty(d,"Float64",{enumerable:!0,get:function(){return y.Float64}});Object.defineProperty(d,"Utf8",{enumerable:!0,get:function(){return y.Utf8}});Object.defineProperty(d,"Binary",{enumerable:!0,get:function(){return y.Binary}});Object.defineProperty(d,"FixedSizeBinary",{enumerable:!0,get:function(){return y.FixedSizeBinary}});Object.defineProperty(d,"Date_",{enumerable:!0,get:function(){return y.Date_}});Object.defineProperty(d,"DateDay",{enumerable:!0,get:function(){return y.DateDay}});Object.defineProperty(d,"DateMillisecond",{enumerable:!0,get:function(){return y.DateMillisecond}});Object.defineProperty(d,"Timestamp",{enumerable:!0,get:function(){return y.Timestamp}});Object.defineProperty(d,"TimestampSecond",{enumerable:!0,get:function(){return y.TimestampSecond}});Object.defineProperty(d,"TimestampMillisecond",{enumerable:!0,get:function(){return y.TimestampMillisecond}});Object.defineProperty(d,"TimestampMicrosecond",{enumerable:!0,get:function(){return y.TimestampMicrosecond}});Object.defineProperty(d,"TimestampNanosecond",{enumerable:!0,get:function(){return y.TimestampNanosecond}});Object.defineProperty(d,"Time",{enumerable:!0,get:function(){return y.Time}});Object.defineProperty(d,"TimeSecond",{enumerable:!0,get:function(){return y.TimeSecond}});Object.defineProperty(d,"TimeMillisecond",{enumerable:!0,get:function(){return y.TimeMillisecond}});Object.defineProperty(d,"TimeMicrosecond",{enumerable:!0,get:function(){return y.TimeMicrosecond}});Object.defineProperty(d,"TimeNanosecond",{enumerable:!0,get:function(){return y.TimeNanosecond}});Object.defineProperty(d,"Decimal",{enumerable:!0,get:function(){return y.Decimal}});Object.defineProperty(d,"List",{enumerable:!0,get:function(){return y.List}});Object.defineProperty(d,"Struct",{enumerable:!0,get:function(){return y.Struct}});Object.defineProperty(d,"Union",{enumerable:!0,get:function(){return y.Union}});Object.defineProperty(d,"DenseUnion",{enumerable:!0,get:function(){return y.DenseUnion}});Object.defineProperty(d,"SparseUnion",{enumerable:!0,get:function(){return y.SparseUnion}});Object.defineProperty(d,"Dictionary",{enumerable:!0,get:function(){return y.Dictionary}});Object.defineProperty(d,"Interval",{enumerable:!0,get:function(){return y.Interval}});Object.defineProperty(d,"IntervalDayTime",{enumerable:!0,get:function(){return y.IntervalDayTime}});Object.defineProperty(d,"IntervalYearMonth",{enumerable:!0,get:function(){return y.IntervalYearMonth}});Object.defineProperty(d,"FixedSizeList",{enumerable:!0,get:function(){return y.FixedSizeList}});Object.defineProperty(d,"Map_",{enumerable:!0,get:function(){return y.Map_}});Object.defineProperty(d,"Table",{enumerable:!0,get:function(){return y.Table}});Object.defineProperty(d,"Column",{enumerable:!0,get:function(){return y.Column}});Object.defineProperty(d,"Schema",{enumerable:!0,get:function(){return y.Schema}});Object.defineProperty(d,"Field",{enumerable:!0,get:function(){return y.Field}});Object.defineProperty(d,"Visitor",{enumerable:!0,get:function(){return y.Visitor}});Object.defineProperty(d,"Vector",{enumerable:!0,get:function(){return y.Vector}});Object.defineProperty(d,"BaseVector",{enumerable:!0,get:function(){return y.BaseVector}});Object.defineProperty(d,"BinaryVector",{enumerable:!0,get:function(){return y.BinaryVector}});Object.defineProperty(d,"BoolVector",{enumerable:!0,get:function(){return y.BoolVector}});Object.defineProperty(d,"Chunked",{enumerable:!0,get:function(){return y.Chunked}});Object.defineProperty(d,"DateVector",{enumerable:!0,get:function(){return y.DateVector}});Object.defineProperty(d,"DateDayVector",{enumerable:!0,get:function(){return y.DateDayVector}});Object.defineProperty(d,"DateMillisecondVector",{enumerable:!0,get:function(){return y.DateMillisecondVector}});Object.defineProperty(d,"DecimalVector",{enumerable:!0,get:function(){return y.DecimalVector}});Object.defineProperty(d,"DictionaryVector",{enumerable:!0,get:function(){return y.DictionaryVector}});Object.defineProperty(d,"FixedSizeBinaryVector",{enumerable:!0,get:function(){return y.FixedSizeBinaryVector}});Object.defineProperty(d,"FixedSizeListVector",{enumerable:!0,get:function(){return y.FixedSizeListVector}});Object.defineProperty(d,"FloatVector",{enumerable:!0,get:function(){return y.FloatVector}});Object.defineProperty(d,"Float16Vector",{enumerable:!0,get:function(){return y.Float16Vector}});Object.defineProperty(d,"Float32Vector",{enumerable:!0,get:function(){return y.Float32Vector}});Object.defineProperty(d,"Float64Vector",{enumerable:!0,get:function(){return y.Float64Vector}});Object.defineProperty(d,"IntervalVector",{enumerable:!0,get:function(){return y.IntervalVector}});Object.defineProperty(d,"IntervalDayTimeVector",{enumerable:!0,get:function(){return y.IntervalDayTimeVector}});Object.defineProperty(d,"IntervalYearMonthVector",{enumerable:!0,get:function(){return y.IntervalYearMonthVector}});Object.defineProperty(d,"IntVector",{enumerable:!0,get:function(){return y.IntVector}});Object.defineProperty(d,"Int8Vector",{enumerable:!0,get:function(){return y.Int8Vector}});Object.defineProperty(d,"Int16Vector",{enumerable:!0,get:function(){return y.Int16Vector}});Object.defineProperty(d,"Int32Vector",{enumerable:!0,get:function(){return y.Int32Vector}});Object.defineProperty(d,"Int64Vector",{enumerable:!0,get:function(){return y.Int64Vector}});Object.defineProperty(d,"Uint8Vector",{enumerable:!0,get:function(){return y.Uint8Vector}});Object.defineProperty(d,"Uint16Vector",{enumerable:!0,get:function(){return y.Uint16Vector}});Object.defineProperty(d,"Uint32Vector",{enumerable:!0,get:function(){return y.Uint32Vector}});Object.defineProperty(d,"Uint64Vector",{enumerable:!0,get:function(){return y.Uint64Vector}});Object.defineProperty(d,"ListVector",{enumerable:!0,get:function(){return y.ListVector}});Object.defineProperty(d,"MapVector",{enumerable:!0,get:function(){return y.MapVector}});Object.defineProperty(d,"NullVector",{enumerable:!0,get:function(){return y.NullVector}});Object.defineProperty(d,"StructVector",{enumerable:!0,get:function(){return y.StructVector}});Object.defineProperty(d,"TimestampVector",{enumerable:!0,get:function(){return y.TimestampVector}});Object.defineProperty(d,"TimestampSecondVector",{enumerable:!0,get:function(){return y.TimestampSecondVector}});Object.defineProperty(d,"TimestampMillisecondVector",{enumerable:!0,get:function(){return y.TimestampMillisecondVector}});Object.defineProperty(d,"TimestampMicrosecondVector",{enumerable:!0,get:function(){return y.TimestampMicrosecondVector}});Object.defineProperty(d,"TimestampNanosecondVector",{enumerable:!0,get:function(){return y.TimestampNanosecondVector}});Object.defineProperty(d,"TimeVector",{enumerable:!0,get:function(){return y.TimeVector}});Object.defineProperty(d,"TimeSecondVector",{enumerable:!0,get:function(){return y.TimeSecondVector}});Object.defineProperty(d,"TimeMillisecondVector",{enumerable:!0,get:function(){return y.TimeMillisecondVector}});Object.defineProperty(d,"TimeMicrosecondVector",{enumerable:!0,get:function(){return y.TimeMicrosecondVector}});Object.defineProperty(d,"TimeNanosecondVector",{enumerable:!0,get:function(){return y.TimeNanosecondVector}});Object.defineProperty(d,"UnionVector",{enumerable:!0,get:function(){return y.UnionVector}});Object.defineProperty(d,"DenseUnionVector",{enumerable:!0,get:function(){return y.DenseUnionVector}});Object.defineProperty(d,"SparseUnionVector",{enumerable:!0,get:function(){return y.SparseUnionVector}});Object.defineProperty(d,"Utf8Vector",{enumerable:!0,get:function(){return y.Utf8Vector}});Object.defineProperty(d,"ByteStream",{enumerable:!0,get:function(){return y.ByteStream}});Object.defineProperty(d,"AsyncByteStream",{enumerable:!0,get:function(){return y.AsyncByteStream}});Object.defineProperty(d,"AsyncByteQueue",{enumerable:!0,get:function(){return y.AsyncByteQueue}});Object.defineProperty(d,"RecordBatchReader",{enumerable:!0,get:function(){return y.RecordBatchReader}});Object.defineProperty(d,"RecordBatchFileReader",{enumerable:!0,get:function(){return y.RecordBatchFileReader}});Object.defineProperty(d,"RecordBatchStreamReader",{enumerable:!0,get:function(){return y.RecordBatchStreamReader}});Object.defineProperty(d,"AsyncRecordBatchFileReader",{enumerable:!0,get:function(){return y.AsyncRecordBatchFileReader}});Object.defineProperty(d,"AsyncRecordBatchStreamReader",{enumerable:!0,get:function(){return y.AsyncRecordBatchStreamReader}});Object.defineProperty(d,"RecordBatchWriter",{enumerable:!0,get:function(){return y.RecordBatchWriter}});Object.defineProperty(d,"RecordBatchFileWriter",{enumerable:!0,get:function(){return y.RecordBatchFileWriter}});Object.defineProperty(d,"RecordBatchStreamWriter",{enumerable:!0,get:function(){return y.RecordBatchStreamWriter}});Object.defineProperty(d,"RecordBatchJSONWriter",{enumerable:!0,get:function(){return y.RecordBatchJSONWriter}});Object.defineProperty(d,"MessageReader",{enumerable:!0,get:function(){return y.MessageReader}});Object.defineProperty(d,"AsyncMessageReader",{enumerable:!0,get:function(){return y.AsyncMessageReader}});Object.defineProperty(d,"JSONMessageReader",{enumerable:!0,get:function(){return y.JSONMessageReader}});Object.defineProperty(d,"Message",{enumerable:!0,get:function(){return y.Message}});Object.defineProperty(d,"RecordBatch",{enumerable:!0,get:function(){return y.RecordBatch}});Object.defineProperty(d,"DataFrame",{enumerable:!0,get:function(){return y.DataFrame}});Object.defineProperty(d,"FilteredDataFrame",{enumerable:!0,get:function(){return y.FilteredDataFrame}});Object.defineProperty(d,"CountByResult",{enumerable:!0,get:function(){return y.CountByResult}});Object.defineProperty(d,"predicate",{enumerable:!0,get:function(){return y.predicate}});Object.defineProperty(d,"util",{enumerable:!0,get:function(){return y.util}});Object.defineProperty(d,"Builder",{enumerable:!0,get:function(){return y.Builder}});Object.defineProperty(d,"BinaryBuilder",{enumerable:!0,get:function(){return y.BinaryBuilder}});Object.defineProperty(d,"BoolBuilder",{enumerable:!0,get:function(){return y.BoolBuilder}});Object.defineProperty(d,"DateBuilder",{enumerable:!0,get:function(){return y.DateBuilder}});Object.defineProperty(d,"DateDayBuilder",{enumerable:!0,get:function(){return y.DateDayBuilder}});Object.defineProperty(d,"DateMillisecondBuilder",{enumerable:!0,get:function(){return y.DateMillisecondBuilder}});Object.defineProperty(d,"DecimalBuilder",{enumerable:!0,get:function(){return y.DecimalBuilder}});Object.defineProperty(d,"DictionaryBuilder",{enumerable:!0,get:function(){return y.DictionaryBuilder}});Object.defineProperty(d,"FixedSizeBinaryBuilder",{enumerable:!0,get:function(){return y.FixedSizeBinaryBuilder}});Object.defineProperty(d,"FixedSizeListBuilder",{enumerable:!0,get:function(){return y.FixedSizeListBuilder}});Object.defineProperty(d,"FloatBuilder",{enumerable:!0,get:function(){return y.FloatBuilder}});Object.defineProperty(d,"Float16Builder",{enumerable:!0,get:function(){return y.Float16Builder}});Object.defineProperty(d,"Float32Builder",{enumerable:!0,get:function(){return y.Float32Builder}});Object.defineProperty(d,"Float64Builder",{enumerable:!0,get:function(){return y.Float64Builder}});Object.defineProperty(d,"IntervalBuilder",{enumerable:!0,get:function(){return y.IntervalBuilder}});Object.defineProperty(d,"IntervalDayTimeBuilder",{enumerable:!0,get:function(){return y.IntervalDayTimeBuilder}});Object.defineProperty(d,"IntervalYearMonthBuilder",{enumerable:!0,get:function(){return y.IntervalYearMonthBuilder}});Object.defineProperty(d,"IntBuilder",{enumerable:!0,get:function(){return y.IntBuilder}});Object.defineProperty(d,"Int8Builder",{enumerable:!0,get:function(){return y.Int8Builder}});Object.defineProperty(d,"Int16Builder",{enumerable:!0,get:function(){return y.Int16Builder}});Object.defineProperty(d,"Int32Builder",{enumerable:!0,get:function(){return y.Int32Builder}});Object.defineProperty(d,"Int64Builder",{enumerable:!0,get:function(){return y.Int64Builder}});Object.defineProperty(d,"Uint8Builder",{enumerable:!0,get:function(){return y.Uint8Builder}});Object.defineProperty(d,"Uint16Builder",{enumerable:!0,get:function(){return y.Uint16Builder}});Object.defineProperty(d,"Uint32Builder",{enumerable:!0,get:function(){return y.Uint32Builder}});Object.defineProperty(d,"Uint64Builder",{enumerable:!0,get:function(){return y.Uint64Builder}});Object.defineProperty(d,"ListBuilder",{enumerable:!0,get:function(){return y.ListBuilder}});Object.defineProperty(d,"MapBuilder",{enumerable:!0,get:function(){return y.MapBuilder}});Object.defineProperty(d,"NullBuilder",{enumerable:!0,get:function(){return y.NullBuilder}});Object.defineProperty(d,"StructBuilder",{enumerable:!0,get:function(){return y.StructBuilder}});Object.defineProperty(d,"TimestampBuilder",{enumerable:!0,get:function(){return y.TimestampBuilder}});Object.defineProperty(d,"TimestampSecondBuilder",{enumerable:!0,get:function(){return y.TimestampSecondBuilder}});Object.defineProperty(d,"TimestampMillisecondBuilder",{enumerable:!0,get:function(){return y.TimestampMillisecondBuilder}});Object.defineProperty(d,"TimestampMicrosecondBuilder",{enumerable:!0,get:function(){return y.TimestampMicrosecondBuilder}});Object.defineProperty(d,"TimestampNanosecondBuilder",{enumerable:!0,get:function(){return y.TimestampNanosecondBuilder}});Object.defineProperty(d,"TimeBuilder",{enumerable:!0,get:function(){return y.TimeBuilder}});Object.defineProperty(d,"TimeSecondBuilder",{enumerable:!0,get:function(){return y.TimeSecondBuilder}});Object.defineProperty(d,"TimeMillisecondBuilder",{enumerable:!0,get:function(){return y.TimeMillisecondBuilder}});Object.defineProperty(d,"TimeMicrosecondBuilder",{enumerable:!0,get:function(){return y.TimeMicrosecondBuilder}});Object.defineProperty(d,"TimeNanosecondBuilder",{enumerable:!0,get:function(){return y.TimeNanosecondBuilder}});Object.defineProperty(d,"UnionBuilder",{enumerable:!0,get:function(){return y.UnionBuilder}});Object.defineProperty(d,"DenseUnionBuilder",{enumerable:!0,get:function(){return y.DenseUnionBuilder}});Object.defineProperty(d,"SparseUnionBuilder",{enumerable:!0,get:function(){return y.SparseUnionBuilder}});Object.defineProperty(d,"Utf8Builder",{enumerable:!0,get:function(){return y.Utf8Builder}})});var Fa=w(()=>{});var sd=w(()=>{});var Db=w(()=>{});var r0={};sg(r0,{registerWorker:()=>Pb});var nd=As(ps());var Ab=As(ps()),Da=class extends Ab.AsyncByteQueue{flush(){let e=super.toUint8Array(!0);return this._values.length=0,e}};var Xl;(function(o){o[o.NONE=0]="NONE",o[o.DEBUG=1]="DEBUG",o[o.INFO=2]="INFO",o[o.WARNING=3]="WARNING",o[o.ERROR=4]="ERROR"})(Xl||(Xl={}));var ed;(function(o){o[o.NONE=0]="NONE",o[o.CONNECT=1]="CONNECT",o[o.DISCONNECT=2]="DISCONNECT",o[o.OPEN=3]="OPEN",o[o.QUERY=4]="QUERY"})(ed||(ed={}));var td;(function(a){a[a.NONE=0]="NONE",a[a.OK=1]="OK",a[a.ERROR=2]="ERROR",a[a.START=3]="START",a[a.RUN=4]="RUN",a[a.CAPTURE=5]="CAPTURE"})(td||(td={}));var rd;(function(o){o[o.NONE=0]="NONE",o[o.WEB_WORKER=1]="WEB_WORKER",o[o.NODE_WORKER=2]="NODE_WORKER",o[o.BINDINGS=3]="BINDINGS",o[o.ASYNC_DUCKDB=4]="ASYNC_DUCKDB"})(rd||(rd={}));var QO=class{constructor(e,t,n){this.db=e;this.conn=t;this.header=n;this._first=!0,this._depleted=!1,this._inFlight=null}async next(){if(this._first)return this._first=!1,{done:!1,value:this.header};if(this._depleted)return{done:!0,value:null};let e;return this._inFlight!=null?(e=await this._inFlight,this._inFlight=null):e=await this.db.fetchQueryResults(this.conn),this._depleted=e.length==0,this._depleted||(this._inFlight=this.db.fetchQueryResults(this.conn)),{done:this._depleted,value:e}}[Symbol.asyncIterator](){return this}};var se;(function(E){E.CLOSE_PREPARED="CLOSE_PREPARED",E.COLLECT_FILE_STATISTICS="COLLECT_FILE_STATISTICS",E.CONNECT="CONNECT",E.COPY_FILE_TO_BUFFER="COPY_FILE_TO_BUFFER",E.COPY_FILE_TO_PATH="COPY_FILE_TO_PATH",E.CREATE_PREPARED="CREATE_PREPARED",E.DISCONNECT="DISCONNECT",E.DROP_FILE="DROP_FILE",E.DROP_FILES="DROP_FILES",E.EXPORT_FILE_STATISTICS="EXPORT_FILE_STATISTICS",E.FETCH_QUERY_RESULTS="FETCH_QUERY_RESULTS",E.FLUSH_FILES="FLUSH_FILES",E.GET_FEATURE_FLAGS="GET_FEATURE_FLAGS",E.GET_VERSION="GET_VERSION",E.GLOB_FILE_INFOS="GLOB_FILE_INFOS",E.INSERT_ARROW_FROM_IPC_STREAM="INSERT_ARROW_FROM_IPC_STREAM",E.INSERT_CSV_FROM_PATH="IMPORT_CSV_FROM_PATH",E.INSERT_JSON_FROM_PATH="IMPORT_JSON_FROM_PATH",E.INSTANTIATE="INSTANTIATE",E.OPEN="OPEN",E.PING="PING",E.REGISTER_FILE_BUFFER="REGISTER_FILE_BUFFER",E.REGISTER_FILE_HANDLE="REGISTER_FILE_HANDLE",E.REGISTER_FILE_URL="REGISTER_FILE_URL",E.RESET="RESET",E.RUN_PREPARED="RUN_PREPARED",E.RUN_QUERY="RUN_QUERY",E.SEND_PREPARED="SEND_PREPARED",E.SEND_QUERY="SEND_QUERY",E.TOKENIZE="TOKENIZE"})(se||(se={}));var Se;(function(Z){Z.CONNECTION_INFO="CONNECTION_INFO",Z.ERROR="ERROR",Z.FEATURE_FLAGS="FEATURE_FLAGS",Z.FILE_BUFFER="FILE_BUFFER",Z.FILE_INFOS="FILE_INFOS",Z.FILE_SIZE="FILE_SIZE",Z.FILE_STATISTICS="FILE_STATISTICS",Z.LOG="LOG",Z.OK="OK",Z.PREPARED_STATEMENT_ID="PREPARED_STATEMENT_ID",Z.QUERY_PLAN="QUERY_PLAN",Z.QUERY_RESULT="QUERY_RESULT",Z.QUERY_RESULT_CHUNK="QUERY_RESULT_CHUNK",Z.QUERY_START="QUERY_START",Z.REGISTERED_FILE="REGISTERED_FILE",Z.SCRIPT_TOKENS="SCRIPT_TOKENS",Z.SUCCESS="SUCCESS",Z.VERSION_STRING="VERSION_STRING"})(Se||(Se={}));var ee=As(ps());function gi(r,e){switch(e.typeId){case ee.Type.Binary:return{name:r,type:"binary"};case ee.Type.Bool:return{name:r,type:"bool"};case ee.Type.Date:return{name:r,type:"date"};case ee.Type.DateDay:return{name:r,type:"date32[d]"};case ee.Type.DateMillisecond:return{name:r,type:"date64[ms]"};case ee.Type.Decimal:{let t=e;return{name:r,type:"decimal",precision:t.precision,scale:t.scale}}case ee.Type.Float:return{name:r,type:"float"};case ee.Type.Float16:return{name:r,type:"float16"};case ee.Type.Float32:return{name:r,type:"float32"};case ee.Type.Float64:return{name:r,type:"float64"};case ee.Type.Int:return{name:r,type:"int32"};case ee.Type.Int16:return{name:r,type:"int16"};case ee.Type.Int32:return{name:r,type:"int32"};case ee.Type.Int64:return{name:r,type:"int64"};case ee.Type.Uint16:return{name:r,type:"uint16"};case ee.Type.Uint32:return{name:r,type:"uint32"};case ee.Type.Uint64:return{name:r,type:"uint64"};case ee.Type.Uint8:return{name:r,type:"uint8"};case ee.Type.IntervalDayTime:return{name:r,type:"interval[dt]"};case ee.Type.IntervalYearMonth:return{name:r,type:"interval[m]"};case ee.Type.List:{let t=e;return{name:r,type:"list",children:[gi(t.valueField.name,t.valueField.type)]}}case ee.Type.FixedSizeBinary:return{name:r,type:"fixedsizebinary",byteWidth:e.byteWidth};case ee.Type.Null:return{name:r,type:"null"};case ee.Type.Utf8:return{name:r,type:"utf8"};case ee.Type.Struct:return{name:r,type:"struct",children:e.children.map(n=>gi(n.name,n.type))};case ee.Type.Time:return{name:r,type:"time[s]"};case ee.Type.TimeMicrosecond:return{name:r,type:"time[us]"};case ee.Type.TimeMillisecond:return{name:r,type:"time[ms]"};case ee.Type.TimeNanosecond:return{name:r,type:"time[ns]"};case ee.Type.TimeSecond:return{name:r,type:"time[s]"};case ee.Type.Timestamp:return{name:r,type:"timestamp",timezone:e.timezone||void 0};case ee.Type.TimestampSecond:return{name:r,type:"timestamp[s]",timezone:e.timezone||void 0};case ee.Type.TimestampMicrosecond:return{name:r,type:"timestamp[us]",timezone:e.timezone||void 0};case ee.Type.TimestampNanosecond:return{name:r,type:"timestamp[ns]",timezone:e.timezone||void 0};case ee.Type.TimestampMillisecond:return{name:r,type:"timestamp[ms]",timezone:e.timezone||void 0}}throw new Error(`unsupported arrow type: ${e.toString()}`)}var BD=new TextEncoder;var id=class{constructor(){this._bindings=null;this._nextMessageId=0}log(e){this.postMessage({messageId:this._nextMessageId++,requestId:0,type:Se.LOG,data:e},[])}sendOK(e){this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:Se.OK,data:null},[])}failWith(e,t){let n={name:t.name,message:t.message,stack:t.stack||void 0};this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:Se.ERROR,data:n},[])}async onMessage(e){switch(e.type){case se.PING:this.sendOK(e);return;case se.INSTANTIATE:this._bindings!=null&&this.failWith(e,new Error("duckdb already initialized"));try{this._bindings=await this.instantiate(e.data[0],e.data[1]),this.sendOK(e)}catch(t){this._bindings=null,this.failWith(e,t)}return;default:break}if(!this._bindings)return this.failWith(e,new Error("duckdb is not initialized"));try{switch(e.type){case se.GET_VERSION:this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:Se.VERSION_STRING,data:this._bindings.getVersion()},[]);break;case se.GET_FEATURE_FLAGS:this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:Se.FEATURE_FLAGS,data:this._bindings.getFeatureFlags()},[]);break;case se.RESET:this._bindings.reset(),this.sendOK(e);break;case se.OPEN:this._bindings.open(e.data),this.sendOK(e);break;case se.DROP_FILE:this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:Se.SUCCESS,data:this._bindings.dropFile(e.data)},[]);break;case se.DROP_FILES:this._bindings.dropFiles(),this.sendOK(e);break;case se.FLUSH_FILES:this._bindings.flushFiles(),this.sendOK(e);break;case se.CONNECT:{let t=this._bindings.connect();this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:Se.CONNECTION_INFO,data:t.useUnsafe((n,i)=>i)},[]);break}case se.DISCONNECT:this._bindings.disconnect(e.data),this.sendOK(e);break;case se.CREATE_PREPARED:{let t=this._bindings.createPrepared(e.data[0],e.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:Se.PREPARED_STATEMENT_ID,data:t},[]);break}case se.CLOSE_PREPARED:{this._bindings.closePrepared(e.data[0],e.data[1]),this.sendOK(e);break}case se.RUN_PREPARED:{let t=this._bindings.runPrepared(e.data[0],e.data[1],e.data[2]);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:Se.QUERY_RESULT,data:t},[t.buffer]);break}case se.RUN_QUERY:{let t=this._bindings.runQuery(e.data[0],e.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:Se.QUERY_RESULT,data:t},[t.buffer]);break}case se.SEND_PREPARED:{let t=this._bindings.sendPrepared(e.data[0],e.data[1],e.data[2]);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:Se.QUERY_START,data:t},[t.buffer]);break}case se.SEND_QUERY:{let t=this._bindings.sendQuery(e.data[0],e.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:Se.QUERY_START,data:t},[t.buffer]);break}case se.FETCH_QUERY_RESULTS:{let t=this._bindings.fetchQueryResults(e.data);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:Se.QUERY_RESULT_CHUNK,data:t},[t.buffer]);break}case se.GLOB_FILE_INFOS:{let t=this._bindings.globFiles(e.data);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:Se.FILE_INFOS,data:t},[]);break}case se.REGISTER_FILE_URL:this._bindings.registerFileURL(e.data[0],e.data[1]),this.sendOK(e);break;case se.REGISTER_FILE_BUFFER:this._bindings.registerFileBuffer(e.data[0],e.data[1]),this.sendOK(e);break;case se.REGISTER_FILE_HANDLE:this._bindings.registerFileHandle(e.data[0],e.data[1]),this.sendOK(e);break;case se.COPY_FILE_TO_PATH:this._bindings.copyFileToPath(e.data[0],e.data[1]),this.sendOK(e);break;case se.COPY_FILE_TO_BUFFER:{let t=this._bindings.copyFileToBuffer(e.data);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:Se.FILE_BUFFER,data:t},[]);break}case se.COLLECT_FILE_STATISTICS:this._bindings.collectFileStatistics(e.data[0],e.data[1]),this.sendOK(e);break;case se.EXPORT_FILE_STATISTICS:{this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:Se.FILE_STATISTICS,data:this._bindings.exportFileStatistics(e.data)},[]);break}case se.INSERT_ARROW_FROM_IPC_STREAM:{this._bindings.insertArrowFromIPCStream(e.data[0],e.data[1],e.data[2]),this.sendOK(e);break}case se.INSERT_CSV_FROM_PATH:{this._bindings.insertCSVFromPath(e.data[0],e.data[1],e.data[2]),this.sendOK(e);break}case se.INSERT_JSON_FROM_PATH:{this._bindings.insertJSONFromPath(e.data[0],e.data[1],e.data[2]),this.sendOK(e);break}case se.TOKENIZE:{let t=this._bindings.tokenize(e.data);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:Se.SCRIPT_TOKENS,data:t},[]);break}}}catch(t){return this.failWith(e,t)}}};var Rb={},ZO=function(){var r=Rb.url;return function(e){e=e||{};var t=typeof e!="undefined"?e:{},n,i;t.ready=new Promise(function(h,p){n=h,i=p});var o={},a;for(a in t)t.hasOwnProperty(a)&&(o[a]=t[a]);var u=[],f="./this.program",s=function(h,p){throw p},c=typeof window=="object",_=typeof importScripts=="function",U=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",J="";function et(h){return t.locateFile?t.locateFile(h,J):J+h}var Ut,vt,yn,Z;function Vb(h){if(!(h instanceof Ss)){var p=h;Jr("exiting due to exception: "+p)}}var bn,mn;U?(_?J=Fa().dirname(J)+"/":J=__dirname+"/",Ut=function(p,m){return bn||(bn=sd()),mn||(mn=Fa()),p=mn.normalize(p),bn.readFileSync(p,m?null:"utf8")},yn=function(p){var m=Ut(p,!0);return m.buffer||(m=new Uint8Array(m)),fd(m.buffer),m},vt=function(p,m,I){bn||(bn=sd()),mn||(mn=Fa()),p=mn.normalize(p),bn.readFile(p,function(C,K){C?I(C):m(K.buffer)})},process.argv.length>1&&(f=process.argv[1].replace(/\\/g,"/")),u=process.argv.slice(2),process.on("uncaughtException",function(h){if(!(h instanceof Ss))throw h}),process.on("unhandledRejection",function(h){throw h}),s=function(h,p){if(Ua())throw process.exitCode=h,p;Vb(p),process.exit(h)},t.inspect=function(){return"[Emscripten Module object]"}):(c||_)&&(_?J=self.location.href:typeof document!="undefined"&&document.currentScript&&(J=document.currentScript.src),r&&(J=r),J.indexOf("blob:")!==0?J=J.substr(0,J.replace(/[?#].*/,"").lastIndexOf("/")+1):J="",Ut=function(h){var p=new XMLHttpRequest;return p.open("GET",h,!1),p.send(null),p.responseText},_&&(yn=function(h){var p=new XMLHttpRequest;return p.open("GET",h,!1),p.responseType="arraybuffer",p.send(null),new Uint8Array(p.response)}),vt=function(h,p,m){var I=new XMLHttpRequest;I.open("GET",h,!0),I.responseType="arraybuffer",I.onload=function(){if(I.status==200||I.status==0&&I.response){p(I.response);return}m()},I.onerror=m,I.send(null)},Z=function(h){document.title=h});var Nb=t.print||console.log.bind(console),Jr=t.printErr||console.warn.bind(console);for(a in o)o.hasOwnProperty(a)&&(t[a]=o[a]);o=null,t.arguments&&(u=t.arguments),t.thisProgram&&(f=t.thisProgram),t.quit&&(s=t.quit);var Ti;t.wasmBinary&&(Ti=t.wasmBinary);var kb=t.noExitRuntime||!0;typeof WebAssembly!="object"&&nr("no native wasm support detected");var ys,Ra=!1,bs;function fd(h,p){h||nr("Assertion failed: "+p)}function E(h){var p=t["_"+h];return fd(p,"Cannot call unknown function "+h+", make sure it is exported"),p}function Lb(h,p,m,I,C){var K={string:function(Ue){var ir=0;if(Ue!=null&&Ue!==0){var Si=(Ue.length<<2)+1;ir=ka(Si),xb(Ue,ir,Si)}return ir},array:function(Ue){var ir=ka(Ue.length);return bd(Ue,ir),ir}};function W(Ue){return p==="string"?ms(Ue):p==="boolean"?Boolean(Ue):Ue}var H=E(h),me=[],Mt=0;if(I)for(var Pt=0;Pt<I.length;Pt++){var Ii=K[m[Pt]];Ii?(Mt===0&&(Mt=Sd()),me[Pt]=Ii(I[Pt])):me[Pt]=I[Pt]}var $e=H.apply(null,me);function Vt(Ue){return Mt!==0&&Od(Mt),W(Ue)}return $e=Vt($e),$e}var hd=typeof TextDecoder!="undefined"?new TextDecoder("utf8"):void 0;function pd(h,p,m){for(var I=p+m,C=p;h[C]&&!(C>=I);)++C;if(C-p>16&&h.subarray&&hd)return hd.decode(h.subarray(p,C));for(var K="";p<C;){var W=h[p++];if(!(W&128)){K+=String.fromCharCode(W);continue}var H=h[p++]&63;if((W&224)==192){K+=String.fromCharCode((W&31)<<6|H);continue}var me=h[p++]&63;if((W&240)==224?W=(W&15)<<12|H<<6|me:W=(W&7)<<18|H<<12|me<<6|h[p++]&63,W<65536)K+=String.fromCharCode(W);else{var Mt=W-65536;K+=String.fromCharCode(55296|Mt>>10,56320|Mt&1023)}}return K}function ms(h,p){return h?pd(gn,h,p):""}function yd(h,p,m,I){if(!(I>0))return 0;for(var C=m,K=m+I-1,W=0;W<h.length;++W){var H=h.charCodeAt(W);if(H>=55296&&H<=57343){var me=h.charCodeAt(++W);H=65536+((H&1023)<<10)|me&1023}if(H<=127){if(m>=K)break;p[m++]=H}else if(H<=2047){if(m+1>=K)break;p[m++]=192|H>>6,p[m++]=128|H&63}else if(H<=65535){if(m+2>=K)break;p[m++]=224|H>>12,p[m++]=128|H>>6&63,p[m++]=128|H&63}else{if(m+3>=K)break;p[m++]=240|H>>18,p[m++]=128|H>>12&63,p[m++]=128|H>>6&63,p[m++]=128|H&63}}return p[m]=0,m-C}function xb(h,p,m){return yd(h,gn,p,m)}function Cb(h){for(var p=0,m=0;m<h.length;++m){var I=h.charCodeAt(m);I>=55296&&I<=57343&&(I=65536+((I&1023)<<10)|h.charCodeAt(++m)&1023),I<=127?++p:I<=2047?p+=2:I<=65535?p+=3:p+=4}return p}function bd(h,p){_n.set(h,p)}function jb(h,p,m){for(var I=0;I<h.length;++I)_n[p++>>0]=h.charCodeAt(I);m||(_n[p>>0]=0)}function qb(h,p){return h%p>0&&(h+=p-h%p),h}var md,_n,gn,Wb,zb,he,Yb,Hb,Gb;function _d(h){md=h,t.HEAP8=_n=new Int8Array(h),t.HEAP16=Wb=new Int16Array(h),t.HEAP32=he=new Int32Array(h),t.HEAPU8=gn=new Uint8Array(h),t.HEAPU16=zb=new Uint16Array(h),t.HEAPU32=Yb=new Uint32Array(h),t.HEAPF32=Hb=new Float32Array(h),t.HEAPF64=Gb=new Float64Array(h)}var n0=t.INITIAL_MEMORY||16777216,Ea,gd=[],wd=[],$b=[],Td=[],Jb=!1,Kb=!1,Qb=0;function Ua(){return kb||Qb>0}function Zb(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)nm(t.preRun.shift());_s(gd)}function Xb(){Jb=!0,_s(wd)}function em(){_s($b)}function tm(){Kb=!0}function rm(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)sm(t.postRun.shift());_s(Td)}function nm(h){gd.unshift(h)}function im(h){wd.unshift(h)}function sm(h){Td.unshift(h)}var Kr=0,Ma=null,Bi=null;function om(h){Kr++,t.monitorRunDependencies&&t.monitorRunDependencies(Kr)}function am(h){if(Kr--,t.monitorRunDependencies&&t.monitorRunDependencies(Kr),Kr==0&&(Ma!==null&&(clearInterval(Ma),Ma=null),Bi)){var p=Bi;Bi=null,p()}}t.preloadedImages={},t.preloadedAudios={};function nr(h){t.onAbort&&t.onAbort(h),h="Aborted("+h+")",Jr(h),Ra=!0,bs=1,h+=". Build with -s ASSERTIONS=1 for more info.";var p=new WebAssembly.RuntimeError(h);throw i(p),p}var um="data:application/octet-stream;base64,";function Bd(h){return h.startsWith(um)}var ut;t.locateFile?(ut="duckdb_wasm.wasm",Bd(ut)||(ut=et(ut))):ut=new URL("duckdb_wasm.wasm",Rb.url).toString();function vd(h){try{if(h==ut&&Ti)return new Uint8Array(Ti);if(yn)return yn(h);throw"both async and sync fetching of the wasm failed"}catch(p){nr(p)}}function cm(){return!Ti&&(c||_)&&typeof fetch=="function"?fetch(ut,{credentials:"same-origin"}).then(function(h){if(!h.ok)throw"failed to load wasm binary file at '"+ut+"'";return h.arrayBuffer()}).catch(function(){return vd(ut)}):Promise.resolve().then(function(){return vd(ut)})}function lm(){var h={a:d_};function p(W,H){var me=W.exports;t.asm=me,ys=t.asm.V,_d(ys.buffer),Ea=t.asm.Y,im(t.asm.W),am("wasm-instantiate")}om("wasm-instantiate");function m(W){p(W.instance)}function I(W){return cm().then(function(H){return WebAssembly.instantiate(H,h)}).then(function(H){return H}).then(W,function(H){Jr("failed to asynchronously prepare wasm: "+H),nr(H)})}function C(){return!Ti&&typeof WebAssembly.instantiateStreaming=="function"&&!Bd(ut)&&typeof fetch=="function"?fetch(ut,{credentials:"same-origin"}).then(function(W){var H=WebAssembly.instantiateStreaming(W,h);return H.then(m,function(me){return Jr("wasm streaming compile failed: "+me),Jr("falling back to ArrayBuffer instantiation"),I(m)})}):I(m)}if(t.instantiateWasm)try{var K=t.instantiateWasm(h,p);return K}catch(W){return Jr("Module.instantiateWasm callback failed with error: "+W),!1}return C().catch(i),{}}function _s(h){for(;h.length>0;){var p=h.shift();if(typeof p=="function"){p(t);continue}var m=p.func;typeof m=="number"?p.arg===void 0?Ea.get(m)():Ea.get(m)(p.arg):m(p.arg===void 0?null:p.arg)}}function dm(h){if(h instanceof Ss||h=="unwind")return bs;s(1,h)}var ke={mappings:{},buffers:[null,[],[]],printChar:function(h,p){var m=ke.buffers[h];p===0||p===10?((h===1?Nb:Jr)(pd(m,0)),m.length=0):m.push(p)},varargs:void 0,get:function(){ke.varargs+=4;var h=he[ke.varargs-4>>2];return h},getStr:function(h){var p=ms(h);return p},get64:function(h,p){return h}};function fm(h,p){return h=ke.getStr(h),ke.doAccess(h,p)}function hm(h){return he[Id()>>2]=h,h}function pm(h,p,m){return ke.varargs=m,0}function ym(h,p){}function bm(h,p,m,I){}function mm(h,p,m){}function _m(){return 42}function gm(h,p,m){return ke.varargs=m,0}function wm(h,p,m){return 0}function Tm(h,p){return h=ke.getStr(h),ke.doMkdir(h,p)}function Bm(h,p,m){ke.varargs=m}function vm(h,p){}function Im(h){}function Sm(h,p){}function Om(h){}function Am(h,p){nr("To use dlopen, you need to use Emscripten's linking support, see https://github.com/emscripten-core/emscripten/wiki/Linking")}function Dm(h,p){nr("To use dlopen, you need to use Emscripten's linking support, see https://github.com/emscripten-core/emscripten/wiki/Linking")}function Fm(){nr("")}var Pa;U?Pa=function(){var h=process.hrtime();return h[0]*1e3+h[1]/1e6}:Pa=function(){return performance.now()};var Rm=!0;function Em(h,p){var m;if(h===0)m=Date.now();else if((h===1||h===4)&&Rm)m=Pa();else return hm(28),-1;return he[p>>2]=m/1e3|0,he[p+4>>2]=m%1e3*1e3*1e3|0,0}function Um(h,p){return globalThis.DUCKDB_RUNTIME.createDirectory(t,h,p)}function Mm(h,p){return globalThis.DUCKDB_RUNTIME.checkDirectory(t,h,p)}function Pm(h,p){return globalThis.DUCKDB_RUNTIME.listDirectoryEntries(t,h,p)}function Vm(h,p){return globalThis.DUCKDB_RUNTIME.removeDirectory(t,h,p)}function Nm(h){return globalThis.DUCKDB_RUNTIME.closeFile(t,h)}function km(h,p){return globalThis.DUCKDB_RUNTIME.checkFile(t,h,p)}function Lm(h){return globalThis.DUCKDB_RUNTIME.getLastFileModificationTime(t,h)}function xm(h,p,m,I){return globalThis.DUCKDB_RUNTIME.moveFile(t,h,p,m,I)}function Cm(h){return globalThis.DUCKDB_RUNTIME.openFile(t,h)}function jm(h,p,m,I){return globalThis.DUCKDB_RUNTIME.readFile(t,h,p,m,I)}function qm(h,p){return globalThis.DUCKDB_RUNTIME.truncateFile(t,h,p)}function Wm(h,p,m,I){return globalThis.DUCKDB_RUNTIME.writeFile(t,h,p,m,I)}function zm(h,p){return globalThis.DUCKDB_RUNTIME.glob(t,h,p)}function Ym(h){return globalThis.DUCKDB_RUNTIME.testPlatformFeature(t,h)}function Hm(){return 2147483648}function Gm(h,p,m){gn.copyWithin(h,p,p+m)}function $m(h){try{return ys.grow(h-md.byteLength+65535>>>16),_d(ys.buffer),1}catch{}}function Jm(h){var p=gn.length;h=h>>>0;var m=2147483648;if(h>m)return!1;for(var I=1;I<=4;I*=2){var C=p*(1+.2/I);C=Math.min(C,h+100663296);var K=Math.min(m,qb(Math.max(h,C),65536)),W=$m(K);if(W)return!0}return!1}var Va={};function Km(){return f||"./this.program"}function vi(){if(!vi.strings){var h=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",p={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:h,_:Km()};for(var m in Va)Va[m]===void 0?delete p[m]:p[m]=Va[m];var I=[];for(var m in p)I.push(m+"="+p[m]);vi.strings=I}return vi.strings}function Qm(h,p){var m=0;return vi().forEach(function(I,C){var K=p+m;he[h+C*4>>2]=K,jb(I,K),m+=I.length+1}),0}function Zm(h,p){var m=vi();he[h>>2]=m.length;var I=0;return m.forEach(function(C){I+=C.length+1}),he[p>>2]=I,0}function Xm(h){return 0}function e_(h,p){var m=h==1||h==2?2:nr();return _n[p>>0]=m,0}function t_(h,p,m,I,C,K){var W=ke.getStreamFromFD(h),H=ke.doReadv(W,p,m,I);return he[K>>2]=H,0}function r_(h,p,m,I,C,K){var W=ke.getStreamFromFD(h),H=ke.doWritev(W,p,m,I);return he[K>>2]=H,0}function n_(h,p,m,I){var C=ke.getStreamFromFD(h),K=ke.doReadv(C,p,m);return he[I>>2]=K,0}function i_(h,p,m,I,C){}function s_(h){var p=ke.getStreamFromFD(h);return p.stream_ops&&p.stream_ops.fsync?-p.stream_ops.fsync(p):0}function o_(h,p,m,I){for(var C=0,K=0;K<m;K++){for(var W=he[p+K*8>>2],H=he[p+(K*8+4)>>2],me=0;me<H;me++)ke.printChar(h,gn[W+me]);C+=H}return he[I>>2]=C,0}function a_(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var h=new Uint8Array(1);return function(){return crypto.getRandomValues(h),h[0]}}else if(U)try{var p=Db();return function(){return p.randomBytes(1)[0]}}catch{}return function(){nr("randomDevice")}}function gs(h,p){gs.randomDevice||(gs.randomDevice=a_());for(var m=0;m<p;m++)_n[h+m>>0]=gs.randomDevice();return 0}function ws(h){return h%4==0&&(h%100!=0||h%400==0)}function Na(h,p){for(var m=0,I=0;I<=p;m+=h[I++]);return m}var Ts=[31,29,31,30,31,30,31,31,30,31,30,31],Bs=[31,28,31,30,31,30,31,31,30,31,30,31];function vs(h,p){for(var m=new Date(h.getTime());p>0;){var I=ws(m.getFullYear()),C=m.getMonth(),K=(I?Ts:Bs)[C];if(p>K-m.getDate())p-=K-m.getDate()+1,m.setDate(1),C<11?m.setMonth(C+1):(m.setMonth(0),m.setFullYear(m.getFullYear()+1));else return m.setDate(m.getDate()+p),m}return m}function u_(h,p,m,I){var C=he[I+40>>2],K={tm_sec:he[I>>2],tm_min:he[I+4>>2],tm_hour:he[I+8>>2],tm_mday:he[I+12>>2],tm_mon:he[I+16>>2],tm_year:he[I+20>>2],tm_wday:he[I+24>>2],tm_yday:he[I+28>>2],tm_isdst:he[I+32>>2],tm_gmtoff:he[I+36>>2],tm_zone:C?ms(C):""},W=ms(m),H={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var me in H)W=W.replace(new RegExp(me,"g"),H[me]);var Mt=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Pt=["January","February","March","April","May","June","July","August","September","October","November","December"];function Ii(S,M,Me){for(var le=typeof S=="number"?S.toString():S||"";le.length<M;)le=Me[0]+le;return le}function $e(S,M){return Ii(S,M,"0")}function Vt(S,M){function Me(Nt){return Nt<0?-1:Nt>0?1:0}var le;return(le=Me(S.getFullYear()-M.getFullYear()))===0&&(le=Me(S.getMonth()-M.getMonth()))===0&&(le=Me(S.getDate()-M.getDate())),le}function Ue(S){switch(S.getDay()){case 0:return new Date(S.getFullYear()-1,11,29);case 1:return S;case 2:return new Date(S.getFullYear(),0,3);case 3:return new Date(S.getFullYear(),0,2);case 4:return new Date(S.getFullYear(),0,1);case 5:return new Date(S.getFullYear()-1,11,31);case 6:return new Date(S.getFullYear()-1,11,30)}}function ir(S){var M=vs(new Date(S.tm_year+1900,0,1),S.tm_yday),Me=new Date(M.getFullYear(),0,4),le=new Date(M.getFullYear()+1,0,4),Nt=Ue(Me),mr=Ue(le);return Vt(Nt,M)<=0?Vt(mr,M)<=0?M.getFullYear()+1:M.getFullYear():M.getFullYear()-1}var Si={"%a":function(S){return Mt[S.tm_wday].substring(0,3)},"%A":function(S){return Mt[S.tm_wday]},"%b":function(S){return Pt[S.tm_mon].substring(0,3)},"%B":function(S){return Pt[S.tm_mon]},"%C":function(S){var M=S.tm_year+1900;return $e(M/100|0,2)},"%d":function(S){return $e(S.tm_mday,2)},"%e":function(S){return Ii(S.tm_mday,2," ")},"%g":function(S){return ir(S).toString().substring(2)},"%G":function(S){return ir(S)},"%H":function(S){return $e(S.tm_hour,2)},"%I":function(S){var M=S.tm_hour;return M==0?M=12:M>12&&(M-=12),$e(M,2)},"%j":function(S){return $e(S.tm_mday+Na(ws(S.tm_year+1900)?Ts:Bs,S.tm_mon-1),3)},"%m":function(S){return $e(S.tm_mon+1,2)},"%M":function(S){return $e(S.tm_min,2)},"%n":function(){return`
`},"%p":function(S){return S.tm_hour>=0&&S.tm_hour<12?"AM":"PM"},"%S":function(S){return $e(S.tm_sec,2)},"%t":function(){return"	"},"%u":function(S){return S.tm_wday||7},"%U":function(S){var M=new Date(S.tm_year+1900,0,1),Me=M.getDay()===0?M:vs(M,7-M.getDay()),le=new Date(S.tm_year+1900,S.tm_mon,S.tm_mday);if(Vt(Me,le)<0){var Nt=Na(ws(le.getFullYear())?Ts:Bs,le.getMonth()-1)-31,mr=31-Me.getDate(),Qr=mr+Nt+le.getDate();return $e(Math.ceil(Qr/7),2)}return Vt(Me,M)===0?"01":"00"},"%V":function(S){var M=new Date(S.tm_year+1900,0,4),Me=new Date(S.tm_year+1901,0,4),le=Ue(M),Nt=Ue(Me),mr=vs(new Date(S.tm_year+1900,0,1),S.tm_yday);if(Vt(mr,le)<0)return"53";if(Vt(Nt,mr)<=0)return"01";var Qr;return le.getFullYear()<S.tm_year+1900?Qr=S.tm_yday+32-le.getDate():Qr=S.tm_yday+1-le.getDate(),$e(Math.ceil(Qr/7),2)},"%w":function(S){return S.tm_wday},"%W":function(S){var M=new Date(S.tm_year,0,1),Me=M.getDay()===1?M:vs(M,M.getDay()===0?1:7-M.getDay()+1),le=new Date(S.tm_year+1900,S.tm_mon,S.tm_mday);if(Vt(Me,le)<0){var Nt=Na(ws(le.getFullYear())?Ts:Bs,le.getMonth()-1)-31,mr=31-Me.getDate(),Qr=mr+Nt+le.getDate();return $e(Math.ceil(Qr/7),2)}return Vt(Me,M)===0?"01":"00"},"%y":function(S){return(S.tm_year+1900).toString().substring(2)},"%Y":function(S){return S.tm_year+1900},"%z":function(S){var M=S.tm_gmtoff,Me=M>=0;return M=Math.abs(M)/60,M=M/60*100+M%60,(Me?"+":"-")+String("0000"+M).slice(-4)},"%Z":function(S){return S.tm_zone},"%%":function(){return"%"}};for(var me in Si)W.includes(me)&&(W=W.replace(new RegExp(me,"g"),Si[me](K)));var xa=l_(W,!1);return xa.length>p?0:(bd(xa,h),xa.length-1)}function c_(h,p,m,I){return u_(h,p,m,I)}function l_(h,p,m){var I=m>0?m:Cb(h)+1,C=new Array(I),K=yd(h,C,0,C.length);return p&&(C.length=K),C}var d_={M:fm,c:pm,O:ym,N:bm,K:mm,i:_m,o:gm,H:wm,L:Tm,f:Bm,I:vm,j:Im,l:Sm,k:Om,R:Am,Q:Dm,a:Fm,m:Em,A:Um,B:Mm,y:Pm,z:Vm,h:Nm,v:km,D:Lm,w:xm,F:Cm,d:jm,C:qm,E:Wm,u:zm,g:Ym,p:Hm,T:Gm,U:Jm,x:Qm,G:Zm,b:Xm,S:e_,s:t_,r:r_,n:n_,t:i_,J:s_,e:o_,P:gs,q:c_},i0=lm(),f_=t.___wasm_call_ctors=function(){return(f_=t.___wasm_call_ctors=t.asm.W).apply(null,arguments)},h_=t._main=function(){return(h_=t._main=t.asm.X).apply(null,arguments)},p_=t._duckdb_web_fs_glob_add_path=function(){return(p_=t._duckdb_web_fs_glob_add_path=t.asm.Z).apply(null,arguments)},y_=t._duckdb_web_clear_response=function(){return(y_=t._duckdb_web_clear_response=t.asm._).apply(null,arguments)},b_=t._duckdb_web_fail_with=function(){return(b_=t._duckdb_web_fail_with=t.asm.$).apply(null,arguments)},m_=t._duckdb_web_reset=function(){return(m_=t._duckdb_web_reset=t.asm.aa).apply(null,arguments)},__=t._duckdb_web_connect=function(){return(__=t._duckdb_web_connect=t.asm.ba).apply(null,arguments)},g_=t._duckdb_web_disconnect=function(){return(g_=t._duckdb_web_disconnect=t.asm.ca).apply(null,arguments)},w_=t._duckdb_web_flush_files=function(){return(w_=t._duckdb_web_flush_files=t.asm.da).apply(null,arguments)},T_=t._duckdb_web_flush_file=function(){return(T_=t._duckdb_web_flush_file=t.asm.ea).apply(null,arguments)},B_=t._duckdb_web_open=function(){return(B_=t._duckdb_web_open=t.asm.fa).apply(null,arguments)},v_=t._duckdb_web_collect_file_stats=function(){return(v_=t._duckdb_web_collect_file_stats=t.asm.ga).apply(null,arguments)},I_=t._duckdb_web_export_file_stats=function(){return(I_=t._duckdb_web_export_file_stats=t.asm.ha).apply(null,arguments)},S_=t._duckdb_web_fs_drop_file=function(){return(S_=t._duckdb_web_fs_drop_file=t.asm.ia).apply(null,arguments)},O_=t._duckdb_web_fs_drop_files=function(){return(O_=t._duckdb_web_fs_drop_files=t.asm.ja).apply(null,arguments)},A_=t._duckdb_web_fs_glob_file_infos=function(){return(A_=t._duckdb_web_fs_glob_file_infos=t.asm.ka).apply(null,arguments)},D_=t._duckdb_web_fs_get_file_info_by_id=function(){return(D_=t._duckdb_web_fs_get_file_info_by_id=t.asm.la).apply(null,arguments)},F_=t._duckdb_web_fs_get_file_info_by_name=function(){return(F_=t._duckdb_web_fs_get_file_info_by_name=t.asm.ma).apply(null,arguments)},R_=t._duckdb_web_fs_set_file_descriptor=function(){return(R_=t._duckdb_web_fs_set_file_descriptor=t.asm.na).apply(null,arguments)},E_=t._duckdb_web_fs_register_file_url=function(){return(E_=t._duckdb_web_fs_register_file_url=t.asm.oa).apply(null,arguments)},U_=t._duckdb_web_fs_register_file_buffer=function(){return(U_=t._duckdb_web_fs_register_file_buffer=t.asm.pa).apply(null,arguments)},M_=t._duckdb_web_copy_file_to_buffer=function(){return(M_=t._duckdb_web_copy_file_to_buffer=t.asm.qa).apply(null,arguments)},P_=t._duckdb_web_copy_file_to_path=function(){return(P_=t._duckdb_web_copy_file_to_path=t.asm.ra).apply(null,arguments)},V_=t._duckdb_web_get_version=function(){return(V_=t._duckdb_web_get_version=t.asm.sa).apply(null,arguments)},N_=t._duckdb_web_get_feature_flags=function(){return(N_=t._duckdb_web_get_feature_flags=t.asm.ta).apply(null,arguments)},k_=t._duckdb_web_tokenize=function(){return(k_=t._duckdb_web_tokenize=t.asm.ua).apply(null,arguments)},L_=t._duckdb_web_prepared_create=function(){return(L_=t._duckdb_web_prepared_create=t.asm.va).apply(null,arguments)},x_=t._duckdb_web_prepared_close=function(){return(x_=t._duckdb_web_prepared_close=t.asm.wa).apply(null,arguments)},C_=t._duckdb_web_prepared_run=function(){return(C_=t._duckdb_web_prepared_run=t.asm.xa).apply(null,arguments)},j_=t._duckdb_web_prepared_send=function(){return(j_=t._duckdb_web_prepared_send=t.asm.ya).apply(null,arguments)},q_=t._duckdb_web_query_run=function(){return(q_=t._duckdb_web_query_run=t.asm.za).apply(null,arguments)},W_=t._duckdb_web_query_send=function(){return(W_=t._duckdb_web_query_send=t.asm.Aa).apply(null,arguments)},z_=t._duckdb_web_query_fetch_results=function(){return(z_=t._duckdb_web_query_fetch_results=t.asm.Ba).apply(null,arguments)},Y_=t._duckdb_web_insert_arrow_from_ipc_stream=function(){return(Y_=t._duckdb_web_insert_arrow_from_ipc_stream=t.asm.Ca).apply(null,arguments)},H_=t._duckdb_web_insert_csv_from_path=function(){return(H_=t._duckdb_web_insert_csv_from_path=t.asm.Da).apply(null,arguments)},G_=t._duckdb_web_insert_json_from_path=function(){return(G_=t._duckdb_web_insert_json_from_path=t.asm.Ea).apply(null,arguments)},Id=t.___errno_location=function(){return(Id=t.___errno_location=t.asm.Fa).apply(null,arguments)},Sd=t.stackSave=function(){return(Sd=t.stackSave=t.asm.Ga).apply(null,arguments)},Od=t.stackRestore=function(){return(Od=t.stackRestore=t.asm.Ha).apply(null,arguments)},ka=t.stackAlloc=function(){return(ka=t.stackAlloc=t.asm.Ia).apply(null,arguments)},$_=t._malloc=function(){return($_=t._malloc=t.asm.Ja).apply(null,arguments)},J_=t._free=function(){return(J_=t._free=t.asm.Ka).apply(null,arguments)};t.ccall=Lb;var Is;function Ss(h){this.name="ExitStatus",this.message="Program terminated with exit("+h+")",this.status=h}var K_=!1;Bi=function h(){Is||La(),Is||(Bi=h)};function Q_(h){var p=t._main,m=0,I=0;try{var C=p(m,I);return Z_(C,!0),C}catch(K){return dm(K)}finally{K_=!0}}function La(h){if(h=h||u,Kr>0||(Zb(),Kr>0))return;function p(){Is||(Is=!0,t.calledRun=!0,!Ra&&(Xb(),em(),n(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),Ad&&Q_(h),rm()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),p()},1)):p()}t.run=La;function Z_(h,p){bs=h,Ua()||tm(),X_(h)}function X_(h){bs=h,Ua()||(t.onExit&&t.onExit(h),Ra=!0),s(h,new Ss(h))}if(t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();var Ad=!0;return t.noInitialRun&&(Ad=!1),La(),e.ready}}(),Fb=ZO;var Et=As(ps());var od=class{constructor(e,t){this._bindings=e,this._conn=t}close(){this._bindings.disconnect(this._conn)}useUnsafe(e){return e(this._bindings,this._conn)}query(e){let t=this._bindings.runQuery(this._conn,e),n=Et.RecordBatchReader.from(t);return console.assert(n.isSync()),console.assert(n.isFile()),Et.Table.from(n)}send(e){let t=this._bindings.sendQuery(this._conn,e),n=new ad(this._bindings,this._conn,t),i=Et.RecordBatchReader.from(n);return console.assert(i.isSync()),console.assert(i.isStream()),i}prepare(e){let t=this._bindings.createPrepared(this._conn,e);return new Eb(this._bindings,this._conn,t)}insertArrowVectors(e,t){this.insertArrowTable(Et.Table.new(e),t)}insertArrowTable(e,t){e.schema.fields.length==0&&console.warn("The schema is empty! If you used arrow.Table.from, consider constructing schema and batches manually"),this.insertArrowBatches(e.schema,e.chunks,t)}insertArrowBatches(e,t,n){e.fields.length==0&&console.warn("The schema is empty! If you used arrow.Table.from, consider constructing schema and batches manually");let i=new Da,o=new Et.RecordBatchStreamWriter().reset(i,e),a=!0;for(let u of t)a||this._bindings.insertArrowFromIPCStream(this._conn,i.flush(),n),a=!1,o.write(u);o.finish(),this._bindings.insertArrowFromIPCStream(this._conn,i.flush(),n)}insertArrowFromIPCStream(e,t){this._bindings.insertArrowFromIPCStream(this._conn,e,t)}insertCSVFromPath(e,t){this._bindings.insertCSVFromPath(this._conn,e,t)}insertJSONFromPath(e,t){this._bindings.insertJSONFromPath(this._conn,e,t)}},ad=class{constructor(e,t,n){this.bindings=e;this.conn=t;this.header=n;this._first=!0,this._depleted=!1}next(){if(this._first)return this._first=!1,{done:!1,value:this.header};if(this._depleted)return{done:!0,value:null};let e=this.bindings.fetchQueryResults(this.conn);return this._depleted=e.length==0,{done:this._depleted,value:e}}[Symbol.iterator](){return this}},Eb=class{constructor(e,t,n){this.bindings=e,this.connectionId=t,this.statementId=n}close(){this.bindings.closePrepared(this.connectionId,this.statementId)}query(...e){let t=this.bindings.runPrepared(this.connectionId,this.statementId,e),n=Et.RecordBatchReader.from(t);return console.assert(n.isSync()),console.assert(n.isFile()),Et.Table.from(n)}send(...e){let t=this.bindings.sendPrepared(this.connectionId,this.statementId,e),n=new ad(this.bindings,this.connectionId,t),i=Et.RecordBatchReader.from(n);return console.assert(i.isSync()),console.assert(i.isStream()),i}};var ue;(function(e){e[e.SUCCESS=0]="SUCCESS"})(ue||(ue={}));function XO(){let r=new TextDecoder;return e=>(typeof SharedArrayBuffer!="undefined"&&e.buffer instanceof SharedArrayBuffer&&(e=new Uint8Array(e)),r.decode(e))}var e0=XO();function br(r,e){r.ccall("duckdb_web_fail_with",null,["string"],[e])}function wi(r,e,t){let n=r.HEAPU8.subarray(e,e+t),i=new Uint8Array(new ArrayBuffer(n.byteLength));return i.set(n),i}function ne(r,e,t){return e0(r.HEAPU8.subarray(e,e+t))}var Ze;(function(n){n[n.BUFFER=0]="BUFFER",n[n.NATIVE=1]="NATIVE",n[n.HTTP=3]="HTTP"})(Ze||(Ze={}));function fe(r,e,t,n){let i=r.stackSave(),o=r.stackAlloc(3*8);t.unshift("number"),n.unshift(o),r.ccall(e,null,t,n);let a=r.HEAPF64[(o>>3)+0],u=r.HEAPF64[(o>>3)+1],f=r.HEAPF64[(o>>3)+2];return r.stackRestore(i),[a,u,f]}function Oe(r){r.ccall("duckdb_web_clear_response",null,[],[])}var ud=class{constructor(e){let t=new Float64Array(e.buffer,e.byteOffset,e.byteLength/8),n=new Uint8Array(new ArrayBuffer(e.byteLength));n.set(e.subarray(7*8)),this.totalFileReadsCold=t[0],this.totalFileReadsAhead=t[1],this.totalFileReadsCached=t[2],this.totalFileWrites=t[3],this.totalPageAccesses=t[4],this.totalPageLoads=t[5],this.blockSize=t[6],this.blockStats=n}getBlockStats(e,t){return t=t||{file_reads_cold:0,file_reads_ahead:0,file_reads_cached:0,file_writes:0,page_accesses:0,page_loads:0},t.file_writes=this.blockStats[e*3+0]&15,t.file_reads_cold=this.blockStats[e*3+0]>>4,t.file_reads_ahead=this.blockStats[e*3+1]&15,t.file_reads_cached=this.blockStats[e*3+1]>>4,t.page_accesses=this.blockStats[e*3+1]&15,t.page_loads=this.blockStats[e*3+1]>>4,t}};var t0=new TextEncoder,Ub;(function(o){o[o.WASM_EXCEPTIONS=1]="WASM_EXCEPTIONS",o[o.WASM_THREADS=2]="WASM_THREADS",o[o.WASM_SIMD=4]="WASM_SIMD",o[o.WASM_BULK_MEMORY=8]="WASM_BULK_MEMORY",o[o.EMIT_BIGINT=16]="EMIT_BIGINT"})(Ub||(Ub={}));var cd=class{constructor(e,t){this._instance=null;this._initPromise=null;this._initPromiseResolver=()=>{};this._logger=e,this._runtime=t}get logger(){return this._logger}get mod(){return this._instance}get pthread(){return this.mod.PThread||null}async instantiate(){return this._instance!=null?this:(this._initPromise!=null&&await this._initPromise,this._initPromise=new Promise(e=>{this._initPromiseResolver=e}),this._instance=await this.instantiateImpl({print:console.log.bind(console),printErr:console.log.bind(console),onRuntimeInitialized:this._initPromiseResolver}),await this._initPromise,this._initPromise=null,this)}open(e){let[t,n,i]=fe(this.mod,"duckdb_web_open",["string"],[JSON.stringify(e)]);if(t!==ue.SUCCESS)throw new Error(ne(this.mod,n,i));Oe(this.mod)}reset(){let[e,t,n]=fe(this.mod,"duckdb_web_reset",[],[]);if(e!==ue.SUCCESS)throw new Error(ne(this.mod,t,n));Oe(this.mod)}getVersion(){let[e,t,n]=fe(this.mod,"duckdb_web_get_version",[],[]);if(e!==ue.SUCCESS)throw new Error(ne(this.mod,t,n));let i=ne(this.mod,t,n);return Oe(this.mod),i}getFeatureFlags(){return this.mod.ccall("duckdb_web_get_feature_flags","number",[],[])}tokenize(e){let[t,n,i]=fe(this.mod,"duckdb_web_tokenize",["string"],[e]);if(t!==ue.SUCCESS)throw new Error(ne(this.mod,n,i));let o=ne(this.mod,n,i);return Oe(this.mod),JSON.parse(o)}connect(){let e=this.mod.ccall("duckdb_web_connect","number",[],[]);return new od(this,e)}disconnect(e){this.mod.ccall("duckdb_web_disconnect",null,["number"],[e])}runQuery(e,t){let[n,i,o]=fe(this.mod,"duckdb_web_query_run",["number","string"],[e,t]);if(n!==ue.SUCCESS)throw new Error(ne(this.mod,i,o));let a=wi(this.mod,i,o);return Oe(this.mod),a}sendQuery(e,t){let[n,i,o]=fe(this.mod,"duckdb_web_query_send",["number","string"],[e,t]);if(n!==ue.SUCCESS)throw new Error(ne(this.mod,i,o));let a=wi(this.mod,i,o);return Oe(this.mod),a}fetchQueryResults(e){let[t,n,i]=fe(this.mod,"duckdb_web_query_fetch_results",["number"],[e]);if(t!==ue.SUCCESS)throw new Error(ne(this.mod,n,i));let o=wi(this.mod,n,i);return Oe(this.mod),o}createPrepared(e,t){let[n,i,o]=fe(this.mod,"duckdb_web_prepared_create",["number","string"],[e,t]);if(n!==ue.SUCCESS)throw new Error(ne(this.mod,i,o));return Oe(this.mod),i}closePrepared(e,t){let[n,i,o]=fe(this.mod,"duckdb_web_prepared_close",["number","number"],[e,t]);if(n!==ue.SUCCESS)throw new Error(ne(this.mod,i,o));Oe(this.mod)}runPrepared(e,t,n){let[i,o,a]=fe(this.mod,"duckdb_web_prepared_run",["number","number","string"],[e,t,JSON.stringify(n)]);if(i!==ue.SUCCESS)throw new Error(ne(this.mod,o,a));let u=wi(this.mod,o,a);return Oe(this.mod),u}sendPrepared(e,t,n){let[i,o,a]=fe(this.mod,"duckdb_web_prepared_send",["number","number","string"],[e,t,JSON.stringify(n)]);if(i!==ue.SUCCESS)throw new Error(ne(this.mod,o,a));let u=wi(this.mod,o,a);return Oe(this.mod),u}insertArrowFromIPCStream(e,t,n){let i=this.mod._malloc(t.length);this.mod.HEAPU8.subarray(i,i+t.length).set(t);let a=n?JSON.stringify(n):"",[u,f,s]=fe(this.mod,"duckdb_web_insert_arrow_from_ipc_stream",["number","number","number","string"],[e,i,t.length,a]);if(u!==ue.SUCCESS)throw new Error(ne(this.mod,f,s))}insertCSVFromPath(e,t,n){if(n.columns!==void 0){n.columnsFlat=[];for(let s in n.columns)n.columnsFlat.push(gi(s,n.columns[s]))}let i={...n};i.columns=i.columnsFlat,delete i.columnsFlat;let o=JSON.stringify(i),[a,u,f]=fe(this.mod,"duckdb_web_insert_csv_from_path",["number","string","string"],[e,t,o]);if(a!==ue.SUCCESS)throw new Error(ne(this.mod,u,f))}insertJSONFromPath(e,t,n){if(n.columns!==void 0){n.columnsFlat=[];for(let s in n.columns)n.columnsFlat.push(gi(s,n.columns[s]))}let i={...n};i.columns=i.columnsFlat,delete i.columnsFlat;let o=JSON.stringify(i),[a,u,f]=fe(this.mod,"duckdb_web_insert_json_from_path",["number","string","string"],[e,t,o]);if(a!==ue.SUCCESS)throw new Error(ne(this.mod,u,f))}globFiles(e){let[t,n,i]=fe(this.mod,"duckdb_web_fs_glob_file_infos",["string"],[e]);if(t!==ue.SUCCESS)throw new Error(ne(this.mod,n,i));let o=ne(this.mod,n,i);Oe(this.mod);let a=JSON.parse(o);return a??[]}registerFileURL(e,t){t===void 0&&(t=e);let[n,i,o]=fe(this.mod,"duckdb_web_fs_register_file_url",["string","string"],[e,t]);if(n!==ue.SUCCESS)throw new Error(ne(this.mod,i,o));Oe(this.mod)}registerFileText(e,t){let n=t0.encode(t);this.registerFileBuffer(e,n)}registerFileBuffer(e,t){let n=this.mod._malloc(t.length);this.mod.HEAPU8.subarray(n,n+t.length).set(t);let[o,a,u]=fe(this.mod,"duckdb_web_fs_register_file_buffer",["string","number","number"],[e,n,t.length]);if(o!==ue.SUCCESS)throw new Error(ne(this.mod,a,u));Oe(this.mod)}registerFileHandle(e,t){let[n,i,o]=fe(this.mod,"duckdb_web_fs_register_file_url",["string","string"],[e,e]);if(n!==ue.SUCCESS)throw new Error(ne(this.mod,i,o));if(Oe(this.mod),globalThis.DUCKDB_RUNTIME._files=(globalThis.DUCKDB_RUNTIME._files||new Map).set(e,t),this.pthread){for(let a of this.pthread.runningWorkers)a.postMessage({cmd:"registerFileHandle",fileName:e,fileHandle:t});for(let a of this.pthread.unusedWorkers)a.postMessage({cmd:"dropFileHandle",fileName:e})}}dropFile(e){return this.mod.ccall("duckdb_web_fs_drop_file","boolean",["string"],[e])}dropFiles(){let[e,t,n]=fe(this.mod,"duckdb_web_fs_drop_files",[],[]);if(e!==ue.SUCCESS)throw new Error(ne(this.mod,t,n));Oe(this.mod)}flushFiles(){this.mod.ccall("duckdb_web_flush_files",null,[],[])}copyFileToPath(e,t){let[n,i,o]=fe(this.mod,"duckdb_web_copy_file_to_path",["string","string"],[e,t]);if(n!==ue.SUCCESS)throw new Error(ne(this.mod,i,o));Oe(this.mod)}copyFileToBuffer(e){let[t,n,i]=fe(this.mod,"duckdb_web_copy_file_to_buffer",["string"],[e]);if(t!==ue.SUCCESS)throw new Error(ne(this.mod,n,i));let o=this.mod.HEAPU8.subarray(n,n+i),a=new Uint8Array(o.length);return a.set(o),Oe(this.mod),a}collectFileStatistics(e,t){let[n,i,o]=fe(this.mod,"duckdb_web_collect_file_stats",["string","boolean"],[e,t]);if(n!==ue.SUCCESS)throw new Error(ne(this.mod,i,o))}exportFileStatistics(e){let[t,n,i]=fe(this.mod,"duckdb_web_export_file_stats",["string"],[e]);if(t!==ue.SUCCESS)throw new Error(ne(this.mod,n,i));return new ud(this.mod.HEAPU8.subarray(n,n+i))}};var ld=class extends cd{constructor(e,t,n,i){super(e,t);this.mainModuleURL=n,this.pthreadWorkerURL=i}locateFile(e,t){if(e.endsWith(".wasm"))return this.mainModuleURL;if(e.endsWith(".worker.js")){if(!this.pthreadWorkerURL)throw new Error("Missing DuckDB worker URL!");return this.pthreadWorkerURL}throw new Error(`WASM instantiation requested unexpected file: prefix=${t} path=${e}`)}instantiateWasm(e,t){return globalThis.DUCKDB_RUNTIME=this._runtime,WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(fetch(this.mainModuleURL),e).then(n=>{t(n.instance,n.module)}):fetch(this.mainModuleURL).then(n=>n.arrayBuffer()).then(n=>WebAssembly.instantiate(n,e).then(i=>{t(i.instance,i.module)})).catch(n=>{console.error("Failed to instantiate WASM:",n)}),[]}};var dd=class extends ld{constructor(e,t,n,i=null){super(e,t,n,i)}instantiateImpl(e){return Fb({...e,instantiateWasm:this.instantiateWasm.bind(this),locateFile:this.locateFile.bind(this)})}};var Xe={fileInfoCache:new Map,getFileInfo(r,e){try{let t=Xe.fileInfoCache.get(e);if(t)return t;let[n,i,o]=fe(r,"duckdb_web_fs_get_file_info_by_id",["number"],[e]);if(n!==ue.SUCCESS)return null;let a=ne(r,i,o);Oe(r);let u=JSON.parse(a);if(u==null)return null;let f={...u,blob:null};return Xe.fileInfoCache.set(e,f),f}catch{return null}},testPlatformFeature:(r,e)=>{switch(e){case 1:return typeof BigInt64Array!="undefined";default:return console.warn(`test for unknown feature: ${e}`),!1}},openFile:(r,e)=>{try{Xe.fileInfoCache.delete(e);let t=Xe.getFileInfo(r,e);switch(t?.dataProtocol){case Ze.HTTP:{let n=null;try{let i=new XMLHttpRequest;i.open("HEAD",t.dataUrl,!1),i.setRequestHeader("Range","bytes=0-"),i.send(null);let o=i.getResponseHeader("Content-Length");if(i.status==206&&o!==null){let a=r._malloc(2*8);return r.HEAPF64[(a>>3)+0]=+o,r.HEAPF64[(a>>3)+1]=0,a}}catch(i){n=i,console.warn(`HEAD request with range header failed: ${i}`)}if(t.allowFullHttpReads){console.warn(`falling back to full HTTP read for: ${t.dataUrl}`);let i=new XMLHttpRequest;if(i.open("GET",t.dataUrl,!1),i.responseType="arraybuffer",i.send(null),i.status==200){let o=r._malloc(i.response.byteLength),a=new Uint8Array(i.response,0,i.response.byteLength);r.HEAPU8.set(a,o);let u=r._malloc(2*8);return r.HEAPF64[(u>>3)+0]=i.response.byteLength,r.HEAPF64[(u>>3)+1]=o,u}}if(n!=null)throw new Error(`Reading file ${t.fileName} failed with error: ${n}`);return 0}case Ze.NATIVE:{let n=Xe._files?.get(t.fileName);if(n){let a=r._malloc(2*8);return r.HEAPF64[(a>>3)+0]=n.size,r.HEAPF64[(a>>3)+1]=0,a}console.warn(`Buffering missing file: ${t.fileName}`);let i=r._malloc(2*8),o=r._malloc(1);return r.HEAPF64[(i>>3)+0]=1,r.HEAPF64[(i>>3)+1]=o,i}}}catch(t){console.error(t.toString()),br(r,t.toString())}return 0},glob:(r,e,t)=>{try{let n=ne(r,e,t);if(n.startsWith("http")){let i=new XMLHttpRequest;if(i.open("HEAD",n,!1),i.send(null),i.status!=200&&i.status!==206){br(r,`HEAD request failed: ${n}`);return}r.ccall("duckdb_web_fs_glob_add_path",null,["string"],[n])}}catch(n){return br(r,n.toString()),0}},checkFile:(r,e,t)=>{try{let n=ne(r,e,t);if(n.startsWith("http")){let i=new XMLHttpRequest;i.open("HEAD",n,!1),i.setRequestHeader("Range","bytes=0-"),i.send(null);let o=!1;if(i.status==206)o=!0;else if(i.status==200)o=i.getResponseHeader("Accept-Ranges")==="bytes";else return!1;return!!o}}catch{return!1}return!1},syncFile:(r,e)=>{},closeFile:(r,e)=>{let t=Xe.getFileInfo(r,e);switch(Xe.fileInfoCache.delete(e),t?.dataProtocol){case Ze.HTTP:break;case Ze.NATIVE:return}},truncateFile:(r,e,t)=>{switch(Xe.getFileInfo(r,e)?.dataProtocol){case Ze.HTTP:br(r,"Cannot truncate a http file");return;case Ze.NATIVE:br(r,"truncateFile not implemented");return}return 0},readFile(r,e,t,n,i){try{let o=Xe.getFileInfo(r,e);switch(o?.dataProtocol){case Ze.HTTP:{if(!o.dataUrl)throw new Error(`Missing data URL for file ${e}`);try{let a=new XMLHttpRequest;if(a.open("GET",o.dataUrl,!1),a.responseType="arraybuffer",a.setRequestHeader("Range",`bytes=${i}-${i+n-1}`),a.send(null),a.status==206||a.status==200&&n==a.response.byteLength&&i==0){let u=new Uint8Array(a.response,0,Math.min(a.response.byteLength,n));return r.HEAPU8.set(u,t),u.byteLength}else throw a.status==200?new Error(`Range request for ${o.dataUrl} did not return a partial response: ${a.status} "${a.statusText}"`):new Error(`Range request for ${o.dataUrl} did returned non-success status: ${a.status} "${a.statusText}"`)}catch(a){throw new Error(`Range request for ${o.dataUrl} failed with error: ${a}"`)}}case Ze.NATIVE:{let a=Xe._files?.get(o.fileName);if(!a)throw new Error(`No handle available for file: ${o.fileName}`);let u=a.slice(i,i+n),f=new Uint8Array(new FileReaderSync().readAsArrayBuffer(u));return r.HEAPU8.set(f,t),f.byteLength}}return 0}catch(o){return br(r,o.toString()),0}},writeFile:(r,e,t,n,i)=>{switch(Xe.getFileInfo(r,e)?.dataProtocol){case Ze.HTTP:return br(r,"Cannot write to HTTP file"),0;case Ze.NATIVE:return br(r,"writefile not implemented"),0}return 0},getLastFileModificationTime:(r,e)=>{let t=Xe.getFileInfo(r,e);switch(t?.dataProtocol){case Ze.NATIVE:{if(!Xe._files?.get(t.fileName))throw Error(`No handle available for file: ${t.fileName}`);return 0}case Ze.HTTP:return new Date().getTime()}return 0},checkDirectory:(r,e,t)=>{let n=ne(r,e,t);return console.log(`checkDirectory: ${n}`),!1},createDirectory:(r,e,t)=>{let n=ne(r,e,t);console.log(`createDirectory: ${n}`)},removeDirectory:(r,e,t)=>{let n=ne(r,e,t);console.log(`removeDirectory: ${n}`)},listDirectoryEntries:(r,e,t)=>{let n=ne(r,e,t);return console.log(`listDirectoryEntries: ${n}`),!1},moveFile:(r,e,t,n,i)=>{},removeFile:(r,e,t)=>{}};var Mb=class extends id{postMessage(e,t){globalThis.postMessage(e,t)}async instantiate(e,t){return await new dd(this,Xe,e,t).instantiate()}};function Pb(){let r=new Mb;globalThis.onmessage=async e=>{await r.onMessage(e.data)}}Pb();return r0;})();
//# sourceMappingURL=duckdb-browser-async-next.worker.js.map
